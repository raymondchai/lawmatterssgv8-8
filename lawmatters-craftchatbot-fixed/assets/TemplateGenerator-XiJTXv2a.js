import{r as e,aO as a,j as t,cq as s,b0 as r,aU as n,bO as l,F as i,q as c,W as o,aY as d}from"./react-vendor-SE0pM8Ra.js";import{o as m,s as p,e as u,b as h,t as g}from"./forms-Mu2Tem6y.js";import{aa as x,C as y,u as j,v as f,z as v,o as b,a0 as w,A as N,E as T,G as A,H as S,K as C,I as P,p as q,a1 as F,B as $,L as k,M as _}from"./ai-services-C7T4cFUa.js";import{supabase as U}from"./supabase-Cfql4b7O.js";import{J as R}from"./vendor-CrSvAuNw.js";const E={async getPublicTemplates(){const{data:e,error:a}=await U.from("templates").select("*").eq("is_public",!0).order("created_at",{ascending:!1});if(a)throw a;return e},async getUserTemplates(){const{data:e,error:a}=await U.from("templates").select("*").order("created_at",{ascending:!1});if(a)throw a;return e},async getTemplatesByCategory(e){const{data:a,error:t}=await U.from("templates").select("*").eq("category",e).eq("is_public",!0).order("created_at",{ascending:!1});if(t)throw t;return a},async getTemplate(e){const{data:a,error:t}=await U.from("templates").select("*").eq("id",e).single();if(t)throw t;return a},async createTemplate(e){const a=await U.auth.getUser();if(!a.data.user)throw new Error("User not authenticated");const{data:t,error:s}=await U.from("templates").insert({...e,created_by:a.data.user.id}).select().single();if(s)throw s;return t},async updateTemplate(e,a){const{data:t,error:s}=await U.from("templates").update(a).eq("id",e).select().single();if(s)throw s;return t},async deleteTemplate(e){const{error:a}=await U.from("templates").delete().eq("id",e);if(a)throw a},async searchTemplates(e){const{data:a,error:t}=await U.from("templates").select("*").or(`name.ilike.%${e}%,description.ilike.%${e}%,category.ilike.%${e}%`).eq("is_public",!0).order("created_at",{ascending:!1});if(t)throw t;return a},exportTemplate(e,a="txt"){let t,s;switch(a){case"json":t=JSON.stringify(e,null,2),s="application/json";break;case"docx":t=e.content,s="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;default:t=e.content,s="text/plain"}return new Blob([t],{type:s})},downloadTemplate(e,a="txt"){const t=this.exportTemplate(e,a),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`${e.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.${a}`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)},async createTemplateVersion(e,a,t){const s=await this.getTemplate(e),r={name:`${s.name} v${Date.now()}`,description:a.description||s.description,category:a.category||s.category,content:a.content||s.content,variables:a.variables||s.variables,is_public:a.is_public??s.is_public};return this.createTemplate(r)}};async function I(e){const a=function(e){const{type:a,parties:t,terms:s,customRequirements:r,language:n="english",jurisdiction:l="singapore"}=e;let i=`Generate a professional legal ${a} template for ${"singapore"===l?"Singapore":"international"} use. `;i+="simplified"===n?"Use clear, simple language that non-lawyers can understand. ":"Use standard legal terminology and formal language. ";i+="\n\nTemplate Requirements:\n",i+=`- Document Type: ${a}\n`,(t.party1||t.party2)&&(i+="- Parties:\n",t.party1&&(i+=`  - First Party: Use variable {{party1_name}} for ${t.party1}\n`),t.party2&&(i+=`  - Second Party: Use variable {{party2_name}} for ${t.party2}\n`));Object.keys(s).length>0&&(i+="- Key Terms:\n",Object.entries(s).forEach(([e,a])=>{a&&(i+=`  - ${e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}: Use variable {{${e}}} for ${a}\n`)}));r&&(i+=`- Additional Requirements: ${r}\n`);return i+="\nInstructions:\n",i+="1. Create a complete, legally sound template\n",i+="2. Use variables in double curly braces {{variable_name}} for customizable fields\n",i+="3. Include all necessary legal clauses and provisions\n",i+="4. Ensure compliance with Singapore law (if applicable)\n",i+="5. Add appropriate signature blocks and date fields\n",i+="6. Include clear section headings and numbering\n\n",i+="Format your response as JSON with the following structure:\n",i+="{\n",i+='  "name": "Template name",\n',i+='  "description": "Brief description of the template",\n',i+='  "category": "Template category (contracts, employment, corporate, etc.)",\n',i+='  "content": "Full template content with variables",\n',i+='  "variables": ["list", "of", "variable", "names"]\n',i+="}\n\n",i+="Respond with valid JSON only, no additional text.",i}(e);try{const t=await x(a,[],[]),s=function(e,a){try{const t=JSON.parse(e);return{name:t.name||`${a.type} Template`,content:t.content||e,variables:t.variables||L(t.content||e),category:t.category||G(a.type),description:t.description||`AI-generated ${a.type} template`}}catch(t){return{name:`${a.type} Template`,content:e,variables:L(e),category:G(a.type),description:`AI-generated ${a.type} template`}}}(t.message,e);return{...s,confidence:t.confidence}}catch(t){throw new Error("Failed to generate template")}}function L(e){const a=e.match(/\{\{([^}]+)\}\}/g)||[];return[...new Set(a.map(e=>e.replace(/[{}]/g,"").trim()))]}function G(e){return{contract:"contracts",agreement:"contracts","employment contract":"employment","service agreement":"contracts",nda:"contracts","non-disclosure agreement":"contracts","lease agreement":"real-estate","rental agreement":"real-estate","purchase agreement":"real-estate","partnership agreement":"corporate","shareholder agreement":"corporate","articles of incorporation":"corporate","trademark application":"intellectual-property","copyright notice":"intellectual-property","privacy policy":"compliance","terms of service":"compliance",will:"personal","power of attorney":"personal"}[e.toLowerCase()]||"other"}const O=m({type:p().min(1,"Template type is required"),party1:p().optional(),party2:p().optional(),duration:p().optional(),amount:p().optional(),jurisdiction:u(["singapore","international"]).default("singapore"),language:u(["english","simplified"]).default("english"),customRequirements:p().optional(),saveAsPublic:h().default(!1)}),D=[{value:"service agreement",label:"Service Agreement"},{value:"employment contract",label:"Employment Contract"},{value:"non-disclosure agreement",label:"Non-Disclosure Agreement (NDA)"},{value:"consulting agreement",label:"Consulting Agreement"},{value:"partnership agreement",label:"Partnership Agreement"},{value:"lease agreement",label:"Lease Agreement"},{value:"purchase agreement",label:"Purchase Agreement"},{value:"terms of service",label:"Terms of Service"},{value:"privacy policy",label:"Privacy Policy"},{value:"shareholder agreement",label:"Shareholder Agreement"},{value:"licensing agreement",label:"Licensing Agreement"},{value:"distribution agreement",label:"Distribution Agreement"}],V=({onTemplateGenerated:m,className:p=""})=>{const[u,h]=e.useState(!1),[x,U]=e.useState(null),[L,G]=e.useState(!1),{register:V,handleSubmit:B,watch:J,setValue:z,formState:{errors:M}}=a({resolver:g(O),defaultValues:{jurisdiction:"singapore",language:"english",saveAsPublic:!1}}),H=J("type");return t.jsxs("div",{className:`space-y-6 ${p}`,children:[t.jsx(y,{children:t.jsxs(j,{children:[t.jsxs(f,{className:"flex items-center space-x-2",children:[t.jsx(s,{className:"h-5 w-5 text-purple-600"}),t.jsx("span",{children:"AI Template Generator"})]}),t.jsx(v,{children:"Generate custom legal templates using AI. Fill in the details below to create a professional legal document."})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(y,{children:[t.jsxs(j,{children:[t.jsx(f,{className:"text-lg",children:"Template Details"}),t.jsx(v,{children:"Provide information about the template you want to generate"})]}),t.jsx(b,{children:t.jsxs("form",{onSubmit:B(async e=>{h(!0);try{const a={type:e.type,parties:{party1:e.party1,party2:e.party2},terms:{duration:e.duration,amount:e.amount,jurisdiction:e.jurisdiction},customRequirements:e.customRequirements,language:e.language,jurisdiction:e.jurisdiction},t=await I(a);U(t),G(!0),m?.(t),R.success("Template generated successfully!")}catch(a){R.error("Failed to generate template: "+a.message)}finally{h(!1)}}),className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"type",children:"Template Type *"}),t.jsxs(N,{onValueChange:e=>z("type",e),children:[t.jsx(T,{children:t.jsx(A,{placeholder:"Select template type"})}),t.jsx(S,{children:D.map(e=>t.jsx(C,{value:e.value,children:e.label},e.value))})]}),M.type&&t.jsx("p",{className:"text-red-500 text-sm",children:M.type.message}),H&&t.jsx("p",{className:"text-sm text-gray-600",children:(K=H,{"service agreement":"A contract for providing services between two parties","employment contract":"An agreement between employer and employee","non-disclosure agreement":"A confidentiality agreement to protect sensitive information","consulting agreement":"A contract for consulting services","partnership agreement":"An agreement between business partners","lease agreement":"A rental agreement for property","purchase agreement":"A contract for buying/selling goods or property","terms of service":"Terms and conditions for using a service or platform","privacy policy":"A policy explaining how personal data is collected and used","shareholder agreement":"An agreement between company shareholders"}[K]||"A legal document template")})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"party1",children:"First Party"}),t.jsx(P,{...V("party1"),placeholder:"e.g., Service Provider, Employer"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"party2",children:"Second Party"}),t.jsx(P,{...V("party2"),placeholder:"e.g., Client, Employee"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"duration",children:"Duration/Term"}),t.jsx(P,{...V("duration"),placeholder:"e.g., 12 months, 2 years"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"amount",children:"Amount/Value"}),t.jsx(P,{...V("amount"),placeholder:"e.g., $5,000, SGD 10,000"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"jurisdiction",children:"Jurisdiction"}),t.jsxs(N,{onValueChange:e=>z("jurisdiction",e),children:[t.jsx(T,{children:t.jsx(A,{placeholder:"Select jurisdiction"})}),t.jsxs(S,{children:[t.jsx(C,{value:"singapore",children:"Singapore"}),t.jsx(C,{value:"international",children:"International"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"language",children:"Language Style"}),t.jsxs(N,{onValueChange:e=>z("language",e),children:[t.jsx(T,{children:t.jsx(A,{placeholder:"Select language style"})}),t.jsxs(S,{children:[t.jsx(C,{value:"english",children:"Standard Legal"}),t.jsx(C,{value:"simplified",children:"Plain English"})]})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(w,{htmlFor:"customRequirements",children:"Additional Requirements"}),t.jsx(q,{...V("customRequirements"),placeholder:"Describe any specific clauses, terms, or requirements you need...",rows:3})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(F,{id:"saveAsPublic",onCheckedChange:e=>z("saveAsPublic",!!e)}),t.jsx(w,{htmlFor:"saveAsPublic",className:"text-sm",children:"Make this template public for other users"})]}),t.jsx($,{type:"submit",disabled:u,className:"w-full",children:u?t.jsxs(t.Fragment,{children:[t.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Template..."]}):t.jsxs(t.Fragment,{children:[t.jsx(s,{className:"mr-2 h-4 w-4"}),"Generate Template"]})})]})})]}),t.jsxs(y,{children:[t.jsx(j,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(f,{className:"text-lg",children:"Generated Template"}),t.jsx(v,{children:"Preview and save your AI-generated template"})]}),x&&t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs($,{variant:"outline",size:"sm",onClick:()=>G(!L),children:[t.jsx(n,{className:"h-4 w-4 mr-2"}),L?"Hide":"Show"," Preview"]}),t.jsxs($,{size:"sm",onClick:async()=>{if(x)try{const e=J("saveAsPublic");await async function(e,a=!1){try{const t={name:e.name,description:e.description,category:e.category,content:e.content,variables:e.variables,is_public:a};return await E.createTemplate(t)}catch(t){throw new Error("Failed to save template")}}(x,e),R.success("Template saved successfully!")}catch(e){R.error("Failed to save template: "+e.message)}},children:[t.jsx(l,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})}),t.jsx(b,{children:x?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx(c,{className:"h-5 w-5 text-green-600"}),t.jsx("h4",{className:"font-medium text-green-900",children:x.name})]}),t.jsx("p",{className:"text-sm text-green-700 mb-2",children:x.description}),t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-green-600",children:[t.jsxs("span",{children:["Category: ",x.category]}),t.jsxs("span",{children:["Variables: ",x.variables.length]}),t.jsxs("span",{children:["Confidence: ",Math.round(100*x.confidence),"%"]})]})]}),x.variables.length>0&&t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium text-sm mb-2",children:"Template Variables:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:x.variables.map((e,a)=>t.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:e},a))})]}),L&&t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium text-sm mb-2",children:"Template Content:"}),t.jsx("div",{className:"max-h-64 overflow-y-auto p-3 bg-gray-50 rounded border text-sm",children:t.jsx("pre",{className:"whitespace-pre-wrap font-mono",children:x.content})})]}),x.confidence<.7&&t.jsxs(k,{children:[t.jsx(o,{className:"h-4 w-4"}),t.jsx(_,{children:"This template was generated with lower confidence. Please review carefully and consider consulting a legal professional."})]})]}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(i,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No template generated yet"}),t.jsx("p",{className:"text-gray-500",children:'Fill in the form and click "Generate Template" to create your custom legal document.'})]})})]})]}),t.jsxs(y,{children:[t.jsx(j,{children:t.jsxs(f,{className:"text-sm flex items-center space-x-2",children:[t.jsx(d,{className:"h-4 w-4"}),t.jsx("span",{children:"Tips for Better Templates"})]})}),t.jsx(b,{children:t.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[t.jsx("li",{children:"• Be specific about the type of agreement you need"}),t.jsx("li",{children:'• Provide clear party descriptions (e.g., "Software Company" vs "Company A")'}),t.jsx("li",{children:"• Include specific terms like duration, amounts, and key obligations"}),t.jsx("li",{children:"• Mention any special requirements or unique clauses needed"}),t.jsx("li",{children:"• Choose the appropriate jurisdiction for your use case"}),t.jsx("li",{children:'• Use "Plain English" style for simpler, more readable templates'})]})})]})]});var K};export{V as T,E as t};
