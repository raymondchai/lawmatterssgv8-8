import"./vendor-CrSvAuNw.js";function e(e,t){for(var a=0;a<t.length;a++){const o=t[a];if("string"!=typeof o&&!Array.isArray(o))for(const t in o)if("default"!==t&&!(t in e)){const a=Object.getOwnPropertyDescriptor(o,t);a&&Object.defineProperty(e,t,a.get?a:{enumerable:!0,get:()=>o[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var a=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};a.prototype=t.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(a,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})}),a}function r(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var n=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`;const i=n;let s=0;var l=({id:e,action:t,payload:a={}})=>{let o=e;return void 0===o&&(o=i("Job",s),s+=1),{id:o,action:t,payload:a}},c={};let d=!1;c.logging=d,c.setLogging=e=>{d=e},c.log=(...e)=>d?void 0:null;const u=l,{log:g}=c,p=n;let f=0;const y="browser"===(e=>{const t={};return"undefined"!=typeof WorkerGlobalScope?t.type="webworker":"object"==typeof document?t.type="browser":"object"==typeof process&&(t.type="node"),void 0===e?t:t[e]})("type")?e=>new URL(e,window.location.href).href:e=>e;var h={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};var m={...{workerBlobURL:!0,logger:()=>{}},workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${"6.0.1"}/dist/worker.min.js`};const L=e=>new Promise((t,a)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=({target:{error:{code:e}}})=>{a(Error(`File could not be read! Code=${e}`))},o.readAsArrayBuffer(e)}),w=async e=>{let t=e;if(void 0===e)return"undefined";if("string"==typeof e)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e))t=atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0));else{const a=await fetch(e);t=await a.arrayBuffer()}else if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)"IMG"===e.tagName&&(t=await w(e.src)),"VIDEO"===e.tagName&&(t=await w(e.poster)),"CANVAS"===e.tagName&&await new Promise(a=>{e.toBlob(async e=>{t=await L(e),a()})});else if("undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas){const a=await e.convertToBlob();t=await L(a)}else(e instanceof File||e instanceof Blob)&&(t=await L(e));return new Uint8Array(t)};var S={defaultOptions:m,spawnWorker:({workerPath:e,workerBlobURL:t})=>{let a;if(Blob&&URL&&t){const t=new Blob([`importScripts("${e}");`],{type:"application/javascript"});a=new Worker(URL.createObjectURL(t))}else a=new Worker(e);return a},terminateWorker:e=>{e.terminate()},onMessage:(e,t)=>{e.onmessage=({data:e})=>{t(e)}},send:async(e,t)=>{e.postMessage(t)},loadImage:w};const A=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach(a=>{e[a]&&(t[a]=y(t[a]))}),t},E=l,{log:b}=c,O=n,T=h,{defaultOptions:_,spawnWorker:R,terminateWorker:k,onMessage:N,loadImage:P,send:I}=S;let v=0;var M=async(e="eng",t=T.LSTM_ONLY,a={},o={})=>{const r=O("Worker",v),{logger:n,errorHandler:i,...s}=A({..._,...a}),l={},c="string"==typeof e?e.split("+"):e;let d=t,u=o;const g=[T.DEFAULT,T.LSTM_ONLY].includes(t)&&!s.legacyCore;let p,f;const y=new Promise((e,t)=>{f=e,p=t});let h=R(s);h.onerror=e=>{p(e.message)},v+=1;const m=({id:e,action:t,payload:a})=>new Promise((o,n)=>{b(`[${r}]: Start ${e}, action=${t}`);l[`${t}-${e}`]={resolve:o,reject:n},I(h,{workerId:r,jobId:e,action:t,payload:a})}),L=(e,t)=>m(E({id:t,action:"loadLanguage",payload:{langs:e,options:{langPath:s.langPath,dataPath:s.dataPath,cachePath:s.cachePath,cacheMethod:s.cacheMethod,gzip:s.gzip,lstmOnly:[T.DEFAULT,T.LSTM_ONLY].includes(d)&&!s.legacyLang}}})),w=(e,t,a,o)=>m(E({id:o,action:"initialize",payload:{langs:e,oem:t,config:a}}));N(h,({workerId:e,jobId:t,status:a,action:o,data:r})=>{const s=`${o}-${t}`;if("resolve"===a)b(`[${e}]: Complete ${t}`),l[s].resolve({jobId:t,data:r}),delete l[s];else if("reject"===a){if(l[s].reject(r),delete l[s],"load"===o&&p(r),!i)throw Error(r);i(r)}else"progress"===a&&n({...r,userJobId:t})});const S={id:r,worker:h,load:()=>{},writeText:(e,t,a)=>m(E({id:a,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>m(E({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>m(E({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,a)=>m(E({id:a,action:"FS",payload:{method:e,args:t}})),reinitialize:(e="eng",t,a,o)=>{if(g&&[T.TESSERACT_ONLY,T.TESSERACT_LSTM_COMBINED].includes(t))throw Error("Legacy model requested but code missing.");const r=t||d;d=r;const n=a||u;u=n;const i=("string"==typeof e?e.split("+"):e).filter(e=>!c.includes(e));return c.push(...i),i.length>0?L(i,o).then(()=>w(e,r,n,o)):w(e,r,n,o)},setParameters:(e={},t)=>m(E({id:t,action:"setParameters",payload:{params:e}})),recognize:async(e,t={},a={text:!0},o)=>m(E({id:o,action:"recognize",payload:{image:await P(e),options:t,output:a}})),detect:async(e,t)=>{if(g)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return m(E({id:t,action:"detect",payload:{image:await P(e)}}))},terminate:async()=>(null!==h&&(k(h),h=null),Promise.resolve())};var M;return m(E({id:M,action:"load",payload:{options:{lstmOnly:g,corePath:s.corePath,logging:s.logging}}})).then(()=>L(e)).then(()=>w(e,t,o)).then(()=>f(S)).catch(()=>{}),y};const j=M;const C=()=>{const e=p("Scheduler",f),t={},a={};let o=[];f+=1;const r=()=>Object.keys(t).length,n=()=>{if(0!==o.length){const e=Object.keys(t);for(let r=0;r<e.length;r+=1)if(void 0===a[e[r]]){o[0](t[e[r]]);break}}};return{addWorker:a=>(t[a.id]=a,g(`[${e}]: Add ${a.id}`),g(`[${e}]: Number of workers=${r()}`),n(),a.id),addJob:async(t,...i)=>{if(0===r())throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return((t,r)=>new Promise((i,s)=>{const l=u({action:t,payload:r});o.push(async e=>{o.shift(),a[e.id]=l;try{i(await e[t].apply(void 0,[...r,l.id]))}catch(c){s(c)}finally{delete a[e.id],n()}}),g(`[${e}]: Add ${l.id} to JobQueue`),g(`[${e}]: JobQueue length=${o.length}`),n()}))(t,i)},terminate:async()=>{Object.keys(t).forEach(async e=>{await t[e].terminate()}),o=[]},getQueueLen:()=>o.length,getNumWorkers:r}},U=M,D={recognize:async(e,t,a)=>{const o=await j(t,1,a);return o.recognize(e).finally(async()=>{await o.terminate()})},detect:async(e,t)=>{const a=await j("osd",0,t);return a.detect(e).finally(async()=>{await a.terminate()})}},$={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},B=h,F={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"},{setLogging:G}=c;var z={languages:$,OEM:B,PSM:F,createScheduler:C,createWorker:U,setLogging:G,...D};const K=e({__proto__:null,default:a(z)},[z]);export{o as a,r as b,t as c,a as g,K as i};
