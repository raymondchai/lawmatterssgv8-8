const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdfWorker-U21o7yO1.js","assets/ui-rwFeZS9w.js","assets/vendor-BIY3Q1RY.js","assets/ocr-worker-BKso6bwf.js","assets/jszip.min-DVQYy7dD.js","assets/PdfAnnotationsDemo-Ds5wn2OS.js","assets/PdfAnnotationsDemo-C7U9D9nZ.css"])))=>i.map(i=>d[i]);
var UD=Object.defineProperty;var Mw=r=>{throw TypeError(r)};var $D=(r,t,s)=>t in r?UD(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var rs=(r,t,s)=>$D(r,typeof t!="symbol"?t+"":t,s),vp=(r,t,s)=>t.has(r)||Mw("Cannot "+s);var G=(r,t,s)=>(vp(r,t,"read from private field"),s?s.call(r):t.get(r)),Xe=(r,t,s)=>t.has(r)?Mw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,s),Oe=(r,t,s,a)=>(vp(r,t,"write to private field"),a?a.call(r,s):t.set(r,s),s),kt=(r,t,s)=>(vp(r,t,"access private method"),s);var Bu=(r,t,s,a)=>({set _(n){Oe(r,t,n,s)},get _(){return G(r,t,a)}});import{j as e,P as zt,c as m_,a as Io,u as Ys,B as zD,b as _o,d as Pd,e as Fl,f as Nt,R as BD,g as Dg,h as Va,i as qD,k as ec,A as fm,D as Fg,C as Og,S as VD,l as Mg,m as Id,n as Lg,o as pm,O as xm,p as gm,q as f_,T as ym,r as vm,s as p_,t as x_,v as g_,w as y_,x as v_,y as w_,z as j_,F as b_,E as WD,_ as Do,G as __,H as N_,I as HD,J as S_,K as k_,L as C_,M as E_,N as A_,Q as T_,U as R_,V as GD,W as KD}from"./ui-rwFeZS9w.js";import{a as wm,r as p,R as xe,G as QD,u as ps,L as gs,b as P_,c as Fi,d as Ug,N as Lw,e as Dd,B as YD,f as JD,g as Et}from"./vendor-BIY3Q1RY.js";import{a as ZD,c as ca,g as XD}from"./ocr-worker-BKso6bwf.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var I_,Uw=wm;I_=Uw.createRoot,Uw.hydrateRoot;const e5="modulepreload",t5=function(r){return"/"+r},$w={},Ns=function(t,s,a){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(s.map(d=>{if(d=t5(d),d in $w)return;$w[d]=!0;const h=d.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":e5,h||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),h)return new Promise((g,y)=>{f.addEventListener("load",g),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})},s5=1,r5=1e6;let wp=0;function a5(){return wp=(wp+1)%Number.MAX_SAFE_INTEGER,wp.toString()}const jp=new Map,zw=r=>{if(jp.has(r))return;const t=setTimeout(()=>{jp.delete(r),ed({type:"REMOVE_TOAST",toastId:r})},r5);jp.set(r,t)},n5=(r,t)=>{switch(t.type){case"ADD_TOAST":return{...r,toasts:[t.toast,...r.toasts].slice(0,s5)};case"UPDATE_TOAST":return{...r,toasts:r.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?zw(s):r.toasts.forEach(a=>{zw(a.id)}),{...r,toasts:r.toasts.map(a=>a.id===s||s===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return t.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(s=>s.id!==t.toastId)}}},ph=[];let xh={toasts:[]};function ed(r){xh=n5(xh,r),ph.forEach(t=>{t(xh)})}function i5({...r}){const t=a5(),s=n=>ed({type:"UPDATE_TOAST",toast:{...n,id:t}}),a=()=>ed({type:"DISMISS_TOAST",toastId:t});return ed({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:n=>{n||a()}}}),{id:t,dismiss:a,update:s}}function Bn(){const[r,t]=p.useState(xh);return p.useEffect(()=>(ph.push(t),()=>{const s=ph.indexOf(t);s>-1&&ph.splice(s,1)}),[r]),{...r,toast:i5,dismiss:s=>ed({type:"DISMISS_TOAST",toastId:s})}}var o5="VisuallyHidden",Fd=p.forwardRef((r,t)=>e.jsx(zt.span,{...r,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...r.style}}));Fd.displayName=o5;var l5=Fd,$g="ToastProvider",[zg,c5,d5]=m_("Toast"),[D_,gW]=Io("Toast",[d5]),[u5,jm]=D_($g),F_=r=>{const{__scopeToast:t,label:s="Notification",duration:a=5e3,swipeDirection:n="right",swipeThreshold:i=50,children:o}=r,[c,d]=p.useState(null),[h,m]=p.useState(0),f=p.useRef(!1),g=p.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${$g}\`. Expected non-empty \`string\`.`),e.jsx(zg.Provider,{scope:t,children:e.jsx(u5,{scope:t,label:s,duration:a,swipeDirection:n,swipeThreshold:i,toastCount:h,viewport:c,onViewportChange:d,onToastAdd:p.useCallback(()=>m(y=>y+1),[]),onToastRemove:p.useCallback(()=>m(y=>y-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:g,children:o})})};F_.displayName=$g;var O_="ToastViewport",h5=["F8"],dx="toast.viewportPause",ux="toast.viewportResume",M_=p.forwardRef((r,t)=>{const{__scopeToast:s,hotkey:a=h5,label:n="Notifications ({hotkey})",...i}=r,o=jm(O_,s),c=c5(s),d=p.useRef(null),h=p.useRef(null),m=p.useRef(null),f=p.useRef(null),g=Ys(t,f,o.onViewportChange),y=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),b=o.toastCount>0;p.useEffect(()=>{const S=N=>{var j;a.length!==0&&a.every(C=>N[C]||N.code===C)&&((j=f.current)==null||j.focus())};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[a]),p.useEffect(()=>{const S=d.current,N=f.current;if(b&&S&&N){const v=()=>{if(!o.isClosePausedRef.current){const I=new CustomEvent(dx);N.dispatchEvent(I),o.isClosePausedRef.current=!0}},j=()=>{if(o.isClosePausedRef.current){const I=new CustomEvent(ux);N.dispatchEvent(I),o.isClosePausedRef.current=!1}},C=I=>{!S.contains(I.relatedTarget)&&j()},k=()=>{S.contains(document.activeElement)||j()};return S.addEventListener("focusin",v),S.addEventListener("focusout",C),S.addEventListener("pointermove",v),S.addEventListener("pointerleave",k),window.addEventListener("blur",v),window.addEventListener("focus",j),()=>{S.removeEventListener("focusin",v),S.removeEventListener("focusout",C),S.removeEventListener("pointermove",v),S.removeEventListener("pointerleave",k),window.removeEventListener("blur",v),window.removeEventListener("focus",j)}}},[b,o.isClosePausedRef]);const w=p.useCallback(({tabbingDirection:S})=>{const v=c().map(j=>{const C=j.ref.current,k=[C,...S5(C)];return S==="forwards"?k:k.reverse()});return(S==="forwards"?v.reverse():v).flat()},[c]);return p.useEffect(()=>{const S=f.current;if(S){const N=v=>{var k,I,T;const j=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!j){const O=document.activeElement,U=v.shiftKey;if(v.target===S&&U){(k=h.current)==null||k.focus();return}const M=w({tabbingDirection:U?"backwards":"forwards"}),se=M.findIndex(W=>W===O);bp(M.slice(se+1))?v.preventDefault():U?(I=h.current)==null||I.focus():(T=m.current)==null||T.focus()}};return S.addEventListener("keydown",N),()=>S.removeEventListener("keydown",N)}},[c,w]),e.jsxs(zD,{ref:d,role:"region","aria-label":n.replace("{hotkey}",y),tabIndex:-1,style:{pointerEvents:b?void 0:"none"},children:[b&&e.jsx(hx,{ref:h,onFocusFromOutsideViewport:()=>{const S=w({tabbingDirection:"forwards"});bp(S)}}),e.jsx(zg.Slot,{scope:s,children:e.jsx(zt.ol,{tabIndex:-1,...i,ref:g})}),b&&e.jsx(hx,{ref:m,onFocusFromOutsideViewport:()=>{const S=w({tabbingDirection:"backwards"});bp(S)}})]})});M_.displayName=O_;var L_="ToastFocusProxy",hx=p.forwardRef((r,t)=>{const{__scopeToast:s,onFocusFromOutsideViewport:a,...n}=r,i=jm(L_,s);return e.jsx(Fd,{"aria-hidden":!0,tabIndex:0,...n,ref:t,style:{position:"fixed"},onFocus:o=>{var h;const c=o.relatedTarget;!((h=i.viewport)!=null&&h.contains(c))&&a()}})});hx.displayName=L_;var bm="Toast",m5="toast.swipeStart",f5="toast.swipeMove",p5="toast.swipeCancel",x5="toast.swipeEnd",U_=p.forwardRef((r,t)=>{const{forceMount:s,open:a,defaultOpen:n,onOpenChange:i,...o}=r,[c=!0,d]=_o({prop:a,defaultProp:n,onChange:i});return e.jsx(Pd,{present:s||c,children:e.jsx(v5,{open:c,...o,ref:t,onClose:()=>d(!1),onPause:Fl(r.onPause),onResume:Fl(r.onResume),onSwipeStart:Nt(r.onSwipeStart,h=>{h.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Nt(r.onSwipeMove,h=>{const{x:m,y:f}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","move"),h.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Nt(r.onSwipeCancel,h=>{h.currentTarget.setAttribute("data-swipe","cancel"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Nt(r.onSwipeEnd,h=>{const{x:m,y:f}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","end"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),d(!1)})})})});U_.displayName=bm;var[g5,y5]=D_(bm,{onClose(){}}),v5=p.forwardRef((r,t)=>{const{__scopeToast:s,type:a="foreground",duration:n,open:i,onClose:o,onEscapeKeyDown:c,onPause:d,onResume:h,onSwipeStart:m,onSwipeMove:f,onSwipeCancel:g,onSwipeEnd:y,...b}=r,w=jm(bm,s),[S,N]=p.useState(null),v=Ys(t,W=>N(W)),j=p.useRef(null),C=p.useRef(null),k=n||w.duration,I=p.useRef(0),T=p.useRef(k),O=p.useRef(0),{onToastAdd:U,onToastRemove:A}=w,L=Fl(()=>{var q;(S==null?void 0:S.contains(document.activeElement))&&((q=w.viewport)==null||q.focus()),o()}),M=p.useCallback(W=>{!W||W===1/0||(window.clearTimeout(O.current),I.current=new Date().getTime(),O.current=window.setTimeout(L,W))},[L]);p.useEffect(()=>{const W=w.viewport;if(W){const q=()=>{M(T.current),h==null||h()},K=()=>{const Y=new Date().getTime()-I.current;T.current=T.current-Y,window.clearTimeout(O.current),d==null||d()};return W.addEventListener(dx,K),W.addEventListener(ux,q),()=>{W.removeEventListener(dx,K),W.removeEventListener(ux,q)}}},[w.viewport,k,d,h,M]),p.useEffect(()=>{i&&!w.isClosePausedRef.current&&M(k)},[i,k,w.isClosePausedRef,M]),p.useEffect(()=>(U(),()=>A()),[U,A]);const se=p.useMemo(()=>S?H_(S):null,[S]);return w.viewport?e.jsxs(e.Fragment,{children:[se&&e.jsx(w5,{__scopeToast:s,role:"status","aria-live":a==="foreground"?"assertive":"polite","aria-atomic":!0,children:se}),e.jsx(g5,{scope:s,onClose:L,children:wm.createPortal(e.jsx(zg.ItemSlot,{scope:s,children:e.jsx(BD,{asChild:!0,onEscapeKeyDown:Nt(c,()=>{w.isFocusedToastEscapeKeyDownRef.current||L(),w.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(zt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":w.swipeDirection,...b,ref:v,style:{userSelect:"none",touchAction:"none",...r.style},onKeyDown:Nt(r.onKeyDown,W=>{W.key==="Escape"&&(c==null||c(W.nativeEvent),W.nativeEvent.defaultPrevented||(w.isFocusedToastEscapeKeyDownRef.current=!0,L()))}),onPointerDown:Nt(r.onPointerDown,W=>{W.button===0&&(j.current={x:W.clientX,y:W.clientY})}),onPointerMove:Nt(r.onPointerMove,W=>{if(!j.current)return;const q=W.clientX-j.current.x,K=W.clientY-j.current.y,Y=!!C.current,le=["left","right"].includes(w.swipeDirection),Ne=["left","up"].includes(w.swipeDirection)?Math.min:Math.max,Ke=le?Ne(0,q):0,ke=le?0:Ne(0,K),$e=W.pointerType==="touch"?10:2,ce={x:Ke,y:ke},Re={originalEvent:W,delta:ce};Y?(C.current=ce,qu(f5,f,Re,{discrete:!1})):Bw(ce,w.swipeDirection,$e)?(C.current=ce,qu(m5,m,Re,{discrete:!1}),W.target.setPointerCapture(W.pointerId)):(Math.abs(q)>$e||Math.abs(K)>$e)&&(j.current=null)}),onPointerUp:Nt(r.onPointerUp,W=>{const q=C.current,K=W.target;if(K.hasPointerCapture(W.pointerId)&&K.releasePointerCapture(W.pointerId),C.current=null,j.current=null,q){const Y=W.currentTarget,le={originalEvent:W,delta:q};Bw(q,w.swipeDirection,w.swipeThreshold)?qu(x5,y,le,{discrete:!0}):qu(p5,g,le,{discrete:!0}),Y.addEventListener("click",Ne=>Ne.preventDefault(),{once:!0})}})})})}),w.viewport)})]}):null}),w5=r=>{const{__scopeToast:t,children:s,...a}=r,n=jm(bm,t),[i,o]=p.useState(!1),[c,d]=p.useState(!1);return _5(()=>o(!0)),p.useEffect(()=>{const h=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(h)},[]),c?null:e.jsx(Dg,{asChild:!0,children:e.jsx(Fd,{...a,children:i&&e.jsxs(e.Fragment,{children:[n.label," ",s]})})})},j5="ToastTitle",$_=p.forwardRef((r,t)=>{const{__scopeToast:s,...a}=r;return e.jsx(zt.div,{...a,ref:t})});$_.displayName=j5;var b5="ToastDescription",z_=p.forwardRef((r,t)=>{const{__scopeToast:s,...a}=r;return e.jsx(zt.div,{...a,ref:t})});z_.displayName=b5;var B_="ToastAction",q_=p.forwardRef((r,t)=>{const{altText:s,...a}=r;return s.trim()?e.jsx(W_,{altText:s,asChild:!0,children:e.jsx(Bg,{...a,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${B_}\`. Expected non-empty \`string\`.`),null)});q_.displayName=B_;var V_="ToastClose",Bg=p.forwardRef((r,t)=>{const{__scopeToast:s,...a}=r,n=y5(V_,s);return e.jsx(W_,{asChild:!0,children:e.jsx(zt.button,{type:"button",...a,ref:t,onClick:Nt(r.onClick,n.onClose)})})});Bg.displayName=V_;var W_=p.forwardRef((r,t)=>{const{__scopeToast:s,altText:a,...n}=r;return e.jsx(zt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...n,ref:t})});function H_(r){const t=[];return Array.from(r.childNodes).forEach(a=>{if(a.nodeType===a.TEXT_NODE&&a.textContent&&t.push(a.textContent),N5(a)){const n=a.ariaHidden||a.hidden||a.style.display==="none",i=a.dataset.radixToastAnnounceExclude==="";if(!n)if(i){const o=a.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...H_(a))}}),t}function qu(r,t,s,{discrete:a}){const n=s.originalEvent.currentTarget,i=new CustomEvent(r,{bubbles:!0,cancelable:!0,detail:s});t&&n.addEventListener(r,t,{once:!0}),a?qD(n,i):n.dispatchEvent(i)}var Bw=(r,t,s=0)=>{const a=Math.abs(r.x),n=Math.abs(r.y),i=a>n;return t==="left"||t==="right"?i&&a>s:!i&&n>s};function _5(r=()=>{}){const t=Fl(r);Va(()=>{let s=0,a=0;return s=window.requestAnimationFrame(()=>a=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(s),window.cancelAnimationFrame(a)}},[t])}function N5(r){return r.nodeType===r.ELEMENT_NODE}function S5(r){const t=[],s=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const n=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||n?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)t.push(s.currentNode);return t}function bp(r){const t=document.activeElement;return r.some(s=>s===t?!0:(s.focus(),document.activeElement!==t))}var k5=F_,G_=M_,K_=U_,Q_=$_,Y_=z_,J_=q_,Z_=Bg;function X_(r){var t,s,a="";if(typeof r=="string"||typeof r=="number")a+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(t=0;t<n;t++)r[t]&&(s=X_(r[t]))&&(a&&(a+=" "),a+=s)}else for(s in r)r[s]&&(a&&(a+=" "),a+=s);return a}function eN(){for(var r,t,s=0,a="",n=arguments.length;s<n;s++)(r=arguments[s])&&(t=X_(r))&&(a&&(a+=" "),a+=t);return a}const qw=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Vw=eN,tc=(r,t)=>s=>{var a;if((t==null?void 0:t.variants)==null)return Vw(r,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:n,defaultVariants:i}=t,o=Object.keys(n).map(h=>{const m=s==null?void 0:s[h],f=i==null?void 0:i[h];if(m===null)return null;const g=qw(m)||qw(f);return n[h][g]}),c=s&&Object.entries(s).reduce((h,m)=>{let[f,g]=m;return g===void 0||(h[f]=g),h},{}),d=t==null||(a=t.compoundVariants)===null||a===void 0?void 0:a.reduce((h,m)=>{let{class:f,className:g,...y}=m;return Object.entries(y).every(b=>{let[w,S]=b;return Array.isArray(S)?S.includes({...i,...c}[w]):{...i,...c}[w]===S})?[...h,f,g]:h},[]);return Vw(r,o,d,s==null?void 0:s.class,s==null?void 0:s.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C5=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tN=(...r)=>r.filter((t,s,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===s).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A5=p.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:o,...c},d)=>p.createElement("svg",{ref:d,...E5,width:t,height:t,stroke:r,strokeWidth:a?Number(s)*24/Number(t):s,className:tN("lucide",n),...c},[...o.map(([h,m])=>p.createElement(h,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=(r,t)=>{const s=p.forwardRef(({className:a,...n},i)=>p.createElement(A5,{ref:i,iconNode:t,className:tN(`lucide-${C5(r)}`,a),...n}));return s.displayName=`${r}`,s};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=me("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=me("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=me("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R5=me("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=me("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=me("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P5=me("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=me("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I5=me("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D5=me("BookmarkCheck",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=me("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=me("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=me("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=me("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=me("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F5=me("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=me("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=me("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O5=me("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=me("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M5=me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aN=me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L5=me("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=me("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=me("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=me("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=me("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=me("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=me("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=me("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=me("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=me("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=me("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=me("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U5=me("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=me("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=me("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=me("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=me("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=me("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=me("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=me("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z5=me("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=me("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=me("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=me("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=me("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B5=me("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=me("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=me("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q5=me("Highlighter",[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=me("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=me("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=me("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=me("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=me("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=me("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=me("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=me("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lN=me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=me("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=me("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W5=me("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=me("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H5=me("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=me("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=me("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=me("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G5=me("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=me("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=me("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=me("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K5=me("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=me("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=me("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q5=me("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=me("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=me("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y5=me("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=me("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=me("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J5=me("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=me("ShieldX",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=me("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=me("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=me("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z5=me("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=me("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=me("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=me("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X5=me("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=me("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=me("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=me("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=me("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=me("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=me("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=me("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=me("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=me("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=me("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=me("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=me("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=me("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=me("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=me("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=me("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Jg="-",o6=r=>{const t=c6(r),{conflictingClassGroups:s,conflictingClassGroupModifiers:a}=r;return{getClassGroupId:o=>{const c=o.split(Jg);return c[0]===""&&c.length!==1&&c.shift(),hN(c,t)||l6(o)},getConflictingClassGroupIds:(o,c)=>{const d=s[o]||[];return c&&a[o]?[...d,...a[o]]:d}}},hN=(r,t)=>{var o;if(r.length===0)return t.classGroupId;const s=r[0],a=t.nextPart.get(s),n=a?hN(r.slice(1),a):void 0;if(n)return n;if(t.validators.length===0)return;const i=r.join(Jg);return(o=t.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},Yw=/^\[(.+)\]$/,l6=r=>{if(Yw.test(r)){const t=Yw.exec(r)[1],s=t==null?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},c6=r=>{const{theme:t,prefix:s}=r,a={nextPart:new Map,validators:[]};return u6(Object.entries(r.classGroups),s).forEach(([i,o])=>{vx(o,a,i,t)}),a},vx=(r,t,s,a)=>{r.forEach(n=>{if(typeof n=="string"){const i=n===""?t:Jw(t,n);i.classGroupId=s;return}if(typeof n=="function"){if(d6(n)){vx(n(a),t,s,a);return}t.validators.push({validator:n,classGroupId:s});return}Object.entries(n).forEach(([i,o])=>{vx(o,Jw(t,i),s,a)})})},Jw=(r,t)=>{let s=r;return t.split(Jg).forEach(a=>{s.nextPart.has(a)||s.nextPart.set(a,{nextPart:new Map,validators:[]}),s=s.nextPart.get(a)}),s},d6=r=>r.isThemeGetter,u6=(r,t)=>t?r.map(([s,a])=>{const n=a.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[t+o,c])):i);return[s,n]}):r,h6=r=>{if(r<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,a=new Map;const n=(i,o)=>{s.set(i,o),t++,t>r&&(t=0,a=s,s=new Map)};return{get(i){let o=s.get(i);if(o!==void 0)return o;if((o=a.get(i))!==void 0)return n(i,o),o},set(i,o){s.has(i)?s.set(i,o):n(i,o)}}},mN="!",m6=r=>{const{separator:t,experimentalParseClassName:s}=r,a=t.length===1,n=t[0],i=t.length,o=c=>{const d=[];let h=0,m=0,f;for(let S=0;S<c.length;S++){let N=c[S];if(h===0){if(N===n&&(a||c.slice(S,S+i)===t)){d.push(c.slice(m,S)),m=S+i;continue}if(N==="/"){f=S;continue}}N==="["?h++:N==="]"&&h--}const g=d.length===0?c:c.substring(m),y=g.startsWith(mN),b=y?g.substring(1):g,w=f&&f>m?f-m:void 0;return{modifiers:d,hasImportantModifier:y,baseClassName:b,maybePostfixModifierPosition:w}};return s?c=>s({className:c,parseClassName:o}):o},f6=r=>{if(r.length<=1)return r;const t=[];let s=[];return r.forEach(a=>{a[0]==="["?(t.push(...s.sort(),a),s=[]):s.push(a)}),t.push(...s.sort()),t},p6=r=>({cache:h6(r.cacheSize),parseClassName:m6(r),...o6(r)}),x6=/\s+/,g6=(r,t)=>{const{parseClassName:s,getClassGroupId:a,getConflictingClassGroupIds:n}=t,i=[],o=r.trim().split(x6);let c="";for(let d=o.length-1;d>=0;d-=1){const h=o[d],{modifiers:m,hasImportantModifier:f,baseClassName:g,maybePostfixModifierPosition:y}=s(h);let b=!!y,w=a(b?g.substring(0,y):g);if(!w){if(!b){c=h+(c.length>0?" "+c:c);continue}if(w=a(g),!w){c=h+(c.length>0?" "+c:c);continue}b=!1}const S=f6(m).join(":"),N=f?S+mN:S,v=N+w;if(i.includes(v))continue;i.push(v);const j=n(w,b);for(let C=0;C<j.length;++C){const k=j[C];i.push(N+k)}c=h+(c.length>0?" "+c:c)}return c};function y6(){let r=0,t,s,a="";for(;r<arguments.length;)(t=arguments[r++])&&(s=fN(t))&&(a&&(a+=" "),a+=s);return a}const fN=r=>{if(typeof r=="string")return r;let t,s="";for(let a=0;a<r.length;a++)r[a]&&(t=fN(r[a]))&&(s&&(s+=" "),s+=t);return s};function v6(r,...t){let s,a,n,i=o;function o(d){const h=t.reduce((m,f)=>f(m),r());return s=p6(h),a=s.cache.get,n=s.cache.set,i=c,c(d)}function c(d){const h=a(d);if(h)return h;const m=g6(d,s);return n(d,m),m}return function(){return i(y6.apply(null,arguments))}}const ms=r=>{const t=s=>s[r]||[];return t.isThemeGetter=!0,t},pN=/^\[(?:([a-z-]+):)?(.+)\]$/i,w6=/^\d+\/\d+$/,j6=new Set(["px","full","screen"]),b6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,_6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,N6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,S6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,k6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,_n=r=>gl(r)||j6.has(r)||w6.test(r),Xn=r=>rc(r,"length",D6),gl=r=>!!r&&!Number.isNaN(Number(r)),Sp=r=>rc(r,"number",gl),kc=r=>!!r&&Number.isInteger(Number(r)),C6=r=>r.endsWith("%")&&gl(r.slice(0,-1)),_t=r=>pN.test(r),ei=r=>b6.test(r),E6=new Set(["length","size","percentage"]),A6=r=>rc(r,E6,xN),T6=r=>rc(r,"position",xN),R6=new Set(["image","url"]),P6=r=>rc(r,R6,O6),I6=r=>rc(r,"",F6),Cc=()=>!0,rc=(r,t,s)=>{const a=pN.exec(r);return a?a[1]?typeof t=="string"?a[1]===t:t.has(a[1]):s(a[2]):!1},D6=r=>_6.test(r)&&!N6.test(r),xN=()=>!1,F6=r=>S6.test(r),O6=r=>k6.test(r),M6=()=>{const r=ms("colors"),t=ms("spacing"),s=ms("blur"),a=ms("brightness"),n=ms("borderColor"),i=ms("borderRadius"),o=ms("borderSpacing"),c=ms("borderWidth"),d=ms("contrast"),h=ms("grayscale"),m=ms("hueRotate"),f=ms("invert"),g=ms("gap"),y=ms("gradientColorStops"),b=ms("gradientColorStopPositions"),w=ms("inset"),S=ms("margin"),N=ms("opacity"),v=ms("padding"),j=ms("saturate"),C=ms("scale"),k=ms("sepia"),I=ms("skew"),T=ms("space"),O=ms("translate"),U=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],L=()=>["auto",_t,t],M=()=>[_t,t],se=()=>["",_n,Xn],W=()=>["auto",gl,_t],q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],K=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],le=()=>["start","end","center","between","around","evenly","stretch"],Ne=()=>["","0",_t],Ke=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ke=()=>[gl,_t];return{cacheSize:500,separator:":",theme:{colors:[Cc],spacing:[_n,Xn],blur:["none","",ei,_t],brightness:ke(),borderColor:[r],borderRadius:["none","","full",ei,_t],borderSpacing:M(),borderWidth:se(),contrast:ke(),grayscale:Ne(),hueRotate:ke(),invert:Ne(),gap:M(),gradientColorStops:[r],gradientColorStopPositions:[C6,Xn],inset:L(),margin:L(),opacity:ke(),padding:M(),saturate:ke(),scale:ke(),sepia:Ne(),skew:ke(),space:M(),translate:M()},classGroups:{aspect:[{aspect:["auto","square","video",_t]}],container:["container"],columns:[{columns:[ei]}],"break-after":[{"break-after":Ke()}],"break-before":[{"break-before":Ke()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...q(),_t]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:U()}],"overscroll-x":[{"overscroll-x":U()}],"overscroll-y":[{"overscroll-y":U()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[w]}],"inset-x":[{"inset-x":[w]}],"inset-y":[{"inset-y":[w]}],start:[{start:[w]}],end:[{end:[w]}],top:[{top:[w]}],right:[{right:[w]}],bottom:[{bottom:[w]}],left:[{left:[w]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",kc,_t]}],basis:[{basis:L()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",_t]}],grow:[{grow:Ne()}],shrink:[{shrink:Ne()}],order:[{order:["first","last","none",kc,_t]}],"grid-cols":[{"grid-cols":[Cc]}],"col-start-end":[{col:["auto",{span:["full",kc,_t]},_t]}],"col-start":[{"col-start":W()}],"col-end":[{"col-end":W()}],"grid-rows":[{"grid-rows":[Cc]}],"row-start-end":[{row:["auto",{span:[kc,_t]},_t]}],"row-start":[{"row-start":W()}],"row-end":[{"row-end":W()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",_t]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",_t]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...le()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...le(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...le(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",_t,t]}],"min-w":[{"min-w":[_t,t,"min","max","fit"]}],"max-w":[{"max-w":[_t,t,"none","full","min","max","fit","prose",{screen:[ei]},ei]}],h:[{h:[_t,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[_t,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[_t,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[_t,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ei,Xn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Sp]}],"font-family":[{font:[Cc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",_t]}],"line-clamp":[{"line-clamp":["none",gl,Sp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",_n,_t]}],"list-image":[{"list-image":["none",_t]}],"list-style-type":[{list:["none","disc","decimal",_t]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[N]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[N]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...K(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",_n,Xn]}],"underline-offset":[{"underline-offset":["auto",_n,_t]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",_t]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",_t]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[N]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...q(),T6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",A6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},P6]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[N]}],"border-style":[{border:[...K(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[N]}],"divide-style":[{divide:K()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...K()]}],"outline-offset":[{"outline-offset":[_n,_t]}],"outline-w":[{outline:[_n,Xn]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:se()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[N]}],"ring-offset-w":[{"ring-offset":[_n,Xn]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",ei,I6]}],"shadow-color":[{shadow:[Cc]}],opacity:[{opacity:[N]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[a]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",ei,_t]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[f]}],saturate:[{saturate:[j]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[N]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",_t]}],duration:[{duration:ke()}],ease:[{ease:["linear","in","out","in-out",_t]}],delay:[{delay:ke()}],animate:[{animate:["none","spin","ping","pulse","bounce",_t]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[kc,_t]}],"translate-x":[{"translate-x":[O]}],"translate-y":[{"translate-y":[O]}],"skew-x":[{"skew-x":[I]}],"skew-y":[{"skew-y":[I]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",_t]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",_t]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",_t]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[_n,Xn,Sp]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},L6=v6(M6);function Ie(...r){return L6(eN(r))}const U6=k5,gN=p.forwardRef(({className:r,...t},s)=>e.jsx(G_,{ref:s,className:Ie("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...t}));gN.displayName=G_.displayName;const $6=tc("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),yN=p.forwardRef(({className:r,variant:t,...s},a)=>e.jsx(K_,{ref:a,className:Ie($6({variant:t}),r),...s}));yN.displayName=K_.displayName;const z6=p.forwardRef(({className:r,...t},s)=>e.jsx(J_,{ref:s,className:Ie("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...t}));z6.displayName=J_.displayName;const vN=p.forwardRef(({className:r,...t},s)=>e.jsx(Z_,{ref:s,className:Ie("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...t,children:e.jsx(Vs,{className:"h-4 w-4"})}));vN.displayName=Z_.displayName;const wN=p.forwardRef(({className:r,...t},s)=>e.jsx(Q_,{ref:s,className:Ie("text-sm font-semibold",r),...t}));wN.displayName=Q_.displayName;const jN=p.forwardRef(({className:r,...t},s)=>e.jsx(Y_,{ref:s,className:Ie("text-sm opacity-90",r),...t}));jN.displayName=Y_.displayName;function B6(){const{toasts:r}=Bn();return e.jsxs(U6,{children:[r.map(function({id:t,title:s,description:a,action:n,...i}){return e.jsxs(yN,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(wN,{children:s}),a&&e.jsx(jN,{children:a})]}),n,e.jsx(vN,{})]},t)}),e.jsx(gN,{})]})}var Zw=["light","dark"],q6="(prefers-color-scheme: dark)",V6=p.createContext(void 0),W6={setTheme:r=>{},themes:[]},H6=()=>{var r;return(r=p.useContext(V6))!=null?r:W6};p.memo(({forcedTheme:r,storageKey:t,attribute:s,enableSystem:a,enableColorScheme:n,defaultTheme:i,value:o,attrs:c,nonce:d})=>{let h=i==="system",m=s==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(b=>`'${b}'`).join(",")})`};`:`var d=document.documentElement,n='${s}',s='setAttribute';`,f=n?Zw.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",g=(b,w=!1,S=!0)=>{let N=o?o[b]:b,v=w?b+"|| ''":`'${N}'`,j="";return n&&S&&!w&&Zw.includes(b)&&(j+=`d.style.colorScheme = '${b}';`),s==="class"?w||N?j+=`c.add(${v})`:j+="null":N&&(j+=`d[s](n,${v})`),j},y=r?`!function(){${m}${g(r)}}()`:a?`!function(){try{${m}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${h})){var t='${q6}',m=window.matchMedia(t);if(m.media!==t||m.matches){${g("dark")}}else{${g("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${g(o?"x[e]":"e",!0)}}${h?"":"else{"+g(i,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${m}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${g(o?"x[e]":"e",!0)}}else{${g(i,!1,!1)};}${f}}catch(t){}}();`;return p.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:y}})});var G6=r=>{switch(r){case"success":return Y6;case"info":return Z6;case"warning":return J6;case"error":return X6;default:return null}},K6=Array(12).fill(0),Q6=({visible:r})=>xe.createElement("div",{className:"sonner-loading-wrapper","data-visible":r},xe.createElement("div",{className:"sonner-spinner"},K6.map((t,s)=>xe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),Y6=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),J6=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Z6=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),X6=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),eF=()=>{let[r,t]=xe.useState(document.hidden);return xe.useEffect(()=>{let s=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),r},wx=1,tF=class{constructor(){this.subscribe=r=>(this.subscribers.push(r),()=>{let t=this.subscribers.indexOf(r);this.subscribers.splice(t,1)}),this.publish=r=>{this.subscribers.forEach(t=>t(r))},this.addToast=r=>{this.publish(r),this.toasts=[...this.toasts,r]},this.create=r=>{var t;let{message:s,...a}=r,n=typeof(r==null?void 0:r.id)=="number"||((t=r.id)==null?void 0:t.length)>0?r.id:wx++,i=this.toasts.find(c=>c.id===n),o=r.dismissible===void 0?!0:r.dismissible;return i?this.toasts=this.toasts.map(c=>c.id===n?(this.publish({...c,...r,id:n,title:s}),{...c,...r,id:n,dismissible:o,title:s}):c):this.addToast({title:s,...a,dismissible:o,id:n}),n},this.dismiss=r=>(r||this.toasts.forEach(t=>{this.subscribers.forEach(s=>s({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:r,dismiss:!0})),r),this.message=(r,t)=>this.create({...t,message:r}),this.error=(r,t)=>this.create({...t,message:r,type:"error"}),this.success=(r,t)=>this.create({...t,type:"success",message:r}),this.info=(r,t)=>this.create({...t,type:"info",message:r}),this.warning=(r,t)=>this.create({...t,type:"warning",message:r}),this.loading=(r,t)=>this.create({...t,type:"loading",message:r}),this.promise=(r,t)=>{if(!t)return;let s;t.loading!==void 0&&(s=this.create({...t,promise:r,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let a=r instanceof Promise?r:r(),n=s!==void 0;return a.then(async i=>{if(rF(i)&&!i.ok){n=!1;let o=typeof t.error=="function"?await t.error(`HTTP error! status: ${i.status}`):t.error,c=typeof t.description=="function"?await t.description(`HTTP error! status: ${i.status}`):t.description;this.create({id:s,type:"error",message:o,description:c})}else if(t.success!==void 0){n=!1;let o=typeof t.success=="function"?await t.success(i):t.success,c=typeof t.description=="function"?await t.description(i):t.description;this.create({id:s,type:"success",message:o,description:c})}}).catch(async i=>{if(t.error!==void 0){n=!1;let o=typeof t.error=="function"?await t.error(i):t.error,c=typeof t.description=="function"?await t.description(i):t.description;this.create({id:s,type:"error",message:o,description:c})}}).finally(()=>{var i;n&&(this.dismiss(s),s=void 0),(i=t.finally)==null||i.call(t)}),s},this.custom=(r,t)=>{let s=(t==null?void 0:t.id)||wx++;return this.create({jsx:r(s),id:s,...t}),s},this.subscribers=[],this.toasts=[]}},ra=new tF,sF=(r,t)=>{let s=(t==null?void 0:t.id)||wx++;return ra.addToast({title:r,...t,id:s}),s},rF=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",aF=sF,nF=()=>ra.toasts,te=Object.assign(aF,{success:ra.success,info:ra.info,warning:ra.warning,error:ra.error,custom:ra.custom,message:ra.message,promise:ra.promise,dismiss:ra.dismiss,loading:ra.loading},{getHistory:nF});function iF(r,{insertAt:t}={}){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r))}iF(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Vu(r){return r.label!==void 0}var oF=3,lF="32px",cF=4e3,dF=356,uF=14,hF=20,mF=200;function fF(...r){return r.filter(Boolean).join(" ")}var pF=r=>{var t,s,a,n,i,o,c,d,h,m;let{invert:f,toast:g,unstyled:y,interacting:b,setHeights:w,visibleToasts:S,heights:N,index:v,toasts:j,expanded:C,removeToast:k,defaultRichColors:I,closeButton:T,style:O,cancelButtonStyle:U,actionButtonStyle:A,className:L="",descriptionClassName:M="",duration:se,position:W,gap:q,loadingIcon:K,expandByDefault:Y,classNames:le,icons:Ne,closeButtonAriaLabel:Ke="Close toast",pauseWhenPageIsHidden:ke,cn:$e}=r,[ce,Re]=xe.useState(!1),[Qe,nt]=xe.useState(!1),[We,ct]=xe.useState(!1),[he,fe]=xe.useState(!1),[Me,ze]=xe.useState(0),[ts,Tt]=xe.useState(0),Os=xe.useRef(null),Ms=xe.useRef(null),os=v===0,V=v+1<=S,ee=g.type,oe=g.dismissible!==!1,Se=g.className||"",_e=g.descriptionClassName||"",we=xe.useMemo(()=>N.findIndex(dt=>dt.toastId===g.id)||0,[N,g.id]),de=xe.useMemo(()=>{var dt;return(dt=g.closeButton)!=null?dt:T},[g.closeButton,T]),je=xe.useMemo(()=>g.duration||se||cF,[g.duration,se]),mt=xe.useRef(0),et=xe.useRef(0),Wt=xe.useRef(0),Ws=xe.useRef(null),[Js,qr]=W.split("-"),ma=xe.useMemo(()=>N.reduce((dt,Zt,ss)=>ss>=we?dt:dt+Zt.height,0),[N,we]),Vr=eF(),fa=g.invert||f,kr=ee==="loading";et.current=xe.useMemo(()=>we*q+ma,[we,ma]),xe.useEffect(()=>{Re(!0)},[]),xe.useLayoutEffect(()=>{if(!ce)return;let dt=Ms.current,Zt=dt.style.height;dt.style.height="auto";let ss=dt.getBoundingClientRect().height;dt.style.height=Zt,Tt(ss),w(Wr=>Wr.find(Hr=>Hr.toastId===g.id)?Wr.map(Hr=>Hr.toastId===g.id?{...Hr,height:ss}:Hr):[{toastId:g.id,height:ss,position:g.position},...Wr])},[ce,g.title,g.description,w,g.id]);let ir=xe.useCallback(()=>{nt(!0),ze(et.current),w(dt=>dt.filter(Zt=>Zt.toastId!==g.id)),setTimeout(()=>{k(g)},mF)},[g,k,w,et]);xe.useEffect(()=>{if(g.promise&&ee==="loading"||g.duration===1/0||g.type==="loading")return;let dt,Zt=je;return C||b||ke&&Vr?(()=>{if(Wt.current<mt.current){let ss=new Date().getTime()-mt.current;Zt=Zt-ss}Wt.current=new Date().getTime()})():Zt!==1/0&&(mt.current=new Date().getTime(),dt=setTimeout(()=>{var ss;(ss=g.onAutoClose)==null||ss.call(g,g),ir()},Zt)),()=>clearTimeout(dt)},[C,b,Y,g,je,ir,g.promise,ee,ke,Vr]),xe.useEffect(()=>{let dt=Ms.current;if(dt){let Zt=dt.getBoundingClientRect().height;return Tt(Zt),w(ss=>[{toastId:g.id,height:Zt,position:g.position},...ss]),()=>w(ss=>ss.filter(Wr=>Wr.toastId!==g.id))}},[w,g.id]),xe.useEffect(()=>{g.delete&&ir()},[ir,g.delete]);function mn(){return Ne!=null&&Ne.loading?xe.createElement("div",{className:"sonner-loader","data-visible":ee==="loading"},Ne.loading):K?xe.createElement("div",{className:"sonner-loader","data-visible":ee==="loading"},K):xe.createElement(Q6,{visible:ee==="loading"})}return xe.createElement("li",{"aria-live":g.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Ms,className:$e(L,Se,le==null?void 0:le.toast,(t=g==null?void 0:g.classNames)==null?void 0:t.toast,le==null?void 0:le.default,le==null?void 0:le[ee],(s=g==null?void 0:g.classNames)==null?void 0:s[ee]),"data-sonner-toast":"","data-rich-colors":(a=g.richColors)!=null?a:I,"data-styled":!(g.jsx||g.unstyled||y),"data-mounted":ce,"data-promise":!!g.promise,"data-removed":Qe,"data-visible":V,"data-y-position":Js,"data-x-position":qr,"data-index":v,"data-front":os,"data-swiping":We,"data-dismissible":oe,"data-type":ee,"data-invert":fa,"data-swipe-out":he,"data-expanded":!!(C||Y&&ce),style:{"--index":v,"--toasts-before":v,"--z-index":j.length-v,"--offset":`${Qe?Me:et.current}px`,"--initial-height":Y?"auto":`${ts}px`,...O,...g.style},onPointerDown:dt=>{kr||!oe||(Os.current=new Date,ze(et.current),dt.target.setPointerCapture(dt.pointerId),dt.target.tagName!=="BUTTON"&&(ct(!0),Ws.current={x:dt.clientX,y:dt.clientY}))},onPointerUp:()=>{var dt,Zt,ss,Wr;if(he||!oe)return;Ws.current=null;let Hr=Number(((dt=Ms.current)==null?void 0:dt.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Bo=new Date().getTime()-((Zt=Os.current)==null?void 0:Zt.getTime()),nf=Math.abs(Hr)/Bo;if(Math.abs(Hr)>=hF||nf>.11){ze(et.current),(ss=g.onDismiss)==null||ss.call(g,g),ir(),fe(!0);return}(Wr=Ms.current)==null||Wr.style.setProperty("--swipe-amount","0px"),ct(!1)},onPointerMove:dt=>{var Zt;if(!Ws.current||!oe)return;let ss=dt.clientY-Ws.current.y,Wr=dt.clientX-Ws.current.x,Hr=(Js==="top"?Math.min:Math.max)(0,ss),Bo=dt.pointerType==="touch"?10:2;Math.abs(Hr)>Bo?(Zt=Ms.current)==null||Zt.style.setProperty("--swipe-amount",`${ss}px`):Math.abs(Wr)>Bo&&(Ws.current=null)}},de&&!g.jsx?xe.createElement("button",{"aria-label":Ke,"data-disabled":kr,"data-close-button":!0,onClick:kr||!oe?()=>{}:()=>{var dt;ir(),(dt=g.onDismiss)==null||dt.call(g,g)},className:$e(le==null?void 0:le.closeButton,(n=g==null?void 0:g.classNames)==null?void 0:n.closeButton)},xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},xe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),xe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,g.jsx||xe.isValidElement(g.title)?g.jsx||g.title:xe.createElement(xe.Fragment,null,ee||g.icon||g.promise?xe.createElement("div",{"data-icon":"",className:$e(le==null?void 0:le.icon,(i=g==null?void 0:g.classNames)==null?void 0:i.icon)},g.promise||g.type==="loading"&&!g.icon?g.icon||mn():null,g.type!=="loading"?g.icon||(Ne==null?void 0:Ne[ee])||G6(ee):null):null,xe.createElement("div",{"data-content":"",className:$e(le==null?void 0:le.content,(o=g==null?void 0:g.classNames)==null?void 0:o.content)},xe.createElement("div",{"data-title":"",className:$e(le==null?void 0:le.title,(c=g==null?void 0:g.classNames)==null?void 0:c.title)},g.title),g.description?xe.createElement("div",{"data-description":"",className:$e(M,_e,le==null?void 0:le.description,(d=g==null?void 0:g.classNames)==null?void 0:d.description)},g.description):null),xe.isValidElement(g.cancel)?g.cancel:g.cancel&&Vu(g.cancel)?xe.createElement("button",{"data-button":!0,"data-cancel":!0,style:g.cancelButtonStyle||U,onClick:dt=>{var Zt,ss;Vu(g.cancel)&&oe&&((ss=(Zt=g.cancel).onClick)==null||ss.call(Zt,dt),ir())},className:$e(le==null?void 0:le.cancelButton,(h=g==null?void 0:g.classNames)==null?void 0:h.cancelButton)},g.cancel.label):null,xe.isValidElement(g.action)?g.action:g.action&&Vu(g.action)?xe.createElement("button",{"data-button":!0,"data-action":!0,style:g.actionButtonStyle||A,onClick:dt=>{var Zt,ss;Vu(g.action)&&(dt.defaultPrevented||((ss=(Zt=g.action).onClick)==null||ss.call(Zt,dt),ir()))},className:$e(le==null?void 0:le.actionButton,(m=g==null?void 0:g.classNames)==null?void 0:m.actionButton)},g.action.label):null))};function Xw(){if(typeof window>"u"||typeof document>"u")return"ltr";let r=document.documentElement.getAttribute("dir");return r==="auto"||!r?window.getComputedStyle(document.documentElement).direction:r}var xF=r=>{let{invert:t,position:s="bottom-right",hotkey:a=["altKey","KeyT"],expand:n,closeButton:i,className:o,offset:c,theme:d="light",richColors:h,duration:m,style:f,visibleToasts:g=oF,toastOptions:y,dir:b=Xw(),gap:w=uF,loadingIcon:S,icons:N,containerAriaLabel:v="Notifications",pauseWhenPageIsHidden:j,cn:C=fF}=r,[k,I]=xe.useState([]),T=xe.useMemo(()=>Array.from(new Set([s].concat(k.filter(ke=>ke.position).map(ke=>ke.position)))),[k,s]),[O,U]=xe.useState([]),[A,L]=xe.useState(!1),[M,se]=xe.useState(!1),[W,q]=xe.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),K=xe.useRef(null),Y=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),le=xe.useRef(null),Ne=xe.useRef(!1),Ke=xe.useCallback(ke=>{var $e;($e=k.find(ce=>ce.id===ke.id))!=null&&$e.delete||ra.dismiss(ke.id),I(ce=>ce.filter(({id:Re})=>Re!==ke.id))},[k]);return xe.useEffect(()=>ra.subscribe(ke=>{if(ke.dismiss){I($e=>$e.map(ce=>ce.id===ke.id?{...ce,delete:!0}:ce));return}setTimeout(()=>{QD.flushSync(()=>{I($e=>{let ce=$e.findIndex(Re=>Re.id===ke.id);return ce!==-1?[...$e.slice(0,ce),{...$e[ce],...ke},...$e.slice(ce+1)]:[ke,...$e]})})})}),[]),xe.useEffect(()=>{if(d!=="system"){q(d);return}d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?q("dark"):q("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:ke})=>{q(ke?"dark":"light")})},[d]),xe.useEffect(()=>{k.length<=1&&L(!1)},[k]),xe.useEffect(()=>{let ke=$e=>{var ce,Re;a.every(Qe=>$e[Qe]||$e.code===Qe)&&(L(!0),(ce=K.current)==null||ce.focus()),$e.code==="Escape"&&(document.activeElement===K.current||(Re=K.current)!=null&&Re.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",ke),()=>document.removeEventListener("keydown",ke)},[a]),xe.useEffect(()=>{if(K.current)return()=>{le.current&&(le.current.focus({preventScroll:!0}),le.current=null,Ne.current=!1)}},[K.current]),k.length?xe.createElement("section",{"aria-label":`${v} ${Y}`,tabIndex:-1},T.map((ke,$e)=>{var ce;let[Re,Qe]=ke.split("-");return xe.createElement("ol",{key:ke,dir:b==="auto"?Xw():b,tabIndex:-1,ref:K,className:o,"data-sonner-toaster":!0,"data-theme":W,"data-y-position":Re,"data-x-position":Qe,style:{"--front-toast-height":`${((ce=O[0])==null?void 0:ce.height)||0}px`,"--offset":typeof c=="number"?`${c}px`:c||lF,"--width":`${dF}px`,"--gap":`${w}px`,...f},onBlur:nt=>{Ne.current&&!nt.currentTarget.contains(nt.relatedTarget)&&(Ne.current=!1,le.current&&(le.current.focus({preventScroll:!0}),le.current=null))},onFocus:nt=>{nt.target instanceof HTMLElement&&nt.target.dataset.dismissible==="false"||Ne.current||(Ne.current=!0,le.current=nt.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{M||L(!1)},onPointerDown:nt=>{nt.target instanceof HTMLElement&&nt.target.dataset.dismissible==="false"||se(!0)},onPointerUp:()=>se(!1)},k.filter(nt=>!nt.position&&$e===0||nt.position===ke).map((nt,We)=>{var ct,he;return xe.createElement(pF,{key:nt.id,icons:N,index:We,toast:nt,defaultRichColors:h,duration:(ct=y==null?void 0:y.duration)!=null?ct:m,className:y==null?void 0:y.className,descriptionClassName:y==null?void 0:y.descriptionClassName,invert:t,visibleToasts:g,closeButton:(he=y==null?void 0:y.closeButton)!=null?he:i,interacting:M,position:ke,style:y==null?void 0:y.style,unstyled:y==null?void 0:y.unstyled,classNames:y==null?void 0:y.classNames,cancelButtonStyle:y==null?void 0:y.cancelButtonStyle,actionButtonStyle:y==null?void 0:y.actionButtonStyle,removeToast:Ke,toasts:k.filter(fe=>fe.position==nt.position),heights:O.filter(fe=>fe.position==nt.position),setHeights:U,expandByDefault:n,gap:w,loadingIcon:S,expanded:A,pauseWhenPageIsHidden:j,cn:C})}))})):null};const gF=({...r})=>{const{theme:t="system"}=H6();return e.jsx(xF,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...r})};var[km,yW]=Io("Tooltip",[ec]),Cm=ec(),bN="TooltipProvider",yF=700,jx="tooltip.open",[vF,Zg]=km(bN),_N=r=>{const{__scopeTooltip:t,delayDuration:s=yF,skipDelayDuration:a=300,disableHoverableContent:n=!1,children:i}=r,[o,c]=p.useState(!0),d=p.useRef(!1),h=p.useRef(0);return p.useEffect(()=>{const m=h.current;return()=>window.clearTimeout(m)},[]),e.jsx(vF,{scope:t,isOpenDelayed:o,delayDuration:s,onOpen:p.useCallback(()=>{window.clearTimeout(h.current),c(!1)},[]),onClose:p.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>c(!0),a)},[a]),isPointerInTransitRef:d,onPointerInTransitChange:p.useCallback(m=>{d.current=m},[]),disableHoverableContent:n,children:i})};_N.displayName=bN;var Em="Tooltip",[wF,Am]=km(Em),NN=r=>{const{__scopeTooltip:t,children:s,open:a,defaultOpen:n=!1,onOpenChange:i,disableHoverableContent:o,delayDuration:c}=r,d=Zg(Em,r.__scopeTooltip),h=Cm(t),[m,f]=p.useState(null),g=Id(),y=p.useRef(0),b=o??d.disableHoverableContent,w=c??d.delayDuration,S=p.useRef(!1),[N=!1,v]=_o({prop:a,defaultProp:n,onChange:T=>{T?(d.onOpen(),document.dispatchEvent(new CustomEvent(jx))):d.onClose(),i==null||i(T)}}),j=p.useMemo(()=>N?S.current?"delayed-open":"instant-open":"closed",[N]),C=p.useCallback(()=>{window.clearTimeout(y.current),y.current=0,S.current=!1,v(!0)},[v]),k=p.useCallback(()=>{window.clearTimeout(y.current),y.current=0,v(!1)},[v]),I=p.useCallback(()=>{window.clearTimeout(y.current),y.current=window.setTimeout(()=>{S.current=!0,v(!0),y.current=0},w)},[w,v]);return p.useEffect(()=>()=>{y.current&&(window.clearTimeout(y.current),y.current=0)},[]),e.jsx(Lg,{...h,children:e.jsx(wF,{scope:t,contentId:g,open:N,stateAttribute:j,trigger:m,onTriggerChange:f,onTriggerEnter:p.useCallback(()=>{d.isOpenDelayed?I():C()},[d.isOpenDelayed,I,C]),onTriggerLeave:p.useCallback(()=>{b?k():(window.clearTimeout(y.current),y.current=0)},[k,b]),onOpen:C,onClose:k,disableHoverableContent:b,children:s})})};NN.displayName=Em;var bx="TooltipTrigger",SN=p.forwardRef((r,t)=>{const{__scopeTooltip:s,...a}=r,n=Am(bx,s),i=Zg(bx,s),o=Cm(s),c=p.useRef(null),d=Ys(t,c,n.onTriggerChange),h=p.useRef(!1),m=p.useRef(!1),f=p.useCallback(()=>h.current=!1,[]);return p.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),e.jsx(fm,{asChild:!0,...o,children:e.jsx(zt.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...a,ref:d,onPointerMove:Nt(r.onPointerMove,g=>{g.pointerType!=="touch"&&!m.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),m.current=!0)}),onPointerLeave:Nt(r.onPointerLeave,()=>{n.onTriggerLeave(),m.current=!1}),onPointerDown:Nt(r.onPointerDown,()=>{h.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Nt(r.onFocus,()=>{h.current||n.onOpen()}),onBlur:Nt(r.onBlur,n.onClose),onClick:Nt(r.onClick,n.onClose)})})});SN.displayName=bx;var jF="TooltipPortal",[vW,bF]=km(jF,{forceMount:void 0}),Ml="TooltipContent",kN=p.forwardRef((r,t)=>{const s=bF(Ml,r.__scopeTooltip),{forceMount:a=s.forceMount,side:n="top",...i}=r,o=Am(Ml,r.__scopeTooltip);return e.jsx(Pd,{present:a||o.open,children:o.disableHoverableContent?e.jsx(CN,{side:n,...i,ref:t}):e.jsx(_F,{side:n,...i,ref:t})})}),_F=p.forwardRef((r,t)=>{const s=Am(Ml,r.__scopeTooltip),a=Zg(Ml,r.__scopeTooltip),n=p.useRef(null),i=Ys(t,n),[o,c]=p.useState(null),{trigger:d,onClose:h}=s,m=n.current,{onPointerInTransitChange:f}=a,g=p.useCallback(()=>{c(null),f(!1)},[f]),y=p.useCallback((b,w)=>{const S=b.currentTarget,N={x:b.clientX,y:b.clientY},v=CF(N,S.getBoundingClientRect()),j=EF(N,v),C=AF(w.getBoundingClientRect()),k=RF([...j,...C]);c(k),f(!0)},[f]);return p.useEffect(()=>()=>g(),[g]),p.useEffect(()=>{if(d&&m){const b=S=>y(S,m),w=S=>y(S,d);return d.addEventListener("pointerleave",b),m.addEventListener("pointerleave",w),()=>{d.removeEventListener("pointerleave",b),m.removeEventListener("pointerleave",w)}}},[d,m,y,g]),p.useEffect(()=>{if(o){const b=w=>{const S=w.target,N={x:w.clientX,y:w.clientY},v=(d==null?void 0:d.contains(S))||(m==null?void 0:m.contains(S)),j=!TF(N,o);v?g():j&&(g(),h())};return document.addEventListener("pointermove",b),()=>document.removeEventListener("pointermove",b)}},[d,m,o,h,g]),e.jsx(CN,{...r,ref:i})}),[NF,SF]=km(Em,{isInside:!1}),CN=p.forwardRef((r,t)=>{const{__scopeTooltip:s,children:a,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=r,d=Am(Ml,s),h=Cm(s),{onClose:m}=d;return p.useEffect(()=>(document.addEventListener(jx,m),()=>document.removeEventListener(jx,m)),[m]),p.useEffect(()=>{if(d.trigger){const f=g=>{const y=g.target;y!=null&&y.contains(d.trigger)&&m()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[d.trigger,m]),e.jsx(Fg,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:m,children:e.jsxs(Og,{"data-state":d.stateAttribute,...h,...c,ref:t,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(VD,{children:a}),e.jsx(NF,{scope:s,isInside:!0,children:e.jsx(l5,{id:d.contentId,role:"tooltip",children:n||a})})]})})});kN.displayName=Ml;var EN="TooltipArrow",kF=p.forwardRef((r,t)=>{const{__scopeTooltip:s,...a}=r,n=Cm(s);return SF(EN,s).isInside?null:e.jsx(Mg,{...n,...a,ref:t})});kF.displayName=EN;function CF(r,t){const s=Math.abs(t.top-r.y),a=Math.abs(t.bottom-r.y),n=Math.abs(t.right-r.x),i=Math.abs(t.left-r.x);switch(Math.min(s,a,n,i)){case i:return"left";case n:return"right";case s:return"top";case a:return"bottom";default:throw new Error("unreachable")}}function EF(r,t,s=5){const a=[];switch(t){case"top":a.push({x:r.x-s,y:r.y+s},{x:r.x+s,y:r.y+s});break;case"bottom":a.push({x:r.x-s,y:r.y-s},{x:r.x+s,y:r.y-s});break;case"left":a.push({x:r.x+s,y:r.y-s},{x:r.x+s,y:r.y+s});break;case"right":a.push({x:r.x-s,y:r.y-s},{x:r.x-s,y:r.y+s});break}return a}function AF(r){const{top:t,right:s,bottom:a,left:n}=r;return[{x:n,y:t},{x:s,y:t},{x:s,y:a},{x:n,y:a}]}function TF(r,t){const{x:s,y:a}=r;let n=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const c=t[i].x,d=t[i].y,h=t[o].x,m=t[o].y;d>a!=m>a&&s<(h-c)*(a-d)/(m-d)+c&&(n=!n)}return n}function RF(r){const t=r.slice();return t.sort((s,a)=>s.x<a.x?-1:s.x>a.x?1:s.y<a.y?-1:s.y>a.y?1:0),PF(t)}function PF(r){if(r.length<=1)return r.slice();const t=[];for(let a=0;a<r.length;a++){const n=r[a];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))t.pop();else break}t.push(n)}t.pop();const s=[];for(let a=r.length-1;a>=0;a--){const n=r[a];for(;s.length>=2;){const i=s[s.length-1],o=s[s.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))s.pop();else break}s.push(n)}return s.pop(),t.length===1&&s.length===1&&t[0].x===s[0].x&&t[0].y===s[0].y?t:t.concat(s)}var IF=_N,DF=NN,FF=SN,AN=kN;const OF=IF,wW=DF,jW=FF,MF=p.forwardRef(({className:r,sideOffset:t=4,...s},a)=>e.jsx(AN,{ref:a,sideOffset:t,className:Ie("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...s}));MF.displayName=AN.displayName;var ac=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ko=typeof window>"u"||"Deno"in globalThis;function Na(){}function LF(r,t){return typeof r=="function"?r(t):r}function _x(r){return typeof r=="number"&&r>=0&&r!==1/0}function TN(r,t){return Math.max(r+(t||0)-Date.now(),0)}function yl(r,t){return typeof r=="function"?r(t):r}function $a(r,t){return typeof r=="function"?r(t):r}function ej(r,t){const{type:s="all",exact:a,fetchStatus:n,predicate:i,queryKey:o,stale:c}=r;if(o){if(a){if(t.queryHash!==Xg(o,t.options))return!1}else if(!xd(t.queryKey,o))return!1}if(s!=="all"){const d=t.isActive();if(s==="active"&&!d||s==="inactive"&&d)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||n&&n!==t.state.fetchStatus||i&&!i(t))}function tj(r,t){const{exact:s,status:a,predicate:n,mutationKey:i}=r;if(i){if(!t.options.mutationKey)return!1;if(s){if(Co(t.options.mutationKey)!==Co(i))return!1}else if(!xd(t.options.mutationKey,i))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function Xg(r,t){return((t==null?void 0:t.queryKeyHashFn)||Co)(r)}function Co(r){return JSON.stringify(r,(t,s)=>Nx(s)?Object.keys(s).sort().reduce((a,n)=>(a[n]=s[n],a),{}):s)}function xd(r,t){return r===t?!0:typeof r!=typeof t?!1:r&&t&&typeof r=="object"&&typeof t=="object"?!Object.keys(t).some(s=>!xd(r[s],t[s])):!1}function RN(r,t){if(r===t)return r;const s=sj(r)&&sj(t);if(s||Nx(r)&&Nx(t)){const a=s?r:Object.keys(r),n=a.length,i=s?t:Object.keys(t),o=i.length,c=s?[]:{};let d=0;for(let h=0;h<o;h++){const m=s?h:i[h];(!s&&a.includes(m)||s)&&r[m]===void 0&&t[m]===void 0?(c[m]=void 0,d++):(c[m]=RN(r[m],t[m]),c[m]===r[m]&&r[m]!==void 0&&d++)}return n===o&&d===n?r:c}return t}function Oh(r,t){if(!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const s in r)if(r[s]!==t[s])return!1;return!0}function sj(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Nx(r){if(!rj(r))return!1;const t=r.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!rj(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function rj(r){return Object.prototype.toString.call(r)==="[object Object]"}function UF(r){return new Promise(t=>{setTimeout(t,r)})}function Sx(r,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(r,t):s.structuralSharing!==!1?RN(r,t):t}function $F(r,t,s=0){const a=[...r,t];return s&&a.length>s?a.slice(1):a}function zF(r,t,s=0){const a=[t,...r];return s&&a.length>s?a.slice(0,-1):a}var ey=Symbol();function PN(r,t){return!r.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!r.queryFn||r.queryFn===ey?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}var mo,hi,bl,r_,BF=(r_=class extends ac{constructor(){super();Xe(this,mo);Xe(this,hi);Xe(this,bl);Oe(this,bl,t=>{if(!ko&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){G(this,hi)||this.setEventListener(G(this,bl))}onUnsubscribe(){var t;this.hasListeners()||((t=G(this,hi))==null||t.call(this),Oe(this,hi,void 0))}setEventListener(t){var s;Oe(this,bl,t),(s=G(this,hi))==null||s.call(this),Oe(this,hi,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){G(this,mo)!==t&&(Oe(this,mo,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof G(this,mo)=="boolean"?G(this,mo):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},mo=new WeakMap,hi=new WeakMap,bl=new WeakMap,r_),ty=new BF,_l,mi,Nl,a_,qF=(a_=class extends ac{constructor(){super();Xe(this,_l,!0);Xe(this,mi);Xe(this,Nl);Oe(this,Nl,t=>{if(!ko&&window.addEventListener){const s=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}}})}onSubscribe(){G(this,mi)||this.setEventListener(G(this,Nl))}onUnsubscribe(){var t;this.hasListeners()||((t=G(this,mi))==null||t.call(this),Oe(this,mi,void 0))}setEventListener(t){var s;Oe(this,Nl,t),(s=G(this,mi))==null||s.call(this),Oe(this,mi,t(this.setOnline.bind(this)))}setOnline(t){G(this,_l)!==t&&(Oe(this,_l,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return G(this,_l)}},_l=new WeakMap,mi=new WeakMap,Nl=new WeakMap,a_),Mh=new qF;function kx(){let r,t;const s=new Promise((n,i)=>{r=n,t=i});s.status="pending",s.catch(()=>{});function a(n){Object.assign(s,n),delete s.resolve,delete s.reject}return s.resolve=n=>{a({status:"fulfilled",value:n}),r(n)},s.reject=n=>{a({status:"rejected",reason:n}),t(n)},s}function VF(r){return Math.min(1e3*2**r,3e4)}function IN(r){return(r??"online")==="online"?Mh.isOnline():!0}var DN=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function kp(r){return r instanceof DN}function FN(r){let t=!1,s=0,a=!1,n;const i=kx(),o=w=>{var S;a||(g(new DN(w)),(S=r.abort)==null||S.call(r))},c=()=>{t=!0},d=()=>{t=!1},h=()=>ty.isFocused()&&(r.networkMode==="always"||Mh.isOnline())&&r.canRun(),m=()=>IN(r.networkMode)&&r.canRun(),f=w=>{var S;a||(a=!0,(S=r.onSuccess)==null||S.call(r,w),n==null||n(),i.resolve(w))},g=w=>{var S;a||(a=!0,(S=r.onError)==null||S.call(r,w),n==null||n(),i.reject(w))},y=()=>new Promise(w=>{var S;n=N=>{(a||h())&&w(N)},(S=r.onPause)==null||S.call(r)}).then(()=>{var w;n=void 0,a||(w=r.onContinue)==null||w.call(r)}),b=()=>{if(a)return;let w;const S=s===0?r.initialPromise:void 0;try{w=S??r.fn()}catch(N){w=Promise.reject(N)}Promise.resolve(w).then(f).catch(N=>{var I;if(a)return;const v=r.retry??(ko?0:3),j=r.retryDelay??VF,C=typeof j=="function"?j(s,N):j,k=v===!0||typeof v=="number"&&s<v||typeof v=="function"&&v(s,N);if(t||!k){g(N);return}s++,(I=r.onFail)==null||I.call(r,s,N),UF(C).then(()=>h()?void 0:y()).then(()=>{t?g(N):b()})})};return{promise:i,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:c,continueRetry:d,canStart:m,start:()=>(m()?b():y().then(b),i)}}function WF(){let r=[],t=0,s=c=>{c()},a=c=>{c()},n=c=>setTimeout(c,0);const i=c=>{t?r.push(c):n(()=>{s(c)})},o=()=>{const c=r;r=[],c.length&&n(()=>{a(()=>{c.forEach(d=>{s(d)})})})};return{batch:c=>{let d;t++;try{d=c()}finally{t--,t||o()}return d},batchCalls:c=>(...d)=>{i(()=>{c(...d)})},schedule:i,setNotifyFunction:c=>{s=c},setBatchNotifyFunction:c=>{a=c},setScheduler:c=>{n=c}}}var qs=WF(),fo,n_,ON=(n_=class{constructor(){Xe(this,fo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),_x(this.gcTime)&&Oe(this,fo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(ko?1/0:5*60*1e3))}clearGcTimeout(){G(this,fo)&&(clearTimeout(G(this,fo)),Oe(this,fo,void 0))}},fo=new WeakMap,n_),Sl,kl,_a,cr,Ed,po,La,Cn,i_,HF=(i_=class extends ON{constructor(t){super();Xe(this,La);Xe(this,Sl);Xe(this,kl);Xe(this,_a);Xe(this,cr);Xe(this,Ed);Xe(this,po);Oe(this,po,!1),Oe(this,Ed,t.defaultOptions),this.setOptions(t.options),this.observers=[],Oe(this,_a,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Oe(this,Sl,GF(this.options)),this.state=t.state??G(this,Sl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=G(this,cr))==null?void 0:t.promise}setOptions(t){this.options={...G(this,Ed),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&G(this,_a).remove(this)}setData(t,s){const a=Sx(this.state.data,t,this.options);return kt(this,La,Cn).call(this,{data:a,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),a}setState(t,s){kt(this,La,Cn).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var a,n;const s=(a=G(this,cr))==null?void 0:a.promise;return(n=G(this,cr))==null||n.cancel(t),s?s.then(Na).catch(Na):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(G(this,Sl))}isActive(){return this.observers.some(t=>$a(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ey||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!TN(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=G(this,cr))==null||s.continue()}onOnline(){var s;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=G(this,cr))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),G(this,_a).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(G(this,cr)&&(G(this,po)?G(this,cr).cancel({revert:!0}):G(this,cr).cancelRetry()),this.scheduleGc()),G(this,_a).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||kt(this,La,Cn).call(this,{type:"invalidate"})}fetch(t,s){var d,h,m;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(G(this,cr))return G(this,cr).continueRetry(),G(this,cr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(g=>g.options.queryFn);f&&this.setOptions(f.options)}const a=new AbortController,n=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Oe(this,po,!0),a.signal)})},i=()=>{const f=PN(this.options,s),g={queryKey:this.queryKey,meta:this.meta};return n(g),Oe(this,po,!1),this.options.persister?this.options.persister(f,g,this):f(g)},o={fetchOptions:s,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};n(o),(d=this.options.behavior)==null||d.onFetch(o,this),Oe(this,kl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=o.fetchOptions)==null?void 0:h.meta))&&kt(this,La,Cn).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta});const c=f=>{var g,y,b,w;kp(f)&&f.silent||kt(this,La,Cn).call(this,{type:"error",error:f}),kp(f)||((y=(g=G(this,_a).config).onError)==null||y.call(g,f,this),(w=(b=G(this,_a).config).onSettled)==null||w.call(b,this.state.data,f,this)),this.scheduleGc()};return Oe(this,cr,FN({initialPromise:s==null?void 0:s.initialPromise,fn:o.fetchFn,abort:a.abort.bind(a),onSuccess:f=>{var g,y,b,w;if(f===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(S){c(S);return}(y=(g=G(this,_a).config).onSuccess)==null||y.call(g,f,this),(w=(b=G(this,_a).config).onSettled)==null||w.call(b,f,this.state.error,this),this.scheduleGc()},onError:c,onFail:(f,g)=>{kt(this,La,Cn).call(this,{type:"failed",failureCount:f,error:g})},onPause:()=>{kt(this,La,Cn).call(this,{type:"pause"})},onContinue:()=>{kt(this,La,Cn).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),G(this,cr).start()}},Sl=new WeakMap,kl=new WeakMap,_a=new WeakMap,cr=new WeakMap,Ed=new WeakMap,po=new WeakMap,La=new WeakSet,Cn=function(t){const s=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...MN(a.data,this.options),fetchMeta:t.meta??null};case"success":return{...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return kp(n)&&n.revert&&G(this,kl)?{...G(this,kl),fetchStatus:"idle"}:{...a,error:n,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=s(this.state),qs.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),G(this,_a).notify({query:this,type:"updated",action:t})})},i_);function MN(r,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:IN(t.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function GF(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,s=t!==void 0,a=s?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var Za,o_,KF=(o_=class extends ac{constructor(t={}){super();Xe(this,Za);this.config=t,Oe(this,Za,new Map)}build(t,s,a){const n=s.queryKey,i=s.queryHash??Xg(n,s);let o=this.get(i);return o||(o=new HF({cache:this,queryKey:n,queryHash:i,options:t.defaultQueryOptions(s),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(o)),o}add(t){G(this,Za).has(t.queryHash)||(G(this,Za).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=G(this,Za).get(t.queryHash);s&&(t.destroy(),s===t&&G(this,Za).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){qs.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return G(this,Za).get(t)}getAll(){return[...G(this,Za).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(a=>ej(s,a))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(a=>ej(t,a)):s}notify(t){qs.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){qs.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){qs.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Za=new WeakMap,o_),Xa,wr,xo,en,ri,l_,QF=(l_=class extends ON{constructor(t){super();Xe(this,en);Xe(this,Xa);Xe(this,wr);Xe(this,xo);this.mutationId=t.mutationId,Oe(this,wr,t.mutationCache),Oe(this,Xa,[]),this.state=t.state||LN(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){G(this,Xa).includes(t)||(G(this,Xa).push(t),this.clearGcTimeout(),G(this,wr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Oe(this,Xa,G(this,Xa).filter(s=>s!==t)),this.scheduleGc(),G(this,wr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){G(this,Xa).length||(this.state.status==="pending"?this.scheduleGc():G(this,wr).remove(this))}continue(){var t;return((t=G(this,xo))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var n,i,o,c,d,h,m,f,g,y,b,w,S,N,v,j,C,k,I,T;Oe(this,xo,FN({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(O,U)=>{kt(this,en,ri).call(this,{type:"failed",failureCount:O,error:U})},onPause:()=>{kt(this,en,ri).call(this,{type:"pause"})},onContinue:()=>{kt(this,en,ri).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>G(this,wr).canRun(this)}));const s=this.state.status==="pending",a=!G(this,xo).canStart();try{if(!s){kt(this,en,ri).call(this,{type:"pending",variables:t,isPaused:a}),await((i=(n=G(this,wr).config).onMutate)==null?void 0:i.call(n,t,this));const U=await((c=(o=this.options).onMutate)==null?void 0:c.call(o,t));U!==this.state.context&&kt(this,en,ri).call(this,{type:"pending",context:U,variables:t,isPaused:a})}const O=await G(this,xo).start();return await((h=(d=G(this,wr).config).onSuccess)==null?void 0:h.call(d,O,t,this.state.context,this)),await((f=(m=this.options).onSuccess)==null?void 0:f.call(m,O,t,this.state.context)),await((y=(g=G(this,wr).config).onSettled)==null?void 0:y.call(g,O,null,this.state.variables,this.state.context,this)),await((w=(b=this.options).onSettled)==null?void 0:w.call(b,O,null,t,this.state.context)),kt(this,en,ri).call(this,{type:"success",data:O}),O}catch(O){try{throw await((N=(S=G(this,wr).config).onError)==null?void 0:N.call(S,O,t,this.state.context,this)),await((j=(v=this.options).onError)==null?void 0:j.call(v,O,t,this.state.context)),await((k=(C=G(this,wr).config).onSettled)==null?void 0:k.call(C,void 0,O,this.state.variables,this.state.context,this)),await((T=(I=this.options).onSettled)==null?void 0:T.call(I,void 0,O,t,this.state.context)),O}finally{kt(this,en,ri).call(this,{type:"error",error:O})}}finally{G(this,wr).runNext(this)}}},Xa=new WeakMap,wr=new WeakMap,xo=new WeakMap,en=new WeakSet,ri=function(t){const s=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),qs.batch(()=>{G(this,Xa).forEach(a=>{a.onMutationUpdate(t)}),G(this,wr).notify({mutation:this,type:"updated",action:t})})},l_);function LN(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var sa,Ad,c_,YF=(c_=class extends ac{constructor(t={}){super();Xe(this,sa);Xe(this,Ad);this.config=t,Oe(this,sa,new Map),Oe(this,Ad,Date.now())}build(t,s,a){const n=new QF({mutationCache:this,mutationId:++Bu(this,Ad)._,options:t.defaultMutationOptions(s),state:a});return this.add(n),n}add(t){const s=Wu(t),a=G(this,sa).get(s)??[];a.push(t),G(this,sa).set(s,a),this.notify({type:"added",mutation:t})}remove(t){var a;const s=Wu(t);if(G(this,sa).has(s)){const n=(a=G(this,sa).get(s))==null?void 0:a.filter(i=>i!==t);n&&(n.length===0?G(this,sa).delete(s):G(this,sa).set(s,n))}this.notify({type:"removed",mutation:t})}canRun(t){var a;const s=(a=G(this,sa).get(Wu(t)))==null?void 0:a.find(n=>n.state.status==="pending");return!s||s===t}runNext(t){var a;const s=(a=G(this,sa).get(Wu(t)))==null?void 0:a.find(n=>n!==t&&n.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}clear(){qs.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...G(this,sa).values()].flat()}find(t){const s={exact:!0,...t};return this.getAll().find(a=>tj(s,a))}findAll(t={}){return this.getAll().filter(s=>tj(t,s))}notify(t){qs.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return qs.batch(()=>Promise.all(t.map(s=>s.continue().catch(Na))))}},sa=new WeakMap,Ad=new WeakMap,c_);function Wu(r){var t;return((t=r.options.scope)==null?void 0:t.id)??String(r.mutationId)}function aj(r){return{onFetch:(t,s)=>{var m,f,g,y,b;const a=t.options,n=(g=(f=(m=t.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:g.direction,i=((y=t.state.data)==null?void 0:y.pages)||[],o=((b=t.state.data)==null?void 0:b.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const h=async()=>{let w=!1;const S=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(t.signal.aborted?w=!0:t.signal.addEventListener("abort",()=>{w=!0}),t.signal)})},N=PN(t.options,t.fetchOptions),v=async(j,C,k)=>{if(w)return Promise.reject();if(C==null&&j.pages.length)return Promise.resolve(j);const I={queryKey:t.queryKey,pageParam:C,direction:k?"backward":"forward",meta:t.options.meta};S(I);const T=await N(I),{maxPages:O}=t.options,U=k?zF:$F;return{pages:U(j.pages,T,O),pageParams:U(j.pageParams,C,O)}};if(n&&i.length){const j=n==="backward",C=j?JF:nj,k={pages:i,pageParams:o},I=C(a,k);c=await v(k,I,j)}else{const j=r??i.length;do{const C=d===0?o[0]??a.initialPageParam:nj(a,c);if(d>0&&C==null)break;c=await v(c,C),d++}while(d<j)}return c};t.options.persister?t.fetchFn=()=>{var w,S;return(S=(w=t.options).persister)==null?void 0:S.call(w,h,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=h}}}function nj(r,{pages:t,pageParams:s}){const a=t.length-1;return t.length>0?r.getNextPageParam(t[a],t,s[a],s):void 0}function JF(r,{pages:t,pageParams:s}){var a;return t.length>0?(a=r.getPreviousPageParam)==null?void 0:a.call(r,t[0],t,s[0],s):void 0}var Cs,fi,pi,Cl,El,xi,Al,Tl,d_,ZF=(d_=class{constructor(r={}){Xe(this,Cs);Xe(this,fi);Xe(this,pi);Xe(this,Cl);Xe(this,El);Xe(this,xi);Xe(this,Al);Xe(this,Tl);Oe(this,Cs,r.queryCache||new KF),Oe(this,fi,r.mutationCache||new YF),Oe(this,pi,r.defaultOptions||{}),Oe(this,Cl,new Map),Oe(this,El,new Map),Oe(this,xi,0)}mount(){Bu(this,xi)._++,G(this,xi)===1&&(Oe(this,Al,ty.subscribe(async r=>{r&&(await this.resumePausedMutations(),G(this,Cs).onFocus())})),Oe(this,Tl,Mh.subscribe(async r=>{r&&(await this.resumePausedMutations(),G(this,Cs).onOnline())})))}unmount(){var r,t;Bu(this,xi)._--,G(this,xi)===0&&((r=G(this,Al))==null||r.call(this),Oe(this,Al,void 0),(t=G(this,Tl))==null||t.call(this),Oe(this,Tl,void 0))}isFetching(r){return G(this,Cs).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return G(this,fi).findAll({...r,status:"pending"}).length}getQueryData(r){var s;const t=this.defaultQueryOptions({queryKey:r});return(s=G(this,Cs).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(r){const t=this.getQueryData(r.queryKey);if(t===void 0)return this.fetchQuery(r);{const s=this.defaultQueryOptions(r),a=G(this,Cs).build(this,s);return r.revalidateIfStale&&a.isStaleByTime(yl(s.staleTime,a))&&this.prefetchQuery(s),Promise.resolve(t)}}getQueriesData(r){return G(this,Cs).findAll(r).map(({queryKey:t,state:s})=>{const a=s.data;return[t,a]})}setQueryData(r,t,s){const a=this.defaultQueryOptions({queryKey:r}),n=G(this,Cs).get(a.queryHash),i=n==null?void 0:n.state.data,o=LF(t,i);if(o!==void 0)return G(this,Cs).build(this,a).setData(o,{...s,manual:!0})}setQueriesData(r,t,s){return qs.batch(()=>G(this,Cs).findAll(r).map(({queryKey:a})=>[a,this.setQueryData(a,t,s)]))}getQueryState(r){var s;const t=this.defaultQueryOptions({queryKey:r});return(s=G(this,Cs).get(t.queryHash))==null?void 0:s.state}removeQueries(r){const t=G(this,Cs);qs.batch(()=>{t.findAll(r).forEach(s=>{t.remove(s)})})}resetQueries(r,t){const s=G(this,Cs),a={type:"active",...r};return qs.batch(()=>(s.findAll(r).forEach(n=>{n.reset()}),this.refetchQueries(a,t)))}cancelQueries(r={},t={}){const s={revert:!0,...t},a=qs.batch(()=>G(this,Cs).findAll(r).map(n=>n.cancel(s)));return Promise.all(a).then(Na).catch(Na)}invalidateQueries(r={},t={}){return qs.batch(()=>{if(G(this,Cs).findAll(r).forEach(a=>{a.invalidate()}),r.refetchType==="none")return Promise.resolve();const s={...r,type:r.refetchType??r.type??"active"};return this.refetchQueries(s,t)})}refetchQueries(r={},t){const s={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},a=qs.batch(()=>G(this,Cs).findAll(r).filter(n=>!n.isDisabled()).map(n=>{let i=n.fetch(void 0,s);return s.throwOnError||(i=i.catch(Na)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(a).then(Na)}fetchQuery(r){const t=this.defaultQueryOptions(r);t.retry===void 0&&(t.retry=!1);const s=G(this,Cs).build(this,t);return s.isStaleByTime(yl(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Na).catch(Na)}fetchInfiniteQuery(r){return r.behavior=aj(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Na).catch(Na)}ensureInfiniteQueryData(r){return r.behavior=aj(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Mh.isOnline()?G(this,fi).resumePausedMutations():Promise.resolve()}getQueryCache(){return G(this,Cs)}getMutationCache(){return G(this,fi)}getDefaultOptions(){return G(this,pi)}setDefaultOptions(r){Oe(this,pi,r)}setQueryDefaults(r,t){G(this,Cl).set(Co(r),{queryKey:r,defaultOptions:t})}getQueryDefaults(r){const t=[...G(this,Cl).values()];let s={};return t.forEach(a=>{xd(r,a.queryKey)&&(s={...s,...a.defaultOptions})}),s}setMutationDefaults(r,t){G(this,El).set(Co(r),{mutationKey:r,defaultOptions:t})}getMutationDefaults(r){const t=[...G(this,El).values()];let s={};return t.forEach(a=>{xd(r,a.mutationKey)&&(s={...s,...a.defaultOptions})}),s}defaultQueryOptions(r){if(r._defaulted)return r;const t={...G(this,pi).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return t.queryHash||(t.queryHash=Xg(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===ey&&(t.enabled=!1),t}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...G(this,pi).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){G(this,Cs).clear(),G(this,fi).clear()}},Cs=new WeakMap,fi=new WeakMap,pi=new WeakMap,Cl=new WeakMap,El=new WeakMap,xi=new WeakMap,Al=new WeakMap,Tl=new WeakMap,d_),Ir,Lt,Td,jr,go,Rl,gi,tn,Rd,Pl,Il,yo,vo,yi,Dl,Jt,$c,Cx,Ex,Ax,Tx,Rx,Px,Ix,UN,u_,XF=(u_=class extends ac{constructor(t,s){super();Xe(this,Jt);Xe(this,Ir);Xe(this,Lt);Xe(this,Td);Xe(this,jr);Xe(this,go);Xe(this,Rl);Xe(this,gi);Xe(this,tn);Xe(this,Rd);Xe(this,Pl);Xe(this,Il);Xe(this,yo);Xe(this,vo);Xe(this,yi);Xe(this,Dl,new Set);this.options=s,Oe(this,Ir,t),Oe(this,tn,null),Oe(this,gi,kx()),this.options.experimental_prefetchInRender||G(this,gi).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(G(this,Lt).addObserver(this),ij(G(this,Lt),this.options)?kt(this,Jt,$c).call(this):this.updateResult(),kt(this,Jt,Tx).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Dx(G(this,Lt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Dx(G(this,Lt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,kt(this,Jt,Rx).call(this),kt(this,Jt,Px).call(this),G(this,Lt).removeObserver(this)}setOptions(t,s){const a=this.options,n=G(this,Lt);if(this.options=G(this,Ir).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof $a(this.options.enabled,G(this,Lt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");kt(this,Jt,Ix).call(this),G(this,Lt).setOptions(this.options),a._defaulted&&!Oh(this.options,a)&&G(this,Ir).getQueryCache().notify({type:"observerOptionsUpdated",query:G(this,Lt),observer:this});const i=this.hasListeners();i&&oj(G(this,Lt),n,this.options,a)&&kt(this,Jt,$c).call(this),this.updateResult(s),i&&(G(this,Lt)!==n||$a(this.options.enabled,G(this,Lt))!==$a(a.enabled,G(this,Lt))||yl(this.options.staleTime,G(this,Lt))!==yl(a.staleTime,G(this,Lt)))&&kt(this,Jt,Cx).call(this);const o=kt(this,Jt,Ex).call(this);i&&(G(this,Lt)!==n||$a(this.options.enabled,G(this,Lt))!==$a(a.enabled,G(this,Lt))||o!==G(this,yi))&&kt(this,Jt,Ax).call(this,o)}getOptimisticResult(t){const s=G(this,Ir).getQueryCache().build(G(this,Ir),t),a=this.createResult(s,t);return tO(this,a)&&(Oe(this,jr,a),Oe(this,Rl,this.options),Oe(this,go,G(this,Lt).state)),a}getCurrentResult(){return G(this,jr)}trackResult(t,s){const a={};return Object.keys(t).forEach(n=>{Object.defineProperty(a,n,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(n),s==null||s(n),t[n])})}),a}trackProp(t){G(this,Dl).add(t)}getCurrentQuery(){return G(this,Lt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=G(this,Ir).defaultQueryOptions(t),a=G(this,Ir).getQueryCache().build(G(this,Ir),s);return a.fetch().then(()=>this.createResult(a,s))}fetch(t){return kt(this,Jt,$c).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),G(this,jr)))}createResult(t,s){var O;const a=G(this,Lt),n=this.options,i=G(this,jr),o=G(this,go),c=G(this,Rl),h=t!==a?t.state:G(this,Td),{state:m}=t;let f={...m},g=!1,y;if(s._optimisticResults){const U=this.hasListeners(),A=!U&&ij(t,s),L=U&&oj(t,a,s,n);(A||L)&&(f={...f,...MN(m.data,t.options)}),s._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:b,errorUpdatedAt:w,status:S}=f;if(s.select&&f.data!==void 0)if(i&&f.data===(o==null?void 0:o.data)&&s.select===G(this,Rd))y=G(this,Pl);else try{Oe(this,Rd,s.select),y=s.select(f.data),y=Sx(i==null?void 0:i.data,y,s),Oe(this,Pl,y),Oe(this,tn,null)}catch(U){Oe(this,tn,U)}else y=f.data;if(s.placeholderData!==void 0&&y===void 0&&S==="pending"){let U;if(i!=null&&i.isPlaceholderData&&s.placeholderData===(c==null?void 0:c.placeholderData))U=i.data;else if(U=typeof s.placeholderData=="function"?s.placeholderData((O=G(this,Il))==null?void 0:O.state.data,G(this,Il)):s.placeholderData,s.select&&U!==void 0)try{U=s.select(U),Oe(this,tn,null)}catch(A){Oe(this,tn,A)}U!==void 0&&(S="success",y=Sx(i==null?void 0:i.data,U,s),g=!0)}G(this,tn)&&(b=G(this,tn),y=G(this,Pl),w=Date.now(),S="error");const N=f.fetchStatus==="fetching",v=S==="pending",j=S==="error",C=v&&N,k=y!==void 0,T={status:S,fetchStatus:f.fetchStatus,isPending:v,isSuccess:S==="success",isError:j,isInitialLoading:C,isLoading:C,data:y,dataUpdatedAt:f.dataUpdatedAt,error:b,errorUpdatedAt:w,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>h.dataUpdateCount||f.errorUpdateCount>h.errorUpdateCount,isFetching:N,isRefetching:N&&!v,isLoadingError:j&&!k,isPaused:f.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:j&&k,isStale:sy(t,s),refetch:this.refetch,promise:G(this,gi)};if(this.options.experimental_prefetchInRender){const U=M=>{T.status==="error"?M.reject(T.error):T.data!==void 0&&M.resolve(T.data)},A=()=>{const M=Oe(this,gi,T.promise=kx());U(M)},L=G(this,gi);switch(L.status){case"pending":t.queryHash===a.queryHash&&U(L);break;case"fulfilled":(T.status==="error"||T.data!==L.value)&&A();break;case"rejected":(T.status!=="error"||T.error!==L.reason)&&A();break}}return T}updateResult(t){const s=G(this,jr),a=this.createResult(G(this,Lt),this.options);if(Oe(this,go,G(this,Lt).state),Oe(this,Rl,this.options),G(this,go).data!==void 0&&Oe(this,Il,G(this,Lt)),Oh(a,s))return;Oe(this,jr,a);const n={},i=()=>{if(!s)return!0;const{notifyOnChangeProps:o}=this.options,c=typeof o=="function"?o():o;if(c==="all"||!c&&!G(this,Dl).size)return!0;const d=new Set(c??G(this,Dl));return this.options.throwOnError&&d.add("error"),Object.keys(G(this,jr)).some(h=>{const m=h;return G(this,jr)[m]!==s[m]&&d.has(m)})};(t==null?void 0:t.listeners)!==!1&&i()&&(n.listeners=!0),kt(this,Jt,UN).call(this,{...n,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&kt(this,Jt,Tx).call(this)}},Ir=new WeakMap,Lt=new WeakMap,Td=new WeakMap,jr=new WeakMap,go=new WeakMap,Rl=new WeakMap,gi=new WeakMap,tn=new WeakMap,Rd=new WeakMap,Pl=new WeakMap,Il=new WeakMap,yo=new WeakMap,vo=new WeakMap,yi=new WeakMap,Dl=new WeakMap,Jt=new WeakSet,$c=function(t){kt(this,Jt,Ix).call(this);let s=G(this,Lt).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(Na)),s},Cx=function(){kt(this,Jt,Rx).call(this);const t=yl(this.options.staleTime,G(this,Lt));if(ko||G(this,jr).isStale||!_x(t))return;const a=TN(G(this,jr).dataUpdatedAt,t)+1;Oe(this,yo,setTimeout(()=>{G(this,jr).isStale||this.updateResult()},a))},Ex=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(G(this,Lt)):this.options.refetchInterval)??!1},Ax=function(t){kt(this,Jt,Px).call(this),Oe(this,yi,t),!(ko||$a(this.options.enabled,G(this,Lt))===!1||!_x(G(this,yi))||G(this,yi)===0)&&Oe(this,vo,setInterval(()=>{(this.options.refetchIntervalInBackground||ty.isFocused())&&kt(this,Jt,$c).call(this)},G(this,yi)))},Tx=function(){kt(this,Jt,Cx).call(this),kt(this,Jt,Ax).call(this,kt(this,Jt,Ex).call(this))},Rx=function(){G(this,yo)&&(clearTimeout(G(this,yo)),Oe(this,yo,void 0))},Px=function(){G(this,vo)&&(clearInterval(G(this,vo)),Oe(this,vo,void 0))},Ix=function(){const t=G(this,Ir).getQueryCache().build(G(this,Ir),this.options);if(t===G(this,Lt))return;const s=G(this,Lt);Oe(this,Lt,t),Oe(this,Td,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},UN=function(t){qs.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(G(this,jr))}),G(this,Ir).getQueryCache().notify({query:G(this,Lt),type:"observerResultsUpdated"})})},u_);function eO(r,t){return $a(t.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&t.retryOnMount===!1)}function ij(r,t){return eO(r,t)||r.state.data!==void 0&&Dx(r,t,t.refetchOnMount)}function Dx(r,t,s){if($a(t.enabled,r)!==!1){const a=typeof s=="function"?s(r):s;return a==="always"||a!==!1&&sy(r,t)}return!1}function oj(r,t,s,a){return(r!==t||$a(a.enabled,r)===!1)&&(!s.suspense||r.state.status!=="error")&&sy(r,s)}function sy(r,t){return $a(t.enabled,r)!==!1&&r.isStaleByTime(yl(t.staleTime,r))}function tO(r,t){return!Oh(r.getCurrentResult(),t)}var vi,wi,Dr,Rn,On,yh,Fx,h_,sO=(h_=class extends ac{constructor(s,a){super();Xe(this,On);Xe(this,vi);Xe(this,wi);Xe(this,Dr);Xe(this,Rn);Oe(this,vi,s),this.setOptions(a),this.bindMethods(),kt(this,On,yh).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var n;const a=this.options;this.options=G(this,vi).defaultMutationOptions(s),Oh(this.options,a)||G(this,vi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:G(this,Dr),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Co(a.mutationKey)!==Co(this.options.mutationKey)?this.reset():((n=G(this,Dr))==null?void 0:n.state.status)==="pending"&&G(this,Dr).setOptions(this.options)}onUnsubscribe(){var s;this.hasListeners()||(s=G(this,Dr))==null||s.removeObserver(this)}onMutationUpdate(s){kt(this,On,yh).call(this),kt(this,On,Fx).call(this,s)}getCurrentResult(){return G(this,wi)}reset(){var s;(s=G(this,Dr))==null||s.removeObserver(this),Oe(this,Dr,void 0),kt(this,On,yh).call(this),kt(this,On,Fx).call(this)}mutate(s,a){var n;return Oe(this,Rn,a),(n=G(this,Dr))==null||n.removeObserver(this),Oe(this,Dr,G(this,vi).getMutationCache().build(G(this,vi),this.options)),G(this,Dr).addObserver(this),G(this,Dr).execute(s)}},vi=new WeakMap,wi=new WeakMap,Dr=new WeakMap,Rn=new WeakMap,On=new WeakSet,yh=function(){var a;const s=((a=G(this,Dr))==null?void 0:a.state)??LN();Oe(this,wi,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})},Fx=function(s){qs.batch(()=>{var a,n,i,o,c,d,h,m;if(G(this,Rn)&&this.hasListeners()){const f=G(this,wi).variables,g=G(this,wi).context;(s==null?void 0:s.type)==="success"?((n=(a=G(this,Rn)).onSuccess)==null||n.call(a,s.data,f,g),(o=(i=G(this,Rn)).onSettled)==null||o.call(i,s.data,null,f,g)):(s==null?void 0:s.type)==="error"&&((d=(c=G(this,Rn)).onError)==null||d.call(c,s.error,f,g),(m=(h=G(this,Rn)).onSettled)==null||m.call(h,void 0,s.error,f,g))}this.listeners.forEach(f=>{f(G(this,wi))})})},h_),$N=p.createContext(void 0),qn=r=>{const t=p.useContext($N);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},rO=({client:r,children:t})=>(p.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),e.jsx($N.Provider,{value:r,children:t})),zN=p.createContext(!1),aO=()=>p.useContext(zN);zN.Provider;function nO(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var iO=p.createContext(nO()),oO=()=>p.useContext(iO);function BN(r,t){return typeof r=="function"?r(...t):!!r}function qN(){}var lO=(r,t)=>{(r.suspense||r.throwOnError)&&(t.isReset()||(r.retryOnMount=!1))},cO=r=>{p.useEffect(()=>{r.clearReset()},[r])},dO=({result:r,errorResetBoundary:t,throwOnError:s,query:a})=>r.isError&&!t.isReset()&&!r.isFetching&&a&&BN(s,[r.error,a]),uO=r=>{r.suspense&&(r.staleTime===void 0&&(r.staleTime=1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},hO=(r,t)=>r.isLoading&&r.isFetching&&!t,mO=(r,t)=>(r==null?void 0:r.suspense)&&t.isPending,lj=(r,t,s)=>t.fetchOptimistic(r).catch(()=>{s.clearReset()});function fO(r,t,s){var m,f,g,y,b;const a=qn(),n=aO(),i=oO(),o=a.defaultQueryOptions(r);(f=(m=a.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||f.call(m,o),o._optimisticResults=n?"isRestoring":"optimistic",uO(o),lO(o,i),cO(i);const c=!a.getQueryCache().get(o.queryHash),[d]=p.useState(()=>new t(a,o)),h=d.getOptimisticResult(o);if(p.useSyncExternalStore(p.useCallback(w=>{const S=n?()=>{}:d.subscribe(qs.batchCalls(w));return d.updateResult(),S},[d,n]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),p.useEffect(()=>{d.setOptions(o,{listeners:!1})},[o,d]),mO(o,h))throw lj(o,d,i);if(dO({result:h,errorResetBoundary:i,throwOnError:o.throwOnError,query:a.getQueryCache().get(o.queryHash)}))throw h.error;if((y=(g=a.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||y.call(g,o,h),o.experimental_prefetchInRender&&!ko&&hO(h,n)){const w=c?lj(o,d,i):(b=a.getQueryCache().get(o.queryHash))==null?void 0:b.promise;w==null||w.catch(qN).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?h:d.trackResult(h)}function Fo(r,t){return fO(r,XF)}function oa(r,t){const s=qn(),[a]=p.useState(()=>new sO(s,r));p.useEffect(()=>{a.setOptions(r)},[a,r]);const n=p.useSyncExternalStore(p.useCallback(o=>a.subscribe(qs.batchCalls(o)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=p.useCallback((o,c)=>{a.mutate(o,c).catch(qN)},[a]);if(n.error&&BN(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}const pO=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...s)=>Ns(async()=>{const{default:a}=await Promise.resolve().then(()=>nc);return{default:a}},void 0).then(({default:a})=>a(...s)):t=fetch,(...s)=>t(...s)};class ry extends Error{constructor(t,s="FunctionsError",a){super(t),this.name=s,this.context=a}}class xO extends ry{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class gO extends ry{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class yO extends ry{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ox;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Ox||(Ox={}));var vO=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,t||[])).next())})};class wO{constructor(t,{headers:s={},customFetch:a,region:n=Ox.Any}={}){this.url=t,this.headers=s,this.region=n,this.fetch=pO(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,s={}){var a;return vO(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=s;let c={},{region:d}=s;d||(d=this.region),d&&d!=="any"&&(c["x-region"]=d);let h;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(c["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(c["Content-Type"]="application/json",h=JSON.stringify(o)));const m=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),n),body:h}).catch(b=>{throw new xO(b)}),f=m.headers.get("x-relay-error");if(f&&f==="true")throw new gO(m);if(!m.ok)throw new yO(m);let g=((a=m.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),y;return g==="application/json"?y=yield m.json():g==="application/octet-stream"?y=yield m.blob():g==="text/event-stream"?y=m:g==="multipart/form-data"?y=yield m.formData():y=yield m.text(),{data:y,error:null}}catch(n){return{data:null,error:n}}})}}var Lr={},ay={},Tm={},Md={},Rm={},Pm={},jO=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate global object")},Ll=jO();const bO=Ll.fetch,VN=Ll.fetch.bind(Ll),WN=Ll.Headers,_O=Ll.Request,NO=Ll.Response,nc=Object.freeze(Object.defineProperty({__proto__:null,Headers:WN,Request:_O,Response:NO,default:VN,fetch:bO},Symbol.toStringTag,{value:"Module"})),SO=ZD(nc);var Im={};Object.defineProperty(Im,"__esModule",{value:!0});let kO=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Im.default=kO;var HN=ca&&ca.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Pm,"__esModule",{value:!0});const CO=HN(SO),EO=HN(Im);let AO=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=CO.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,s){return this.headers=Object.assign({},this.headers),this.headers[t]=s,this}then(t,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,c,d;let h=null,m=null,f=null,g=i.status,y=i.statusText;if(i.ok){if(this.method!=="HEAD"){const N=await i.text();N===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=N:m=JSON.parse(N))}const w=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),S=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");w&&S&&S.length>1&&(f=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(h={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,f=null,g=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const w=await i.text();try{h=JSON.parse(w),Array.isArray(h)&&i.status===404&&(m=[],h=null,g=200,y="OK")}catch{i.status===404&&w===""?(g=204,y="No Content"):h={message:w}}if(h&&this.isMaybeSingle&&(!((d=h==null?void 0:h.details)===null||d===void 0)&&d.includes("0 rows"))&&(h=null,g=200,y="OK"),h&&this.shouldThrowOnError)throw new EO.default(h)}return{error:h,data:m,count:f,status:g,statusText:y}});return this.shouldThrowOnError||(n=n.catch(i=>{var o,c,d;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(c=i==null?void 0:i.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(d=i==null?void 0:i.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,s)}returns(){return this}overrideTypes(){return this}};Pm.default=AO;var TO=ca&&ca.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Rm,"__esModule",{value:!0});const RO=TO(Pm);let PO=class extends RO.default{select(t){let s=!1;const a=(t??"*").split("").map(n=>/\s/.test(n)&&!s?"":(n==='"'&&(s=!s),n)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:s=!0,nullsFirst:a,foreignTable:n,referencedTable:i=n}={}){const o=i?`${i}.order`:"order",c=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${c?`${c},`:""}${t}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:s,referencedTable:a=s}={}){const n=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,s,{foreignTable:a,referencedTable:n=a}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${s-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:s=!1,settings:a=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var c;const d=[t?"analyze":null,s?"verbose":null,a?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),h=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${h}"; options=${d};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Rm.default=PO;var IO=ca&&ca.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Md,"__esModule",{value:!0});const DO=IO(Rm);let FO=class extends DO.default{eq(t,s){return this.url.searchParams.append(t,`eq.${s}`),this}neq(t,s){return this.url.searchParams.append(t,`neq.${s}`),this}gt(t,s){return this.url.searchParams.append(t,`gt.${s}`),this}gte(t,s){return this.url.searchParams.append(t,`gte.${s}`),this}lt(t,s){return this.url.searchParams.append(t,`lt.${s}`),this}lte(t,s){return this.url.searchParams.append(t,`lte.${s}`),this}like(t,s){return this.url.searchParams.append(t,`like.${s}`),this}likeAllOf(t,s){return this.url.searchParams.append(t,`like(all).{${s.join(",")}}`),this}likeAnyOf(t,s){return this.url.searchParams.append(t,`like(any).{${s.join(",")}}`),this}ilike(t,s){return this.url.searchParams.append(t,`ilike.${s}`),this}ilikeAllOf(t,s){return this.url.searchParams.append(t,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(t,s){return this.url.searchParams.append(t,`ilike(any).{${s.join(",")}}`),this}is(t,s){return this.url.searchParams.append(t,`is.${s}`),this}in(t,s){const a=Array.from(new Set(s)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${a})`),this}contains(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cs.{${s.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(s)}`),this}containedBy(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cd.{${s.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(s)}`),this}rangeGt(t,s){return this.url.searchParams.append(t,`sr.${s}`),this}rangeGte(t,s){return this.url.searchParams.append(t,`nxl.${s}`),this}rangeLt(t,s){return this.url.searchParams.append(t,`sl.${s}`),this}rangeLte(t,s){return this.url.searchParams.append(t,`nxr.${s}`),this}rangeAdjacent(t,s){return this.url.searchParams.append(t,`adj.${s}`),this}overlaps(t,s){return typeof s=="string"?this.url.searchParams.append(t,`ov.${s}`):this.url.searchParams.append(t,`ov.{${s.join(",")}}`),this}textSearch(t,s,{config:a,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=a===void 0?"":`(${a})`;return this.url.searchParams.append(t,`${i}fts${o}.${s}`),this}match(t){return Object.entries(t).forEach(([s,a])=>{this.url.searchParams.append(s,`eq.${a}`)}),this}not(t,s,a){return this.url.searchParams.append(t,`not.${s}.${a}`),this}or(t,{foreignTable:s,referencedTable:a=s}={}){const n=a?`${a}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,s,a){return this.url.searchParams.append(t,`${s}.${a}`),this}};Md.default=FO;var OO=ca&&ca.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Tm,"__esModule",{value:!0});const Ec=OO(Md);let MO=class{constructor(t,{headers:s={},schema:a,fetch:n}){this.url=t,this.headers=s,this.schema=a,this.fetch=n}select(t,{head:s=!1,count:a}={}){const n=s?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),a&&(this.headers.Prefer=`count=${a}`),new Ec.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:s,defaultToNull:a=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),s&&i.push(`count=${s}`),a||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(o.length>0){const c=[...new Set(o)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ec.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:s,ignoreDuplicates:a=!1,count:n,defaultToNull:i=!0}={}){const o="POST",c=[`resolution=${a?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&c.push(this.headers.Prefer),n&&c.push(`count=${n}`),i||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(t)){const d=t.reduce((h,m)=>h.concat(Object.keys(m)),[]);if(d.length>0){const h=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",h.join(","))}}return new Ec.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:s}={}){const a="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),s&&n.push(`count=${s}`),this.headers.Prefer=n.join(","),new Ec.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const s="DELETE",a=[];return t&&a.push(`count=${t}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new Ec.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Tm.default=MO;var Dm={},Fm={};Object.defineProperty(Fm,"__esModule",{value:!0});Fm.version=void 0;Fm.version="0.0.0-automated";Object.defineProperty(Dm,"__esModule",{value:!0});Dm.DEFAULT_HEADERS=void 0;const LO=Fm;Dm.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${LO.version}`};var GN=ca&&ca.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ay,"__esModule",{value:!0});const UO=GN(Tm),$O=GN(Md),zO=Dm;let BO=class KN{constructor(t,{headers:s={},schema:a,fetch:n}={}){this.url=t,this.headers=Object.assign(Object.assign({},zO.DEFAULT_HEADERS),s),this.schemaName=a,this.fetch=n}from(t){const s=new URL(`${this.url}/${t}`);return new UO.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new KN(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:a=!1,get:n=!1,count:i}={}){let o;const c=new URL(`${this.url}/rpc/${t}`);let d;a||n?(o=a?"HEAD":"GET",Object.entries(s).filter(([m,f])=>f!==void 0).map(([m,f])=>[m,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([m,f])=>{c.searchParams.append(m,f)})):(o="POST",d=s);const h=Object.assign({},this.headers);return i&&(h.Prefer=`count=${i}`),new $O.default({method:o,url:c,headers:h,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}};ay.default=BO;var ic=ca&&ca.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.PostgrestError=Lr.PostgrestBuilder=Lr.PostgrestTransformBuilder=Lr.PostgrestFilterBuilder=Lr.PostgrestQueryBuilder=Lr.PostgrestClient=void 0;const QN=ic(ay);Lr.PostgrestClient=QN.default;const YN=ic(Tm);Lr.PostgrestQueryBuilder=YN.default;const JN=ic(Md);Lr.PostgrestFilterBuilder=JN.default;const ZN=ic(Rm);Lr.PostgrestTransformBuilder=ZN.default;const XN=ic(Pm);Lr.PostgrestBuilder=XN.default;const e1=ic(Im);Lr.PostgrestError=e1.default;var qO=Lr.default={PostgrestClient:QN.default,PostgrestQueryBuilder:YN.default,PostgrestFilterBuilder:JN.default,PostgrestTransformBuilder:ZN.default,PostgrestBuilder:XN.default,PostgrestError:e1.default};const{PostgrestClient:VO,PostgrestQueryBuilder:EW,PostgrestFilterBuilder:AW,PostgrestTransformBuilder:TW,PostgrestBuilder:RW,PostgrestError:PW}=qO;let Mx;typeof window>"u"?Mx=require("ws"):Mx=window.WebSocket;const WO=Mx,HO="2.11.10",GO={"X-Client-Info":`realtime-js/${HO}`},KO="1.0.0",t1=1e4,QO=1e3;var vl;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(vl||(vl={}));var yr;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(yr||(yr={}));var Ua;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Ua||(Ua={}));var Lx;(function(r){r.websocket="websocket"})(Lx||(Lx={}));var ro;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(ro||(ro={}));class YO{constructor(){this.HEADER_LENGTH=1}decode(t,s){return t.constructor===ArrayBuffer?s(this._binaryDecode(t)):s(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const s=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,s,a)}_decodeBroadcast(t,s,a){const n=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const c=a.decode(t.slice(o,o+n));o=o+n;const d=a.decode(t.slice(o,o+i));o=o+i;const h=JSON.parse(a.decode(t.slice(o,t.byteLength)));return{ref:null,topic:c,event:d,payload:h}}}class s1{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var cs;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(cs||(cs={}));const cj=(r,t,s={})=>{var a;const n=(a=s.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(t).reduce((i,o)=>(i[o]=JO(o,r,t,n),i),{})},JO=(r,t,s,a)=>{const n=t.find(c=>c.name===r),i=n==null?void 0:n.type,o=s[r];return i&&!a.includes(i)?r1(i,o):Ux(o)},r1=(r,t)=>{if(r.charAt(0)==="_"){const s=r.slice(1,r.length);return t3(t,s)}switch(r){case cs.bool:return ZO(t);case cs.float4:case cs.float8:case cs.int2:case cs.int4:case cs.int8:case cs.numeric:case cs.oid:return XO(t);case cs.json:case cs.jsonb:return e3(t);case cs.timestamp:return s3(t);case cs.abstime:case cs.date:case cs.daterange:case cs.int4range:case cs.int8range:case cs.money:case cs.reltime:case cs.text:case cs.time:case cs.timestamptz:case cs.timetz:case cs.tsrange:case cs.tstzrange:return Ux(t);default:return Ux(t)}},Ux=r=>r,ZO=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},XO=r=>{if(typeof r=="string"){const t=parseFloat(r);if(!Number.isNaN(t))return t}return r},e3=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(t){return console.log(`JSON parse error: ${t}`),r}return r},t3=(r,t)=>{if(typeof r!="string")return r;const s=r.length-1,a=r[s];if(r[0]==="{"&&a==="}"){let i;const o=r.slice(1,s);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>r1(t,c))}return r},s3=r=>typeof r=="string"?r.replace(" ","T"):r,a1=r=>{let t=r;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Cp{constructor(t,s,a={},n=t1){this.channel=t,this.event=s,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var a;return this._hasReceived(t)&&s((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var dj;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(dj||(dj={}));class ad{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ad.syncState(this.state,n,i,o),this.pendingDiffs.forEach(d=>{this.state=ad.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ad.syncDiff(this.state,n,i,o),c())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,a,n){const i=this.cloneDeep(t),o=this.transformState(s),c={},d={};return this.map(i,(h,m)=>{o[h]||(d[h]=m)}),this.map(o,(h,m)=>{const f=i[h];if(f){const g=m.map(S=>S.presence_ref),y=f.map(S=>S.presence_ref),b=m.filter(S=>y.indexOf(S.presence_ref)<0),w=f.filter(S=>g.indexOf(S.presence_ref)<0);b.length>0&&(c[h]=b),w.length>0&&(d[h]=w)}else c[h]=m}),this.syncDiff(i,{joins:c,leaves:d},a,n)}static syncDiff(t,s,a,n){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(i,(c,d)=>{var h;const m=(h=t[c])!==null&&h!==void 0?h:[];if(t[c]=this.cloneDeep(d),m.length>0){const f=t[c].map(y=>y.presence_ref),g=m.filter(y=>f.indexOf(y.presence_ref)<0);t[c].unshift(...g)}a(c,m,d)}),this.map(o,(c,d)=>{let h=t[c];if(!h)return;const m=d.map(f=>f.presence_ref);h=h.filter(f=>m.indexOf(f.presence_ref)<0),t[c]=h,n(c,h,d),h.length===0&&delete t[c]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(a=>s(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,a)=>{const n=t[a];return"metas"in n?s[a]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[a]=n,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var uj;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(uj||(uj={}));var hj;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(hj||(hj={}));var Tn;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Tn||(Tn={}));class ny{constructor(t,s={config:{}},a){this.topic=t,this.params=s,this.socket=a,this.bindings={},this.state=yr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new Cp(this,Ua.join,this.params,this.timeout),this.rejoinTimer=new s1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=yr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=yr.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=yr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=yr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ua.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new ad(this),this.broadcastEndpointURL=a1(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,s=this.timeout){var a,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:c}}=this.params;this._onError(m=>t==null?void 0:t(Tn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(Tn.CLOSED));const d={},h={broadcast:i,presence:o,postgres_changes:(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(m=>m.filter))!==null&&n!==void 0?n:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:m})=>{var f;if(this.socket.setAuth(),m===void 0){t==null||t(Tn.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(f=g==null?void 0:g.length)!==null&&f!==void 0?f:0,b=[];for(let w=0;w<y;w++){const S=g[w],{filter:{event:N,schema:v,table:j,filter:C}}=S,k=m&&m[w];if(k&&k.event===N&&k.schema===v&&k.table===j&&k.filter===C)b.push(Object.assign(Object.assign({},S),{id:k.id}));else{this.unsubscribe(),this.state=yr.errored,t==null||t(Tn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,t&&t(Tn.SUBSCRIBED);return}}).receive("error",m=>{this.state=yr.errored,t==null||t(Tn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Tn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,a){return this._on(t,s,a)}async send(t,s={}){var a,n;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=h.body)===null||n===void 0?void 0:n.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,d;const h=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),h.receive("ok",()=>i("ok")),h.receive("error",()=>i("error")),h.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=yr.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ua.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(a=>{const n=new Cp(this,Ua.leave,{},t);n.receive("ok",()=>{s(),a("ok")}).receive("timeout",()=>{s(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,s,a){const n=new AbortController,i=setTimeout(()=>n.abort(),a),o=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(i),o}_push(t,s,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Cp(this,t,s,a);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(t,s,a){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,a){var n,i;const o=t.toLocaleLowerCase(),{close:c,error:d,leave:h,join:m}=Ua;if(a&&[c,d,h,m].indexOf(o)>=0&&a!==this._joinRef())return;let g=this._onMessage(o,s,a);if(s&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(y=>{var b,w,S;return((b=y.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(w=y.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(y=>y.callback(g,a)):(i=this.bindings[o])===null||i===void 0||i.filter(y=>{var b,w,S,N,v,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const C=y.id,k=(b=y.filter)===null||b===void 0?void 0:b.event;return C&&((w=s.ids)===null||w===void 0?void 0:w.includes(C))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((S=s.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const C=(v=(N=y==null?void 0:y.filter)===null||N===void 0?void 0:N.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return C==="*"||C===((j=s==null?void 0:s.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof g=="object"&&"ids"in g){const b=g.data,{schema:w,table:S,commit_timestamp:N,type:v,errors:j}=b;g=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:N,eventType:v,new:{},old:{},errors:j}),this._getPayloadRecords(b))}y.callback(g,a)})}_isClosed(){return this.state===yr.closed}_isJoined(){return this.state===yr.joined}_isJoining(){return this.state===yr.joining}_isLeaving(){return this.state===yr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,a){const n=t.toLocaleLowerCase(),i={type:n,filter:s,callback:a};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(t,s){const a=t.toLocaleLowerCase();return this.bindings[a]=this.bindings[a].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&ny.isEqual(n.filter,s))}),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const a in t)if(t[a]!==s[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ua.close,{},t)}_onError(t){this._on(Ua.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=yr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=cj(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=cj(t.columns,t.old_record)),s}}const mj=()=>{},r3=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class a3{constructor(t,s){var a;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=GO,this.params={},this.timeout=t1,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mj,this.ref=0,this.logger=mj,this.conn=null,this.sendBuffer=[],this.serializer=new YO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...c)=>Ns(async()=>{const{default:d}=await Promise.resolve().then(()=>nc);return{default:d}},void 0).then(({default:d})=>d(...c)):o=fetch,(...c)=>o(...c)},this.endPoint=`${t}/${Lx.websocket}`,this.httpEndpoint=a1(t),s!=null&&s.transport?this.transport=s.transport:this.transport=null,s!=null&&s.params&&(this.params=s.params),s!=null&&s.headers&&(this.headers=Object.assign(Object.assign({},this.headers),s.headers)),s!=null&&s.timeout&&(this.timeout=s.timeout),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),s!=null&&s.heartbeatIntervalMs&&(this.heartbeatIntervalMs=s.heartbeatIntervalMs);const n=(a=s==null?void 0:s.params)===null||a===void 0?void 0:a.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=s!=null&&s.reconnectAfterMs?s.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=s!=null&&s.encode?s.encode:(i,o)=>o(JSON.stringify(i)),this.decode=s!=null&&s.decode?s.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new s1(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(s==null?void 0:s.fetch),s!=null&&s.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(s==null?void 0:s.worker)||!1,this.workerUrl=s==null?void 0:s.workerUrl}this.accessToken=(s==null?void 0:s.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=WO),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new n3(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:KO}))}disconnect(t,s){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,s??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(a=>a.teardown()))}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels=this.channels.filter(a=>a._joinRef!==t._joinRef),this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,s,a){this.logger(t,s,a)}connectionState(){switch(this.conn&&this.conn.readyState){case vl.connecting:return ro.Connecting;case vl.open:return ro.Open;case vl.closing:return ro.Closing;default:return ro.Closed}}isConnected(){return this.connectionState()===ro.Open}channel(t,s={config:{}}){const a=`realtime:${t}`,n=this.getChannels().find(i=>i.topic===a);if(n)return n;{const i=new ny(`realtime:${t}`,s,this);return this.channels.push(i),i}}push(t){const{topic:s,event:a,payload:n,ref:i}=t,o=()=>{this.encode(t,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${s} ${a} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let s=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(a=>{s&&a.updateJoinPayload({access_token:s,version:this.headers&&this.headers["X-Client-Info"]}),a.joinedOnce&&a._isJoined()&&a._push(Ua.access_token,{access_token:s})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(QO,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,s=>{let{topic:a,event:n,payload:i,ref:o}=s;a==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(s.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${a} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(a)).forEach(c=>c._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(c=>c(s))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(s=>s(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(s=>s(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ua.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const a=t.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${t}${a}${n}`}_workerObjectUrl(t){let s;if(t)s=t;else{const a=new Blob([r3],{type:"application/javascript"});s=URL.createObjectURL(a)}return s}}class n3{constructor(t,s,a){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=vl.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=a.close}}class iy extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ks(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class i3 extends iy{constructor(t,s){super(t),this.name="StorageApiError",this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class $x extends iy{constructor(t,s){super(t),this.name="StorageUnknownError",this.originalError=s}}var o3=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,t||[])).next())})};const n1=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...s)=>Ns(async()=>{const{default:a}=await Promise.resolve().then(()=>nc);return{default:a}},void 0).then(({default:a})=>a(...s)):t=fetch,(...s)=>t(...s)},l3=()=>o3(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ns(()=>Promise.resolve().then(()=>nc),void 0)).Response:Response}),zx=r=>{if(Array.isArray(r))return r.map(s=>zx(s));if(typeof r=="function"||r!==Object(r))return r;const t={};return Object.entries(r).forEach(([s,a])=>{const n=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[n]=zx(a)}),t};var Oo=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,t||[])).next())})};const Ep=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),c3=(r,t,s)=>Oo(void 0,void 0,void 0,function*(){const a=yield l3();r instanceof a&&!(s!=null&&s.noResolveJson)?r.json().then(n=>{t(new i3(Ep(n),r.status||500))}).catch(n=>{t(new $x(Ep(n),n))}):t(new $x(Ep(r),r))}),d3=(r,t,s,a)=>{const n={method:r,headers:(t==null?void 0:t.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a&&(n.body=JSON.stringify(a)),Object.assign(Object.assign({},n),s))};function Ld(r,t,s,a,n,i){return Oo(this,void 0,void 0,function*(){return new Promise((o,c)=>{r(s,d3(t,a,n,i)).then(d=>{if(!d.ok)throw d;return a!=null&&a.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>c3(d,c,a))})})}function Lh(r,t,s,a){return Oo(this,void 0,void 0,function*(){return Ld(r,"GET",t,s,a)})}function ni(r,t,s,a,n){return Oo(this,void 0,void 0,function*(){return Ld(r,"POST",t,a,n,s)})}function u3(r,t,s,a,n){return Oo(this,void 0,void 0,function*(){return Ld(r,"PUT",t,a,n,s)})}function h3(r,t,s,a){return Oo(this,void 0,void 0,function*(){return Ld(r,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),a)})}function i1(r,t,s,a,n){return Oo(this,void 0,void 0,function*(){return Ld(r,"DELETE",t,a,n,s)})}var Rr=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,t||[])).next())})};const m3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fj={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class f3{constructor(t,s={},a,n){this.url=t,this.headers=s,this.bucketId=a,this.fetch=n1(n)}uploadOrUpdate(t,s,a,n){return Rr(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},fj),n);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&a instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",a)):typeof FormData<"u"&&a instanceof FormData?(i=a,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=a,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),n!=null&&n.headers&&(c=Object.assign(Object.assign({},c),n.headers));const h=this._removeEmptyFolders(s),m=this._getFinalPath(h),f=yield this.fetch(`${this.url}/object/${m}`,Object.assign({method:t,body:i,headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{})),g=yield f.json();return f.ok?{data:{path:h,id:g.Id,fullPath:g.Key},error:null}:{data:null,error:g}}catch(i){if(Ks(i))return{data:null,error:i};throw i}})}upload(t,s,a){return Rr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,s,a)})}uploadToSignedUrl(t,s,a,n){return Rr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",s);try{let d;const h=Object.assign({upsert:fj.upsert},n),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&a instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",a)):typeof FormData<"u"&&a instanceof FormData?(d=a,d.append("cacheControl",h.cacheControl)):(d=a,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType);const f=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:m}),g=yield f.json();return f.ok?{data:{path:i,fullPath:g.Key},error:null}:{data:null,error:g}}catch(d){if(Ks(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,s){return Rr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const n=Object.assign({},this.headers);s!=null&&s.upsert&&(n["x-upsert"]="true");const i=yield ni(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new iy("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:c},error:null}}catch(a){if(Ks(a))return{data:null,error:a};throw a}})}update(t,s,a){return Rr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,s,a)})}move(t,s,a){return Rr(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Ks(n))return{data:null,error:n};throw n}})}copy(t,s,a){return Rr(this,void 0,void 0,function*(){try{return{data:{path:(yield ni(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Ks(n))return{data:null,error:n};throw n}})}createSignedUrl(t,s,a){return Rr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),i=yield ni(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const o=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(Ks(n))return{data:null,error:n};throw n}})}createSignedUrls(t,s,a){return Rr(this,void 0,void 0,function*(){try{const n=yield ni(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:t},{headers:this.headers}),i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(Ks(n))return{data:null,error:n};throw n}})}download(t,s){return Rr(this,void 0,void 0,function*(){const n=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),o=i?`?${i}`:"";try{const c=this._getFinalPath(t);return{data:yield(yield Lh(this.fetch,`${this.url}/${n}/${c}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Ks(c))return{data:null,error:c};throw c}})}info(t){return Rr(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{const a=yield Lh(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:zx(a),error:null}}catch(a){if(Ks(a))return{data:null,error:a};throw a}})}exists(t){return Rr(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{return yield h3(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(Ks(a)&&a instanceof $x){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,s){const a=this._getFinalPath(t),n=[],i=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&n.push(i);const c=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});d!==""&&n.push(d);let h=n.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${a}${h}`)}}}remove(t){return Rr(this,void 0,void 0,function*(){try{return{data:yield i1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(s){if(Ks(s))return{data:null,error:s};throw s}})}list(t,s,a){return Rr(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},m3),s),{prefix:t||""});return{data:yield ni(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(Ks(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const s=[];return t.width&&s.push(`width=${t.width}`),t.height&&s.push(`height=${t.height}`),t.resize&&s.push(`resize=${t.resize}`),t.format&&s.push(`format=${t.format}`),t.quality&&s.push(`quality=${t.quality}`),s.join("&")}}const p3="2.7.1",x3={"X-Client-Info":`storage-js/${p3}`};var rl=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,[])).next())})};class g3{constructor(t,s={},a){this.url=t,this.headers=Object.assign(Object.assign({},x3),s),this.fetch=n1(a)}listBuckets(){return rl(this,void 0,void 0,function*(){try{return{data:yield Lh(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Ks(t))return{data:null,error:t};throw t}})}getBucket(t){return rl(this,void 0,void 0,function*(){try{return{data:yield Lh(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(s){if(Ks(s))return{data:null,error:s};throw s}})}createBucket(t,s={public:!1}){return rl(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(Ks(a))return{data:null,error:a};throw a}})}updateBucket(t,s){return rl(this,void 0,void 0,function*(){try{return{data:yield u3(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(Ks(a))return{data:null,error:a};throw a}})}emptyBucket(t){return rl(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(Ks(s))return{data:null,error:s};throw s}})}deleteBucket(t){return rl(this,void 0,void 0,function*(){try{return{data:yield i1(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(Ks(s))return{data:null,error:s};throw s}})}}class y3 extends g3{constructor(t,s={},a){super(t,s,a)}from(t){return new f3(this.url,this.headers,t,this.fetch)}}const v3="2.50.0";let zc="";typeof Deno<"u"?zc="deno":typeof document<"u"?zc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zc="react-native":zc="node";const w3={"X-Client-Info":`supabase-js-${zc}/${v3}`},j3={headers:w3},b3={schema:"public"},_3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},N3={};var S3=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,t||[])).next())})};const k3=r=>{let t;return r?t=r:typeof fetch>"u"?t=VN:t=fetch,(...s)=>t(...s)},C3=()=>typeof Headers>"u"?WN:Headers,E3=(r,t,s)=>{const a=k3(s),n=C3();return(i,o)=>S3(void 0,void 0,void 0,function*(){var c;const d=(c=yield t())!==null&&c!==void 0?c:r;let h=new n(o==null?void 0:o.headers);return h.has("apikey")||h.set("apikey",r),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),a(i,Object.assign(Object.assign({},o),{headers:h}))})};var A3=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,[])).next())})};function T3(r){return r.endsWith("/")?r:r+"/"}function R3(r,t){var s,a;const{db:n,auth:i,realtime:o,global:c}=r,{db:d,auth:h,realtime:m,global:f}=t,g={db:Object.assign(Object.assign({},d),n),auth:Object.assign(Object.assign({},h),i),realtime:Object.assign(Object.assign({},m),o),global:Object.assign(Object.assign(Object.assign({},f),c),{headers:Object.assign(Object.assign({},(s=f==null?void 0:f.headers)!==null&&s!==void 0?s:{}),(a=c==null?void 0:c.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>A3(this,void 0,void 0,function*(){return""})};return r.accessToken?g.accessToken=r.accessToken:delete g.accessToken,g}const o1="2.70.0",ul=30*1e3,Bx=3,Ap=Bx*ul,P3="http://localhost:9999",I3="supabase.auth.token",D3={"X-Client-Info":`gotrue-js/${o1}`},qx="X-Supabase-Api-Version",l1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},F3=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,O3=6e5;class oy extends Error{constructor(t,s,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=a}}function jt(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class M3 extends oy{constructor(t,s,a){super(t,s,a),this.name="AuthApiError",this.status=s,this.code=a}}function L3(r){return jt(r)&&r.name==="AuthApiError"}class c1 extends oy{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class Oi extends oy{constructor(t,s,a,n){super(t,a,n),this.name=s,this.status=a}}class ai extends Oi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function U3(r){return jt(r)&&r.name==="AuthSessionMissingError"}class Hu extends Oi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Gu extends Oi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ku extends Oi{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $3(r){return jt(r)&&r.name==="AuthImplicitGrantRedirectError"}class pj extends Oi{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vx extends Oi{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function Tp(r){return jt(r)&&r.name==="AuthRetryableFetchError"}class xj extends Oi{constructor(t,s,a){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=a}}class nd extends Oi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Uh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),gj=` 	
\r=`.split(""),z3=(()=>{const r=new Array(128);for(let t=0;t<r.length;t+=1)r[t]=-1;for(let t=0;t<gj.length;t+=1)r[gj[t].charCodeAt(0)]=-2;for(let t=0;t<Uh.length;t+=1)r[Uh[t].charCodeAt(0)]=t;return r})();function yj(r,t,s){if(r!==null)for(t.queue=t.queue<<8|r,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;s(Uh[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;s(Uh[a]),t.queuedBits-=6}}function d1(r,t,s){const a=z3[r];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function vj(r){const t=[],s=o=>{t.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{V3(o,a,s)};for(let o=0;o<r.length;o+=1)d1(r.charCodeAt(o),n,i);return t.join("")}function B3(r,t){if(r<=127){t(r);return}else if(r<=2047){t(192|r>>6),t(128|r&63);return}else if(r<=65535){t(224|r>>12),t(128|r>>6&63),t(128|r&63);return}else if(r<=1114111){t(240|r>>18),t(128|r>>12&63),t(128|r>>6&63),t(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function q3(r,t){for(let s=0;s<r.length;s+=1){let a=r.charCodeAt(s);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(r.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}B3(a,t)}}function V3(r,t,s){if(t.utf8seq===0){if(r<=127){s(r);return}for(let a=1;a<6;a+=1)if(!(r>>7-a&1)){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=r&31;else if(t.utf8seq===3)t.codepoint=r&15;else if(t.utf8seq===4)t.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|r&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function W3(r){const t=[],s={queue:0,queuedBits:0},a=n=>{t.push(n)};for(let n=0;n<r.length;n+=1)d1(r.charCodeAt(n),s,a);return new Uint8Array(t)}function H3(r){const t=[];return q3(r,s=>t.push(s)),new Uint8Array(t)}function G3(r){const t=[],s={queue:0,queuedBits:0},a=n=>{t.push(n)};return r.forEach(n=>yj(n,s,a)),yj(null,s,a),t.join("")}function K3(r){return Math.round(Date.now()/1e3)+r}function Q3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const t=Math.random()*16|0;return(r=="x"?t:t&3|8).toString(16)})}const Fa=()=>typeof window<"u"&&typeof document<"u",Xi={tested:!1,writable:!1},id=()=>{if(!Fa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xi.tested)return Xi.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Xi.tested=!0,Xi.writable=!0}catch{Xi.tested=!0,Xi.writable=!1}return Xi.writable};function Y3(r){const t={},s=new URL(r);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,i)=>{t[i]=n})}catch{}return s.searchParams.forEach((a,n)=>{t[n]=a}),t}const u1=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...s)=>Ns(async()=>{const{default:a}=await Promise.resolve().then(()=>nc);return{default:a}},void 0).then(({default:a})=>a(...s)):t=fetch,(...s)=>t(...s)},J3=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",h1=async(r,t,s)=>{await r.setItem(t,JSON.stringify(s))},Qu=async(r,t)=>{const s=await r.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Yu=async(r,t)=>{await r.removeItem(t)};class Om{constructor(){this.promise=new Om.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}Om.promiseConstructor=Promise;function Rp(r){const t=r.split(".");if(t.length!==3)throw new nd("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!F3.test(t[a]))throw new nd("JWT not in base64url format");return{header:JSON.parse(vj(t[0])),payload:JSON.parse(vj(t[1])),signature:W3(t[2]),raw:{header:t[0],payload:t[1]}}}async function Z3(r){return await new Promise(t=>{setTimeout(()=>t(null),r)})}function X3(r,t){return new Promise((a,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await r(i);if(!t(i,null,o)){a(o);return}}catch(o){if(!t(i,o)){n(o);return}}})()})}function eM(r){return("0"+r.toString(16)).substr(-2)}function tM(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=s.length;let n="";for(let i=0;i<56;i++)n+=s.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(t),Array.from(t,eM).join("")}async function sM(r){const s=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(a);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function rM(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const s=await sM(r);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function al(r,t,s=!1){const a=tM();let n=a;s&&(n+="/PASSWORD_RECOVERY"),await h1(r,`${t}-code-verifier`,n);const i=await rM(a);return[i,a===i?"plain":"s256"]}const aM=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function nM(r){const t=r.headers.get(qx);if(!t||!t.match(aM))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function iM(r){if(!r)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(r<=t)throw new Error("JWT has expired")}function oM(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const lM=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function nl(r){if(!lM.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var cM=function(r,t){var s={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(r);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(r,a[n])&&(s[a[n]]=r[a[n]]);return s};const eo=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),dM=[502,503,504];async function wj(r){var t;if(!J3(r))throw new Vx(eo(r),0);if(dM.includes(r.status))throw new Vx(eo(r),r.status);let s;try{s=await r.json()}catch(i){throw new c1(eo(i),i)}let a;const n=nM(r);if(n&&n.getTime()>=l1["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?a=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(a=s.error_code),a){if(a==="weak_password")throw new xj(eo(s),r.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new ai}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new xj(eo(s),r.status,s.weak_password.reasons);throw new M3(eo(s),r.status||500,a)}const uM=(r,t,s,a)=>{const n={method:r,headers:(t==null?void 0:t.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),s))};async function Pt(r,t,s,a){var n;const i=Object.assign({},a==null?void 0:a.headers);i[qx]||(i[qx]=l1["2024-01-01"].name),a!=null&&a.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const o=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(o.redirect_to=a.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await hM(r,t,s+c,{headers:i,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(d):{data:Object.assign({},d),error:null}}async function hM(r,t,s,a,n,i){const o=uM(t,a,n,i);let c;try{c=await r(s,Object.assign({},o))}catch(d){throw console.error(d),new Vx(eo(d),0)}if(c.ok||await wj(c),a!=null&&a.noResolveJson)return c;try{return await c.json()}catch(d){await wj(d)}}function En(r){var t;let s=null;xM(r)&&(s=Object.assign({},r),r.expires_at||(s.expires_at=K3(r.expires_in)));const a=(t=r.user)!==null&&t!==void 0?t:r;return{data:{session:s,user:a},error:null}}function jj(r){const t=En(r);return!t.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0)&&(t.data.weak_password=r.weak_password),t}function di(r){var t;return{data:{user:(t=r.user)!==null&&t!==void 0?t:r},error:null}}function mM(r){return{data:r,error:null}}function fM(r){const{action_link:t,email_otp:s,hashed_token:a,redirect_to:n,verification_type:i}=r,o=cM(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:s,hashed_token:a,redirect_to:n,verification_type:i},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function pM(r){return r}function xM(r){return r.access_token&&r.refresh_token&&r.expires_in}const Pp=["global","local","others"];var gM=function(r,t){var s={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(r);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(r,a[n])&&(s[a[n]]=r[a[n]]);return s};class yM{constructor({url:t="",headers:s={},fetch:a}){this.url=t,this.headers=s,this.fetch=u1(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,s=Pp[0]){if(Pp.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Pp.join(", ")}`);try{return await Pt(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(jt(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,s={}){try{return await Pt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:di})}catch(a){if(jt(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:s}=t,a=gM(t,["options"]),n=Object.assign(Object.assign({},a),s);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await Pt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:fM,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(jt(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await Pt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:di})}catch(s){if(jt(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,a,n,i,o,c,d;try{const h={nextPage:null,lastPage:0,total:0},m=await Pt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:pM});if(m.error)throw m.error;const f=await m.json(),g=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return y.length>0&&(y.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);h[`${S}Page`]=w}),h.total=parseInt(g)),{data:Object.assign(Object.assign({},f),h),error:null}}catch(h){if(jt(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){nl(t);try{return await Pt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:di})}catch(s){if(jt(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){nl(t);try{return await Pt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:di})}catch(a){if(jt(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,s=!1){nl(t);try{return await Pt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:di})}catch(a){if(jt(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){nl(t.userId);try{const{data:s,error:a}=await Pt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:a}}catch(s){if(jt(s))return{data:null,error:s};throw s}}async _deleteFactor(t){nl(t.userId),nl(t.id);try{return{data:await Pt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(jt(s))return{data:null,error:s};throw s}}}const vM={getItem:r=>id()?globalThis.localStorage.getItem(r):null,setItem:(r,t)=>{id()&&globalThis.localStorage.setItem(r,t)},removeItem:r=>{id()&&globalThis.localStorage.removeItem(r)}};function bj(r={}){return{getItem:t=>r[t]||null,setItem:(t,s)=>{r[t]=s},removeItem:t=>{delete r[t]}}}function wM(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const il={debug:!!(globalThis&&id()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class m1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class jM extends m1{}async function bM(r,t,s){il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),il.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await s()}finally{il.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(t===0)throw il.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new jM(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(il.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}wM();const _M={url:P3,storageKey:I3,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:D3,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function _j(r,t,s){return await s()}class gd{constructor(t){var s,a;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=gd.nextInstanceID,gd.nextInstanceID+=1,this.instanceID>0&&Fa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},_M),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new yM({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=u1(n.fetch),this.lock=n.lock||_j,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Fa()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=bM:this.lock=_j,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:id()?this.storage=vM:(this.memoryStorage={},this.storage=bj(this.memoryStorage)):(this.memoryStorage={},this.storage=bj(this.memoryStorage)),Fa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${o1}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const s=Y3(window.location.href);let a="none";if(this._isImplicitGrantCallback(s)?a="implicit":await this._isPKCECallback(s)&&(a="pkce"),Fa()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:i}=await this._getSessionFromURL(s,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),$3(i)){const d=(t=i.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return jt(s)?{error:s}:{error:new c1("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,a,n;try{const i=await Pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:En}),{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(i){if(jt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var s,a,n;try{let i;if("email"in t){const{email:m,password:f,options:g}=t;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await al(this.storage,this.storageKey)),i=await Pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:m,password:f,data:(s=g==null?void 0:g.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:y,code_challenge_method:b},xform:En})}else if("phone"in t){const{phone:m,password:f,options:g}=t;i=await Pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:f,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},channel:(n=g==null?void 0:g.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:En})}else throw new Gu("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(i){if(jt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let s;if("email"in t){const{email:i,password:o,options:c}=t;s=await Pt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:jj})}else if("phone"in t){const{phone:i,password:o,options:c}=t;s=await Pt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:jj})}else throw new Gu("You must provide either an email or phone number and a password");const{data:a,error:n}=s;return n?{data:{user:null,session:null},error:n}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Hu}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(s){if(jt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(t){var s,a,n,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:s}=t;if(s==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(t){var s,a,n,i,o,c,d,h,m,f,g,y;let b,w;if("message"in t)b=t.message,w=t.signature;else{const{chain:S,wallet:N,statement:v,options:j}=t;let C;if(Fa())if(typeof N=="object")C=N;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))C=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=N}const k=new URL((s=j==null?void 0:j.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in C&&C.signIn){const I=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j==null?void 0:j.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),v?{statement:v}:null));let T;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")T=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)T=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)b=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),w=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${k.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(n=(a=j==null?void 0:j.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=j==null?void 0:j.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((o=j==null?void 0:j.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((c=j==null?void 0:j.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((d=j==null?void 0:j.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((h=j==null?void 0:j.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((f=(m=j==null?void 0:j.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||f===void 0)&&f.length?["Resources",...j.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const I=await C.signMessage(new TextEncoder().encode(b),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=I}}try{const{data:S,error:N}=await Pt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:G3(w)},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:En});if(N)throw N;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new Hu}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:N})}catch(S){if(jt(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(t){const s=await Qu(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(s??"").split("/");try{const{data:i,error:o}=await Pt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:En});if(await Yu(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Hu}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(jt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:s,provider:a,token:n,access_token:i,nonce:o}=t,c=await Pt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:En}),{data:d,error:h}=c;return h?{data:{user:null,session:null},error:h}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Hu}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:h})}catch(s){if(jt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(t){var s,a,n,i,o;try{if("email"in t){const{email:c,options:d}=t;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await al(this.storage,this.storageKey));const{error:f}=await Pt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:c,options:d}=t,{data:h,error:m}=await Pt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:m}}throw new Gu("You must provide either an email or phone number.")}catch(c){if(jt(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var s,a;try{let n,i;"options"in t&&(n=(s=t.options)===null||s===void 0?void 0:s.redirectTo,i=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:c}=await Pt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:En});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,h=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(n){if(jt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var s,a,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await al(this.storage,this.storageKey)),await Pt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:mM})}catch(i){if(jt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:a}=t;if(a)throw a;if(!s)throw new ai;const{error:n}=await Pt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(jt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:a,type:n,options:i}=t,{error:o}=await Pt(this.fetch,"POST",s,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:a,type:n,options:i}=t,{data:o,error:c}=await Pt(this.fetch,"POST",s,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c}}throw new Gu("You must provide either an email or phone number and a type")}catch(s){if(jt(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=s();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await Qu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<Ap:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(d,h,m)=>(!o&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,h,m))})}return{data:{session:t},error:null}}const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Pt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:di}):await this._useSession(async s=>{var a,n,i;const{data:o,error:c}=s;if(c)throw c;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ai}:await Pt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:di})})}catch(s){if(jt(s))return U3(s)&&(await this._removeSession(),await Yu(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async a=>{const{data:n,error:i}=a;if(i)throw i;if(!n.session)throw new ai;const o=n.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=await al(this.storage,this.storageKey));const{data:h,error:m}=await Pt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:di});if(m)throw m;return o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(a){if(jt(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ai;const s=Date.now()/1e3;let a=s,n=!0,i=null;const{payload:o}=Rp(t.access_token);if(o.exp&&(a=o.exp,n=a<=s),n){const{session:c,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(t.access_token);if(d)throw d;i={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:a-s,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(s){if(jt(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var a;if(!t){const{data:o,error:c}=s;if(c)throw c;t=(a=o.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new ai;const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(jt(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(t,s){try{if(!Fa())throw new Ku("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ku(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new pj("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ku("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new pj("No code detected.");const{data:v,error:j}=await this._exchangeCodeForSession(t.code);if(j)throw j;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:c,expires_at:d,token_type:h}=t;if(!i||!c||!o||!h)throw new Ku("No session defined in URL");const m=Math.round(Date.now()/1e3),f=parseInt(c);let g=m+f;d&&(g=parseInt(d));const y=g-m;y*1e3<=ul&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${f}s`);const b=g-f;m-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,g,m):m-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,g,m);const{data:w,error:S}=await this._getUser(i);if(S)throw S;const N={provider_token:a,provider_refresh_token:n,access_token:i,expires_in:f,expires_at:g,refresh_token:o,token_type:h,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:N,redirectType:t.type},error:null}}catch(a){if(jt(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await Qu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var a;const{data:n,error:i}=s;if(i)return{error:i};const o=(a=n.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(L3(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(await this._removeSession(),await Yu(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const s=Q3(),a={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async s=>{var a,n;try{const{data:{session:i},error:o}=s;if(o)throw o;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,s={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await al(this.storage,this.storageKey,!0));try{return await Pt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(jt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:s,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(s){if(jt(s))return{data:null,error:s};throw s}}async linkIdentity(t){var s;try{const{data:a,error:n}=await this._useSession(async i=>{var o,c,d,h,m;const{data:f,error:g}=i;if(g)throw g;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Pt(this.fetch,"GET",y,{headers:this.headers,jwt:(m=(h=f.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})});if(n)throw n;return Fa()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(jt(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async unlinkIdentity(t){try{return await this._useSession(async s=>{var a,n;const{data:i,error:o}=s;if(o)throw o;return await Pt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(jt(s))return{data:null,error:s};throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const a=Date.now();return await X3(async n=>(n>0&&await Z3(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await Pt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:En})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Tp(i)&&Date.now()+o-a<ul})}catch(a){if(this._debug(s,"error",a),jt(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",a),Fa()&&!s.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await Qu(this.storage,this.storageKey);if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const n=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Ap;if(this._debug(s,`session has${n?"":" not"} expired with margin of ${Ap}s`),n){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),Tp(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var s,a;if(!t)throw new ai;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Om;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new ai;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(n,"error",i),jt(i)){const o={session:null,error:i};return Tp(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,s,a=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",s,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,s)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await h1(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Yu(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Fa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ul);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:a}}=s;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-t)/ul);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${ul}ms, refresh threshold is ${Bx} ticks`),n<=Bx&&await this._callRefreshToken(a.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof m1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Fa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,a){const n=[`provider=${encodeURIComponent(s)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,o]=await al(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(c.toString())}if(a!=null&&a.queryParams){const i=new URLSearchParams(a.queryParams);n.push(i.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var a;const{data:n,error:i}=s;return i?{data:null,error:i}:await Pt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(s){if(jt(s))return{data:null,error:s};throw s}}async _enroll(t){try{return await this._useSession(async s=>{var a,n;const{data:i,error:o}=s;if(o)return{data:null,error:o};const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:d,error:h}=await Pt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token});return h?{data:null,error:h}:(t.factorType==="totp"&&(!((n=d==null?void 0:d.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(s){if(jt(s))return{data:null,error:s};throw s}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var a;const{data:n,error:i}=s;if(i)return{data:null,error:i};const{data:o,error:c}=await Pt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(s){if(jt(s))return{data:null,error:s};throw s}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var a;const{data:n,error:i}=s;return i?{data:null,error:i}:await Pt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(s){if(jt(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(t){const{data:s,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const a=(t==null?void 0:t.factors)||[],n=a.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=a.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:a,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var s,a;const{data:{session:n},error:i}=t;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Rp(n.access_token);let c=null;o.aal&&(c=o.aal);let d=c;((a=(s=n.user.factors)===null||s===void 0?void 0:s.filter(f=>f.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(d="aal2");const m=o.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(t,s={keys:[]}){let a=s.keys.find(o=>o.kid===t);if(a||(a=this.jwks.keys.find(o=>o.kid===t),a&&this.jwks_cached_at+O3>Date.now()))return a;const{data:n,error:i}=await Pt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!n.keys||n.keys.length===0)throw new nd("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),a=n.keys.find(o=>o.kid===t),!a)throw new nd("No matching signing key found in JWKS");return a}async getClaims(t,s={keys:[]}){try{let a=t;if(!a){const{data:y,error:b}=await this.getSession();if(b||!y.session)return{data:null,error:b};a=y.session.access_token}const{header:n,payload:i,signature:o,raw:{header:c,payload:d}}=Rp(a);if(iM(i.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:y}=await this.getUser(a);if(y)throw y;return{data:{claims:i,header:n,signature:o},error:null}}const h=oM(n.alg),m=await this.fetchJwk(n.kid,s),f=await crypto.subtle.importKey("jwk",m,h,!0,["verify"]);if(!await crypto.subtle.verify(h,f,o,H3(`${c}.${d}`)))throw new nd("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(a){if(jt(a))return{data:null,error:a};throw a}}}gd.nextInstanceID=0;const NM=gd;class SM extends NM{constructor(t){super(t)}}var kM=function(r,t,s,a){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function c(m){try{h(a.next(m))}catch(f){o(f)}}function d(m){try{h(a.throw(m))}catch(f){o(f)}}function h(m){m.done?i(m.value):n(m.value).then(c,d)}h((a=a.apply(r,[])).next())})};class CM{constructor(t,s,a){var n,i,o;if(this.supabaseUrl=t,this.supabaseKey=s,!t)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const c=T3(t),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const h=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:b3,realtime:N3,auth:Object.assign(Object.assign({},_3),{storageKey:h}),global:j3},f=R3(a??{},m);this.storageKey=(n=f.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(g,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=f.auth)!==null&&o!==void 0?o:{},this.headers,f.global.fetch),this.fetch=E3(s,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new VO(new URL("rest/v1",d).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new wO(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new y3(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,s={},a={}){return this.rest.rpc(t,s,a)}channel(t,s={config:{}}){return this.realtime.channel(t,s)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,s;return kM(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(s=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:s,detectSessionInUrl:a,storage:n,storageKey:i,flowType:o,lock:c,debug:d},h,m){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SM({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),h),storageKey:i,autoRefreshToken:t,persistSession:s,detectSessionInUrl:a,storage:n,flowType:o,lock:c,debug:d,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new a3(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,a)=>{this._handleTokenChanged(s,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,s,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:t==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const EM=(r,t,s)=>new CM(r,t,s);function sn(){return"https://craftchatbot.com"}function AM(){return"https://craftchatbot.com/api"}function Mm(){const t=[sn()];return[...new Set(t)]}function Ac(r){try{const t=Mm(),s=new URL(r);return t.some(a=>new URL(a).origin===s.origin)}catch{return!1}}function ly(){return sn()}sn(),AM(),Mm(),ly();const vh="https://kvlaydeyqidlfpfutbmp.supabase.co",wh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt2bGF5ZGV5cWlkbGZwZnV0Ym1wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyODgzNzAsImV4cCI6MjA2NTg2NDM3MH0.XVSO5W_0v6wW-MYlM7i0MTNKprOWp_O4ON-5LqqVnzw",TM=(vh==null?void 0:vh.includes("placeholder"))??(wh==null?void 0:wh.includes("placeholder"));TM&&console.warn("Using placeholder Supabase configuration. Some features may not work properly.");const D=EM(vh,wh,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,redirectTo:ly()}}),Ip=Object.freeze(Object.defineProperty({__proto__:null,supabase:D},Symbol.toStringTag,{value:"Module"})),ii={getSiteUrl:()=>sn(),getRedirectUrls:()=>Mm(),isValidRedirectUrl:r=>Ac(r),getAuthOptions:()=>({autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,redirectTo:sn()}),getSignInOptions:r=>{const t=sn();return{redirectTo:r&&Ac(r)?r:`${t}/dashboard`}},getSignUpOptions:r=>{const t=sn();return{redirectTo:r&&Ac(r)?r:`${t}/dashboard`}},getPasswordResetOptions:r=>{const t=sn();return{redirectTo:r&&Ac(r)?r:`${t}/auth/reset-password`}},getEmailVerificationOptions:r=>{const t=sn();return{redirectTo:r&&Ac(r)?r:`${t}/auth/verify-email`}}},f1={async getCurrentProfile(){const{data:{user:r},error:t}=await D.auth.getUser();if(t)throw t;if(!r)throw new Error("User not authenticated");const{data:s,error:a}=await D.from("profiles").select("*").eq("id",r.id).single();if(a)throw a;return s},async updateProfile(r){const{data:t,error:s}=await D.from("profiles").update(r).select().single();if(s)throw s;return t},async getUserUsage(){const{data:{user:r},error:t}=await D.auth.getUser();if(t)throw t;if(!r)throw new Error("User not authenticated");const{data:s,error:a}=await D.from("user_usage").select("*").eq("user_id",r.id).single();if(a)throw a;return s},async checkUsageLimit(r){const t=await D.auth.getUser();if(!t.data.user)throw new Error("User not authenticated");const{data:s,error:a}=await D.rpc("check_usage_limits",{user_id:t.data.user.id,operation_type:r});if(a)throw a;return s},async incrementUsage(r){const t=await D.auth.getUser();if(!t.data.user)throw new Error("User not authenticated");const{error:s}=await D.rpc("increment_usage",{user_id:t.data.user.id,operation_type:r});if(s)throw s}},p1=p.createContext(void 0),ft=()=>{const r=p.useContext(p1);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r},RM=({children:r})=>{const[t,s]=p.useState(null),[a,n]=p.useState(null),[i,o]=p.useState(null),[c,d]=p.useState(!0),[h,m]=p.useState(!1);p.useEffect(()=>{const k=setTimeout(()=>{c&&(console.warn("Auth initialization timeout - setting loading to false"),d(!1))},5e3);return()=>clearTimeout(k)},[c]),p.useEffect(()=>{(async()=>{try{const T="https://kvlaydeyqidlfpfutbmp.supabase.co",O="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt2bGF5ZGV5cWlkbGZwZnV0Ym1wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyODgzNzAsImV4cCI6MjA2NTg2NDM3MH0.XVSO5W_0v6wW-MYlM7i0MTNKprOWp_O4ON-5LqqVnzw";if(!T||!O||T.includes("placeholder")||O.includes("placeholder")){console.warn("Supabase not configured properly, skipping auth initialization",{hasUrl:!!T,hasKey:!!O,urlPlaceholder:T==null?void 0:T.includes("placeholder"),keyPlaceholder:O==null?void 0:O.includes("placeholder")}),o(null),s(null),n(null),d(!1);return}console.log("Initializing auth with Supabase:",{url:T,keyLength:(O==null?void 0:O.length)||0});const{data:{session:U},error:A}=await D.auth.getSession();if(A){console.error("Error getting session:",A),o(null),s(null),n(null),d(!1);return}if(U)try{const{data:{user:L},error:M}=await D.auth.getUser();M||!L?(console.log("Invalid session detected, clearing..."),await D.auth.signOut(),o(null),s(null),n(null)):(o(U),s(L))}catch(L){console.error("Session validation failed:",L),await D.auth.signOut(),o(null),s(null),n(null)}else o(null),s(null),n(null);if(U!=null&&U.user)try{await f()}catch(L){console.error("Error loading profile during initialization:",L)}else n(null)}catch(T){console.error("Failed to initialize auth session:",T),o(null),s(null),n(null)}finally{d(!1)}})();let I=null;try{const T="https://kvlaydeyqidlfpfutbmp.supabase.co",O="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt2bGF5ZGV5cWlkbGZwZnV0Ym1wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyODgzNzAsImV4cCI6MjA2NTg2NDM3MH0.XVSO5W_0v6wW-MYlM7i0MTNKprOWp_O4ON-5LqqVnzw";if(T&&O&&!T.includes("placeholder")&&!O.includes("placeholder")){const{data:{subscription:U}}=D.auth.onAuthStateChange(async(A,L)=>{var M;if(console.log("Auth state change:",A,((M=L==null?void 0:L.user)==null?void 0:M.email)||"no user"),o(L),s((L==null?void 0:L.user)??null),L!=null&&L.user)try{await f()}catch(se){console.error("Error loading profile during auth change:",se)}else n(null);d(!1)});I=U}else console.warn("Skipping auth state listener setup - Supabase not configured")}catch(T){console.error("Failed to set up auth state listener:",T),d(!1)}return()=>{I&&I.unsubscribe()}},[]);const f=async(k=0)=>{try{console.log("Loading user profile from database...",k>0?`(retry ${k})`:"");const I=await f1.getCurrentProfile();n(I),console.log("Profile loaded successfully:",I==null?void 0:I.email,"Role:",I==null?void 0:I.role)}catch(I){if(console.error("Error loading profile:",I),k<2){const T=Math.pow(2,k)*1e3;console.log(`Retrying profile load in ${T}ms...`),setTimeout(()=>f(k+1),T)}else console.error("Failed to load profile after retries, setting to null"),n(null)}},g=async(k,I)=>{var T;try{const{data:O,error:U}=await D.auth.signInWithPassword({email:k,password:I});if(U)throw console.error("Login error:",U),U;return console.log("Login successful:",(T=O.user)==null?void 0:T.email),{}}catch(O){throw console.error("Login error:",O),O}},y=async(k,I,T)=>{const{error:O}=await D.auth.signUp({email:k,password:I,options:{data:T,...ii.getSignUpOptions()}});if(O)throw O},b=async()=>{try{const{error:k}=await D.auth.signOut();if(k)throw k;n(null),console.log("Sign out successful")}catch(k){throw console.error("Sign out error:",k),k}},w=async k=>{const{error:I}=await D.auth.resetPasswordForEmail(k,ii.getPasswordResetOptions());if(I)throw I},S=async k=>{try{const{error:I}=await D.auth.updateUser({password:k});if(I)throw I;console.log("Password updated successfully")}catch(I){throw console.error("Password update error:",I),I}},N=async()=>{t&&await f()},v=async(k,I)=>{if(!(I?/^\d{8}$/.test(I):/^\d{6}$/.test(k)))throw new Error("Invalid verification code");m(!1),console.log("2FA verification successful")},j=()=>!1,C=p.useMemo(()=>({user:t,profile:a,session:i,loading:c,requiresTwoFactor:h,signIn:g,signUp:y,signOut:b,resetPassword:w,updatePassword:S,refreshProfile:N,verifyTwoFactor:v,isTwoFactorEnabled:j}),[t,a,i,c,h,g,y,b,w,S,N,v,j]);return e.jsx(p1.Provider,{value:C,children:r})},PM=tc("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),R=p.forwardRef(({className:r,variant:t,size:s,asChild:a=!1,...n},i)=>{const o=a?pm:"button";return e.jsx(o,{className:Ie(PM({variant:t,size:s,className:r})),ref:i,...n})});R.displayName="Button";const Pe=p.forwardRef(({className:r,type:t,...s},a)=>e.jsx("input",{type:t,className:Ie("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:a,...s}));Pe.displayName="Input";const IM=x_,DM=g_,FM=p_,x1=p.forwardRef(({className:r,...t},s)=>e.jsx(xm,{className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...t,ref:s}));x1.displayName=xm.displayName;const OM=tc("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),g1=p.forwardRef(({side:r="right",className:t,children:s,...a},n)=>e.jsxs(FM,{children:[e.jsx(x1,{}),e.jsxs(gm,{ref:n,className:Ie(OM({side:r}),t),...a,children:[s,e.jsxs(f_,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));g1.displayName=gm.displayName;const MM=p.forwardRef(({className:r,...t},s)=>e.jsx(ym,{ref:s,className:Ie("text-lg font-semibold text-foreground",r),...t}));MM.displayName=ym.displayName;const LM=p.forwardRef(({className:r,...t},s)=>e.jsx(vm,{ref:s,className:Ie("text-sm text-muted-foreground",r),...t}));LM.displayName=vm.displayName;const Ca=()=>{const[r,t]=p.useState(!1),[s,a]=p.useState(""),[n,i]=p.useState(!1),o=ps(),c=!1,d=m=>{m.preventDefault(),s.trim()&&(o(`/legal-qa?q=${encodeURIComponent(s)}`),a(""),i(!1))},h=[{name:"Home",href:"/"},{name:"Free Analysis",href:"/analyze",icon:Fe,highlight:!0},{name:"Law Firms",href:"/law-firms",icon:No},{name:"Documents",href:"/documents",icon:Fe},{name:"Legal Q&A",href:"/legal-qa",icon:Ft},{name:"Pricing",href:"/pricing"}];return e.jsx("nav",{className:"bg-white shadow-lg fixed w-full top-0 z-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(gs,{to:"/",className:"text-2xl font-bold text-blue-900 hover:text-blue-800 transition-colors",children:"LegalHelpSG"})}),e.jsxs("div",{className:"hidden lg:flex items-center space-x-4 flex-1",children:[e.jsx("div",{className:"flex items-baseline space-x-3 ml-8",children:h.map(m=>e.jsxs(gs,{to:m.href,className:`px-2 py-2 rounded-md text-sm font-medium transition-colors flex items-center space-x-1 ${m.highlight?"bg-blue-600 text-white hover:bg-blue-700":"text-gray-700 hover:text-blue-600"}`,children:[m.icon&&e.jsx(m.icon,{className:"h-4 w-4"}),e.jsx("span",{children:m.name})]},m.name))}),e.jsx("div",{className:"relative hidden xl:block",children:n?e.jsxs("form",{onSubmit:d,className:"flex items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Pe,{type:"text",placeholder:"Search legal topics...",value:s,onChange:m=>a(m.target.value),className:"pl-10 pr-4 py-2 w-48 border-gray-300 focus:border-blue-500 focus:ring-blue-500",autoFocus:!0,onBlur:()=>{s.trim()||i(!1)}})]}),e.jsx(R,{type:"submit",size:"sm",className:"ml-2 bg-blue-600 hover:bg-blue-700",children:"Search"})]}):e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center space-x-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx("span",{children:"Search"})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 ml-4",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>o("/auth/login"),className:"px-4 py-2 text-sm font-medium whitespace-nowrap border-gray-300 hover:border-blue-600 hover:text-blue-600",children:"Sign In"}),e.jsx(R,{size:"sm",onClick:()=>o("/auth/register"),className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 text-sm font-medium whitespace-nowrap",children:"Get Started"})]}),e.jsx("div",{className:"lg:hidden ml-2",children:e.jsxs(IM,{open:r,onOpenChange:t,children:[e.jsx(DM,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"icon",className:"p-2",children:e.jsx(H5,{className:"h-5 w-5"})})}),e.jsx(g1,{side:"right",className:"w-[300px] sm:w-[400px]",children:e.jsxs("div",{className:"flex flex-col space-y-4 mt-8",children:[e.jsxs("form",{onSubmit:d,className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Pe,{type:"text",placeholder:"Search legal topics...",value:s,onChange:m=>a(m.target.value),className:"pl-10 pr-4 py-2 w-full border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsx(R,{type:"submit",className:"w-full mt-2 bg-blue-600 hover:bg-blue-700",children:"Search"})]}),h.map(m=>e.jsxs(gs,{to:m.href,className:`px-3 py-2 rounded-md text-lg font-medium transition-colors flex items-center space-x-2 ${m.highlight?"bg-blue-600 text-white hover:bg-blue-700":"text-gray-700 hover:text-blue-600"}`,onClick:()=>t(!1),children:[m.icon&&e.jsx(m.icon,{className:"h-5 w-5"}),e.jsx("span",{children:m.name})]},m.name)),e.jsx("div",{className:"border-t pt-4 mt-4",children:e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsx(R,{variant:"outline",onClick:()=>{o("/auth/login"),t(!1)},className:"w-full",disabled:c,children:"Sign In"}),e.jsx(R,{onClick:()=>{o("/auth/register"),t(!1)},className:"w-full bg-blue-600 hover:bg-blue-700",disabled:c,children:"Get Started"})]})})]})})]})})]})})})},y1={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_ALLOWED_FILE_TYPES:"pdf,doc,docx,txt",VITE_API_URL:"https://craftchatbot.com/api",VITE_APP_NAME:"LawMattersSG",VITE_APP_URL:"https://craftchatbot.com",VITE_DEBUG_MODE:"false",VITE_ENABLE_2FA:"true",VITE_ENABLE_AI_CHAT:"true",VITE_ENABLE_DOCUMENT_ANALYSIS:"true",VITE_ENABLE_LAW_FIRM_DIRECTORY:"true",VITE_ENABLE_LAZY_LOADING:"true",VITE_ENABLE_OFFLINE_MODE:"false",VITE_ENABLE_SERVICE_WORKER:"true",VITE_ENABLE_TEMPLATE_GENERATION:"true",VITE_ENVIRONMENT:"production",VITE_LOG_LEVEL:"error",VITE_MAX_FILE_SIZE_MB:"10",VITE_MAX_FILE_SIZE_PREMIUM_MB:"50",VITE_MAX_LOGIN_ATTEMPTS:"5",VITE_POSTHOG_HOST:"https://app.posthog.com",VITE_POSTHOG_KEY:"your-posthog-key",VITE_RATE_LIMIT_REQUESTS_PER_HOUR:"2000",VITE_RATE_LIMIT_REQUESTS_PER_MINUTE:"100",VITE_SESSION_TIMEOUT:"3600",VITE_STRIPE_PUBLISHABLE_KEY:"your-stripe-publishable-key",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt2bGF5ZGV5cWlkbGZwZnV0Ym1wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyODgzNzAsImV4cCI6MjA2NTg2NDM3MH0.XVSO5W_0v6wW-MYlM7i0MTNKprOWp_O4ON-5LqqVnzw",VITE_SUPABASE_URL:"https://kvlaydeyqidlfpfutbmp.supabase.co"};function ks(r,t){const s=y1[r];if(s===void 0&&t===void 0)throw new Error(`Environment variable ${r} is required but not set`);return s??t??""}function Tc(r,t=!1){return ks(r,t.toString()).toLowerCase()==="true"}function ol(r,t){const s=ks(r,t.toString()),a=parseInt(s,10);if(isNaN(a))throw new Error(`Environment variable ${r} must be a valid number`);return a}function UM(r,t=[]){return ks(r,t.join(",")).split(",").map(a=>a.trim()).filter(Boolean)}const sr={supabase:{url:ks("VITE_SUPABASE_URL","https://placeholder.supabase.co"),anonKey:ks("VITE_SUPABASE_ANON_KEY","placeholder-key"),serviceRoleKey:ks("SUPABASE_SERVICE_ROLE_KEY","")},openai:{apiKey:ks("OPENAI_API_KEY",""),model:ks("OPENAI_MODEL","gpt-4-turbo"),maxTokens:ol("OPENAI_MAX_TOKENS",4e3),temperature:ol("OPENAI_TEMPERATURE",.1)},stripe:{publishableKey:ks("VITE_STRIPE_PUBLISHABLE_KEY",""),secretKey:ks("STRIPE_SECRET_KEY",""),webhookSecret:ks("STRIPE_WEBHOOK_SECRET","")},email:{sendgridApiKey:ks("SENDGRID_API_KEY",""),resendApiKey:ks("RESEND_API_KEY",""),fromEmail:ks("SENDGRID_FROM_EMAIL","noreply@lawmatterssg.com")},app:{name:ks("VITE_APP_NAME","LawMattersSG"),url:ks("VITE_APP_URL","http://localhost:8082"),apiUrl:ks("VITE_API_URL","http://localhost:8082/api"),environment:ks("VITE_ENVIRONMENT","development")},analytics:{posthogKey:ks("VITE_POSTHOG_KEY",""),posthogHost:ks("VITE_POSTHOG_HOST","https://app.posthog.com"),sentryDsn:ks("SENTRY_DSN","")},fileUpload:{maxFileSizeMB:ol("VITE_MAX_FILE_SIZE_MB",10),maxFileSizePremiumMB:ol("VITE_MAX_FILE_SIZE_PREMIUM_MB",50),allowedFileTypes:UM("VITE_ALLOWED_FILE_TYPES",["pdf","doc","docx","txt"])},rateLimit:{requestsPerMinute:ol("VITE_RATE_LIMIT_REQUESTS_PER_MINUTE",60),requestsPerHour:ol("VITE_RATE_LIMIT_REQUESTS_PER_HOUR",1e3)},features:{aiChat:Tc("VITE_ENABLE_AI_CHAT",!0),documentAnalysis:Tc("VITE_ENABLE_DOCUMENT_ANALYSIS",!0),templateGeneration:Tc("VITE_ENABLE_TEMPLATE_GENERATION",!1),lawFirmDirectory:Tc("VITE_ENABLE_LAW_FIRM_DIRECTORY",!1)},debug:{enabled:Tc("VITE_DEBUG_MODE",!1),logLevel:ks("VITE_LOG_LEVEL","info")}};function $M(){const t=["VITE_SUPABASE_URL","VITE_SUPABASE_ANON_KEY"].filter(s=>{const a=y1[s];return!a||a.trim()===""});if(t.length>0)throw new Error(`Missing required environment variables: ${t.join(", ")}
Please check your .env file and ensure all required variables are set.`)}$M();const Pn={free:{name:"Free",price:0,period:"forever",limits:{dailyAiRequests:10,monthlyAiRequests:10,dailyDocumentUploads:1,monthlyDocumentUploads:1,customDocumentDownloads:0,maxFileSize:10*1024*1024,maxDocuments:50},features:["Law firm directory access (basic)","10 AI queries per month","1 document download per month","Save bookmarks","Premium contract templates","Document analysis with AI","Priority support"]},premium:{name:"Premium",price:19,period:"month",popular:!0,limits:{dailyAiRequests:50,monthlyAiRequests:50,dailyDocumentUploads:10,monthlyDocumentUploads:10,customDocumentDownloads:3,maxFileSize:50*1024*1024,maxDocuments:500},features:["All features from Free plan","50 AI queries per month","10 document downloads per month","Access to all premium templates","Advanced document analysis with AI","Priority dashboard and analytics","Priority support"]},pro:{name:"Pro",price:159,period:"month",limits:{dailyAiRequests:500,monthlyAiRequests:500,dailyDocumentUploads:50,monthlyDocumentUploads:20,customDocumentDownloads:20,maxFileSize:100*1024*1024,maxDocuments:2e3},features:["Everything in Premium plan","500 AI queries per month","20 customized legal document downloads","Unlimited AI queries","Unlimited document downloads","Custom document templates","API access for integrations","Dedicated account manager"]},enterprise:{name:"Enterprise",price:null,period:"custom",limits:{dailyAiRequests:-1,monthlyAiRequests:-1,dailyDocumentUploads:-1,monthlyDocumentUploads:-1,customDocumentDownloads:-1,maxFileSize:500*1024*1024,maxDocuments:-1},features:["All features from Premium plan","Unlimited AI queries","Unlimited document downloads","Custom document templates","API access for integrations","Document extraction and bulk uploads","Dedicated account manager"]}},dn={contract:"Contract",legal_brief:"Legal Brief",court_filing:"Court Filing",agreement:"Agreement",other:"Other"},Un={pending:"Pending",processing:"Processing",completed:"Completed",failed:"Failed"},bi={maxSize:{free:10*1024*1024,premium:50*1024*1024,pro:100*1024*1024,enterprise:500*1024*1024},allowedTypes:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"],allowedExtensions:sr.fileUpload.allowedFileTypes.map(r=>`.${r}`)},zM={premium:{monthly:"price_premium_monthly",yearly:"price_premium_yearly"},pro:{monthly:"price_pro_monthly",yearly:"price_pro_yearly"}},Ye={home:"/",login:"/auth/login",register:"/auth/register",forgotPassword:"/auth/forgot-password",resetPassword:"/auth/reset-password",dashboard:"/dashboard",documents:"/dashboard/documents",templates:"/dashboard/templates",aiChat:"/dashboard/ai-chat",profile:"/dashboard/profile",subscription:"/dashboard/subscription",security:"/dashboard/security",lawFirms:"/law-firms",pricing:"/pricing",subscribe:"/subscribe",paymentSuccess:"/payment/success",paymentFailure:"/payment/failure",admin:"/admin",adminUsers:"/admin/users",adminAnalytics:"/admin/analytics",publicAnalysis:"/analyze",publicAnalysisResult:"/analyze/result",templateMarketplace:"/templates",templateBrowser:"/templates/browse",templatePreview:"/templates/preview",templateCustomize:"/templates/customize",templateGenerate:"/templates/generate",templateDownload:"/templates/download"},Wx={rateLimits:{documentsPerHour:3,documentsPerDay:10,maxFileSize:10*1024*1024,allowedFileTypes:["application/pdf","image/jpeg","image/png","image/webp"],sessionDuration:60*60*1e3},features:{basicOCR:!0,textExtraction:!0,documentSummary:!0,keywordExtraction:!0,documentClassification:!1,legalInsights:!1,entityExtraction:!1,complianceCheck:!1},storage:{bucket:"public-documents",retentionHours:24,maxStoragePerSession:50*1024*1024},conversionPrompts:{showAfterAnalysis:!0,showAdvancedFeatures:!0,highlightPremiumBenefits:!0}},BM={categories:[{id:"employment",name:"Employment",description:"Employment contracts, agreements, and HR documents",icon:"briefcase",subcategories:["contracts","policies","termination","benefits"]},{id:"business",name:"Business",description:"Business formation, partnerships, and commercial agreements",icon:"building",subcategories:["incorporation","partnerships","commercial","licensing"]},{id:"property",name:"Property",description:"Real estate, leases, and property-related documents",icon:"home",subcategories:["purchase","lease","rental","development"]},{id:"family",name:"Family",description:"Family law, wills, and personal legal documents",icon:"users",subcategories:["wills","divorce","custody","adoption"]},{id:"intellectual-property",name:"Intellectual Property",description:"Patents, trademarks, and IP protection documents",icon:"lightbulb",subcategories:["patents","trademarks","copyright","licensing"]},{id:"compliance",name:"Compliance",description:"Regulatory compliance and legal compliance documents",icon:"shield",subcategories:["gdpr","financial","healthcare","environmental"]}],accessLevels:{public:{name:"Public",description:"Free templates available to all users",features:["basic_customization","pdf_download","preview"],limitations:["watermark","basic_fields_only"]},premium:{name:"Premium",description:"Advanced templates for premium subscribers",features:["advanced_customization","multiple_formats","legal_review","version_history"],limitations:[]},enterprise:{name:"Enterprise",description:"Custom templates for enterprise clients",features:["custom_branding","api_access","bulk_generation","priority_support"],limitations:[]}},generation:{maxCustomFields:50,supportedFormats:["pdf","docx","html"],aiModels:["gpt-4","claude-3"],maxGenerationTime:3e4,retryAttempts:3},singapore:{jurisdiction:"Singapore",language:"English",currency:"SGD",legalSystem:"Common Law",regulatoryBodies:["ACRA","MAS","MOM","URA","IRAS","AGC"],complianceStandards:["Companies Act","Employment Act","Personal Data Protection Act","Securities and Futures Act"]},validation:{requiredFields:["title","description","category","jurisdiction"],maxTitleLength:100,maxDescriptionLength:500,minPreviewLength:100,allowedFileTypes:["pdf","docx","txt"],maxFileSize:5*1024*1024},pricing:{free:{templatesPerMonth:3,customizationLevel:"basic",downloadFormats:["pdf"],support:"community"},premium:{templatesPerMonth:50,customizationLevel:"advanced",downloadFormats:["pdf","docx","html"],support:"email"},enterprise:{templatesPerMonth:"unlimited",customizationLevel:"full",downloadFormats:["pdf","docx","html","xml"],support:"priority"}}};class qM{constructor(){rs(this,"cache",null);rs(this,"cacheExpiry",0);rs(this,"CACHE_DURATION",5*60*1e3)}async getStats(){if(this.cache&&Date.now()<this.cacheExpiry)return this.cache;try{const{data:t,error:s}=await D.rpc("get_platform_statistics");if(!s&&t){const m={legalProfessionals:t.legalProfessionals,documentsProcessed:t.documentsProcessed,questionsAnswered:t.questionsAnswered,templatesDownloaded:t.templatesDownloaded,activeLawFirms:t.activeLawFirms,totalUsers:t.totalUsers};return this.cache=m,this.cacheExpiry=Date.now()+this.CACHE_DURATION,m}console.warn("Database function failed, using individual queries:",s);const[a,n,i,o,c,d]=await Promise.all([this.getLegalProfessionalsCount(),this.getDocumentsProcessedCount(),this.getQuestionsAnsweredCount(),this.getTemplatesDownloadedCount(),this.getActiveLawFirmsCount(),this.getTotalUsersCount()]),h={legalProfessionals:a,documentsProcessed:n,questionsAnswered:i,templatesDownloaded:o,activeLawFirms:c,totalUsers:d};return this.cache=h,this.cacheExpiry=Date.now()+this.CACHE_DURATION,h}catch(t){return console.error("Error fetching platform stats:",t),this.getFallbackStats()}}async getLegalProfessionalsCount(){try{let t=0,s=0;try{t=(await D.from("legal_experts").select("*",{count:"exact",head:!0}).eq("verification_status","verified")).count||0}catch(n){console.warn("Legal experts table not accessible:",n)}try{s=(await D.from("law_firm_team_members").select("*",{count:"exact",head:!0}).eq("is_active",!0)).count||0}catch(n){console.warn("Law firm team members table not accessible:",n)}const a=t+s;return a>0?a:500}catch(t){return console.error("Error getting legal professionals count:",t),500}}async getDocumentsProcessedCount(){const t=await this.safeQuery(()=>D.from("uploaded_documents").select("*",{count:"exact",head:!0}),5e3,"Uploaded documents count"),s=await this.safeQuery(()=>D.from("public_document_analyses").select("*",{count:"exact",head:!0}),5e3,"Public document analyses count");return t+s}async getQuestionsAnsweredCount(){try{let t=await D.from("legal_questions").select("*",{count:"exact",head:!0}).eq("moderation_status","approved").gt("answer_count",0);return t.error&&(t=await D.from("legal_questions").select("*",{count:"exact",head:!0}).gt("answer_count",0)),t.error&&(t=await D.from("legal_questions").select("*",{count:"exact",head:!0}).eq("status","answered")),t.count||15e3}catch(t){return console.error("Error getting questions answered count:",t),15e3}}async getTemplatesDownloadedCount(){return await this.safeQuery(()=>D.from("template_downloads").select("*",{count:"exact",head:!0}),5e3,"Template downloads count")}async getActiveLawFirmsCount(){try{let t=await D.from("law_firms").select("*",{count:"exact",head:!0}).eq("verified",!0).eq("is_active",!0);return t.error&&(t=await D.from("law_firms").select("*",{count:"exact",head:!0}).eq("verified",!0)),t.count||150}catch(t){return console.error("Error getting active law firms count:",t),150}}async getTotalUsersCount(){return await this.safeQuery(()=>D.from("profiles").select("*",{count:"exact",head:!0}),25e3,"Total users count")}getFallbackStats(){return{legalProfessionals:500,documentsProcessed:1e4,questionsAnswered:15e3,templatesDownloaded:5e3,activeLawFirms:150,totalUsers:25e3}}async safeQuery(t,s,a){try{const n=await t();return n.error?(console.warn(`${a} query failed:`,n.error.message),s):n.count??s}catch(n){return console.warn(`${a} query error:`,n),s}}formatStatNumber(t){return t>=1e6?`${Math.floor(t/1e5)/10}M+`:t>=1e3?`${Math.floor(t/100)/10}K+`:`${t}+`}clearCache(){this.cache=null,this.cacheExpiry=0}}const Ju=new qM,VM=()=>{const[r,t]=p.useState(""),[s,a]=p.useState({legalProfessionals:500,documentsProcessed:1e4,questionsAnswered:15e3}),[n,i]=p.useState(!0),o=ps();p.useEffect(()=>{(async()=>{try{const h=await Ju.getStats();a({legalProfessionals:h.legalProfessionals,documentsProcessed:h.documentsProcessed,questionsAnswered:h.questionsAnswered})}catch(h){console.error("Error loading platform stats:",h)}finally{i(!1)}})()},[]);const c=()=>{r.trim()&&o(`/legal-qa?q=${encodeURIComponent(r)}`)};return e.jsxs("section",{id:"home",className:"relative bg-gradient-to-r from-blue-900 via-blue-800 to-blue-900 pt-16",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-10"}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 lg:py-32",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{className:"text-white",children:[e.jsxs("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold leading-tight mb-6",children:["AI-Powered Legal Solutions for"," ",e.jsx("span",{className:"text-yellow-300 block",children:"Singapore"})]}),e.jsx("p",{className:"text-xl text-blue-100 mb-8 leading-relaxed",children:"Find the right law firm, get instant legal answers, and access legal document analysis - all in one place."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(Pe,{type:"text",placeholder:"I need help understanding Singapore's Employment Act...",value:r,onChange:d=>t(d.target.value),className:"pl-10 py-3 text-gray-900 bg-white border-0 focus:ring-2 focus:ring-yellow-400"})]}),e.jsx(R,{size:"lg",onClick:c,className:"bg-yellow-500 hover:bg-yellow-600 text-blue-900 font-semibold px-8",children:"Search"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("p",{className:"text-sm text-blue-200 mb-2",children:"Popular:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Tenant Rights","Company Incorporation","Employment Act","Divorce Proceedings"].map(d=>e.jsx("button",{onClick:()=>t(d),className:"px-3 py-1 bg-blue-700 hover:bg-blue-600 rounded-full text-sm text-blue-100 transition-colors",children:d},d))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[e.jsxs(R,{size:"lg",onClick:()=>o(Ye.publicAnalysis),className:"bg-yellow-500 hover:bg-yellow-600 text-blue-900 font-semibold",children:[e.jsx(Nr,{className:"mr-2 h-5 w-5"}),"Free Document Analysis"]}),e.jsxs(R,{size:"lg",onClick:()=>o("/legal-qa"),className:"bg-blue-600 hover:bg-blue-700 text-white",children:["Ask Legal Question",e.jsx(Ft,{className:"ml-2 h-5 w-5"})]}),e.jsxs(R,{size:"lg",variant:"outline",onClick:()=>o("/law-firms"),className:"border-white text-white hover:bg-white hover:text-blue-900",children:["Find Law Firms",e.jsx(No,{className:"ml-2 h-5 w-5"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-8 pt-8 border-t border-blue-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(No,{className:"h-8 w-8 text-yellow-300"})}),e.jsx("div",{className:"text-2xl font-bold",children:n?e.jsx("div",{className:"animate-pulse bg-blue-600 h-8 w-16 mx-auto rounded"}):Ju.formatStatNumber(s.legalProfessionals)}),e.jsx("div",{className:"text-sm text-blue-200",children:"Legal Professionals"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(Fe,{className:"h-8 w-8 text-yellow-300"})}),e.jsx("div",{className:"text-2xl font-bold",children:n?e.jsx("div",{className:"animate-pulse bg-blue-600 h-8 w-16 mx-auto rounded"}):Ju.formatStatNumber(s.documentsProcessed)}),e.jsx("div",{className:"text-sm text-blue-200",children:"Documents Simplified"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(Ft,{className:"h-8 w-8 text-yellow-300"})}),e.jsx("div",{className:"text-2xl font-bold",children:n?e.jsx("div",{className:"animate-pulse bg-blue-600 h-8 w-16 mx-auto rounded"}):Ju.formatStatNumber(s.questionsAnswered)}),e.jsx("div",{className:"text-sm text-blue-200",children:"Questions Answered"})]})]})]}),e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 transform rotate-2 hover:rotate-0 transition-transform duration-300",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"How can I help you today?"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"I need help understanding Singapore's Employment Act..."}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(Yt,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:"Popular: Tenant Rights • Company Incorporation"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"The Employment Act is Singapore's main labor law that provides basic terms and working conditions for employees. The Act was last amended in April 2019 to extend coverage to all employees regardless of salary level, with exceptions for public servants, domestic workers, and seafarers. Key provisions include..."}),e.jsx(R,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Try the AI Legal Assistant →"})]})]})]})})})]})})]})},$=p.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,className:Ie("rounded-lg border bg-card text-card-foreground shadow-sm",r),...t}));$.displayName="Card";const Z=p.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,className:Ie("flex flex-col space-y-1.5 p-6",r),...t}));Z.displayName="CardHeader";const X=p.forwardRef(({className:r,...t},s)=>e.jsx("h3",{ref:s,className:Ie("text-2xl font-semibold leading-none tracking-tight",r),...t}));X.displayName="CardTitle";const ye=p.forwardRef(({className:r,...t},s)=>e.jsx("p",{ref:s,className:Ie("text-sm text-muted-foreground",r),...t}));ye.displayName="CardDescription";const z=p.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,className:Ie("p-6 pt-0",r),...t}));z.displayName="CardContent";const Ul=p.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,className:Ie("flex items-center p-6 pt-0",r),...t}));Ul.displayName="CardFooter";const WM=tc("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ae({className:r,variant:t,...s}){return e.jsx("div",{className:Ie(WM({variant:t}),r),...s})}const HM=()=>{const r=ps(),t=[{icon:Nr,title:"Instant Analysis",description:"Get document insights in seconds with AI-powered analysis"},{icon:vs,title:"Secure & Private",description:"Your documents are automatically deleted after 24 hours"},{icon:us,title:"No Registration",description:"Start analyzing immediately without creating an account"},{icon:Fe,title:"Multiple Formats",description:"Support for PDF, JPEG, PNG, and WebP files up to 10MB"}],s=["Extract text from PDFs and images","Generate document summaries","Identify key terms and concepts","Basic document classification","No credit card required","Try before you subscribe"],a=[{name:"Sarah Chen",role:"Small Business Owner",content:"The free analysis helped me understand my lease agreement before signing. Very helpful!",rating:5},{name:"Michael Tan",role:"Freelancer",content:"Quick and easy way to get insights from legal documents. Saved me time and money.",rating:5}];return e.jsx("section",{className:"py-20 bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx(ae,{className:"mb-4 bg-yellow-100 text-yellow-800 border-yellow-300",children:"🎉 Free Tool Available"}),e.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-6",children:"Try Our Free Document Analysis"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto mb-8",children:"Get instant insights from your legal documents with our AI-powered analysis tool. No registration required, completely free to try."}),e.jsxs(R,{size:"lg",onClick:()=>r(Ye.publicAnalysis),className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg",children:[e.jsx(Nr,{className:"mr-2 h-5 w-5"}),"Analyze Document Now",e.jsx(Mn,{className:"ml-2 h-5 w-5"})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16",children:t.map(n=>e.jsx($,{className:"text-center border-0 shadow-lg hover:shadow-xl transition-shadow",children:e.jsxs(z,{className:"p-6",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(n.icon,{className:"h-6 w-6 text-blue-600"})})}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.title}),e.jsx("p",{className:"text-sm text-gray-600",children:n.description})]})},n.title))}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center mb-16",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"What You Get with Free Analysis"}),e.jsx("div",{className:"space-y-3",children:s.map(n=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-700",children:n})]},n))}),e.jsx("div",{className:"mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ot,{className:"h-5 w-5 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Want More?"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Upgrade to get advanced legal insights, unlimited analysis, and permanent storage."}),e.jsx(R,{variant:"link",className:"p-0 h-auto text-blue-600 hover:text-blue-700",onClick:()=>r(Ye.pricing),children:"View Pricing Plans →"})]})]})})]}),e.jsx("div",{className:"relative",children:e.jsx($,{className:"shadow-2xl",children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Fe,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Sample Analysis Result"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Document Type"}),e.jsx(ae,{variant:"secondary",children:"Employment Contract"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Key Terms Found"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["salary","probation","termination","benefits"].map(n=>e.jsx(ae,{variant:"outline",className:"text-xs",children:n},n))})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Summary"}),e.jsx("p",{className:"text-xs text-gray-600",children:"This employment contract outlines the terms and conditions of employment including salary, benefits, and termination clauses..."})]})]}),e.jsx(R,{className:"w-full mt-4 bg-blue-600 hover:bg-blue-700",onClick:()=>r(Ye.publicAnalysis),children:"Try With Your Document"})]})})})]}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-8",children:"What Users Are Saying"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:a.map(n=>e.jsx($,{className:"border-0 shadow-lg",children:e.jsxs(z,{className:"p-6",children:[e.jsx("div",{className:"flex justify-center mb-3",children:[...Array(n.rating)].map((i,o)=>e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"},o))}),e.jsxs("p",{className:"text-gray-700 mb-4 italic",children:['"',n.content,'"']}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-gray-900",children:n.name}),e.jsx("div",{className:"text-sm text-gray-600",children:n.role})]})]})},n.name))})]}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"grid grid-cols-3 gap-8 max-w-2xl mx-auto",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"1,000+"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Documents Analyzed"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"95%"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy Rate"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"30s"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Average Analysis Time"})]})]})})]})})},GM=[{icon:No,title:"Law Firm Directory",description:"Find the perfect law firm with our comprehensive directory. Filter by practice area, location, and ratings.",features:["Advanced Search Filters","Verified Reviews & Ratings","Direct Contact Information","Specialization Matching"],action:"Browse Directory",link:"/law-firms"},{icon:Fe,title:"Legal Document Analysis",description:"Upload your documents for instant AI-powered analysis, summary, and interpretation.",features:["AI Document Summary","Legal Risk Assessment","Key Terms Extraction","Compliance Checking"],action:"Analyze Documents",link:"/dashboard/documents"},{icon:Ft,title:"Legal Q&A",description:"Get instant answers to your legal questions from our AI assistant trained on Singapore law.",features:["24/7 AI Legal Assistant","Singapore Law Expertise","Case Law References","Personalized Advice"],action:"Ask a Question",link:"/dashboard/ai-assistant"},{icon:fs,title:"Document Templates",description:"Access a library of legal document templates specific to Singapore's legal system.",features:["Singapore-Specific Templates","Customizable Forms","Legal Compliance Validation","Instant Download"],action:"Browse Templates",link:"/dashboard/templates"},{icon:Yt,title:"Case Summaries",description:"Explore our database of court case summaries, without lengthy and easy to understand.",features:["Simplified Case Summaries","Search by Legal Topic","Recent Court Decisions","Legal Precedents"],action:"Explore Cases",link:"/case-summaries"},{icon:I5,title:"Singapore-Specific Resources",description:"All resources are tailored specifically to Singapore's legal system and requirements.",features:["Local Legal Updates","Regulatory Changes","Government Resources","Legal Glossary"],action:"Learn More",link:"/resources"}],KM=()=>{const r=ps();return e.jsx("section",{id:"features",className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Everything You Need In One Place"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"LegalHelpSG combines AI technology with comprehensive legal resources to give you the most efficient legal help experience."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:GM.map(t=>e.jsxs($,{className:"group hover:shadow-xl transition-all duration-300 hover:-translate-y-2",children:[e.jsxs(Z,{children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-blue-100 rounded-lg mb-4 group-hover:bg-blue-600 transition-colors",children:e.jsx(t.icon,{className:"h-6 w-6 text-blue-600 group-hover:text-white transition-colors"})}),e.jsx(X,{className:"text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors",children:t.title}),e.jsx(ye,{className:"text-gray-600",children:t.description})]}),e.jsxs(z,{children:[e.jsx("ul",{className:"space-y-2 mb-6",children:t.features.map(s=>e.jsxs("li",{className:"flex items-center text-sm text-gray-700",children:[e.jsx("div",{className:"h-1.5 w-1.5 bg-blue-600 rounded-full mr-3"}),s]},s))}),e.jsx(R,{variant:"outline",className:"w-full group-hover:bg-blue-600 group-hover:text-white group-hover:border-blue-600 transition-colors",onClick:()=>r(t.link),children:t.action})]})]},t.title))}),e.jsx("div",{className:"text-center mt-12",children:e.jsx(R,{size:"lg",className:"bg-blue-600 hover:bg-blue-700",children:"Get Started"})})]})})},Nj=[{step:"Step 1",icon:Yt,title:"Identify Your Legal Need",description:"Browse our legal topics, use our search function, or start with a question to identify your specific legal need.",features:["Search by legal topic or question","Browse categories and case types","Get instant topic suggestions","Access legal glossary"],color:"blue"},{step:"Step 2",icon:es,title:"Access Resources or Find Experts",description:"Use our AI-powered tools to get information, download templates, or find the right legal professional.",features:["AI legal assistant for instant answers","Download customizable legal templates","Find qualified lawyers by specialty","Access case summaries and precedents"],color:"green"},{step:"Step 3",icon:Ue,title:"Take Informed Action",description:"With clear information and the right resources, you can make confident decisions about your legal matters.",features:["Make informed legal decisions","Connect with verified professionals","Download completed documents","Track your legal progress"],color:"purple"}],QM=()=>e.jsx("section",{id:"how-it-works",className:"py-20 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"How It Works"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"LegalLinkSG makes accessing legal information and services easy for everyone"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12",children:Nj.map((r,t)=>e.jsxs("div",{className:"relative",children:[e.jsxs($,{className:"h-full hover:shadow-lg transition-shadow duration-300",children:[e.jsxs(Z,{className:"text-center",children:[e.jsx("div",{className:`flex items-center justify-center w-16 h-16 bg-${r.color}-100 rounded-full mx-auto mb-4`,children:e.jsx(r.icon,{className:`h-8 w-8 text-${r.color}-600`})}),e.jsx("div",{className:`text-sm font-semibold text-${r.color}-600 mb-2`,children:r.step}),e.jsx(X,{className:"text-xl font-bold text-gray-900",children:r.title}),e.jsx(ye,{className:"text-gray-600",children:r.description})]}),e.jsx(z,{children:e.jsx("ul",{className:"space-y-2",children:r.features.map(s=>e.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[e.jsx("div",{className:`h-1.5 w-1.5 bg-${r.color}-600 rounded-full mt-2 mr-3 flex-shrink-0`}),s]},s))})})]}),t<Nj.length-1&&e.jsx("div",{className:"hidden md:block absolute top-1/2 -right-4 transform -translate-y-1/2 z-10",children:e.jsx(Mn,{className:"h-8 w-8 text-gray-400"})})]},r.title))}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ready to get started?"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Join thousands of Singaporeans who are already using LegalLinkSG to navigate their legal matters."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(R,{size:"lg",className:"bg-blue-600 hover:bg-blue-700",children:"Get Started Free"}),e.jsx(R,{size:"lg",variant:"outline",children:"Browse Law Firms"})]})]})]})}),YM=()=>e.jsx("section",{id:"about",className:"py-20 bg-white",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"Trusted Legal Partners Since 1998"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"LawMatters has been Singapore's premier legal firm for over two decades. We've built our reputation on delivering exceptional legal services with integrity, expertise, and unwavering commitment to our clients' success."}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ue,{className:"h-6 w-6 text-green-500 mt-1 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Client-Focused Approach"}),e.jsx("p",{className:"text-gray-600",children:"We prioritize understanding your unique needs and objectives."})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ue,{className:"h-6 w-6 text-green-500 mt-1 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Proven Track Record"}),e.jsx("p",{className:"text-gray-600",children:"Over 500 successful cases with a 95% client satisfaction rate."})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ue,{className:"h-6 w-6 text-green-500 mt-1 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Expert Legal Team"}),e.jsx("p",{className:"text-gray-600",children:"Qualified lawyers with specialized expertise across multiple practice areas."})]})]})]}),e.jsx(R,{size:"lg",className:"bg-blue-600 hover:bg-blue-700",children:"Meet Our Team"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg text-center",children:[e.jsx(qg,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"25+"}),e.jsx("p",{className:"text-gray-600",children:"Years of Excellence"})]}),e.jsxs("div",{className:"bg-green-50 p-6 rounded-lg text-center",children:[e.jsx(es,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"1000+"}),e.jsx("p",{className:"text-gray-600",children:"Satisfied Clients"})]}),e.jsxs("div",{className:"bg-purple-50 p-6 rounded-lg text-center",children:[e.jsx(Ue,{className:"h-12 w-12 text-purple-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"500+"}),e.jsx("p",{className:"text-gray-600",children:"Cases Won"})]}),e.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg text-center",children:[e.jsx(us,{className:"h-12 w-12 text-orange-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"24/7"}),e.jsx("p",{className:"text-gray-600",children:"Client Support"})]})]})]})})}),JM=[{name:"Sarah Chen",role:"CEO, TechStart Singapore",content:"LawMatters provided exceptional guidance during our company's acquisition. Their expertise in corporate law and attention to detail made the complex process seamless.",rating:5,image:"/placeholder.svg"},{name:"Michael Tan",role:"Property Developer",content:"The real estate legal team at LawMatters helped us navigate multiple property transactions with professionalism and efficiency. Highly recommended!",rating:5,image:"/placeholder.svg"},{name:"Lisa Wong",role:"Small Business Owner",content:"When I needed employment law advice, LawMatters provided clear, actionable guidance that protected my business. Their team is knowledgeable and responsive.",rating:5,image:"/placeholder.svg"}],ZM=()=>e.jsx("section",{id:"testimonials",className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"What Our Clients Say"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Don't just take our word for it. Here's what our satisfied clients have to say about our legal services and expertise."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:JM.map((r,t)=>e.jsx($,{className:"hover:shadow-lg transition-shadow duration-300",children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(K5,{className:"h-8 w-8 text-blue-600 opacity-50"}),e.jsx("div",{className:"flex ml-auto",children:[...Array(r.rating)].map((s,a)=>e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"},a))})]}),e.jsxs("p",{className:"text-gray-700 mb-6 leading-relaxed",children:['"',r.content,'"']}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white font-bold mr-4",children:r.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:r.name}),e.jsx("p",{className:"text-sm text-gray-600",children:r.role})]})]})]})},t))}),e.jsxs("div",{className:"text-center mt-12",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Join hundreds of satisfied clients"}),e.jsxs("div",{className:"flex justify-center items-center space-x-1",children:[[...Array(5)].map((r,t)=>e.jsx(Ot,{className:"h-6 w-6 text-yellow-400 fill-current"},t)),e.jsx("span",{className:"ml-2 text-gray-900 font-semibold",children:"4.9/5 Client Rating"})]})]})]})}),Sr=p.forwardRef(({className:r,...t},s)=>e.jsx("textarea",{className:Ie("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:s,...t}));Sr.displayName="Textarea";const XM=()=>{const[r,t]=p.useState({name:"",email:"",phone:"",subject:"",message:""}),{toast:s}=Bn(),a=i=>{i.preventDefault(),s({title:"Message Sent!",description:"We'll get back to you within 24 hours."}),t({name:"",email:"",phone:"",subject:"",message:""})},n=i=>{t(o=>({...o,[i.target.name]:i.target.value}))};return e.jsx("section",{id:"contact",className:"py-20 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Get In Touch"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Ready to discuss your legal needs? Contact us today for a free consultation and let us help you navigate your legal challenges."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Send Us a Message"})}),e.jsx(z,{children:e.jsxs("form",{onSubmit:a,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx(Pe,{id:"name",name:"name",type:"text",required:!0,value:r.name,onChange:n,placeholder:"Enter your full name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx(Pe,{id:"email",name:"email",type:"email",required:!0,value:r.email,onChange:n,placeholder:"Enter your email"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx(Pe,{id:"phone",name:"phone",type:"tel",value:r.phone,onChange:n,placeholder:"Enter your phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),e.jsx(Pe,{id:"subject",name:"subject",type:"text",required:!0,value:r.subject,onChange:n,placeholder:"Legal matter subject"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),e.jsx(Sr,{id:"message",name:"message",required:!0,value:r.message,onChange:n,placeholder:"Please describe your legal matter...",className:"min-h-[120px]"})]}),e.jsx(R,{type:"submit",size:"lg",className:"w-full bg-blue-600 hover:bg-blue-700",children:"Send Message"})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx(Ol,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Phone"}),e.jsx("p",{className:"text-gray-600",children:"+65 6123 4567"}),e.jsx("p",{className:"text-gray-600",children:"+65 6765 4321"})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx(qa,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-600",children:"info@lawmatters.sg"}),e.jsx("p",{className:"text-gray-600",children:"consultation@lawmatters.sg"})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:e.jsx(ia,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Address"}),e.jsxs("p",{className:"text-gray-600",children:["123 Raffles Place",e.jsx("br",{}),"#45-67 Tower One",e.jsx("br",{}),"Singapore 048624"]})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-lg",children:e.jsx(us,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Office Hours"}),e.jsxs("p",{className:"text-gray-600",children:["Mon - Fri: 9:00 AM - 6:00 PM",e.jsx("br",{}),"Sat: 9:00 AM - 1:00 PM",e.jsx("br",{}),"Sun: Closed"]})]})]})})})]})]})]})})},Ea=()=>e.jsx("footer",{className:"bg-gray-900 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"LawMatters"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Singapore's trusted legal partner for over 25 years. We provide expert legal solutions with integrity and excellence."}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("a",{href:"#",className:"text-gray-300 hover:text-blue-400 transition-colors",children:e.jsx($5,{className:"h-6 w-6"})}),e.jsx("a",{href:"#",className:"text-gray-300 hover:text-blue-400 transition-colors",children:e.jsx(V5,{className:"h-6 w-6"})}),e.jsx("a",{href:"#",className:"text-gray-300 hover:text-blue-400 transition-colors",children:e.jsx(s6,{className:"h-6 w-6"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Practice Areas"}),e.jsxs("ul",{className:"space-y-2 text-gray-300",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Corporate Law"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Employment Law"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Real Estate Law"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Family Law"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Criminal Defense"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Commercial Litigation"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),e.jsxs("ul",{className:"space-y-2 text-gray-300",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"About Us"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Our Team"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Case Studies"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Legal Resources"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Privacy Policy"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-blue-400 transition-colors",children:"Terms of Service"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Contact Info"}),e.jsxs("div",{className:"space-y-3 text-gray-300",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ol,{className:"h-5 w-5 mr-3 text-blue-400"}),e.jsx("span",{children:"+65 6123 4567"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(qa,{className:"h-5 w-5 mr-3 text-blue-400"}),e.jsx("span",{children:"info@lawmatters.sg"})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(ia,{className:"h-5 w-5 mr-3 mt-1 text-blue-400"}),e.jsxs("span",{children:["123 Raffles Place",e.jsx("br",{}),"#45-67 Tower One",e.jsx("br",{}),"Singapore 048624"]})]})]})]})]}),e.jsx("div",{className:"border-t border-gray-700 mt-8 pt-8 text-center text-gray-300",children:e.jsx("p",{children:"© 2024 LawMatters Singapore. All rights reserved."})})]})}),eL=()=>{const{user:r,profile:t,session:s,loading:a,signOut:n}=ft(),i=async()=>{try{await D.auth.signOut(),window.location.reload()}catch(o){console.error("Error clearing session:",o)}};return e.jsxs($,{className:"fixed bottom-4 right-4 w-80 z-50 bg-white border-2 border-blue-500",children:[e.jsx(Z,{children:e.jsx(X,{className:"text-sm",children:"Auth Debug Info"})}),e.jsxs(z,{className:"text-xs space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Loading:"})," ",a?"true":"false"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"User:"})," ",r?r.email:"null"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Session:"})," ",s?"exists":"null"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Profile:"})," ",t?`${t.first_name} ${t.last_name}`:"null"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"User ID:"})," ",(r==null?void 0:r.id)||"null"]}),e.jsx("div",{className:"mt-2",children:e.jsx(R,{onClick:i,size:"sm",variant:"outline",children:"Clear Session"})})]})]})},tL=()=>{const{user:r,loading:t}=ft();return console.log("Index page - Auth state:",{user:(r==null?void 0:r.email)||"No user",loading:t}),e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsx(VM,{}),e.jsx(HM,{}),e.jsx(KM,{}),e.jsx(QM,{}),e.jsx(YM,{}),e.jsx(ZM,{}),e.jsx(XM,{}),e.jsx(Ea,{}),e.jsx(eL,{})]})};function cy(r){const t=p.useRef({value:r,previous:r});return p.useMemo(()=>(t.current.value!==r&&(t.current.previous=t.current.value,t.current.value=r),t.current.previous),[r])}var dy="Switch",[sL,IW]=Io(dy),[rL,aL]=sL(dy),v1=p.forwardRef((r,t)=>{const{__scopeSwitch:s,name:a,checked:n,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:h,form:m,...f}=r,[g,y]=p.useState(null),b=Ys(t,j=>y(j)),w=p.useRef(!1),S=g?m||!!g.closest("form"):!0,[N=!1,v]=_o({prop:n,defaultProp:i,onChange:h});return e.jsxs(rL,{scope:s,checked:N,disabled:c,children:[e.jsx(zt.button,{type:"button",role:"switch","aria-checked":N,"aria-required":o,"data-state":b1(N),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:b,onClick:Nt(r.onClick,j=>{v(C=>!C),S&&(w.current=j.isPropagationStopped(),w.current||j.stopPropagation())})}),S&&e.jsx(nL,{control:g,bubbles:!w.current,name:a,value:d,checked:N,required:o,disabled:c,form:m,style:{transform:"translateX(-100%)"}})]})});v1.displayName=dy;var w1="SwitchThumb",j1=p.forwardRef((r,t)=>{const{__scopeSwitch:s,...a}=r,n=aL(w1,s);return e.jsx(zt.span,{"data-state":b1(n.checked),"data-disabled":n.disabled?"":void 0,...a,ref:t})});j1.displayName=w1;var nL=r=>{const{control:t,checked:s,bubbles:a=!0,...n}=r,i=p.useRef(null),o=cy(s),c=y_(t);return p.useEffect(()=>{const d=i.current,h=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(h,"checked").set;if(o!==s&&f){const g=new Event("click",{bubbles:a});f.call(d,s),d.dispatchEvent(g)}},[o,s,a]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:i,style:{...r.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function b1(r){return r?"checked":"unchecked"}var _1=v1,iL=j1;const wl=p.forwardRef(({className:r,...t},s)=>e.jsx(_1,{className:Ie("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...t,ref:s,children:e.jsx(iL,{className:Ie("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));wl.displayName=_1.displayName;const oL=()=>{const[r,t]=p.useState(!1),{user:s}=ft(),a=ps(),n=h=>{if(!s){a("/auth/login");return}if(h==="free"){a("/dashboard");return}if(h==="enterprise"){window.location.href="mailto:sales@lawmatterssg.com?subject=Enterprise Plan Inquiry";return}a(`/subscribe/${h}${r?"?billing=yearly":""}`)},i=h=>h.price===null?"Custom":h.price===0?"Free":`$${r?h.price*10:h.price}`,o=h=>h.price===null||h.price===0?"":r?"/year":"/month",c=h=>h.price===null||h.price===0?null:r?"Save 20%":null,d=[{key:"free",...Pn.free,icon:Ot,color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200"},{key:"premium",...Pn.premium,icon:Nr,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",popular:!0},{key:"pro",...Pn.pro,icon:jo,color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200"},{key:"enterprise",...Pn.enterprise,icon:No,color:"text-gray-800",bgColor:"bg-gray-100",borderColor:"border-gray-300"}];return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsx("section",{className:"py-20 bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-6",children:"Simple, Transparent Pricing"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8 max-w-3xl mx-auto",children:"Choose the plan that works best for your legal needs, with no hidden fees or long-term commitments."}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-12",children:[e.jsx("span",{className:`text-sm font-medium ${r?"text-gray-500":"text-gray-900"}`,children:"Monthly"}),e.jsx(wl,{checked:r,onCheckedChange:t,className:"data-[state=checked]:bg-blue-600"}),e.jsx("span",{className:`text-sm font-medium ${r?"text-gray-900":"text-gray-500"}`,children:"Annual"}),e.jsx(ae,{variant:"secondary",className:"ml-2 bg-green-100 text-green-800",children:"Save 20%"})]})]})}),e.jsx("section",{className:"py-20 -mt-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:d.map(h=>{const m=h.icon,f=c(h);return e.jsxs($,{className:`relative ${h.borderColor} ${h.popular?"ring-2 ring-blue-500 shadow-xl scale-105":"shadow-lg"} transition-all duration-300 hover:shadow-xl hover:-translate-y-1`,children:[h.popular&&e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:e.jsx(ae,{className:"bg-blue-600 text-white px-4 py-1",children:"Most Popular"})}),e.jsxs(Z,{className:`text-center ${h.bgColor} rounded-t-lg`,children:[e.jsx("div",{className:`inline-flex items-center justify-center w-12 h-12 ${h.color} mb-4 mx-auto`,children:e.jsx(m,{className:"h-8 w-8"})}),e.jsx(X,{className:"text-2xl font-bold text-gray-900",children:h.name}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-4xl font-bold text-gray-900",children:i(h)}),e.jsx("span",{className:"text-gray-600 ml-1",children:o(h)}),f&&e.jsx("div",{className:"mt-1",children:e.jsx(ae,{variant:"secondary",className:"bg-green-100 text-green-800 text-xs",children:f})})]})]}),e.jsxs(z,{className:"p-6",children:[e.jsx("ul",{className:"space-y-3 mb-8",children:h.features.map((g,y)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(sc,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:g})]},y))}),e.jsx(R,{onClick:()=>n(h.key),className:`w-full ${h.popular?"bg-blue-600 hover:bg-blue-700 text-white":h.key==="free"?"bg-gray-100 hover:bg-gray-200 text-gray-900":"bg-gray-900 hover:bg-gray-800 text-white"}`,size:"lg",children:h.key==="free"?"Sign Up Free":h.key==="enterprise"?"Contact Sales":s?"Subscribe Now":"Get Started"})]})]},h.key)})})})}),e.jsx("section",{className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Compare All Features"}),e.jsx("p",{className:"text-lg text-gray-600",children:"See exactly what's included in each plan"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full bg-white rounded-lg shadow-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-4 px-6 font-semibold text-gray-900",children:"Features"}),e.jsx("th",{className:"text-center py-4 px-6 font-semibold text-gray-900",children:"Free"}),e.jsx("th",{className:"text-center py-4 px-6 font-semibold text-blue-600",children:"Premium"}),e.jsx("th",{className:"text-center py-4 px-6 font-semibold text-purple-600",children:"Pro"}),e.jsx("th",{className:"text-center py-4 px-6 font-semibold text-gray-900",children:"Enterprise"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"AI Queries"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-600",children:"10/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-blue-600",children:"50/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-purple-600",children:"500/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-900",children:"Unlimited"})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"Document Downloads"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-600",children:"1/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-blue-600",children:"10/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-purple-600",children:"20/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-900",children:"Unlimited"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"Custom Legal Document Downloads"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-600",children:"✗"}),e.jsx("td",{className:"py-4 px-6 text-center text-blue-600",children:"3/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-purple-600",children:"20/month"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-900",children:"Unlimited"})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"Premium Templates"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"Document Analysis"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"API Access"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-600",children:"✗"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-600",children:"✗"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"Priority Support"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-medium text-gray-900",children:"Dedicated Account Manager"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-600",children:"✗"}),e.jsx("td",{className:"py-4 px-6 text-center text-gray-600",children:"✗"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"}),e.jsx("td",{className:"py-4 px-6 text-center text-green-600",children:"✓"})]})]})]})})]})}),e.jsx("section",{className:"py-20",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"text-center mb-16",children:e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Frequently Asked Questions"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Can I change plans later?"}),e.jsx("p",{className:"text-gray-600",children:"Yes, you can upgrade, downgrade, or cancel your plan at any time. Changes to your subscription take effect immediately."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"How do the monthly limits work?"}),e.jsx("p",{className:"text-gray-600",children:"Usage limits reset on the first day of each billing cycle. Unused queries or downloads don't roll over to the next month."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Is my payment information secure?"}),e.jsx("p",{className:"text-gray-600",children:"Yes, we use Stripe for all payment processing. Your payment information is never stored on our servers and is protected by bank-level security."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"What's your refund policy?"}),e.jsx("p",{className:"text-gray-600",children:"If you're not satisfied, contact us within 14 days of your purchase for a full refund. No questions asked."})]})]})]})}),e.jsx(Ea,{})]})},lL=({lawFirms:r,selectedFirm:t,onFirmSelect:s,className:a=""})=>{const[n,i]=p.useState(!1),[o,c]=p.useState({lat:1.3521,lng:103.8198}),[d,h]=p.useState(null);p.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(y=>{const{latitude:b,longitude:w}=y.coords;h({lat:b,lng:w}),c({lat:b,lng:w})},y=>{console.log("Location access denied or unavailable:",y)})},[]);const m=(y,b,w,S)=>{const v=(w-y)*Math.PI/180,j=(S-b)*Math.PI/180,C=Math.sin(v/2)*Math.sin(v/2)+Math.cos(y*Math.PI/180)*Math.cos(w*Math.PI/180)*Math.sin(j/2)*Math.sin(j/2);return 6371*(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)))},f=y=>d?`${m(d.lat,d.lng,y.coordinates.lat,y.coordinates.lng).toFixed(1)} km away`:"",g=()=>e.jsxs("div",{className:"relative w-full h-full bg-gray-100 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-green-50",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ia,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Interactive Map"}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[r.length," law firms in Singapore"]})]})}),r.map((y,b)=>e.jsx("div",{className:`absolute transform -translate-x-1/2 -translate-y-1/2 cursor-pointer transition-all duration-200 ${(t==null?void 0:t.id)===y.id?"scale-125 z-20":"hover:scale-110 z-10"}`,style:{left:`${20+b*15%60}%`,top:`${30+b*10%40}%`},onClick:()=>s(y),children:e.jsxs("div",{className:`relative ${(t==null?void 0:t.id)===y.id?"text-red-600":"text-blue-600 hover:text-red-600"}`,children:[e.jsx(ia,{className:"h-8 w-8 fill-current"}),e.jsx("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 bg-white text-xs font-bold rounded-full w-4 h-4 flex items-center justify-center border-2 border-current",children:y.id})]})},y.id)),d&&e.jsx("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 z-30",style:{left:"50%",top:"50%"},children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow-lg"}),e.jsx("div",{className:"absolute inset-0 w-4 h-4 bg-blue-500 rounded-full animate-ping opacity-75"})]})})]}),e.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2",children:[e.jsx(R,{size:"sm",variant:"outline",className:"bg-white/90 backdrop-blur-sm",onClick:()=>i(!n),children:n?e.jsx(gx,{className:"h-4 w-4"}):e.jsx(Fh,{className:"h-4 w-4"})}),d&&e.jsx(R,{size:"sm",variant:"outline",className:"bg-white/90 backdrop-blur-sm",onClick:()=>c(d),children:e.jsx(_p,{className:"h-4 w-4"})})]})]});return e.jsx("div",{className:`${a} ${n?"fixed inset-0 z-50 bg-white":""}`,children:e.jsxs($,{className:`h-full ${n?"rounded-none border-0":""}`,children:[e.jsx(Z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(X,{className:"text-lg font-semibold",children:"Law Firms Near You"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsxs(ae,{variant:"outline",className:"text-xs",children:[e.jsx(_p,{className:"h-3 w-3 mr-1"}),"Location enabled"]}),e.jsx(R,{size:"sm",variant:"outline",onClick:()=>i(!n),children:n?e.jsx(gx,{className:"h-4 w-4"}):e.jsx(Fh,{className:"h-4 w-4"})})]})]})}),e.jsxs(z,{className:"p-0 flex-1",children:[e.jsx("div",{className:`${n?"h-screen":"h-96"} relative`,children:g()}),t&&e.jsxs("div",{className:"p-4 border-t bg-gray-50",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-sm font-medium",children:t.rating}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.reviews,")"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:t.specialties.slice(0,3).map(y=>e.jsx(ae,{variant:"secondary",className:"text-xs",children:y},y))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ia,{className:"h-4 w-4"}),e.jsx("span",{children:t.location})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.lawyers," Lawyers"]})]}),d&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_p,{className:"h-4 w-4"}),e.jsx("span",{children:f(t)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsxs("span",{children:["Est. ",t.established]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(R,{size:"sm",className:"flex-1 bg-blue-600 hover:bg-blue-700",children:"View Profile"}),e.jsx(R,{size:"sm",variant:"outline",className:"flex-1",children:"Get Directions"})]})]})]})]})})},cL=()=>{const[r,t]=p.useState(""),[s,a]=p.useState(""),[n,i]=p.useState(""),[o,c]=p.useState(null),[d,h]=p.useState("list"),m=[{id:1,name:"Singapore Legal Associates",description:"Full-service law firm specializing in corporate and commercial law",specialties:["Corporate Law","Commercial Litigation","M&A"],location:"Central Business District",address:"1 Raffles Place, #40-01, One Raffles Place, Singapore 048616",coordinates:{lat:1.2844,lng:103.851},rating:4.8,reviews:124,phone:"+65 6234 5678",email:"contact@sla.com.sg",lawyers:15,established:"1995"},{id:2,name:"Family Law Partners",description:"Dedicated family law practice with compassionate approach",specialties:["Family Law","Divorce","Child Custody"],location:"Orchard",address:"391 Orchard Road, #12-01, Ngee Ann City Tower A, Singapore 238873",coordinates:{lat:1.3048,lng:103.8318},rating:4.9,reviews:89,phone:"+65 6345 6789",email:"info@flp.com.sg",lawyers:8,established:"2001"},{id:3,name:"Employment Rights Advocates",description:"Protecting employee and employer rights across Singapore",specialties:["Employment Law","HR Compliance","Workplace Disputes"],location:"Raffles Place",address:"6 Battery Road, #25-01, Singapore 049909",coordinates:{lat:1.2858,lng:103.8518},rating:4.7,reviews:156,phone:"+65 6456 7890",email:"help@era.com.sg",lawyers:12,established:"2008"}],f=["All Locations","Central Business District","Orchard","Raffles Place","Marina Bay"],g=["All Specialties","Corporate Law","Family Law","Employment Law","Real Estate Law","Criminal Defense"];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ca,{}),e.jsx("section",{className:"bg-blue-900 text-white pt-24 pb-16",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Find Legal Professionals"}),e.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-3xl mx-auto",children:"Search our directory of qualified Singaporean lawyers and law firms. Filter by practice area, location, and ratings."}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-white p-4 rounded-lg",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(Pe,{type:"text",placeholder:"Search by firm name, lawyer, or legal topic...",value:r,onChange:y=>t(y.target.value),className:"pl-10 border-0 focus:ring-2 focus:ring-blue-500"})]}),e.jsx("select",{value:s,onChange:y=>a(y.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:f.map(y=>e.jsx("option",{value:y,children:y},y))}),e.jsx("select",{value:n,onChange:y=>i(y.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:g.map(y=>e.jsx("option",{value:y,children:y},y))}),e.jsx(R,{className:"bg-blue-600 hover:bg-blue-700 px-8",children:"Search"})]})})]})})}),e.jsx("section",{className:"py-16",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:[m.length," Law Firms Found"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{variant:d==="list"?"default":"outline",size:"sm",onClick:()=>h("list"),className:"flex items-center space-x-2",children:[e.jsx(So,{className:"h-4 w-4"}),e.jsx("span",{children:"List"})]}),e.jsxs(R,{variant:d==="map"?"default":"outline",size:"sm",onClick:()=>h("map"),className:"flex items-center space-x-2",children:[e.jsx(W5,{className:"h-4 w-4"}),e.jsx("span",{children:"Map"})]})]}),e.jsxs(R,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(z5,{className:"h-4 w-4"}),e.jsx("span",{children:"More Filters"})]})]})]}),d==="list"&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:m.map(y=>e.jsxs($,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(Z,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-xl font-bold text-gray-900 mb-2",children:y.name}),e.jsx(ye,{className:"text-gray-600 mb-4",children:y.description})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"font-semibold",children:y.rating}),e.jsxs("span",{className:"text-gray-500",children:["(",y.reviews,")"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:y.specialties.map(b=>e.jsx(ae,{variant:"secondary",children:b},b))})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(ia,{className:"h-4 w-4"}),e.jsx("span",{children:y.location})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsxs("span",{children:[y.lawyers," Lawyers"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsxs("span",{children:["Established ",y.established]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(R,{className:"flex-1 bg-blue-600 hover:bg-blue-700",children:"View Profile"}),e.jsx(R,{variant:"outline",className:"flex-1",children:"Contact Firm"})]})]})]},y.id))}),d==="map"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1 space-y-4 max-h-[600px] overflow-y-auto",children:m.map(y=>e.jsx($,{className:`cursor-pointer transition-all duration-200 ${(o==null?void 0:o.id)===y.id?"ring-2 ring-blue-500 shadow-lg":"hover:shadow-md"}`,onClick:()=>c(y),children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:y.name}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ot,{className:"h-3 w-3 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-xs font-medium",children:y.rating})]})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:y.description}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[e.jsx(ia,{className:"h-3 w-3"}),e.jsx("span",{children:y.location})]})]})},y.id))}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(lL,{lawFirms:m,selectedFirm:o,onFirmSelect:c,className:"h-[600px]"})})]}),e.jsx("div",{className:"text-center mt-12",children:e.jsx(R,{variant:"outline",size:"lg",children:"Load More Results"})})]})}),e.jsx(Ea,{})]})};function Sj(r,[t,s]){return Math.min(s,Math.max(t,r))}var dL=[" ","Enter","ArrowUp","ArrowDown"],uL=[" ","Enter"],Ud="Select",[Lm,Um,hL]=m_(Ud),[oc,DW]=Io(Ud,[hL,ec]),$m=ec(),[mL,Mi]=oc(Ud),[fL,pL]=oc(Ud),N1=r=>{const{__scopeSelect:t,children:s,open:a,defaultOpen:n,onOpenChange:i,value:o,defaultValue:c,onValueChange:d,dir:h,name:m,autoComplete:f,disabled:g,required:y,form:b}=r,w=$m(t),[S,N]=p.useState(null),[v,j]=p.useState(null),[C,k]=p.useState(!1),I=WD(h),[T=!1,O]=_o({prop:a,defaultProp:n,onChange:i}),[U,A]=_o({prop:o,defaultProp:c,onChange:d}),L=p.useRef(null),M=S?b||!!S.closest("form"):!0,[se,W]=p.useState(new Set),q=Array.from(se).map(K=>K.props.value).join(";");return e.jsx(Lg,{...w,children:e.jsxs(mL,{required:y,scope:t,trigger:S,onTriggerChange:N,valueNode:v,onValueNodeChange:j,valueNodeHasChildren:C,onValueNodeHasChildrenChange:k,contentId:Id(),value:U,onValueChange:A,open:T,onOpenChange:O,dir:I,triggerPointerDownPosRef:L,disabled:g,children:[e.jsx(Lm.Provider,{scope:t,children:e.jsx(fL,{scope:r.__scopeSelect,onNativeOptionAdd:p.useCallback(K=>{W(Y=>new Set(Y).add(K))},[]),onNativeOptionRemove:p.useCallback(K=>{W(Y=>{const le=new Set(Y);return le.delete(K),le})},[]),children:s})}),M?e.jsxs(Q1,{"aria-hidden":!0,required:y,tabIndex:-1,name:m,autoComplete:f,value:U,onChange:K=>A(K.target.value),disabled:g,form:b,children:[U===void 0?e.jsx("option",{value:""}):null,Array.from(se)]},q):null]})})};N1.displayName=Ud;var S1="SelectTrigger",k1=p.forwardRef((r,t)=>{const{__scopeSelect:s,disabled:a=!1,...n}=r,i=$m(s),o=Mi(S1,s),c=o.disabled||a,d=Ys(t,o.onTriggerChange),h=Um(s),m=p.useRef("touch"),[f,g,y]=Y1(w=>{const S=h().filter(j=>!j.disabled),N=S.find(j=>j.value===o.value),v=J1(S,w,N);v!==void 0&&o.onValueChange(v.value)}),b=w=>{c||(o.onOpenChange(!0),y()),w&&(o.triggerPointerDownPosRef.current={x:Math.round(w.pageX),y:Math.round(w.pageY)})};return e.jsx(fm,{asChild:!0,...i,children:e.jsx(zt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":K1(o.value)?"":void 0,...n,ref:d,onClick:Nt(n.onClick,w=>{w.currentTarget.focus(),m.current!=="mouse"&&b(w)}),onPointerDown:Nt(n.onPointerDown,w=>{m.current=w.pointerType;const S=w.target;S.hasPointerCapture(w.pointerId)&&S.releasePointerCapture(w.pointerId),w.button===0&&w.ctrlKey===!1&&w.pointerType==="mouse"&&(b(w),w.preventDefault())}),onKeyDown:Nt(n.onKeyDown,w=>{const S=f.current!=="";!(w.ctrlKey||w.altKey||w.metaKey)&&w.key.length===1&&g(w.key),!(S&&w.key===" ")&&dL.includes(w.key)&&(b(),w.preventDefault())})})})});k1.displayName=S1;var C1="SelectValue",E1=p.forwardRef((r,t)=>{const{__scopeSelect:s,className:a,style:n,children:i,placeholder:o="",...c}=r,d=Mi(C1,s),{onValueNodeHasChildrenChange:h}=d,m=i!==void 0,f=Ys(t,d.onValueNodeChange);return Va(()=>{h(m)},[h,m]),e.jsx(zt.span,{...c,ref:f,style:{pointerEvents:"none"},children:K1(d.value)?e.jsx(e.Fragment,{children:o}):i})});E1.displayName=C1;var xL="SelectIcon",A1=p.forwardRef((r,t)=>{const{__scopeSelect:s,children:a,...n}=r;return e.jsx(zt.span,{"aria-hidden":!0,...n,ref:t,children:a||"▼"})});A1.displayName=xL;var gL="SelectPortal",T1=r=>e.jsx(Dg,{asChild:!0,...r});T1.displayName=gL;var Eo="SelectContent",R1=p.forwardRef((r,t)=>{const s=Mi(Eo,r.__scopeSelect),[a,n]=p.useState();if(Va(()=>{n(new DocumentFragment)},[]),!s.open){const i=a;return i?wm.createPortal(e.jsx(P1,{scope:r.__scopeSelect,children:e.jsx(Lm.Slot,{scope:r.__scopeSelect,children:e.jsx("div",{children:r.children})})}),i):null}return e.jsx(I1,{...r,ref:t})});R1.displayName=Eo;var Oa=10,[P1,Li]=oc(Eo),yL="SelectContentImpl",I1=p.forwardRef((r,t)=>{const{__scopeSelect:s,position:a="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:i,onPointerDownOutside:o,side:c,sideOffset:d,align:h,alignOffset:m,arrowPadding:f,collisionBoundary:g,collisionPadding:y,sticky:b,hideWhenDetached:w,avoidCollisions:S,...N}=r,v=Mi(Eo,s),[j,C]=p.useState(null),[k,I]=p.useState(null),T=Ys(t,We=>C(We)),[O,U]=p.useState(null),[A,L]=p.useState(null),M=Um(s),[se,W]=p.useState(!1),q=p.useRef(!1);p.useEffect(()=>{if(j)return v_(j)},[j]),w_();const K=p.useCallback(We=>{const[ct,...he]=M().map(ze=>ze.ref.current),[fe]=he.slice(-1),Me=document.activeElement;for(const ze of We)if(ze===Me||(ze==null||ze.scrollIntoView({block:"nearest"}),ze===ct&&k&&(k.scrollTop=0),ze===fe&&k&&(k.scrollTop=k.scrollHeight),ze==null||ze.focus(),document.activeElement!==Me))return},[M,k]),Y=p.useCallback(()=>K([O,j]),[K,O,j]);p.useEffect(()=>{se&&Y()},[se,Y]);const{onOpenChange:le,triggerPointerDownPosRef:Ne}=v;p.useEffect(()=>{if(j){let We={x:0,y:0};const ct=fe=>{var Me,ze;We={x:Math.abs(Math.round(fe.pageX)-(((Me=Ne.current)==null?void 0:Me.x)??0)),y:Math.abs(Math.round(fe.pageY)-(((ze=Ne.current)==null?void 0:ze.y)??0))}},he=fe=>{We.x<=10&&We.y<=10?fe.preventDefault():j.contains(fe.target)||le(!1),document.removeEventListener("pointermove",ct),Ne.current=null};return Ne.current!==null&&(document.addEventListener("pointermove",ct),document.addEventListener("pointerup",he,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ct),document.removeEventListener("pointerup",he,{capture:!0})}}},[j,le,Ne]),p.useEffect(()=>{const We=()=>le(!1);return window.addEventListener("blur",We),window.addEventListener("resize",We),()=>{window.removeEventListener("blur",We),window.removeEventListener("resize",We)}},[le]);const[Ke,ke]=Y1(We=>{const ct=M().filter(Me=>!Me.disabled),he=ct.find(Me=>Me.ref.current===document.activeElement),fe=J1(ct,We,he);fe&&setTimeout(()=>fe.ref.current.focus())}),$e=p.useCallback((We,ct,he)=>{const fe=!q.current&&!he;(v.value!==void 0&&v.value===ct||fe)&&(U(We),fe&&(q.current=!0))},[v.value]),ce=p.useCallback(()=>j==null?void 0:j.focus(),[j]),Re=p.useCallback((We,ct,he)=>{const fe=!q.current&&!he;(v.value!==void 0&&v.value===ct||fe)&&L(We)},[v.value]),Qe=a==="popper"?Hx:D1,nt=Qe===Hx?{side:c,sideOffset:d,align:h,alignOffset:m,arrowPadding:f,collisionBoundary:g,collisionPadding:y,sticky:b,hideWhenDetached:w,avoidCollisions:S}:{};return e.jsx(P1,{scope:s,content:j,viewport:k,onViewportChange:I,itemRefCallback:$e,selectedItem:O,onItemLeave:ce,itemTextRefCallback:Re,focusSelectedItem:Y,selectedItemText:A,position:a,isPositioned:se,searchRef:Ke,children:e.jsx(j_,{as:pm,allowPinchZoom:!0,children:e.jsx(b_,{asChild:!0,trapped:v.open,onMountAutoFocus:We=>{We.preventDefault()},onUnmountAutoFocus:Nt(n,We=>{var ct;(ct=v.trigger)==null||ct.focus({preventScroll:!0}),We.preventDefault()}),children:e.jsx(Fg,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:We=>We.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:e.jsx(Qe,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:We=>We.preventDefault(),...N,...nt,onPlaced:()=>W(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...N.style},onKeyDown:Nt(N.onKeyDown,We=>{const ct=We.ctrlKey||We.altKey||We.metaKey;if(We.key==="Tab"&&We.preventDefault(),!ct&&We.key.length===1&&ke(We.key),["ArrowUp","ArrowDown","Home","End"].includes(We.key)){let fe=M().filter(Me=>!Me.disabled).map(Me=>Me.ref.current);if(["ArrowUp","End"].includes(We.key)&&(fe=fe.slice().reverse()),["ArrowUp","ArrowDown"].includes(We.key)){const Me=We.target,ze=fe.indexOf(Me);fe=fe.slice(ze+1)}setTimeout(()=>K(fe)),We.preventDefault()}})})})})})})});I1.displayName=yL;var vL="SelectItemAlignedPosition",D1=p.forwardRef((r,t)=>{const{__scopeSelect:s,onPlaced:a,...n}=r,i=Mi(Eo,s),o=Li(Eo,s),[c,d]=p.useState(null),[h,m]=p.useState(null),f=Ys(t,T=>m(T)),g=Um(s),y=p.useRef(!1),b=p.useRef(!0),{viewport:w,selectedItem:S,selectedItemText:N,focusSelectedItem:v}=o,j=p.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&h&&w&&S&&N){const T=i.trigger.getBoundingClientRect(),O=h.getBoundingClientRect(),U=i.valueNode.getBoundingClientRect(),A=N.getBoundingClientRect();if(i.dir!=="rtl"){const Me=A.left-O.left,ze=U.left-Me,ts=T.left-ze,Tt=T.width+ts,Os=Math.max(Tt,O.width),Ms=window.innerWidth-Oa,os=Sj(ze,[Oa,Math.max(Oa,Ms-Os)]);c.style.minWidth=Tt+"px",c.style.left=os+"px"}else{const Me=O.right-A.right,ze=window.innerWidth-U.right-Me,ts=window.innerWidth-T.right-ze,Tt=T.width+ts,Os=Math.max(Tt,O.width),Ms=window.innerWidth-Oa,os=Sj(ze,[Oa,Math.max(Oa,Ms-Os)]);c.style.minWidth=Tt+"px",c.style.right=os+"px"}const L=g(),M=window.innerHeight-Oa*2,se=w.scrollHeight,W=window.getComputedStyle(h),q=parseInt(W.borderTopWidth,10),K=parseInt(W.paddingTop,10),Y=parseInt(W.borderBottomWidth,10),le=parseInt(W.paddingBottom,10),Ne=q+K+se+le+Y,Ke=Math.min(S.offsetHeight*5,Ne),ke=window.getComputedStyle(w),$e=parseInt(ke.paddingTop,10),ce=parseInt(ke.paddingBottom,10),Re=T.top+T.height/2-Oa,Qe=M-Re,nt=S.offsetHeight/2,We=S.offsetTop+nt,ct=q+K+We,he=Ne-ct;if(ct<=Re){const Me=L.length>0&&S===L[L.length-1].ref.current;c.style.bottom="0px";const ze=h.clientHeight-w.offsetTop-w.offsetHeight,ts=Math.max(Qe,nt+(Me?ce:0)+ze+Y),Tt=ct+ts;c.style.height=Tt+"px"}else{const Me=L.length>0&&S===L[0].ref.current;c.style.top="0px";const ts=Math.max(Re,q+w.offsetTop+(Me?$e:0)+nt)+he;c.style.height=ts+"px",w.scrollTop=ct-Re+w.offsetTop}c.style.margin=`${Oa}px 0`,c.style.minHeight=Ke+"px",c.style.maxHeight=M+"px",a==null||a(),requestAnimationFrame(()=>y.current=!0)}},[g,i.trigger,i.valueNode,c,h,w,S,N,i.dir,a]);Va(()=>j(),[j]);const[C,k]=p.useState();Va(()=>{h&&k(window.getComputedStyle(h).zIndex)},[h]);const I=p.useCallback(T=>{T&&b.current===!0&&(j(),v==null||v(),b.current=!1)},[j,v]);return e.jsx(jL,{scope:s,contentWrapper:c,shouldExpandOnScrollRef:y,onScrollButtonChange:I,children:e.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:e.jsx(zt.div,{...n,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});D1.displayName=vL;var wL="SelectPopperPosition",Hx=p.forwardRef((r,t)=>{const{__scopeSelect:s,align:a="start",collisionPadding:n=Oa,...i}=r,o=$m(s);return e.jsx(Og,{...o,...i,ref:t,align:a,collisionPadding:n,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Hx.displayName=wL;var[jL,uy]=oc(Eo,{}),Gx="SelectViewport",F1=p.forwardRef((r,t)=>{const{__scopeSelect:s,nonce:a,...n}=r,i=Li(Gx,s),o=uy(Gx,s),c=Ys(t,i.onViewportChange),d=p.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),e.jsx(Lm.Slot,{scope:s,children:e.jsx(zt.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:Nt(n.onScroll,h=>{const m=h.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:g}=o;if(g!=null&&g.current&&f){const y=Math.abs(d.current-m.scrollTop);if(y>0){const b=window.innerHeight-Oa*2,w=parseFloat(f.style.minHeight),S=parseFloat(f.style.height),N=Math.max(w,S);if(N<b){const v=N+y,j=Math.min(b,v),C=v-j;f.style.height=j+"px",f.style.bottom==="0px"&&(m.scrollTop=C>0?C:0,f.style.justifyContent="flex-end")}}}d.current=m.scrollTop})})})]})});F1.displayName=Gx;var O1="SelectGroup",[bL,_L]=oc(O1),NL=p.forwardRef((r,t)=>{const{__scopeSelect:s,...a}=r,n=Id();return e.jsx(bL,{scope:s,id:n,children:e.jsx(zt.div,{role:"group","aria-labelledby":n,...a,ref:t})})});NL.displayName=O1;var M1="SelectLabel",L1=p.forwardRef((r,t)=>{const{__scopeSelect:s,...a}=r,n=_L(M1,s);return e.jsx(zt.div,{id:n.id,...a,ref:t})});L1.displayName=M1;var $h="SelectItem",[SL,U1]=oc($h),$1=p.forwardRef((r,t)=>{const{__scopeSelect:s,value:a,disabled:n=!1,textValue:i,...o}=r,c=Mi($h,s),d=Li($h,s),h=c.value===a,[m,f]=p.useState(i??""),[g,y]=p.useState(!1),b=Ys(t,v=>{var j;return(j=d.itemRefCallback)==null?void 0:j.call(d,v,a,n)}),w=Id(),S=p.useRef("touch"),N=()=>{n||(c.onValueChange(a),c.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(SL,{scope:s,value:a,disabled:n,textId:w,isSelected:h,onItemTextChange:p.useCallback(v=>{f(j=>j||((v==null?void 0:v.textContent)??"").trim())},[]),children:e.jsx(Lm.ItemSlot,{scope:s,value:a,disabled:n,textValue:m,children:e.jsx(zt.div,{role:"option","aria-labelledby":w,"data-highlighted":g?"":void 0,"aria-selected":h&&g,"data-state":h?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...o,ref:b,onFocus:Nt(o.onFocus,()=>y(!0)),onBlur:Nt(o.onBlur,()=>y(!1)),onClick:Nt(o.onClick,()=>{S.current!=="mouse"&&N()}),onPointerUp:Nt(o.onPointerUp,()=>{S.current==="mouse"&&N()}),onPointerDown:Nt(o.onPointerDown,v=>{S.current=v.pointerType}),onPointerMove:Nt(o.onPointerMove,v=>{var j;S.current=v.pointerType,n?(j=d.onItemLeave)==null||j.call(d):S.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Nt(o.onPointerLeave,v=>{var j;v.currentTarget===document.activeElement&&((j=d.onItemLeave)==null||j.call(d))}),onKeyDown:Nt(o.onKeyDown,v=>{var C;((C=d.searchRef)==null?void 0:C.current)!==""&&v.key===" "||(uL.includes(v.key)&&N(),v.key===" "&&v.preventDefault())})})})})});$1.displayName=$h;var Bc="SelectItemText",z1=p.forwardRef((r,t)=>{const{__scopeSelect:s,className:a,style:n,...i}=r,o=Mi(Bc,s),c=Li(Bc,s),d=U1(Bc,s),h=pL(Bc,s),[m,f]=p.useState(null),g=Ys(t,N=>f(N),d.onItemTextChange,N=>{var v;return(v=c.itemTextRefCallback)==null?void 0:v.call(c,N,d.value,d.disabled)}),y=m==null?void 0:m.textContent,b=p.useMemo(()=>e.jsx("option",{value:d.value,disabled:d.disabled,children:y},d.value),[d.disabled,d.value,y]),{onNativeOptionAdd:w,onNativeOptionRemove:S}=h;return Va(()=>(w(b),()=>S(b)),[w,S,b]),e.jsxs(e.Fragment,{children:[e.jsx(zt.span,{id:d.textId,...i,ref:g}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?wm.createPortal(i.children,o.valueNode):null]})});z1.displayName=Bc;var B1="SelectItemIndicator",q1=p.forwardRef((r,t)=>{const{__scopeSelect:s,...a}=r;return U1(B1,s).isSelected?e.jsx(zt.span,{"aria-hidden":!0,...a,ref:t}):null});q1.displayName=B1;var Kx="SelectScrollUpButton",V1=p.forwardRef((r,t)=>{const s=Li(Kx,r.__scopeSelect),a=uy(Kx,r.__scopeSelect),[n,i]=p.useState(!1),o=Ys(t,a.onScrollButtonChange);return Va(()=>{if(s.viewport&&s.isPositioned){let c=function(){const h=d.scrollTop>0;i(h)};const d=s.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[s.viewport,s.isPositioned]),n?e.jsx(H1,{...r,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=s;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});V1.displayName=Kx;var Qx="SelectScrollDownButton",W1=p.forwardRef((r,t)=>{const s=Li(Qx,r.__scopeSelect),a=uy(Qx,r.__scopeSelect),[n,i]=p.useState(!1),o=Ys(t,a.onScrollButtonChange);return Va(()=>{if(s.viewport&&s.isPositioned){let c=function(){const h=d.scrollHeight-d.clientHeight,m=Math.ceil(d.scrollTop)<h;i(m)};const d=s.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[s.viewport,s.isPositioned]),n?e.jsx(H1,{...r,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=s;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});W1.displayName=Qx;var H1=p.forwardRef((r,t)=>{const{__scopeSelect:s,onAutoScroll:a,...n}=r,i=Li("SelectScrollButton",s),o=p.useRef(null),c=Um(s),d=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>d(),[d]),Va(()=>{var m;const h=c().find(f=>f.ref.current===document.activeElement);(m=h==null?void 0:h.ref.current)==null||m.scrollIntoView({block:"nearest"})},[c]),e.jsx(zt.div,{"aria-hidden":!0,...n,ref:t,style:{flexShrink:0,...n.style},onPointerDown:Nt(n.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(a,50))}),onPointerMove:Nt(n.onPointerMove,()=>{var h;(h=i.onItemLeave)==null||h.call(i),o.current===null&&(o.current=window.setInterval(a,50))}),onPointerLeave:Nt(n.onPointerLeave,()=>{d()})})}),kL="SelectSeparator",G1=p.forwardRef((r,t)=>{const{__scopeSelect:s,...a}=r;return e.jsx(zt.div,{"aria-hidden":!0,...a,ref:t})});G1.displayName=kL;var Yx="SelectArrow",CL=p.forwardRef((r,t)=>{const{__scopeSelect:s,...a}=r,n=$m(s),i=Mi(Yx,s),o=Li(Yx,s);return i.open&&o.position==="popper"?e.jsx(Mg,{...n,...a,ref:t}):null});CL.displayName=Yx;function K1(r){return r===""||r===void 0}var Q1=p.forwardRef((r,t)=>{const{value:s,...a}=r,n=p.useRef(null),i=Ys(t,n),o=cy(s);return p.useEffect(()=>{const c=n.current,d=window.HTMLSelectElement.prototype,m=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==s&&m){const f=new Event("change",{bubbles:!0});m.call(c,s),c.dispatchEvent(f)}},[o,s]),e.jsx(Fd,{asChild:!0,children:e.jsx("select",{...a,ref:i,defaultValue:s})})});Q1.displayName="BubbleSelect";function Y1(r){const t=Fl(r),s=p.useRef(""),a=p.useRef(0),n=p.useCallback(o=>{const c=s.current+o;t(c),function d(h){s.current=h,window.clearTimeout(a.current),h!==""&&(a.current=window.setTimeout(()=>d(""),1e3))}(c)},[t]),i=p.useCallback(()=>{s.current="",window.clearTimeout(a.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(a.current),[]),[s,n,i]}function J1(r,t,s){const n=t.length>1&&Array.from(t).every(h=>h===t[0])?t[0]:t,i=s?r.indexOf(s):-1;let o=EL(r,Math.max(i,0));n.length===1&&(o=o.filter(h=>h!==s));const d=o.find(h=>h.textValue.toLowerCase().startsWith(n.toLowerCase()));return d!==s?d:void 0}function EL(r,t){return r.map((s,a)=>r[(t+a)%r.length])}var AL=N1,Z1=k1,TL=E1,RL=A1,PL=T1,X1=R1,IL=F1,eS=L1,tS=$1,DL=z1,FL=q1,sS=V1,rS=W1,aS=G1;const it=AL,ot=TL,rt=p.forwardRef(({className:r,children:t,...s},a)=>e.jsxs(Z1,{ref:a,className:Ie("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...s,children:[t,e.jsx(RL,{asChild:!0,children:e.jsx(Vg,{className:"h-4 w-4 opacity-50"})})]}));rt.displayName=Z1.displayName;const nS=p.forwardRef(({className:r,...t},s)=>e.jsx(sS,{ref:s,className:Ie("flex cursor-default items-center justify-center py-1",r),...t,children:e.jsx(L5,{className:"h-4 w-4"})}));nS.displayName=sS.displayName;const iS=p.forwardRef(({className:r,...t},s)=>e.jsx(rS,{ref:s,className:Ie("flex cursor-default items-center justify-center py-1",r),...t,children:e.jsx(Vg,{className:"h-4 w-4"})}));iS.displayName=rS.displayName;const at=p.forwardRef(({className:r,children:t,position:s="popper",...a},n)=>e.jsx(PL,{children:e.jsxs(X1,{ref:n,className:Ie("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:s,...a,children:[e.jsx(nS,{}),e.jsx(IL,{className:Ie("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(iS,{})]})}));at.displayName=X1.displayName;const OL=p.forwardRef(({className:r,...t},s)=>e.jsx(eS,{ref:s,className:Ie("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...t}));OL.displayName=eS.displayName;const ne=p.forwardRef(({className:r,children:t,...s},a)=>e.jsxs(tS,{ref:a,className:Ie("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(FL,{children:e.jsx(sc,{className:"h-4 w-4"})})}),e.jsx(DL,{children:t})]}));ne.displayName=tS.displayName;const ML=p.forwardRef(({className:r,...t},s)=>e.jsx(aS,{ref:s,className:Ie("-mx-1 my-1 h-px bg-muted",r),...t}));ML.displayName=aS.displayName;var hy="Checkbox",[LL,FW]=Io(hy),[UL,$L]=LL(hy),oS=p.forwardRef((r,t)=>{const{__scopeCheckbox:s,name:a,checked:n,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:h,form:m,...f}=r,[g,y]=p.useState(null),b=Ys(t,C=>y(C)),w=p.useRef(!1),S=g?m||!!g.closest("form"):!0,[N=!1,v]=_o({prop:n,defaultProp:i,onChange:h}),j=p.useRef(N);return p.useEffect(()=>{const C=g==null?void 0:g.form;if(C){const k=()=>v(j.current);return C.addEventListener("reset",k),()=>C.removeEventListener("reset",k)}},[g,v]),e.jsxs(UL,{scope:s,state:N,disabled:c,children:[e.jsx(zt.button,{type:"button",role:"checkbox","aria-checked":Ai(N)?"mixed":N,"aria-required":o,"data-state":dS(N),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:b,onKeyDown:Nt(r.onKeyDown,C=>{C.key==="Enter"&&C.preventDefault()}),onClick:Nt(r.onClick,C=>{v(k=>Ai(k)?!0:!k),S&&(w.current=C.isPropagationStopped(),w.current||C.stopPropagation())})}),S&&e.jsx(zL,{control:g,bubbles:!w.current,name:a,value:d,checked:N,required:o,disabled:c,form:m,style:{transform:"translateX(-100%)"},defaultChecked:Ai(i)?!1:i})]})});oS.displayName=hy;var lS="CheckboxIndicator",cS=p.forwardRef((r,t)=>{const{__scopeCheckbox:s,forceMount:a,...n}=r,i=$L(lS,s);return e.jsx(Pd,{present:a||Ai(i.state)||i.state===!0,children:e.jsx(zt.span,{"data-state":dS(i.state),"data-disabled":i.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...r.style}})})});cS.displayName=lS;var zL=r=>{const{control:t,checked:s,bubbles:a=!0,defaultChecked:n,...i}=r,o=p.useRef(null),c=cy(s),d=y_(t);p.useEffect(()=>{const m=o.current,f=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==s&&y){const b=new Event("click",{bubbles:a});m.indeterminate=Ai(s),y.call(m,Ai(s)?!1:s),m.dispatchEvent(b)}},[c,s,a]);const h=p.useRef(Ai(s)?!1:s);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n??h.current,...i,tabIndex:-1,ref:o,style:{...r.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ai(r){return r==="indeterminate"}function dS(r){return Ai(r)?"indeterminate":r?"checked":"unchecked"}var uS=oS,BL=cS;const hr=p.forwardRef(({className:r,...t},s)=>e.jsx(uS,{ref:s,className:Ie("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...t,children:e.jsx(BL,{className:Ie("flex items-center justify-center text-current"),children:e.jsx(sc,{className:"h-4 w-4"})})}));hr.displayName=uS.displayName;const Ur={async getLawFirms(r={}){let t=D.from("law_firms").select("*").eq("verified",!0).order("rating",{ascending:!1});r.practiceAreas&&r.practiceAreas.length>0&&(t=t.overlaps("practice_areas",r.practiceAreas)),r.location&&(t=t.ilike("address",`%${r.location}%`)),r.rating&&(t=t.gte("rating",r.rating)),r.search&&(t=t.or(`name.ilike.%${r.search}%,description.ilike.%${r.search}%`));const{data:s,error:a}=await t;if(a)throw console.error("Error fetching law firms:",a),new Error("Failed to fetch law firms");return s||[]},async getLawFirm(r){const{data:t,error:s}=await D.from("law_firms").select("*").eq("id",r).single();if(s)throw console.error("Error fetching law firm:",s),new Error("Failed to fetch law firm");if(!t)throw new Error("Law firm not found");return t},async createLawFirm(r){const{data:t,error:s}=await D.from("law_firms").insert({...r,verified:!1}).select().single();if(s)throw console.error("Error creating law firm:",s),new Error("Failed to create law firm");return t},async updateLawFirm(r,t){const{data:s,error:a}=await D.from("law_firms").update(t).eq("id",r).select().single();if(a)throw console.error("Error updating law firm:",a),new Error("Failed to update law firm");return s},async verifyLawFirm(r,t=!0){const{data:s,error:a}=await D.from("law_firms").update({verified:t}).eq("id",r).select().single();if(a)throw console.error("Error verifying law firm:",a),new Error("Failed to verify law firm");return s},async deleteLawFirm(r){const{error:t}=await D.from("law_firms").delete().eq("id",r);if(t)throw console.error("Error deleting law firm:",t),new Error("Failed to delete law firm")},async getLawFirmReviews(r){const{data:t,error:s}=await D.from("law_firm_reviews").select(`
        *,
        user:profiles(full_name, avatar_url)
      `).eq("law_firm_id",r).eq("status","approved").order("created_at",{ascending:!1});if(s)throw console.error("Error fetching reviews:",s),new Error("Failed to fetch reviews");return t||[]},async createReview(r){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:s,error:a}=await D.from("law_firm_reviews").insert({...r,user_id:t.id,status:"pending"}).select().single();if(a)throw console.error("Error creating review:",a),new Error("Failed to create review");return s},async updateReview(r,t){const{data:s,error:a}=await D.from("law_firm_reviews").update(t).eq("id",r).select().single();if(a)throw console.error("Error updating review:",a),new Error("Failed to update review");return s},async deleteReview(r){const{error:t}=await D.from("law_firm_reviews").delete().eq("id",r);if(t)throw console.error("Error deleting review:",t),new Error("Failed to delete review")},async moderateReview(r,t){const{data:s,error:a}=await D.from("law_firm_reviews").update({status:t}).eq("id",r).select().single();if(a)throw console.error("Error moderating review:",a),new Error("Failed to moderate review");return s},async voteOnReview(r,t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:a,error:n}=await D.from("law_firm_review_votes").upsert({review_id:r,user_id:s.id,is_helpful:t}).select().single();if(n)throw console.error("Error voting on review:",n),new Error("Failed to vote on review");return a},async removeVoteOnReview(r){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User not authenticated");const{error:s}=await D.from("law_firm_review_votes").delete().eq("review_id",r).eq("user_id",t.id);if(s)throw console.error("Error removing vote:",s),new Error("Failed to remove vote")},async getPracticeAreas(){const{data:r,error:t}=await D.from("law_firms").select("practice_areas").eq("verified",!0);if(t)throw console.error("Error fetching practice areas:",t),new Error("Failed to fetch practice areas");const s=(r==null?void 0:r.flatMap(a=>a.practice_areas))||[];return[...new Set(s)].sort()},async searchLawFirms(r,t={}){return this.getLawFirms({...t,search:r})},async getLawFirmProfile(r){const{data:t,error:s}=await D.from("law_firms").select("*").eq("id",r).eq("verified",!0).single();if(s)throw console.error("Error fetching law firm profile:",s),new Error("Failed to fetch law firm profile");const{data:a}=await D.from("law_firm_team_members").select("*").eq("law_firm_id",r).eq("is_active",!0).order("order_index"),{data:n}=await D.from("law_firm_gallery").select("*").eq("law_firm_id",r).order("order_index"),{data:i}=await D.from("law_firm_reviews").select(`
        *,
        user:profiles(full_name, avatar_url)
      `).eq("law_firm_id",r).eq("status","approved").order("created_at",{ascending:!1}).limit(5);return{...t,team_members:a||[],gallery:n||[],recent_reviews:i||[]}},async getTeamMembers(r){const{data:t,error:s}=await D.from("law_firm_team_members").select("*").eq("law_firm_id",r).eq("is_active",!0).order("order_index");if(s)throw console.error("Error fetching team members:",s),new Error("Failed to fetch team members");return t||[]},async createTeamMember(r){const{data:t,error:s}=await D.from("law_firm_team_members").insert(r).select().single();if(s)throw console.error("Error creating team member:",s),new Error("Failed to create team member");return t},async updateTeamMember(r,t){const{data:s,error:a}=await D.from("law_firm_team_members").update(t).eq("id",r).select().single();if(a)throw console.error("Error updating team member:",a),new Error("Failed to update team member");return s},async deleteTeamMember(r){const{error:t}=await D.from("law_firm_team_members").update({is_active:!1}).eq("id",r);if(t)throw console.error("Error deleting team member:",t),new Error("Failed to delete team member")},async getGalleryImages(r){const{data:t,error:s}=await D.from("law_firm_gallery").select("*").eq("law_firm_id",r).order("order_index");if(s)throw console.error("Error fetching gallery images:",s),new Error("Failed to fetch gallery images");return t||[]},async addGalleryImage(r){const{data:t,error:s}=await D.from("law_firm_gallery").insert(r).select().single();if(s)throw console.error("Error adding gallery image:",s),new Error("Failed to add gallery image");return t},async updateGalleryImage(r,t){const{data:s,error:a}=await D.from("law_firm_gallery").update(t).eq("id",r).select().single();if(a)throw console.error("Error updating gallery image:",a),new Error("Failed to update gallery image");return s},async deleteGalleryImage(r){const{error:t}=await D.from("law_firm_gallery").delete().eq("id",r);if(t)throw console.error("Error deleting gallery image:",t),new Error("Failed to delete gallery image")},async createBooking(r){const{data:t,error:s}=await D.from("law_firm_bookings").insert(r).select(`
        *,
        user:profiles(full_name, email, phone),
        team_member:law_firm_team_members(*)
      `).single();if(s)throw console.error("Error creating booking:",s),new Error("Failed to create booking");return t},async getUserBookings(r){const{data:t,error:s}=await D.from("law_firm_bookings").select(`
        *,
        law_firm:law_firms(name, phone, email),
        team_member:law_firm_team_members(name, title, email, phone)
      `).eq("user_id",r).order("created_at",{ascending:!1});if(s)throw console.error("Error fetching user bookings:",s),new Error("Failed to fetch user bookings");return t||[]},async getLawFirmBookings(r){const{data:t,error:s}=await D.from("law_firm_bookings").select(`
        *,
        user:profiles(full_name, email, phone),
        team_member:law_firm_team_members(name, title)
      `).eq("law_firm_id",r).order("created_at",{ascending:!1});if(s)throw console.error("Error fetching law firm bookings:",s),new Error("Failed to fetch law firm bookings");return t||[]},async updateBookingStatus(r,t,s){const a={status:t};s&&(a.notes=s);const{data:n,error:i}=await D.from("law_firm_bookings").update(a).eq("id",r).select(`
        *,
        user:profiles(full_name, email, phone),
        team_member:law_firm_team_members(name, title)
      `).single();if(i)throw console.error("Error updating booking status:",i),new Error("Failed to update booking status");return n},async getTopRatedLawFirms(r=10){const{data:t,error:s}=await D.from("law_firms").select("*").eq("verified",!0).gte("rating",4).order("rating",{ascending:!1}).limit(r);if(s)throw console.error("Error fetching top-rated law firms:",s),new Error("Failed to fetch top-rated law firms");return t||[]},async getRecentLawFirms(r=5){const{data:t,error:s}=await D.from("law_firms").select("*").eq("verified",!0).order("created_at",{ascending:!1}).limit(r);if(s)throw console.error("Error fetching recent law firms:",s),new Error("Failed to fetch recent law firms");return t||[]}},qL=["Corporate Law","Employment Law","Intellectual Property","Real Estate","Family Law","Criminal Law","Immigration Law","Tax Law","Banking & Finance","Litigation","Mergers & Acquisitions","Compliance & Regulatory"],VL=({onFirmSelect:r,className:t=""})=>{const[s,a]=p.useState([]),[n,i]=p.useState([]),[o,c]=p.useState(!0),[d,h]=p.useState(""),[m,f]=p.useState([]),[g,y]=p.useState(0),[b,w]=p.useState(!1),[S,N]=p.useState("grid"),[v,j]=p.useState("rating"),[C,k]=p.useState(""),[I,T]=p.useState(""),[O,U]=p.useState(""),[A,L]=p.useState(""),[M,se]=p.useState(!1),[W,q]=p.useState(!1);p.useEffect(()=>{K()},[]),p.useEffect(()=>{Y()},[s,d,m,g,b,v,C,I,O,A,M]);const K=async()=>{try{c(!0);const ce=await Ur.getLawFirms();a(ce)}catch(ce){console.error("Error loading law firms:",ce),te.error("Failed to load law firms")}finally{c(!1)}},Y=()=>{let ce=[...s];if(d.trim()){const Re=d.toLowerCase();ce=ce.filter(Qe=>Qe.name.toLowerCase().includes(Re)||Qe.description.toLowerCase().includes(Re)||Qe.practice_areas.some(nt=>nt.toLowerCase().includes(Re))||Qe.address.toLowerCase().includes(Re))}if(m.length>0&&(ce=ce.filter(Re=>m.some(Qe=>Re.practice_areas.includes(Qe)))),g>0&&(ce=ce.filter(Re=>Re.rating>=g)),b&&(ce=ce.filter(Re=>Re.verified)),C.trim()){const Re=C.toLowerCase();ce=ce.filter(Qe=>Qe.address.toLowerCase().includes(Re))}I&&(ce=ce.filter(Re=>Re.firm_size===I)),O&&(ce=ce.filter(Re=>Re.fee_structure===O)),A&&(ce=ce.filter(Re=>{var Qe;return(Qe=Re.languages)==null?void 0:Qe.includes(A)})),M&&(ce=ce.filter(Re=>Re.accepts_legal_aid===!0)),ce.sort((Re,Qe)=>{switch(v){case"rating":return Qe.rating-Re.rating;case"name":return Re.name.localeCompare(Qe.name);case"newest":return new Date(Qe.created_at).getTime()-new Date(Re.created_at).getTime();case"reviews":return(Qe.total_reviews||0)-(Re.total_reviews||0);default:return 0}}),i(ce)},le=ce=>{f(Re=>Re.includes(ce)?Re.filter(Qe=>Qe!==ce):[...Re,ce])},Ne=()=>{h(""),f([]),y(0),w(!1),k(""),T(""),U(""),L(""),se(!1)},Ke=ce=>Array.from({length:5},(Re,Qe)=>e.jsx(Ot,{className:`h-4 w-4 ${Qe<Math.floor(ce)?"text-yellow-400 fill-current":"text-gray-300"}`},Qe)),ke=({firm:ce})=>e.jsxs($,{className:"h-full hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>r==null?void 0:r(ce),children:[e.jsx(Z,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(X,{className:"text-lg font-semibold truncate flex items-center space-x-2",children:[e.jsx("span",{children:ce.name}),ce.verified&&e.jsx(Ri,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[Ke(ce.rating),e.jsx("span",{className:"text-sm text-gray-600 ml-2",children:ce.rating.toFixed(1)})]})]})})}),e.jsxs(z,{className:"space-y-3",children:[e.jsx(ye,{className:"line-clamp-2",children:ce.description}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(ia,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:ce.address})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(Ol,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:ce.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(qa,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:ce.email})]}),ce.website&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(Wg,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:ce.website})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Practice Areas:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[ce.practice_areas.slice(0,3).map(Re=>e.jsx(ae,{variant:"secondary",className:"text-xs",children:Re},Re)),ce.practice_areas.length>3&&e.jsxs(ae,{variant:"secondary",className:"text-xs",children:["+",ce.practice_areas.length-3," more"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[ce.firm_size&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(es,{className:"h-3 w-3"}),e.jsx("span",{className:"capitalize",children:ce.firm_size})]}),ce.consultation_fee&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(DollarSign,{className:"h-3 w-3"}),e.jsxs("span",{children:["$",ce.consultation_fee]})]}),ce.accepts_legal_aid&&e.jsx(ae,{variant:"outline",className:"text-xs",children:"Legal Aid"}),ce.total_reviews&&ce.total_reviews>0&&e.jsxs("span",{children:["(",ce.total_reviews," reviews)"]})]})]})]}),$e=({firm:ce})=>e.jsx($,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>r==null?void 0:r(ce),children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(es,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-sm font-medium truncate",children:ce.name}),ce.verified&&e.jsx(Ri,{className:"h-4 w-4 text-blue-500"})]}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:ce.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsx("span",{children:ce.address}),e.jsx("span",{children:ce.phone})]})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[Ke(ce.rating),e.jsx("span",{className:"text-sm text-gray-600 ml-1",children:ce.rating.toFixed(1)})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:ce.practice_areas.slice(0,2).map((Re,Qe)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:Re},Qe))})]})]})})});return e.jsxs("div",{className:`space-y-6 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Law Firm Directory"}),e.jsx("p",{className:"text-gray-600",children:"Find and connect with verified legal professionals in Singapore"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{variant:S==="grid"?"default":"outline",size:"sm",onClick:()=>N("grid"),children:e.jsx(_m,{className:"h-4 w-4"})}),e.jsx(R,{variant:S==="list"?"default":"outline",size:"sm",onClick:()=>N("list"),children:e.jsx(So,{className:"h-4 w-4"})})]})]}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Pe,{placeholder:"Search law firms...",value:d,onChange:ce=>h(ce.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs(it,{value:v,onValueChange:ce=>j(ce),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Sort by"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"rating",children:"Highest Rated"}),e.jsx(ne,{value:"name",children:"Name A-Z"}),e.jsx(ne,{value:"newest",children:"Newest First"}),e.jsx(ne,{value:"reviews",children:"Most Reviews"})]})]})}),e.jsx(R,{variant:"outline",onClick:()=>q(!W),className:"w-full md:w-auto",children:"Advanced Filters"})]}),W&&e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Location"}),e.jsx(Pe,{placeholder:"Enter location...",value:C,onChange:ce=>k(ce.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Firm Size"}),e.jsxs(it,{value:I,onValueChange:T,children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Any size"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"Any size"}),e.jsx(ne,{value:"solo",children:"Solo Practice"}),e.jsx(ne,{value:"small",children:"Small (2-10 lawyers)"}),e.jsx(ne,{value:"medium",children:"Medium (11-50 lawyers)"}),e.jsx(ne,{value:"large",children:"Large (50+ lawyers)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Fee Structure"}),e.jsxs(it,{value:O,onValueChange:U,children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Any structure"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"Any structure"}),e.jsx(ne,{value:"hourly",children:"Hourly Rate"}),e.jsx(ne,{value:"fixed",children:"Fixed Fee"}),e.jsx(ne,{value:"contingency",children:"Contingency"}),e.jsx(ne,{value:"mixed",children:"Mixed"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Language"}),e.jsxs(it,{value:A,onValueChange:L,children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Any language"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"Any language"}),e.jsx(ne,{value:"English",children:"English"}),e.jsx(ne,{value:"Mandarin",children:"Mandarin"}),e.jsx(ne,{value:"Malay",children:"Malay"}),e.jsx(ne,{value:"Tamil",children:"Tamil"}),e.jsx(ne,{value:"Hindi",children:"Hindi"}),e.jsx(ne,{value:"Japanese",children:"Japanese"}),e.jsx(ne,{value:"Korean",children:"Korean"})]})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:"legal-aid",checked:M,onCheckedChange:se}),e.jsx("label",{htmlFor:"legal-aid",className:"text-sm text-gray-700",children:"Accepts Legal Aid"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Practice Areas"}),e.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:qL.map(ce=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:ce,checked:m.includes(ce),onCheckedChange:()=>le(ce)}),e.jsx("label",{htmlFor:ce,className:"text-sm text-gray-600",children:ce})]},ce))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Minimum Rating"}),e.jsxs(it,{value:g.toString(),onValueChange:ce=>y(Number(ce)),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Any rating"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"0",children:"Any rating"}),e.jsx(ne,{value:"3",children:"3+ stars"}),e.jsx(ne,{value:"4",children:"4+ stars"}),e.jsx(ne,{value:"4.5",children:"4.5+ stars"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Other Filters"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:"verified",checked:b,onCheckedChange:w}),e.jsx("label",{htmlFor:"verified",className:"text-sm text-gray-600",children:"Verified firms only"})]})})]})]}),(d||m.length>0||g>0||b||C||I||O||A||M)&&e.jsx("div",{className:"flex justify-end",children:e.jsx(R,{variant:"outline",size:"sm",onClick:Ne,children:"Clear All Filters"})})]})})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:o?"Loading...":`${n.length} law firm${n.length===1?"":"s"} found`})}),o?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((ce,Re)=>e.jsxs($,{className:"animate-pulse",children:[e.jsxs(Z,{children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})})]},Re))}):n.length>0?S==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(ce=>e.jsx(ke,{firm:ce},ce.id))}):e.jsx("div",{className:"space-y-3",children:n.map(ce=>e.jsx($e,{firm:ce},ce.id))}):e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No law firms found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria or browse different practice areas."})]})})]})]})};function Fn(r,t,{checkForDefaultPrevented:s=!0}={}){return function(n){if(r==null||r(n),s===!1||!n.defaultPrevented)return t==null?void 0:t(n)}}function my(r,t=[]){let s=[];function a(i,o){const c=p.createContext(o),d=s.length;s=[...s,o];const h=f=>{var N;const{scope:g,children:y,...b}=f,w=((N=g==null?void 0:g[r])==null?void 0:N[d])||c,S=p.useMemo(()=>b,Object.values(b));return e.jsx(w.Provider,{value:S,children:y})};h.displayName=i+"Provider";function m(f,g){var w;const y=((w=g==null?void 0:g[r])==null?void 0:w[d])||c,b=p.useContext(y);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[h,m]}const n=()=>{const i=s.map(o=>p.createContext(o));return function(c){const d=(c==null?void 0:c[r])||i;return p.useMemo(()=>({[`__scope${r}`]:{...c,[r]:d}}),[c,d])}};return n.scopeName=r,[a,WL(n,...t)]}function WL(...r){const t=r[0];if(r.length===1)return t;const s=()=>{const a=r.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const o=a.reduce((c,{useScope:d,scopeName:h})=>{const f=d(i)[`__scope${h}`];return{...c,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return s.scopeName=t.scopeName,s}function kj(r,t){if(typeof r=="function")return r(t);r!=null&&(r.current=t)}function hS(...r){return t=>{let s=!1;const a=r.map(n=>{const i=kj(n,t);return!s&&typeof i=="function"&&(s=!0),i});if(s)return()=>{for(let n=0;n<a.length;n++){const i=a[n];typeof i=="function"?i():kj(r[n],null)}}}}function zh(...r){return p.useCallback(hS(...r),r)}function Jx(r){const t=HL(r),s=p.forwardRef((a,n)=>{const{children:i,...o}=a,c=p.Children.toArray(i),d=c.find(KL);if(d){const h=d.props.children,m=c.map(f=>f===d?p.Children.count(h)>1?p.Children.only(null):p.isValidElement(h)?h.props.children:null:f);return e.jsx(t,{...o,ref:n,children:p.isValidElement(h)?p.cloneElement(h,void 0,m):null})}return e.jsx(t,{...o,ref:n,children:i})});return s.displayName=`${r}.Slot`,s}function HL(r){const t=p.forwardRef((s,a)=>{const{children:n,...i}=s;if(p.isValidElement(n)){const o=YL(n),c=QL(i,n.props);return n.type!==p.Fragment&&(c.ref=a?hS(a,o):o),p.cloneElement(n,c)}return p.Children.count(n)>1?p.Children.only(null):null});return t.displayName=`${r}.SlotClone`,t}var GL=Symbol("radix.slottable");function KL(r){return p.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===GL}function QL(r,t){const s={...t};for(const a in t){const n=r[a],i=t[a];/^on[A-Z]/.test(a)?n&&i?s[a]=(...c)=>{const d=i(...c);return n(...c),d}:n&&(s[a]=n):a==="style"?s[a]={...n,...i}:a==="className"&&(s[a]=[n,i].filter(Boolean).join(" "))}return{...r,...s}}function YL(r){var a,n;let t=(a=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:a.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?r.ref:(t=(n=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:n.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}function JL(r){const t=r+"CollectionProvider",[s,a]=my(t),[n,i]=s(t,{collectionRef:{current:null},itemMap:new Map}),o=w=>{const{scope:S,children:N}=w,v=xe.useRef(null),j=xe.useRef(new Map).current;return e.jsx(n,{scope:S,itemMap:j,collectionRef:v,children:N})};o.displayName=t;const c=r+"CollectionSlot",d=Jx(c),h=xe.forwardRef((w,S)=>{const{scope:N,children:v}=w,j=i(c,N),C=zh(S,j.collectionRef);return e.jsx(d,{ref:C,children:v})});h.displayName=c;const m=r+"CollectionItemSlot",f="data-radix-collection-item",g=Jx(m),y=xe.forwardRef((w,S)=>{const{scope:N,children:v,...j}=w,C=xe.useRef(null),k=zh(S,C),I=i(m,N);return xe.useEffect(()=>(I.itemMap.set(C,{ref:C,...j}),()=>void I.itemMap.delete(C))),e.jsx(g,{[f]:"",ref:k,children:v})});y.displayName=m;function b(w){const S=i(r+"CollectionConsumer",w);return xe.useCallback(()=>{const v=S.collectionRef.current;if(!v)return[];const j=Array.from(v.querySelectorAll(`[${f}]`));return Array.from(S.itemMap.values()).sort((I,T)=>j.indexOf(I.ref.current)-j.indexOf(T.ref.current))},[S.collectionRef,S.itemMap])}return[{Provider:o,Slot:h,ItemSlot:y},b,a]}var Bh=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},ZL=P_[" useId ".trim().toString()]||(()=>{}),XL=0;function mS(r){const[t,s]=p.useState(ZL());return Bh(()=>{r||s(a=>a??String(XL++))},[r]),r||(t?`radix-${t}`:"")}var eU=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],lc=eU.reduce((r,t)=>{const s=Jx(`Primitive.${t}`),a=p.forwardRef((n,i)=>{const{asChild:o,...c}=n,d=o?s:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:i})});return a.displayName=`Primitive.${t}`,{...r,[t]:a}},{});function tU(r){const t=p.useRef(r);return p.useEffect(()=>{t.current=r}),p.useMemo(()=>(...s)=>{var a;return(a=t.current)==null?void 0:a.call(t,...s)},[])}var sU=P_[" useInsertionEffect ".trim().toString()]||Bh;function fS({prop:r,defaultProp:t,onChange:s=()=>{},caller:a}){const[n,i,o]=rU({defaultProp:t,onChange:s}),c=r!==void 0,d=c?r:n;{const m=p.useRef(r!==void 0);p.useEffect(()=>{const f=m.current;f!==c&&console.warn(`${a} is changing from ${f?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=c},[c,a])}const h=p.useCallback(m=>{var f;if(c){const g=aU(m)?m(r):m;g!==r&&((f=o.current)==null||f.call(o,g))}else i(m)},[c,r,i,o]);return[d,h]}function rU({defaultProp:r,onChange:t}){const[s,a]=p.useState(r),n=p.useRef(s),i=p.useRef(t);return sU(()=>{i.current=t},[t]),p.useEffect(()=>{var o;n.current!==s&&((o=i.current)==null||o.call(i,s),n.current=s)},[s,n]),[s,a,i]}function aU(r){return typeof r=="function"}var nU=p.createContext(void 0);function pS(r){const t=p.useContext(nU);return r||t||"ltr"}var Dp="rovingFocusGroup.onEntryFocus",iU={bubbles:!1,cancelable:!0},$d="RovingFocusGroup",[Zx,xS,oU]=JL($d),[lU,gS]=my($d,[oU]),[cU,dU]=lU($d),yS=p.forwardRef((r,t)=>e.jsx(Zx.Provider,{scope:r.__scopeRovingFocusGroup,children:e.jsx(Zx.Slot,{scope:r.__scopeRovingFocusGroup,children:e.jsx(uU,{...r,ref:t})})}));yS.displayName=$d;var uU=p.forwardRef((r,t)=>{const{__scopeRovingFocusGroup:s,orientation:a,loop:n=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:h,preventScrollOnEntryFocus:m=!1,...f}=r,g=p.useRef(null),y=zh(t,g),b=pS(i),[w,S]=fS({prop:o,defaultProp:c??null,onChange:d,caller:$d}),[N,v]=p.useState(!1),j=tU(h),C=xS(s),k=p.useRef(!1),[I,T]=p.useState(0);return p.useEffect(()=>{const O=g.current;if(O)return O.addEventListener(Dp,j),()=>O.removeEventListener(Dp,j)},[j]),e.jsx(cU,{scope:s,orientation:a,dir:b,loop:n,currentTabStopId:w,onItemFocus:p.useCallback(O=>S(O),[S]),onItemShiftTab:p.useCallback(()=>v(!0),[]),onFocusableItemAdd:p.useCallback(()=>T(O=>O+1),[]),onFocusableItemRemove:p.useCallback(()=>T(O=>O-1),[]),children:e.jsx(lc.div,{tabIndex:N||I===0?-1:0,"data-orientation":a,...f,ref:y,style:{outline:"none",...r.style},onMouseDown:Fn(r.onMouseDown,()=>{k.current=!0}),onFocus:Fn(r.onFocus,O=>{const U=!k.current;if(O.target===O.currentTarget&&U&&!N){const A=new CustomEvent(Dp,iU);if(O.currentTarget.dispatchEvent(A),!A.defaultPrevented){const L=C().filter(K=>K.focusable),M=L.find(K=>K.active),se=L.find(K=>K.id===w),q=[M,se,...L].filter(Boolean).map(K=>K.ref.current);jS(q,m)}}k.current=!1}),onBlur:Fn(r.onBlur,()=>v(!1))})})}),vS="RovingFocusGroupItem",wS=p.forwardRef((r,t)=>{const{__scopeRovingFocusGroup:s,focusable:a=!0,active:n=!1,tabStopId:i,children:o,...c}=r,d=mS(),h=i||d,m=dU(vS,s),f=m.currentTabStopId===h,g=xS(s),{onFocusableItemAdd:y,onFocusableItemRemove:b,currentTabStopId:w}=m;return p.useEffect(()=>{if(a)return y(),()=>b()},[a,y,b]),e.jsx(Zx.ItemSlot,{scope:s,id:h,focusable:a,active:n,children:e.jsx(lc.span,{tabIndex:f?0:-1,"data-orientation":m.orientation,...c,ref:t,onMouseDown:Fn(r.onMouseDown,S=>{a?m.onItemFocus(h):S.preventDefault()}),onFocus:Fn(r.onFocus,()=>m.onItemFocus(h)),onKeyDown:Fn(r.onKeyDown,S=>{if(S.key==="Tab"&&S.shiftKey){m.onItemShiftTab();return}if(S.target!==S.currentTarget)return;const N=fU(S,m.orientation,m.dir);if(N!==void 0){if(S.metaKey||S.ctrlKey||S.altKey||S.shiftKey)return;S.preventDefault();let j=g().filter(C=>C.focusable).map(C=>C.ref.current);if(N==="last")j.reverse();else if(N==="prev"||N==="next"){N==="prev"&&j.reverse();const C=j.indexOf(S.currentTarget);j=m.loop?pU(j,C+1):j.slice(C+1)}setTimeout(()=>jS(j))}}),children:typeof o=="function"?o({isCurrentTabStop:f,hasTabStop:w!=null}):o})})});wS.displayName=vS;var hU={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function mU(r,t){return t!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function fU(r,t,s){const a=mU(r.key,s);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return hU[a]}function jS(r,t=!1){const s=document.activeElement;for(const a of r)if(a===s||(a.focus({preventScroll:t}),document.activeElement!==s))return}function pU(r,t){return r.map((s,a)=>r[(t+a)%r.length])}var xU=yS,gU=wS;function yU(r,t){return p.useReducer((s,a)=>t[s][a]??s,r)}var bS=r=>{const{present:t,children:s}=r,a=vU(t),n=typeof s=="function"?s({present:a.isPresent}):p.Children.only(s),i=zh(a.ref,wU(n));return typeof s=="function"||a.isPresent?p.cloneElement(n,{ref:i}):null};bS.displayName="Presence";function vU(r){const[t,s]=p.useState(),a=p.useRef(null),n=p.useRef(r),i=p.useRef("none"),o=r?"mounted":"unmounted",[c,d]=yU(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const h=Zu(a.current);i.current=c==="mounted"?h:"none"},[c]),Bh(()=>{const h=a.current,m=n.current;if(m!==r){const g=i.current,y=Zu(h);r?d("MOUNT"):y==="none"||(h==null?void 0:h.display)==="none"?d("UNMOUNT"):d(m&&g!==y?"ANIMATION_OUT":"UNMOUNT"),n.current=r}},[r,d]),Bh(()=>{if(t){let h;const m=t.ownerDocument.defaultView??window,f=y=>{const w=Zu(a.current).includes(y.animationName);if(y.target===t&&w&&(d("ANIMATION_END"),!n.current)){const S=t.style.animationFillMode;t.style.animationFillMode="forwards",h=m.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=S)})}},g=y=>{y.target===t&&(i.current=Zu(a.current))};return t.addEventListener("animationstart",g),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{m.clearTimeout(h),t.removeEventListener("animationstart",g),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:p.useCallback(h=>{a.current=h?getComputedStyle(h):null,s(h)},[])}}function Zu(r){return(r==null?void 0:r.animationName)||"none"}function wU(r){var a,n;let t=(a=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:a.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?r.ref:(t=(n=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:n.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}var zm="Tabs",[jU,OW]=my(zm,[gS]),_S=gS(),[bU,fy]=jU(zm),NS=p.forwardRef((r,t)=>{const{__scopeTabs:s,value:a,onValueChange:n,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:d="automatic",...h}=r,m=pS(c),[f,g]=fS({prop:a,onChange:n,defaultProp:i??"",caller:zm});return e.jsx(bU,{scope:s,baseId:mS(),value:f,onValueChange:g,orientation:o,dir:m,activationMode:d,children:e.jsx(lc.div,{dir:m,"data-orientation":o,...h,ref:t})})});NS.displayName=zm;var SS="TabsList",kS=p.forwardRef((r,t)=>{const{__scopeTabs:s,loop:a=!0,...n}=r,i=fy(SS,s),o=_S(s);return e.jsx(xU,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:a,children:e.jsx(lc.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:t})})});kS.displayName=SS;var CS="TabsTrigger",ES=p.forwardRef((r,t)=>{const{__scopeTabs:s,value:a,disabled:n=!1,...i}=r,o=fy(CS,s),c=_S(s),d=RS(o.baseId,a),h=PS(o.baseId,a),m=a===o.value;return e.jsx(gU,{asChild:!0,...c,focusable:!n,active:m,children:e.jsx(lc.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":h,"data-state":m?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:d,...i,ref:t,onMouseDown:Fn(r.onMouseDown,f=>{!n&&f.button===0&&f.ctrlKey===!1?o.onValueChange(a):f.preventDefault()}),onKeyDown:Fn(r.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(a)}),onFocus:Fn(r.onFocus,()=>{const f=o.activationMode!=="manual";!m&&!n&&f&&o.onValueChange(a)})})})});ES.displayName=CS;var AS="TabsContent",TS=p.forwardRef((r,t)=>{const{__scopeTabs:s,value:a,forceMount:n,children:i,...o}=r,c=fy(AS,s),d=RS(c.baseId,a),h=PS(c.baseId,a),m=a===c.value,f=p.useRef(m);return p.useEffect(()=>{const g=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(g)},[]),e.jsx(bS,{present:n||m,children:({present:g})=>e.jsx(lc.div,{"data-state":m?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!g,id:h,tabIndex:0,...o,ref:t,style:{...r.style,animationDuration:f.current?"0s":void 0},children:g&&i})})});TS.displayName=AS;function RS(r,t){return`${r}-trigger-${t}`}function PS(r,t){return`${r}-content-${t}`}var _U=NS,IS=kS,DS=ES,FS=TS;const fr=_U,nr=p.forwardRef(({className:r,...t},s)=>e.jsx(IS,{ref:s,className:Ie("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...t}));nr.displayName=IS.displayName;const Ge=p.forwardRef(({className:r,...t},s)=>e.jsx(DS,{ref:s,className:Ie("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...t}));Ge.displayName=DS.displayName;const He=p.forwardRef(({className:r,...t},s)=>e.jsx(FS,{ref:s,className:Ie("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...t}));He.displayName=FS.displayName;var py="Avatar",[NU,MW]=Io(py),[SU,OS]=NU(py),MS=p.forwardRef((r,t)=>{const{__scopeAvatar:s,...a}=r,[n,i]=p.useState("idle");return e.jsx(SU,{scope:s,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:e.jsx(zt.span,{...a,ref:t})})});MS.displayName=py;var LS="AvatarImage",US=p.forwardRef((r,t)=>{const{__scopeAvatar:s,src:a,onLoadingStatusChange:n=()=>{},...i}=r,o=OS(LS,s),c=kU(a,i.referrerPolicy),d=Fl(h=>{n(h),o.onImageLoadingStatusChange(h)});return Va(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?e.jsx(zt.img,{...i,ref:t,src:a}):null});US.displayName=LS;var $S="AvatarFallback",zS=p.forwardRef((r,t)=>{const{__scopeAvatar:s,delayMs:a,...n}=r,i=OS($S,s),[o,c]=p.useState(a===void 0);return p.useEffect(()=>{if(a!==void 0){const d=window.setTimeout(()=>c(!0),a);return()=>window.clearTimeout(d)}},[a]),o&&i.imageLoadingStatus!=="loaded"?e.jsx(zt.span,{...n,ref:t}):null});zS.displayName=$S;function kU(r,t){const[s,a]=p.useState("idle");return Va(()=>{if(!r){a("error");return}let n=!0;const i=new window.Image,o=c=>()=>{n&&a(c)};return a("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=r,t&&(i.referrerPolicy=t),()=>{n=!1}},[r,t]),s}var BS=MS,qS=US,VS=zS;const zr=p.forwardRef(({className:r,...t},s)=>e.jsx(BS,{ref:s,className:Ie("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...t}));zr.displayName=BS.displayName;const $n=p.forwardRef(({className:r,...t},s)=>e.jsx(qS,{ref:s,className:Ie("aspect-square h-full w-full",r),...t}));$n.displayName=qS.displayName;const Br=p.forwardRef(({className:r,...t},s)=>e.jsx(VS,{ref:s,className:Ie("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...t}));Br.displayName=VS.displayName;function rr(r){const t=Object.prototype.toString.call(r);return r instanceof Date||typeof r=="object"&&t==="[object Date]"?new r.constructor(+r):typeof r=="number"||t==="[object Number]"||typeof r=="string"||t==="[object String]"?new Date(r):new Date(NaN)}function CU(r,t){return r instanceof Date?new r.constructor(t):new Date(t)}const LW=6048e5,UW=864e5,Xu=43200,Cj=1440;let EU={};function AU(){return EU}function Ej(r){const t=rr(r),s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return s.setUTCFullYear(t.getFullYear()),+r-+s}function jh(r,t){const s=rr(r),a=rr(t),n=s.getTime()-a.getTime();return n<0?-1:n>0?1:n}function TU(r){return CU(r,Date.now())}function RU(r,t){const s=rr(r),a=rr(t),n=s.getFullYear()-a.getFullYear(),i=s.getMonth()-a.getMonth();return n*12+i}function PU(r){return t=>{const a=(r?Math[r]:Math.trunc)(t);return a===0?0:a}}function IU(r,t){return+rr(r)-+rr(t)}function DU(r){const t=rr(r);return t.setHours(23,59,59,999),t}function FU(r){const t=rr(r),s=t.getMonth();return t.setFullYear(t.getFullYear(),s+1,0),t.setHours(23,59,59,999),t}function OU(r){const t=rr(r);return+DU(t)==+FU(t)}function MU(r,t){const s=rr(r),a=rr(t),n=jh(s,a),i=Math.abs(RU(s,a));let o;if(i<1)o=0;else{s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-n*i);let c=jh(s,a)===-n;OU(rr(r))&&i===1&&jh(r,a)===1&&(c=!1),o=n*(i-Number(c))}return o===0?0:o}function LU(r,t,s){const a=IU(r,t)/1e3;return PU(s==null?void 0:s.roundingMethod)(a)}const UU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},$U=(r,t,s)=>{let a;const n=UU[r];return typeof n=="string"?a=n:t===1?a=n.one:a=n.other.replace("{{count}}",t.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};function Fp(r){return(t={})=>{const s=t.width?String(t.width):r.defaultWidth;return r.formats[s]||r.formats[r.defaultWidth]}}const zU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},BU={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qU={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},VU={date:Fp({formats:zU,defaultWidth:"full"}),time:Fp({formats:BU,defaultWidth:"full"}),dateTime:Fp({formats:qU,defaultWidth:"full"})},WU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},HU=(r,t,s,a)=>WU[r];function Rc(r){return(t,s)=>{const a=s!=null&&s.context?String(s.context):"standalone";let n;if(a==="formatting"&&r.formattingValues){const o=r.defaultFormattingWidth||r.defaultWidth,c=s!=null&&s.width?String(s.width):o;n=r.formattingValues[c]||r.formattingValues[o]}else{const o=r.defaultWidth,c=s!=null&&s.width?String(s.width):r.defaultWidth;n=r.values[c]||r.values[o]}const i=r.argumentCallback?r.argumentCallback(t):t;return n[i]}}const GU={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},KU={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},QU={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},YU={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},JU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ZU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},XU=(r,t)=>{const s=Number(r),a=s%100;if(a>20||a<10)switch(a%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},e$={ordinalNumber:XU,era:Rc({values:GU,defaultWidth:"wide"}),quarter:Rc({values:KU,defaultWidth:"wide",argumentCallback:r=>r-1}),month:Rc({values:QU,defaultWidth:"wide"}),day:Rc({values:YU,defaultWidth:"wide"}),dayPeriod:Rc({values:JU,defaultWidth:"wide",formattingValues:ZU,defaultFormattingWidth:"wide"})};function Pc(r){return(t,s={})=>{const a=s.width,n=a&&r.matchPatterns[a]||r.matchPatterns[r.defaultMatchWidth],i=t.match(n);if(!i)return null;const o=i[0],c=a&&r.parsePatterns[a]||r.parsePatterns[r.defaultParseWidth],d=Array.isArray(c)?s$(c,f=>f.test(o)):t$(c,f=>f.test(o));let h;h=r.valueCallback?r.valueCallback(d):d,h=s.valueCallback?s.valueCallback(h):h;const m=t.slice(o.length);return{value:h,rest:m}}}function t$(r,t){for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s)&&t(r[s]))return s}function s$(r,t){for(let s=0;s<r.length;s++)if(t(r[s]))return s}function r$(r){return(t,s={})=>{const a=t.match(r.matchPattern);if(!a)return null;const n=a[0],i=t.match(r.parsePattern);if(!i)return null;let o=r.valueCallback?r.valueCallback(i[0]):i[0];o=s.valueCallback?s.valueCallback(o):o;const c=t.slice(n.length);return{value:o,rest:c}}}const a$=/^(\d+)(th|st|nd|rd)?/i,n$=/\d+/i,i$={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},o$={any:[/^b/i,/^(a|c)/i]},l$={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},c$={any:[/1/i,/2/i,/3/i,/4/i]},d$={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},u$={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},h$={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},m$={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},f$={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},p$={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},x$={ordinalNumber:r$({matchPattern:a$,parsePattern:n$,valueCallback:r=>parseInt(r,10)}),era:Pc({matchPatterns:i$,defaultMatchWidth:"wide",parsePatterns:o$,defaultParseWidth:"any"}),quarter:Pc({matchPatterns:l$,defaultMatchWidth:"wide",parsePatterns:c$,defaultParseWidth:"any",valueCallback:r=>r+1}),month:Pc({matchPatterns:d$,defaultMatchWidth:"wide",parsePatterns:u$,defaultParseWidth:"any"}),day:Pc({matchPatterns:h$,defaultMatchWidth:"wide",parsePatterns:m$,defaultParseWidth:"any"}),dayPeriod:Pc({matchPatterns:f$,defaultMatchWidth:"any",parsePatterns:p$,defaultParseWidth:"any"})},g$={code:"en-US",formatDistance:$U,formatLong:VU,formatRelative:HU,localize:e$,match:x$,options:{weekStartsOn:0,firstWeekContainsDate:1}};function y$(r,t,s){const a=AU(),n=(s==null?void 0:s.locale)??a.locale??g$,i=2520,o=jh(r,t);if(isNaN(o))throw new RangeError("Invalid time value");const c=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:o});let d,h;o>0?(d=rr(t),h=rr(r)):(d=rr(r),h=rr(t));const m=LU(h,d),f=(Ej(h)-Ej(d))/1e3,g=Math.round((m-f)/60);let y;if(g<2)return s!=null&&s.includeSeconds?m<5?n.formatDistance("lessThanXSeconds",5,c):m<10?n.formatDistance("lessThanXSeconds",10,c):m<20?n.formatDistance("lessThanXSeconds",20,c):m<40?n.formatDistance("halfAMinute",0,c):m<60?n.formatDistance("lessThanXMinutes",1,c):n.formatDistance("xMinutes",1,c):g===0?n.formatDistance("lessThanXMinutes",1,c):n.formatDistance("xMinutes",g,c);if(g<45)return n.formatDistance("xMinutes",g,c);if(g<90)return n.formatDistance("aboutXHours",1,c);if(g<Cj){const b=Math.round(g/60);return n.formatDistance("aboutXHours",b,c)}else{if(g<i)return n.formatDistance("xDays",1,c);if(g<Xu){const b=Math.round(g/Cj);return n.formatDistance("xDays",b,c)}else if(g<Xu*2)return y=Math.round(g/Xu),n.formatDistance("aboutXMonths",y,c)}if(y=MU(h,d),y<12){const b=Math.round(g/Xu);return n.formatDistance("xMonths",b,c)}else{const b=y%12,w=Math.trunc(y/12);return b<3?n.formatDistance("aboutXYears",w,c):b<9?n.formatDistance("overXYears",w,c):n.formatDistance("almostXYears",w+1,c)}}function Vt(r,t){return y$(r,TU(r),t)}const v$=({lawFirmId:r,reviews:t})=>{const{user:s}=ft(),[a,n]=p.useState(t),[i,o]=p.useState(!1),[c,d]=p.useState(!1),h=N=>Array.from({length:5},(v,j)=>e.jsx(Ot,{className:`h-4 w-4 ${j<Math.floor(N)?"text-yellow-400 fill-current":"text-gray-300"}`},j)),m=N=>N.split(" ").map(v=>v[0]).join("").toUpperCase().slice(0,2),f=()=>{const N={5:0,4:0,3:0,2:0,1:0};return a.forEach(v=>{N[v.rating]++}),N},g=async(N,v)=>{if(!s){te.error("Please log in to vote on reviews");return}try{await Ur.voteOnReview(N,v);const j=await Ur.getLawFirmReviews(r);n(j),te.success("Thank you for your feedback!")}catch(j){console.error("Error voting on review:",j),te.error("Failed to submit vote")}},y=async()=>{try{o(!0);const N=await Ur.getLawFirmReviews(r);n(N)}catch(N){console.error("Error loading reviews:",N),te.error("Failed to load reviews")}finally{o(!1)}};p.useEffect(()=>{n(t)},[t]);const b=f(),w=a.length,S=w>0?a.reduce((N,v)=>N+v.rating,0)/w:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between",children:[e.jsx(X,{children:"Client Reviews"}),s&&e.jsxs(R,{onClick:()=>d(!0),children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Write Review"]})]}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:S.toFixed(1)}),e.jsx("div",{className:"flex items-center justify-center space-x-1 mb-2",children:h(S)}),e.jsxs("p",{className:"text-gray-600",children:["Based on ",w," review",w!==1?"s":""]})]}),e.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(N=>{const v=b[N],j=w>0?v/w*100:0;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm w-8",children:N}),e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-400 h-2 rounded-full",style:{width:`${j}%`}})}),e.jsx("span",{className:"text-sm text-gray-600 w-8",children:v})]},N)})})]})})]}),e.jsx("div",{className:"space-y-4",children:a.length>0?a.map(N=>{var v;return e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(zr,{children:e.jsx(Br,{children:N.user?m(N.user.full_name):"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:((v=N.user)==null?void 0:v.full_name)||"Anonymous"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center space-x-1",children:h(N.rating)}),e.jsx("span",{className:"text-sm text-gray-500",children:Vt(new Date(N.created_at),{addSuffix:!0})}),N.verified_client&&e.jsx(ae,{variant:"outline",className:"text-xs",children:"Verified Client"})]})]})}),e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:N.title}),e.jsx("p",{className:"text-gray-700 mb-3",children:N.content}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(R,{variant:"ghost",size:"sm",className:"text-gray-500",onClick:()=>g(N.id,!0),disabled:!s,children:[e.jsx(pd,{className:"h-4 w-4 mr-1"}),"Helpful (",N.helpful_count,")"]})})]})]})})},N.id)}):e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Ft,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No reviews yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Be the first to review this law firm."}),s&&e.jsxs(R,{onClick:()=>d(!0),children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Write First Review"]})]})})}),a.length>0&&a.length>=5&&e.jsx("div",{className:"text-center",children:e.jsx(R,{variant:"outline",onClick:y,disabled:i,children:i?"Loading...":"Load All Reviews"})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsx(Z,{children:e.jsx(X,{children:"Write a Review"})}),e.jsxs(z,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Review form will be implemented in the next phase."}),e.jsx(R,{onClick:()=>d(!1),className:"w-full",children:"Close"})]})]})})]})};var w$="Label",WS=p.forwardRef((r,t)=>e.jsx(zt.label,{...r,ref:t,onMouseDown:s=>{var n;s.target.closest("button, input, select, textarea")||((n=r.onMouseDown)==null||n.call(r,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));WS.displayName=w$;var HS=WS;const j$=tc("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Te=p.forwardRef(({className:r,...t},s)=>e.jsx(HS,{ref:s,className:Ie(j$(),r),...t}));Te.displayName=HS.displayName;const b$=({lawFirm:r,teamMembers:t,onClose:s,onBookingCreated:a})=>{const{user:n}=ft(),[i,o]=p.useState(!1),[c,d]=p.useState({consultation_type:"initial",team_member_id:"",preferred_date:"",preferred_time:"",duration_minutes:60,message:"",contact_phone:"",alternative_dates:["",""],special_requirements:"",meeting_type:"in_person"});p.useState([]),p.useState(!1);const h=async f=>{if(f.preventDefault(),!n){te.error("Please log in to book a consultation");return}try{o(!0),await Ur.createBooking({law_firm_id:r.id,user_id:n.id,team_member_id:c.team_member_id||void 0,consultation_type:c.consultation_type,preferred_date:c.preferred_date,preferred_time:c.preferred_time,duration_minutes:c.duration_minutes,message:c.message||void 0,contact_phone:c.contact_phone||void 0,status:"pending"}),a()}catch(g){console.error("Error creating booking:",g),te.error("Failed to create booking. Please try again.")}finally{o(!1)}},m=(f,g)=>{d(y=>({...y,[f]:g}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs($,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between",children:[e.jsx(X,{children:"Book Consultation"}),e.jsx(R,{variant:"ghost",size:"sm",onClick:s,children:e.jsx(Vs,{className:"h-4 w-4"})})]}),e.jsx(z,{children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-sm text-gray-600",children:r.address})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"consultation_type",children:"Consultation Type"}),e.jsxs(it,{value:c.consultation_type,onValueChange:f=>m("consultation_type",f),children:[e.jsx(rt,{children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"initial",children:"Initial Consultation"}),e.jsx(ne,{value:"follow_up",children:"Follow-up Meeting"}),e.jsx(ne,{value:"document_review",children:"Document Review"})]})]})]}),t.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"team_member",children:"Preferred Lawyer (Optional)"}),e.jsxs(it,{value:c.team_member_id,onValueChange:f=>m("team_member_id",f),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Any available lawyer"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"Any available lawyer"}),t.map(f=>e.jsxs(ne,{value:f.id,children:[f.name," - ",f.title]},f.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"preferred_date",children:"Preferred Date"}),e.jsx(Pe,{id:"preferred_date",type:"date",value:c.preferred_date,onChange:f=>m("preferred_date",f.target.value),min:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"preferred_time",children:"Preferred Time"}),e.jsx(Pe,{id:"preferred_time",type:"time",value:c.preferred_time,onChange:f=>m("preferred_time",f.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"duration",children:"Duration"}),e.jsxs(it,{value:c.duration_minutes.toString(),onValueChange:f=>m("duration_minutes",parseInt(f)),children:[e.jsx(rt,{children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"30",children:"30 minutes"}),e.jsx(ne,{value:"60",children:"1 hour"}),e.jsx(ne,{value:"90",children:"1.5 hours"}),e.jsx(ne,{value:"120",children:"2 hours"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"contact_phone",children:"Contact Phone (Optional)"}),e.jsx(Pe,{id:"contact_phone",type:"tel",value:c.contact_phone,onChange:f=>m("contact_phone",f.target.value),placeholder:"Your phone number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"meeting_type",children:"Meeting Type"}),e.jsxs(it,{value:c.meeting_type,onValueChange:f=>m("meeting_type",f),children:[e.jsx(rt,{children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"in_person",children:"In-Person Meeting"}),e.jsx(ne,{value:"video_call",children:"Video Call"}),e.jsx(ne,{value:"phone_call",children:"Phone Call"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{children:"Alternative Dates (Optional)"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Provide alternative dates in case your preferred time is not available"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(Pe,{type:"date",value:c.alternative_dates[0],onChange:f=>{const g=[...c.alternative_dates];g[0]=f.target.value,m("alternative_dates",g)},min:new Date().toISOString().split("T")[0]}),e.jsx(Pe,{type:"date",value:c.alternative_dates[1],onChange:f=>{const g=[...c.alternative_dates];g[1]=f.target.value,m("alternative_dates",g)},min:new Date().toISOString().split("T")[0]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"message",children:"Message (Optional)"}),e.jsx(Sr,{id:"message",value:c.message,onChange:f=>m("message",f.target.value),placeholder:"Brief description of your legal matter...",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"special_requirements",children:"Special Requirements (Optional)"}),e.jsx(Sr,{id:"special_requirements",value:c.special_requirements,onChange:f=>m("special_requirements",f.target.value),placeholder:"Any accessibility needs, language preferences, or other special requirements...",rows:2})]}),r.consultation_fee&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Consultation Fee:"})," $",r.consultation_fee]})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(R,{type:"button",variant:"outline",onClick:s,className:"flex-1",disabled:i,children:"Cancel"}),e.jsx(R,{type:"submit",className:"flex-1",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Booking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Book Consultation"]})})]})]})})]})})},_$=({images:r})=>{const[t,s]=p.useState(null),a=c=>{s(c)},n=()=>{s(null)},i=c=>{t!==null&&s(c==="prev"?t>0?t-1:r.length-1:t<r.length-1?t+1:0)},o=c=>{c.key==="Escape"?n():c.key==="ArrowLeft"?i("prev"):c.key==="ArrowRight"&&i("next")};return r.length===0?e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",children:"📷"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No gallery images"}),e.jsx("p",{className:"text-gray-500",children:"Gallery images have not been added yet."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map((c,d)=>e.jsxs($,{className:"overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>a(d),children:[e.jsx("div",{className:"aspect-video relative",children:e.jsx("img",{src:c.image_url,alt:c.alt_text||c.caption||`Gallery image ${d+1}`,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-200"})}),c.caption&&e.jsx(z,{className:"p-3",children:e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:c.caption})})]},c.id))}),t!==null&&e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:n,onKeyDown:o,tabIndex:0,children:[e.jsx(R,{variant:"ghost",size:"sm",className:"absolute top-4 right-4 text-white hover:bg-white/20 z-10",onClick:n,children:e.jsx(Vs,{className:"h-6 w-6"})}),r.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(R,{variant:"ghost",size:"sm",className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:bg-white/20 z-10",onClick:c=>{c.stopPropagation(),i("prev")},children:e.jsx(M5,{className:"h-8 w-8"})}),e.jsx(R,{variant:"ghost",size:"sm",className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:bg-white/20 z-10",onClick:c=>{c.stopPropagation(),i("next")},children:e.jsx(aN,{className:"h-8 w-8"})})]}),e.jsxs("div",{className:"max-w-4xl max-h-[80vh] mx-4",onClick:c=>c.stopPropagation(),children:[e.jsx("img",{src:r[t].image_url,alt:r[t].alt_text||r[t].caption||`Gallery image ${t+1}`,className:"max-w-full max-h-full object-contain"}),r[t].caption&&e.jsx("div",{className:"bg-black/50 text-white p-4 mt-2 rounded",children:e.jsx("p",{className:"text-center",children:r[t].caption})})]}),r.length>1&&e.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-3 py-1 rounded",children:[t+1," / ",r.length]})]})]})},N$=({lawFirm:r,onClose:t,onMessageSent:s})=>{var m;const{user:a}=ft(),[n,i]=p.useState(!1),[o,c]=p.useState({name:((m=a==null?void 0:a.user_metadata)==null?void 0:m.full_name)||"",email:(a==null?void 0:a.email)||"",phone:"",subject:"",message:"",inquiry_type:"general",preferred_contact_method:"email",urgent:!1,consent_to_contact:!1}),d=async f=>{if(f.preventDefault(),!o.consent_to_contact){te.error("Please consent to being contacted");return}try{i(!0),await new Promise(g=>setTimeout(g,1e3)),te.success("Message sent successfully! The law firm will contact you soon."),s()}catch(g){console.error("Error sending message:",g),te.error("Failed to send message. Please try again.")}finally{i(!1)}},h=(f,g)=>{c(y=>({...y,[f]:g}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs($,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between",children:[e.jsxs(X,{children:["Contact ",r.name]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:t,children:e.jsx(Vs,{className:"h-4 w-4"})})]}),e.jsx(z,{children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:r.name}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ol,{className:"h-4 w-4"}),e.jsx("span",{children:r.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qa,{className:"h-4 w-4"}),e.jsx("span",{children:r.email})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"name",children:"Full Name *"}),e.jsx(Pe,{id:"name",value:o.name,onChange:f=>h("name",f.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"email",children:"Email Address *"}),e.jsx(Pe,{id:"email",type:"email",value:o.email,onChange:f=>h("email",f.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"phone",children:"Phone Number"}),e.jsx(Pe,{id:"phone",type:"tel",value:o.phone,onChange:f=>h("phone",f.target.value),placeholder:"Your phone number"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"inquiry_type",children:"Type of Inquiry"}),e.jsxs(it,{value:o.inquiry_type,onValueChange:f=>h("inquiry_type",f),children:[e.jsx(rt,{children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"general",children:"General Inquiry"}),e.jsx(ne,{value:"consultation",children:"Consultation Request"}),e.jsx(ne,{value:"case_evaluation",children:"Case Evaluation"}),e.jsx(ne,{value:"document_review",children:"Document Review"}),e.jsx(ne,{value:"legal_advice",children:"Legal Advice"}),e.jsx(ne,{value:"representation",children:"Legal Representation"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"preferred_contact",children:"Preferred Contact Method"}),e.jsxs(it,{value:o.preferred_contact_method,onValueChange:f=>h("preferred_contact_method",f),children:[e.jsx(rt,{children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"email",children:"Email"}),e.jsx(ne,{value:"phone",children:"Phone Call"}),e.jsx(ne,{value:"either",children:"Either"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"subject",children:"Subject *"}),e.jsx(Pe,{id:"subject",value:o.subject,onChange:f=>h("subject",f.target.value),placeholder:"Brief description of your legal matter",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"message",children:"Message *"}),e.jsx(Sr,{id:"message",value:o.message,onChange:f=>h("message",f.target.value),placeholder:"Please provide details about your legal matter, including any relevant dates, parties involved, and specific questions you have...",rows:5,required:!0})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:"urgent",checked:o.urgent,onCheckedChange:f=>h("urgent",f)}),e.jsx("label",{htmlFor:"urgent",className:"text-sm text-gray-700",children:"This is an urgent matter requiring immediate attention"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:"consent",checked:o.consent_to_contact,onCheckedChange:f=>h("consent_to_contact",f)}),e.jsxs("label",{htmlFor:"consent",className:"text-sm text-gray-700",children:["I consent to being contacted by ",r.name," regarding my inquiry *"]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg text-sm text-yellow-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Important Notice:"}),e.jsx("p",{children:"This form is for initial inquiries only. Do not include confidential or sensitive information. An attorney-client relationship is not formed until a formal agreement is signed."})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(R,{type:"button",variant:"outline",onClick:t,className:"flex-1",disabled:n,children:"Cancel"}),e.jsx(R,{type:"submit",className:"flex-1",disabled:n||!o.consent_to_contact,children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qa,{className:"h-4 w-4 mr-2"}),"Send Message"]})})]})]})})]})})},GS=({firmId:r,onBack:t,className:s=""})=>{var L,M,se,W;const{id:a}=Fi(),n=ps(),i=r||a,[o,c]=p.useState(null),[d,h]=p.useState([]),[m,f]=p.useState([]),[g,y]=p.useState([]),[b,w]=p.useState(!0),[S,N]=p.useState(!1),[v,j]=p.useState(!1),[C,k]=p.useState("overview");p.useEffect(()=>{i&&I()},[i]);const I=async()=>{if(i)try{w(!0);const q=await Ur.getLawFirmProfile(i);c(q),h(q.team_members||[]),f(q.gallery||[]),y(q.recent_reviews||[])}catch(q){console.error("Error loading law firm profile:",q),te.error("Failed to load law firm profile")}finally{w(!1)}},T=q=>Array.from({length:5},(K,Y)=>e.jsx(Ot,{className:`h-4 w-4 ${Y<Math.floor(q)?"text-yellow-400 fill-current":"text-gray-300"}`},Y)),O=()=>{const q={5:0,4:0,3:0,2:0,1:0};return g.forEach(K=>{q[K.rating]++}),q},U=q=>{if(!q)return"Hours not specified";const K=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Y=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return K.map((le,Ne)=>q[le]?`${Y[Ne]}: ${q[le]}`:null).filter(Boolean).join(", ")||"Hours not specified"};if(b)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading law firm profile..."})]})});if(!o)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Law Firm Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The law firm you're looking for doesn't exist or has been removed."}),e.jsxs(R,{onClick:()=>n("/law-firms"),children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to Directory"]})]})});O();const A=g.length;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"relative h-64 bg-gradient-to-r from-blue-600 to-blue-800",children:[o.cover_image_url&&e.jsx("img",{src:o.cover_image_url,alt:`${o.name} cover`,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40"}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsxs(R,{variant:"secondary",size:"sm",onClick:()=>t?t():n("/law-firms"),className:"bg-white/90 hover:bg-white",children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to Directory"]})}),e.jsxs("div",{className:"absolute top-4 right-4 flex space-x-2",children:[e.jsx(R,{variant:"secondary",size:"sm",className:"bg-white/90 hover:bg-white",children:e.jsx(oN,{className:"h-4 w-4"})}),e.jsx(R,{variant:"secondary",size:"sm",className:"bg-white/90 hover:bg-white",children:e.jsx(Od,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"relative -mt-16 mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx($,{className:"bg-white shadow-lg",children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:space-x-6",children:[e.jsx("div",{className:"flex-shrink-0 mb-4 md:mb-0",children:e.jsxs(zr,{className:"h-24 w-24 border-4 border-white shadow-lg",children:[e.jsx($n,{src:o.logo_url,alt:o.name}),e.jsx(Br,{className:"text-2xl font-bold bg-blue-600 text-white",children:o.name.charAt(0)})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:o.name}),o.verified&&e.jsx(Ri,{className:"h-6 w-6 text-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-1 mb-3",children:[T(o.rating),e.jsx("span",{className:"text-lg font-semibold text-gray-900 ml-2",children:o.rating.toFixed(1)}),e.jsxs("span",{className:"text-gray-600",children:["(",o.total_reviews||0," reviews)"]})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:o.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ia,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:o.address})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ol,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:o.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qa,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:o.email})]}),o.website&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Wg,{className:"h-4 w-4 text-gray-400"}),e.jsx("a",{href:o.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Website"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 mt-4 md:mt-0",children:[e.jsxs(R,{onClick:()=>N(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Book Consultation"]}),e.jsxs(R,{variant:"outline",onClick:()=>j(!0),children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Send Message"]})]})]})})})}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(fr,{value:C,onValueChange:k,children:[e.jsxs(nr,{className:"grid w-full grid-cols-4",children:[e.jsx(Ge,{value:"overview",children:"Overview"}),e.jsx(Ge,{value:"team",children:"Team"}),e.jsx(Ge,{value:"gallery",children:"Gallery"}),e.jsx(Ge,{value:"reviews",children:"Reviews"})]}),e.jsx(He,{value:"overview",className:"mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs(X,{children:["About ",o.name]})}),e.jsxs(z,{children:[e.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:o.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[o.established_year&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ln,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Established: ",o.established_year]})]}),o.firm_size&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(es,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Firm Size: ",o.firm_size.charAt(0).toUpperCase()+o.firm_size.slice(1)]})]}),o.response_time&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Response Time: ",o.response_time]})]}),o.consultation_fee&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ph,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Consultation Fee: $",o.consultation_fee]})]})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Practice Areas"})}),e.jsx(z,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:o.practice_areas.map(q=>e.jsx(ae,{variant:"secondary",className:"text-sm",children:q},q))})})]}),(((L=o.languages)==null?void 0:L.length)||((M=o.certifications)==null?void 0:M.length))&&e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Languages & Certifications"})}),e.jsxs(z,{className:"space-y-4",children:[((se=o.languages)==null?void 0:se.length)&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ww,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Languages"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.languages.map(q=>e.jsx(ae,{variant:"outline",className:"text-sm",children:q},q))})]}),((W=o.certifications)==null?void 0:W.length)&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(qg,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Certifications"})]}),e.jsx("div",{className:"space-y-1",children:o.certifications.map(q=>e.jsxs("div",{className:"text-sm text-gray-600",children:["• ",q]},q))})]})]})]}),o.office_hours&&e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Office Hours"})}),e.jsx(z,{children:e.jsx("p",{className:"text-gray-700",children:U(o.office_hours)})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"Quick Stats"})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Rating"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"font-medium",children:o.rating.toFixed(1)})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Reviews"}),e.jsx("span",{className:"font-medium",children:A})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Practice Areas"}),e.jsx("span",{className:"font-medium",children:o.practice_areas.length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Verified"}),e.jsx("div",{className:"flex items-center space-x-1",children:o.verified?e.jsxs(e.Fragment,{children:[e.jsx(Ri,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-blue-600 font-medium",children:"Yes"})]}):e.jsx("span",{className:"text-gray-500",children:"No"})})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"Contact"})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs(R,{className:"w-full",children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Write a Review"]}),e.jsxs(R,{variant:"outline",className:"w-full",children:[e.jsx(Ol,{className:"h-4 w-4 mr-2"}),"Call Now"]}),e.jsxs(R,{variant:"outline",className:"w-full",children:[e.jsx(qa,{className:"h-4 w-4 mr-2"}),"Send Email"]})]})]})]})]})}),e.jsx(He,{value:"team",className:"mt-6",children:d.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(q=>e.jsx($,{className:"hover:shadow-lg transition-shadow",children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs(zr,{className:"h-20 w-20 mx-auto mb-4",children:[e.jsx($n,{src:q.photo_url,alt:q.name}),e.jsx(Br,{className:"text-lg bg-blue-100 text-blue-600",children:q.name.split(" ").map(K=>K[0]).join("")})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:q.name}),e.jsx("p",{className:"text-blue-600 font-medium mb-3",children:q.title}),q.bio&&e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:q.bio}),q.practice_areas.length>0&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1 justify-center",children:[q.practice_areas.slice(0,3).map(K=>e.jsx(ae,{variant:"secondary",className:"text-xs",children:K},K)),q.practice_areas.length>3&&e.jsxs(ae,{variant:"secondary",className:"text-xs",children:["+",q.practice_areas.length-3," more"]})]})}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[q.years_experience&&e.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[e.jsx(B5,{className:"h-4 w-4"}),e.jsxs("span",{children:[q.years_experience," years experience"]})]}),q.languages&&q.languages.length>0&&e.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[e.jsx(Ww,{className:"h-4 w-4"}),e.jsx("span",{children:q.languages.join(", ")})]})]}),e.jsx("div",{className:"mt-4 space-y-2",children:q.email&&e.jsxs(R,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(qa,{className:"h-4 w-4 mr-2"}),"Contact"]})})]})})},q.id))}):e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No team information available"}),e.jsx("p",{className:"text-gray-500",children:"Team member information has not been provided yet."})]})})}),e.jsx(He,{value:"gallery",className:"mt-6",children:e.jsx(_$,{images:m})}),e.jsx(He,{value:"reviews",className:"mt-6",children:e.jsx(v$,{lawFirmId:o.id,reviews:g})})]})}),S&&e.jsx(b$,{lawFirm:o,teamMembers:d,onClose:()=>N(!1),onBookingCreated:()=>{N(!1),te.success("Booking request submitted successfully!")}}),v&&e.jsx(N$,{lawFirm:o,onClose:()=>j(!1),onMessageSent:()=>{j(!1),te.success("Message sent successfully!")}})]})};var zd=r=>r.type==="checkbox",co=r=>r instanceof Date,br=r=>r==null;const KS=r=>typeof r=="object";var Is=r=>!br(r)&&!Array.isArray(r)&&KS(r)&&!co(r),QS=r=>Is(r)&&r.target?zd(r.target)?r.target.checked:r.target.value:r,S$=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,YS=(r,t)=>r.has(S$(t)),k$=r=>{const t=r.constructor&&r.constructor.prototype;return Is(t)&&t.hasOwnProperty("isPrototypeOf")},xy=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Pr(r){let t;const s=Array.isArray(r);if(r instanceof Date)t=new Date(r);else if(r instanceof Set)t=new Set(r);else if(!(xy&&(r instanceof Blob||r instanceof FileList))&&(s||Is(r)))if(t=s?[]:{},!s&&!k$(r))t=r;else for(const a in r)r.hasOwnProperty(a)&&(t[a]=Pr(r[a]));else return r;return t}var Bm=r=>Array.isArray(r)?r.filter(Boolean):[],As=r=>r===void 0,Ce=(r,t,s)=>{if(!t||!Is(r))return s;const a=Bm(t.split(/[,[\].]+?/)).reduce((n,i)=>br(n)?n:n[i],r);return As(a)||a===r?As(r[t])?s:r[t]:a},Sa=r=>typeof r=="boolean",gy=r=>/^\w*$/.test(r),JS=r=>Bm(r.replace(/["|']|\]/g,"").split(/\.|\[/)),Qt=(r,t,s)=>{let a=-1;const n=gy(t)?[t]:JS(t),i=n.length,o=i-1;for(;++a<i;){const c=n[a];let d=s;if(a!==o){const h=r[c];d=Is(h)||Array.isArray(h)?h:isNaN(+n[a+1])?{}:[]}if(c==="__proto__")return;r[c]=d,r=r[c]}return r};const qh={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},za={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Nn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},ZS=xe.createContext(null),qm=()=>xe.useContext(ZS),C$=r=>{const{children:t,...s}=r;return xe.createElement(ZS.Provider,{value:s},t)};var XS=(r,t,s,a=!0)=>{const n={defaultValues:t._defaultValues};for(const i in r)Object.defineProperty(n,i,{get:()=>{const o=i;return t._proxyFormState[o]!==za.all&&(t._proxyFormState[o]=!a||za.all),s&&(s[o]=!0),r[o]}});return n},Fr=r=>Is(r)&&!Object.keys(r).length,e2=(r,t,s,a)=>{s(r);const{name:n,...i}=r;return Fr(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(o=>t[o]===(!a||za.all))},od=r=>Array.isArray(r)?r:[r],t2=(r,t,s)=>!r||!t||r===t||od(r).some(a=>a&&(s?a===t:a.startsWith(t)||t.startsWith(a)));function yy(r){const t=xe.useRef(r);t.current=r,xe.useEffect(()=>{const s=!r.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{s&&s.unsubscribe()}},[r.disabled])}function E$(r){const t=qm(),{control:s=t.control,disabled:a,name:n,exact:i}=r||{},[o,c]=xe.useState(s._formState),d=xe.useRef(!0),h=xe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),m=xe.useRef(n);return m.current=n,yy({disabled:a,next:f=>d.current&&t2(m.current,f.name,i)&&e2(f,h.current,s._updateFormState)&&c({...s._formState,...f}),subject:s._subjects.state}),xe.useEffect(()=>(d.current=!0,h.current.isValid&&s._updateValid(!0),()=>{d.current=!1}),[s]),XS(o,s,h.current,!1)}var rn=r=>typeof r=="string",s2=(r,t,s,a,n)=>rn(r)?(a&&t.watch.add(r),Ce(s,r,n)):Array.isArray(r)?r.map(i=>(a&&t.watch.add(i),Ce(s,i))):(a&&(t.watchAll=!0),s);function A$(r){const t=qm(),{control:s=t.control,name:a,defaultValue:n,disabled:i,exact:o}=r||{},c=xe.useRef(a);c.current=a,yy({disabled:i,subject:s._subjects.values,next:m=>{t2(c.current,m.name,o)&&h(Pr(s2(c.current,s._names,m.values||s._formValues,!1,n)))}});const[d,h]=xe.useState(s._getWatch(a,n));return xe.useEffect(()=>s._removeUnmounted()),d}function T$(r){const t=qm(),{name:s,disabled:a,control:n=t.control,shouldUnregister:i}=r,o=YS(n._names.array,s),c=A$({control:n,name:s,defaultValue:Ce(n._formValues,s,Ce(n._defaultValues,s,r.defaultValue)),exact:!0}),d=E$({control:n,name:s,exact:!0}),h=xe.useRef(n.register(s,{...r.rules,value:c,...Sa(r.disabled)?{disabled:r.disabled}:{}}));return xe.useEffect(()=>{const m=n._options.shouldUnregister||i,f=(g,y)=>{const b=Ce(n._fields,g);b&&b._f&&(b._f.mount=y)};if(f(s,!0),m){const g=Pr(Ce(n._options.defaultValues,s));Qt(n._defaultValues,s,g),As(Ce(n._formValues,s))&&Qt(n._formValues,s,g)}return()=>{(o?m&&!n._state.action:m)?n.unregister(s):f(s,!1)}},[s,n,o,i]),xe.useEffect(()=>{Ce(n._fields,s)&&n._updateDisabledField({disabled:a,fields:n._fields,name:s,value:Ce(n._fields,s)._f.value})},[a,s,n]),{field:{name:s,value:c,...Sa(a)||d.disabled?{disabled:d.disabled||a}:{},onChange:xe.useCallback(m=>h.current.onChange({target:{value:QS(m),name:s},type:qh.CHANGE}),[s]),onBlur:xe.useCallback(()=>h.current.onBlur({target:{value:Ce(n._formValues,s),name:s},type:qh.BLUR}),[s,n]),ref:xe.useCallback(m=>{const f=Ce(n._fields,s);f&&m&&(f._f.ref={focus:()=>m.focus(),select:()=>m.select(),setCustomValidity:g=>m.setCustomValidity(g),reportValidity:()=>m.reportValidity()})},[n._fields,s])},formState:d,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ce(d.errors,s)},isDirty:{enumerable:!0,get:()=>!!Ce(d.dirtyFields,s)},isTouched:{enumerable:!0,get:()=>!!Ce(d.touchedFields,s)},isValidating:{enumerable:!0,get:()=>!!Ce(d.validatingFields,s)},error:{enumerable:!0,get:()=>Ce(d.errors,s)}})}}const R$=r=>r.render(T$(r));var r2=(r,t,s,a,n)=>t?{...s[r],types:{...s[r]&&s[r].types?s[r].types:{},[a]:n||!0}}:{},Aj=r=>({isOnSubmit:!r||r===za.onSubmit,isOnBlur:r===za.onBlur,isOnChange:r===za.onChange,isOnAll:r===za.all,isOnTouch:r===za.onTouched}),Tj=(r,t,s)=>!s&&(t.watchAll||t.watch.has(r)||[...t.watch].some(a=>r.startsWith(a)&&/^\.\w+/.test(r.slice(a.length))));const ld=(r,t,s,a)=>{for(const n of s||Object.keys(r)){const i=Ce(r,n);if(i){const{_f:o,...c}=i;if(o){if(o.refs&&o.refs[0]&&t(o.refs[0],n)&&!a)return!0;if(o.ref&&t(o.ref,o.name)&&!a)return!0;if(ld(c,t))break}else if(Is(c)&&ld(c,t))break}}};var P$=(r,t,s)=>{const a=od(Ce(r,s));return Qt(a,"root",t[s]),Qt(r,s,a),r},vy=r=>r.type==="file",In=r=>typeof r=="function",Vh=r=>{if(!xy)return!1;const t=r?r.ownerDocument:0;return r instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},bh=r=>rn(r),wy=r=>r.type==="radio",Wh=r=>r instanceof RegExp;const Rj={value:!1,isValid:!1},Pj={value:!0,isValid:!0};var a2=r=>{if(Array.isArray(r)){if(r.length>1){const t=r.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:t,isValid:!!t.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!As(r[0].attributes.value)?As(r[0].value)||r[0].value===""?Pj:{value:r[0].value,isValid:!0}:Pj:Rj}return Rj};const Ij={isValid:!1,value:null};var n2=r=>Array.isArray(r)?r.reduce((t,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:t,Ij):Ij;function Dj(r,t,s="validate"){if(bh(r)||Array.isArray(r)&&r.every(bh)||Sa(r)&&!r)return{type:s,message:bh(r)?r:"",ref:t}}var ll=r=>Is(r)&&!Wh(r)?r:{value:r,message:""},Fj=async(r,t,s,a,n)=>{const{ref:i,refs:o,required:c,maxLength:d,minLength:h,min:m,max:f,pattern:g,validate:y,name:b,valueAsNumber:w,mount:S,disabled:N}=r._f,v=Ce(t,b);if(!S||N)return{};const j=o?o[0]:i,C=M=>{a&&j.reportValidity&&(j.setCustomValidity(Sa(M)?"":M||""),j.reportValidity())},k={},I=wy(i),T=zd(i),O=I||T,U=(w||vy(i))&&As(i.value)&&As(v)||Vh(i)&&i.value===""||v===""||Array.isArray(v)&&!v.length,A=r2.bind(null,b,s,k),L=(M,se,W,q=Nn.maxLength,K=Nn.minLength)=>{const Y=M?se:W;k[b]={type:M?q:K,message:Y,ref:i,...A(M?q:K,Y)}};if(n?!Array.isArray(v)||!v.length:c&&(!O&&(U||br(v))||Sa(v)&&!v||T&&!a2(o).isValid||I&&!n2(o).isValid)){const{value:M,message:se}=bh(c)?{value:!!c,message:c}:ll(c);if(M&&(k[b]={type:Nn.required,message:se,ref:j,...A(Nn.required,se)},!s))return C(se),k}if(!U&&(!br(m)||!br(f))){let M,se;const W=ll(f),q=ll(m);if(!br(v)&&!isNaN(v)){const K=i.valueAsNumber||v&&+v;br(W.value)||(M=K>W.value),br(q.value)||(se=K<q.value)}else{const K=i.valueAsDate||new Date(v),Y=Ke=>new Date(new Date().toDateString()+" "+Ke),le=i.type=="time",Ne=i.type=="week";rn(W.value)&&v&&(M=le?Y(v)>Y(W.value):Ne?v>W.value:K>new Date(W.value)),rn(q.value)&&v&&(se=le?Y(v)<Y(q.value):Ne?v<q.value:K<new Date(q.value))}if((M||se)&&(L(!!M,W.message,q.message,Nn.max,Nn.min),!s))return C(k[b].message),k}if((d||h)&&!U&&(rn(v)||n&&Array.isArray(v))){const M=ll(d),se=ll(h),W=!br(M.value)&&v.length>+M.value,q=!br(se.value)&&v.length<+se.value;if((W||q)&&(L(W,M.message,se.message),!s))return C(k[b].message),k}if(g&&!U&&rn(v)){const{value:M,message:se}=ll(g);if(Wh(M)&&!v.match(M)&&(k[b]={type:Nn.pattern,message:se,ref:i,...A(Nn.pattern,se)},!s))return C(se),k}if(y){if(In(y)){const M=await y(v,t),se=Dj(M,j);if(se&&(k[b]={...se,...A(Nn.validate,se.message)},!s))return C(se.message),k}else if(Is(y)){let M={};for(const se in y){if(!Fr(M)&&!s)break;const W=Dj(await y[se](v,t),j,se);W&&(M={...W,...A(se,W.message)},C(W.message),s&&(k[b]=M))}if(!Fr(M)&&(k[b]={ref:j,...M},!s))return k}}return C(!0),k};function I$(r,t){const s=t.slice(0,-1).length;let a=0;for(;a<s;)r=As(r)?a++:r[t[a++]];return r}function D$(r){for(const t in r)if(r.hasOwnProperty(t)&&!As(r[t]))return!1;return!0}function zs(r,t){const s=Array.isArray(t)?t:gy(t)?[t]:JS(t),a=s.length===1?r:I$(r,s),n=s.length-1,i=s[n];return a&&delete a[i],n!==0&&(Is(a)&&Fr(a)||Array.isArray(a)&&D$(a))&&zs(r,s.slice(0,-1)),r}var Op=()=>{let r=[];return{get observers(){return r},next:n=>{for(const i of r)i.next&&i.next(n)},subscribe:n=>(r.push(n),{unsubscribe:()=>{r=r.filter(i=>i!==n)}}),unsubscribe:()=>{r=[]}}},Xx=r=>br(r)||!KS(r);function ui(r,t){if(Xx(r)||Xx(t))return r===t;if(co(r)&&co(t))return r.getTime()===t.getTime();const s=Object.keys(r),a=Object.keys(t);if(s.length!==a.length)return!1;for(const n of s){const i=r[n];if(!a.includes(n))return!1;if(n!=="ref"){const o=t[n];if(co(i)&&co(o)||Is(i)&&Is(o)||Array.isArray(i)&&Array.isArray(o)?!ui(i,o):i!==o)return!1}}return!0}var i2=r=>r.type==="select-multiple",F$=r=>wy(r)||zd(r),Mp=r=>Vh(r)&&r.isConnected,o2=r=>{for(const t in r)if(In(r[t]))return!0;return!1};function Hh(r,t={}){const s=Array.isArray(r);if(Is(r)||s)for(const a in r)Array.isArray(r[a])||Is(r[a])&&!o2(r[a])?(t[a]=Array.isArray(r[a])?[]:{},Hh(r[a],t[a])):br(r[a])||(t[a]=!0);return t}function l2(r,t,s){const a=Array.isArray(r);if(Is(r)||a)for(const n in r)Array.isArray(r[n])||Is(r[n])&&!o2(r[n])?As(t)||Xx(s[n])?s[n]=Array.isArray(r[n])?Hh(r[n],[]):{...Hh(r[n])}:l2(r[n],br(t)?{}:t[n],s[n]):s[n]=!ui(r[n],t[n]);return s}var Ic=(r,t)=>l2(r,t,Hh(t)),c2=(r,{valueAsNumber:t,valueAsDate:s,setValueAs:a})=>As(r)?r:t?r===""?NaN:r&&+r:s&&rn(r)?new Date(r):a?a(r):r;function Lp(r){const t=r.ref;if(!(r.refs?r.refs.every(s=>s.disabled):t.disabled))return vy(t)?t.files:wy(t)?n2(r.refs).value:i2(t)?[...t.selectedOptions].map(({value:s})=>s):zd(t)?a2(r.refs).value:c2(As(t.value)?r.ref.value:t.value,r)}var O$=(r,t,s,a)=>{const n={};for(const i of r){const o=Ce(t,i);o&&Qt(n,i,o._f)}return{criteriaMode:s,names:[...r],fields:n,shouldUseNativeValidation:a}},Dc=r=>As(r)?r:Wh(r)?r.source:Is(r)?Wh(r.value)?r.value.source:r.value:r;const Oj="AsyncFunction";var M$=r=>(!r||!r.validate)&&!!(In(r.validate)&&r.validate.constructor.name===Oj||Is(r.validate)&&Object.values(r.validate).find(t=>t.constructor.name===Oj)),L$=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate);function Mj(r,t,s){const a=Ce(r,s);if(a||gy(s))return{error:a,name:s};const n=s.split(".");for(;n.length;){const i=n.join("."),o=Ce(t,i),c=Ce(r,i);if(o&&!Array.isArray(o)&&s!==i)return{name:s};if(c&&c.type)return{name:i,error:c};n.pop()}return{name:s}}var U$=(r,t,s,a,n)=>n.isOnAll?!1:!s&&n.isOnTouch?!(t||r):(s?a.isOnBlur:n.isOnBlur)?!r:(s?a.isOnChange:n.isOnChange)?r:!0,$$=(r,t)=>!Bm(Ce(r,t)).length&&zs(r,t);const z$={mode:za.onSubmit,reValidateMode:za.onChange,shouldFocusError:!0};function B$(r={}){let t={...z$,...r},s={submitCount:0,isDirty:!1,isLoading:In(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},a={},n=Is(t.defaultValues)||Is(t.values)?Pr(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:Pr(n),o={action:!1,mount:!1,watch:!1},c={mount:new Set,unMount:new Set,array:new Set,watch:new Set},d,h=0;const m={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},f={values:Op(),array:Op(),state:Op()},g=Aj(t.mode),y=Aj(t.reValidateMode),b=t.criteriaMode===za.all,w=V=>ee=>{clearTimeout(h),h=setTimeout(V,ee)},S=async V=>{if(!r.disabled&&(m.isValid||V)){const ee=t.resolver?Fr((await O()).errors):await A(a,!0);ee!==s.isValid&&f.state.next({isValid:ee})}},N=(V,ee)=>{!r.disabled&&(m.isValidating||m.validatingFields)&&((V||Array.from(c.mount)).forEach(oe=>{oe&&(ee?Qt(s.validatingFields,oe,ee):zs(s.validatingFields,oe))}),f.state.next({validatingFields:s.validatingFields,isValidating:!Fr(s.validatingFields)}))},v=(V,ee=[],oe,Se,_e=!0,we=!0)=>{if(Se&&oe&&!r.disabled){if(o.action=!0,we&&Array.isArray(Ce(a,V))){const de=oe(Ce(a,V),Se.argA,Se.argB);_e&&Qt(a,V,de)}if(we&&Array.isArray(Ce(s.errors,V))){const de=oe(Ce(s.errors,V),Se.argA,Se.argB);_e&&Qt(s.errors,V,de),$$(s.errors,V)}if(m.touchedFields&&we&&Array.isArray(Ce(s.touchedFields,V))){const de=oe(Ce(s.touchedFields,V),Se.argA,Se.argB);_e&&Qt(s.touchedFields,V,de)}m.dirtyFields&&(s.dirtyFields=Ic(n,i)),f.state.next({name:V,isDirty:M(V,ee),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else Qt(i,V,ee)},j=(V,ee)=>{Qt(s.errors,V,ee),f.state.next({errors:s.errors})},C=V=>{s.errors=V,f.state.next({errors:s.errors,isValid:!1})},k=(V,ee,oe,Se)=>{const _e=Ce(a,V);if(_e){const we=Ce(i,V,As(oe)?Ce(n,V):oe);As(we)||Se&&Se.defaultChecked||ee?Qt(i,V,ee?we:Lp(_e._f)):q(V,we),o.mount&&S()}},I=(V,ee,oe,Se,_e)=>{let we=!1,de=!1;const je={name:V};if(!r.disabled){const mt=!!(Ce(a,V)&&Ce(a,V)._f&&Ce(a,V)._f.disabled);if(!oe||Se){m.isDirty&&(de=s.isDirty,s.isDirty=je.isDirty=M(),we=de!==je.isDirty);const et=mt||ui(Ce(n,V),ee);de=!!(!mt&&Ce(s.dirtyFields,V)),et||mt?zs(s.dirtyFields,V):Qt(s.dirtyFields,V,!0),je.dirtyFields=s.dirtyFields,we=we||m.dirtyFields&&de!==!et}if(oe){const et=Ce(s.touchedFields,V);et||(Qt(s.touchedFields,V,oe),je.touchedFields=s.touchedFields,we=we||m.touchedFields&&et!==oe)}we&&_e&&f.state.next(je)}return we?je:{}},T=(V,ee,oe,Se)=>{const _e=Ce(s.errors,V),we=m.isValid&&Sa(ee)&&s.isValid!==ee;if(r.delayError&&oe?(d=w(()=>j(V,oe)),d(r.delayError)):(clearTimeout(h),d=null,oe?Qt(s.errors,V,oe):zs(s.errors,V)),(oe?!ui(_e,oe):_e)||!Fr(Se)||we){const de={...Se,...we&&Sa(ee)?{isValid:ee}:{},errors:s.errors,name:V};s={...s,...de},f.state.next(de)}},O=async V=>{N(V,!0);const ee=await t.resolver(i,t.context,O$(V||c.mount,a,t.criteriaMode,t.shouldUseNativeValidation));return N(V),ee},U=async V=>{const{errors:ee}=await O(V);if(V)for(const oe of V){const Se=Ce(ee,oe);Se?Qt(s.errors,oe,Se):zs(s.errors,oe)}else s.errors=ee;return ee},A=async(V,ee,oe={valid:!0})=>{for(const Se in V){const _e=V[Se];if(_e){const{_f:we,...de}=_e;if(we){const je=c.array.has(we.name),mt=_e._f&&M$(_e._f);mt&&m.validatingFields&&N([Se],!0);const et=await Fj(_e,i,b,t.shouldUseNativeValidation&&!ee,je);if(mt&&m.validatingFields&&N([Se]),et[we.name]&&(oe.valid=!1,ee))break;!ee&&(Ce(et,we.name)?je?P$(s.errors,et,we.name):Qt(s.errors,we.name,et[we.name]):zs(s.errors,we.name))}!Fr(de)&&await A(de,ee,oe)}}return oe.valid},L=()=>{for(const V of c.unMount){const ee=Ce(a,V);ee&&(ee._f.refs?ee._f.refs.every(oe=>!Mp(oe)):!Mp(ee._f.ref))&&nt(V)}c.unMount=new Set},M=(V,ee)=>!r.disabled&&(V&&ee&&Qt(i,V,ee),!ui(ke(),n)),se=(V,ee,oe)=>s2(V,c,{...o.mount?i:As(ee)?n:rn(V)?{[V]:ee}:ee},oe,ee),W=V=>Bm(Ce(o.mount?i:n,V,r.shouldUnregister?Ce(n,V,[]):[])),q=(V,ee,oe={})=>{const Se=Ce(a,V);let _e=ee;if(Se){const we=Se._f;we&&(!we.disabled&&Qt(i,V,c2(ee,we)),_e=Vh(we.ref)&&br(ee)?"":ee,i2(we.ref)?[...we.ref.options].forEach(de=>de.selected=_e.includes(de.value)):we.refs?zd(we.ref)?we.refs.length>1?we.refs.forEach(de=>(!de.defaultChecked||!de.disabled)&&(de.checked=Array.isArray(_e)?!!_e.find(je=>je===de.value):_e===de.value)):we.refs[0]&&(we.refs[0].checked=!!_e):we.refs.forEach(de=>de.checked=de.value===_e):vy(we.ref)?we.ref.value="":(we.ref.value=_e,we.ref.type||f.values.next({name:V,values:{...i}})))}(oe.shouldDirty||oe.shouldTouch)&&I(V,_e,oe.shouldTouch,oe.shouldDirty,!0),oe.shouldValidate&&Ke(V)},K=(V,ee,oe)=>{for(const Se in ee){const _e=ee[Se],we=`${V}.${Se}`,de=Ce(a,we);(c.array.has(V)||Is(_e)||de&&!de._f)&&!co(_e)?K(we,_e,oe):q(we,_e,oe)}},Y=(V,ee,oe={})=>{const Se=Ce(a,V),_e=c.array.has(V),we=Pr(ee);Qt(i,V,we),_e?(f.array.next({name:V,values:{...i}}),(m.isDirty||m.dirtyFields)&&oe.shouldDirty&&f.state.next({name:V,dirtyFields:Ic(n,i),isDirty:M(V,we)})):Se&&!Se._f&&!br(we)?K(V,we,oe):q(V,we,oe),Tj(V,c)&&f.state.next({...s}),f.values.next({name:o.mount?V:void 0,values:{...i}})},le=async V=>{o.mount=!0;const ee=V.target;let oe=ee.name,Se=!0;const _e=Ce(a,oe),we=()=>ee.type?Lp(_e._f):QS(V),de=je=>{Se=Number.isNaN(je)||co(je)&&isNaN(je.getTime())||ui(je,Ce(i,oe,je))};if(_e){let je,mt;const et=we(),Wt=V.type===qh.BLUR||V.type===qh.FOCUS_OUT,Ws=!L$(_e._f)&&!t.resolver&&!Ce(s.errors,oe)&&!_e._f.deps||U$(Wt,Ce(s.touchedFields,oe),s.isSubmitted,y,g),Js=Tj(oe,c,Wt);Qt(i,oe,et),Wt?(_e._f.onBlur&&_e._f.onBlur(V),d&&d(0)):_e._f.onChange&&_e._f.onChange(V);const qr=I(oe,et,Wt,!1),ma=!Fr(qr)||Js;if(!Wt&&f.values.next({name:oe,type:V.type,values:{...i}}),Ws)return m.isValid&&(r.mode==="onBlur"?Wt&&S():S()),ma&&f.state.next({name:oe,...Js?{}:qr});if(!Wt&&Js&&f.state.next({...s}),t.resolver){const{errors:Vr}=await O([oe]);if(de(et),Se){const fa=Mj(s.errors,a,oe),kr=Mj(Vr,a,fa.name||oe);je=kr.error,oe=kr.name,mt=Fr(Vr)}}else N([oe],!0),je=(await Fj(_e,i,b,t.shouldUseNativeValidation))[oe],N([oe]),de(et),Se&&(je?mt=!1:m.isValid&&(mt=await A(a,!0)));Se&&(_e._f.deps&&Ke(_e._f.deps),T(oe,mt,je,qr))}},Ne=(V,ee)=>{if(Ce(s.errors,ee)&&V.focus)return V.focus(),1},Ke=async(V,ee={})=>{let oe,Se;const _e=od(V);if(t.resolver){const we=await U(As(V)?V:_e);oe=Fr(we),Se=V?!_e.some(de=>Ce(we,de)):oe}else V?(Se=(await Promise.all(_e.map(async we=>{const de=Ce(a,we);return await A(de&&de._f?{[we]:de}:de)}))).every(Boolean),!(!Se&&!s.isValid)&&S()):Se=oe=await A(a);return f.state.next({...!rn(V)||m.isValid&&oe!==s.isValid?{}:{name:V},...t.resolver||!V?{isValid:oe}:{},errors:s.errors}),ee.shouldFocus&&!Se&&ld(a,Ne,V?_e:c.mount),Se},ke=V=>{const ee={...o.mount?i:n};return As(V)?ee:rn(V)?Ce(ee,V):V.map(oe=>Ce(ee,oe))},$e=(V,ee)=>({invalid:!!Ce((ee||s).errors,V),isDirty:!!Ce((ee||s).dirtyFields,V),error:Ce((ee||s).errors,V),isValidating:!!Ce(s.validatingFields,V),isTouched:!!Ce((ee||s).touchedFields,V)}),ce=V=>{V&&od(V).forEach(ee=>zs(s.errors,ee)),f.state.next({errors:V?s.errors:{}})},Re=(V,ee,oe)=>{const Se=(Ce(a,V,{_f:{}})._f||{}).ref,_e=Ce(s.errors,V)||{},{ref:we,message:de,type:je,...mt}=_e;Qt(s.errors,V,{...mt,...ee,ref:Se}),f.state.next({name:V,errors:s.errors,isValid:!1}),oe&&oe.shouldFocus&&Se&&Se.focus&&Se.focus()},Qe=(V,ee)=>In(V)?f.values.subscribe({next:oe=>V(se(void 0,ee),oe)}):se(V,ee,!0),nt=(V,ee={})=>{for(const oe of V?od(V):c.mount)c.mount.delete(oe),c.array.delete(oe),ee.keepValue||(zs(a,oe),zs(i,oe)),!ee.keepError&&zs(s.errors,oe),!ee.keepDirty&&zs(s.dirtyFields,oe),!ee.keepTouched&&zs(s.touchedFields,oe),!ee.keepIsValidating&&zs(s.validatingFields,oe),!t.shouldUnregister&&!ee.keepDefaultValue&&zs(n,oe);f.values.next({values:{...i}}),f.state.next({...s,...ee.keepDirty?{isDirty:M()}:{}}),!ee.keepIsValid&&S()},We=({disabled:V,name:ee,field:oe,fields:Se,value:_e})=>{if(Sa(V)&&o.mount||V){const we=V?void 0:As(_e)?Lp(oe?oe._f:Ce(Se,ee)._f):_e;Qt(i,ee,we),I(ee,we,!1,!1,!0)}},ct=(V,ee={})=>{let oe=Ce(a,V);const Se=Sa(ee.disabled)||Sa(r.disabled);return Qt(a,V,{...oe||{},_f:{...oe&&oe._f?oe._f:{ref:{name:V}},name:V,mount:!0,...ee}}),c.mount.add(V),oe?We({field:oe,disabled:Sa(ee.disabled)?ee.disabled:r.disabled,name:V,value:ee.value}):k(V,!0,ee.value),{...Se?{disabled:ee.disabled||r.disabled}:{},...t.progressive?{required:!!ee.required,min:Dc(ee.min),max:Dc(ee.max),minLength:Dc(ee.minLength),maxLength:Dc(ee.maxLength),pattern:Dc(ee.pattern)}:{},name:V,onChange:le,onBlur:le,ref:_e=>{if(_e){ct(V,ee),oe=Ce(a,V);const we=As(_e.value)&&_e.querySelectorAll&&_e.querySelectorAll("input,select,textarea")[0]||_e,de=F$(we),je=oe._f.refs||[];if(de?je.find(mt=>mt===we):we===oe._f.ref)return;Qt(a,V,{_f:{...oe._f,...de?{refs:[...je.filter(Mp),we,...Array.isArray(Ce(n,V))?[{}]:[]],ref:{type:we.type,name:V}}:{ref:we}}}),k(V,!1,void 0,we)}else oe=Ce(a,V,{}),oe._f&&(oe._f.mount=!1),(t.shouldUnregister||ee.shouldUnregister)&&!(YS(c.array,V)&&o.action)&&c.unMount.add(V)}}},he=()=>t.shouldFocusError&&ld(a,Ne,c.mount),fe=V=>{Sa(V)&&(f.state.next({disabled:V}),ld(a,(ee,oe)=>{const Se=Ce(a,oe);Se&&(ee.disabled=Se._f.disabled||V,Array.isArray(Se._f.refs)&&Se._f.refs.forEach(_e=>{_e.disabled=Se._f.disabled||V}))},0,!1))},Me=(V,ee)=>async oe=>{let Se;oe&&(oe.preventDefault&&oe.preventDefault(),oe.persist&&oe.persist());let _e=Pr(i);if(f.state.next({isSubmitting:!0}),t.resolver){const{errors:we,values:de}=await O();s.errors=we,_e=de}else await A(a);if(zs(s.errors,"root"),Fr(s.errors)){f.state.next({errors:{}});try{await V(_e,oe)}catch(we){Se=we}}else ee&&await ee({...s.errors},oe),he(),setTimeout(he);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Fr(s.errors)&&!Se,submitCount:s.submitCount+1,errors:s.errors}),Se)throw Se},ze=(V,ee={})=>{Ce(a,V)&&(As(ee.defaultValue)?Y(V,Pr(Ce(n,V))):(Y(V,ee.defaultValue),Qt(n,V,Pr(ee.defaultValue))),ee.keepTouched||zs(s.touchedFields,V),ee.keepDirty||(zs(s.dirtyFields,V),s.isDirty=ee.defaultValue?M(V,Pr(Ce(n,V))):M()),ee.keepError||(zs(s.errors,V),m.isValid&&S()),f.state.next({...s}))},ts=(V,ee={})=>{const oe=V?Pr(V):n,Se=Pr(oe),_e=Fr(V),we=_e?n:Se;if(ee.keepDefaultValues||(n=oe),!ee.keepValues){if(ee.keepDirtyValues){const de=new Set([...c.mount,...Object.keys(Ic(n,i))]);for(const je of Array.from(de))Ce(s.dirtyFields,je)?Qt(we,je,Ce(i,je)):Y(je,Ce(we,je))}else{if(xy&&As(V))for(const de of c.mount){const je=Ce(a,de);if(je&&je._f){const mt=Array.isArray(je._f.refs)?je._f.refs[0]:je._f.ref;if(Vh(mt)){const et=mt.closest("form");if(et){et.reset();break}}}}a={}}i=r.shouldUnregister?ee.keepDefaultValues?Pr(n):{}:Pr(we),f.array.next({values:{...we}}),f.values.next({values:{...we}})}c={mount:ee.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!m.isValid||!!ee.keepIsValid||!!ee.keepDirtyValues,o.watch=!!r.shouldUnregister,f.state.next({submitCount:ee.keepSubmitCount?s.submitCount:0,isDirty:_e?!1:ee.keepDirty?s.isDirty:!!(ee.keepDefaultValues&&!ui(V,n)),isSubmitted:ee.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:_e?{}:ee.keepDirtyValues?ee.keepDefaultValues&&i?Ic(n,i):s.dirtyFields:ee.keepDefaultValues&&V?Ic(n,V):ee.keepDirty?s.dirtyFields:{},touchedFields:ee.keepTouched?s.touchedFields:{},errors:ee.keepErrors?s.errors:{},isSubmitSuccessful:ee.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1})},Tt=(V,ee)=>ts(In(V)?V(i):V,ee);return{control:{register:ct,unregister:nt,getFieldState:$e,handleSubmit:Me,setError:Re,_executeSchema:O,_getWatch:se,_getDirty:M,_updateValid:S,_removeUnmounted:L,_updateFieldArray:v,_updateDisabledField:We,_getFieldArray:W,_reset:ts,_resetDefaultValues:()=>In(t.defaultValues)&&t.defaultValues().then(V=>{Tt(V,t.resetOptions),f.state.next({isLoading:!1})}),_updateFormState:V=>{s={...s,...V}},_disableForm:fe,_subjects:f,_proxyFormState:m,_setErrors:C,get _fields(){return a},get _formValues(){return i},get _state(){return o},set _state(V){o=V},get _defaultValues(){return n},get _names(){return c},set _names(V){c=V},get _formState(){return s},set _formState(V){s=V},get _options(){return t},set _options(V){t={...t,...V}}},trigger:Ke,register:ct,handleSubmit:Me,watch:Qe,setValue:Y,getValues:ke,reset:Tt,resetField:ze,clearErrors:ce,unregister:nt,setError:Re,setFocus:(V,ee={})=>{const oe=Ce(a,V),Se=oe&&oe._f;if(Se){const _e=Se.refs?Se.refs[0]:Se.ref;_e.focus&&(_e.focus(),ee.shouldSelect&&_e.select())}},getFieldState:$e}}function Ui(r={}){const t=xe.useRef(),s=xe.useRef(),[a,n]=xe.useState({isDirty:!1,isValidating:!1,isLoading:In(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,defaultValues:In(r.defaultValues)?void 0:r.defaultValues});t.current||(t.current={...B$(r),formState:a});const i=t.current.control;return i._options=r,yy({subject:i._subjects.state,next:o=>{e2(o,i._proxyFormState,i._updateFormState,!0)&&n({...i._formState})}}),xe.useEffect(()=>i._disableForm(r.disabled),[i,r.disabled]),xe.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==a.isDirty&&i._subjects.state.next({isDirty:o})}},[i,a.isDirty]),xe.useEffect(()=>{r.values&&!ui(r.values,s.current)?(i._reset(r.values,i._options.resetOptions),s.current=r.values,n(o=>({...o}))):i._resetDefaultValues()},[r.values,i]),xe.useEffect(()=>{r.errors&&i._setErrors(r.errors)},[r.errors,i]),xe.useEffect(()=>{i._state.mount||(i._updateValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),xe.useEffect(()=>{r.shouldUnregister&&i._subjects.values.next({values:i._getWatch()})},[r.shouldUnregister,i]),xe.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[a]),t.current.formState=XS(a,i),t.current}const Lj=(r,t,s)=>{if(r&&"reportValidity"in r){const a=Ce(s,t);r.setCustomValidity(a&&a.message||""),r.reportValidity()}},d2=(r,t)=>{for(const s in t.fields){const a=t.fields[s];a&&a.ref&&"reportValidity"in a.ref?Lj(a.ref,s,r):a.refs&&a.refs.forEach(n=>Lj(n,s,r))}},q$=(r,t)=>{t.shouldUseNativeValidation&&d2(r,t);const s={};for(const a in r){const n=Ce(t.fields,a),i=Object.assign(r[a]||{},{ref:n&&n.ref});if(V$(t.names||Object.keys(r),a)){const o=Object.assign({},Ce(s,a));Qt(o,"root",i),Qt(s,a,o)}else Qt(s,a,i)}return s},V$=(r,t)=>r.some(s=>s.startsWith(t+"."));var W$=function(r,t){for(var s={};r.length;){var a=r[0],n=a.code,i=a.message,o=a.path.join(".");if(!s[o])if("unionErrors"in a){var c=a.unionErrors[0].errors[0];s[o]={message:c.message,type:c.code}}else s[o]={message:i,type:n};if("unionErrors"in a&&a.unionErrors.forEach(function(m){return m.errors.forEach(function(f){return r.push(f)})}),t){var d=s[o].types,h=d&&d[a.code];s[o]=r2(o,t,s,n,h?[].concat(h,a.message):a.message)}r.shift()}return s},$i=function(r,t,s){return s===void 0&&(s={}),function(a,n,i){try{return Promise.resolve(function(o,c){try{var d=Promise.resolve(r[s.mode==="sync"?"parse":"parseAsync"](a,t)).then(function(h){return i.shouldUseNativeValidation&&d2({},i),{errors:{},values:s.raw?a:h}})}catch(h){return c(h)}return d&&d.then?d.then(void 0,c):d}(0,function(o){if(function(c){return Array.isArray(c==null?void 0:c.errors)}(o))return{values:{},errors:q$(W$(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},qt;(function(r){r.assertEqual=n=>{};function t(n){}r.assertIs=t;function s(n){throw new Error}r.assertNever=s,r.arrayToEnum=n=>{const i={};for(const o of n)i[o]=o;return i},r.getValidEnumValues=n=>{const i=r.objectKeys(n).filter(c=>typeof n[n[c]]!="number"),o={};for(const c of i)o[c]=n[c];return r.objectValues(o)},r.objectValues=n=>r.objectKeys(n).map(function(i){return n[i]}),r.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const i=[];for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},r.find=(n,i)=>{for(const o of n)if(i(o))return o},r.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function a(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}r.joinValues=a,r.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(qt||(qt={}));var Uj;(function(r){r.mergeShapes=(t,s)=>({...t,...s})})(Uj||(Uj={}));const Be=qt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),oi=r=>{switch(typeof r){case"undefined":return Be.undefined;case"string":return Be.string;case"number":return Number.isNaN(r)?Be.nan:Be.number;case"boolean":return Be.boolean;case"function":return Be.function;case"bigint":return Be.bigint;case"symbol":return Be.symbol;case"object":return Array.isArray(r)?Be.array:r===null?Be.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?Be.promise:typeof Map<"u"&&r instanceof Map?Be.map:typeof Set<"u"&&r instanceof Set?Be.set:typeof Date<"u"&&r instanceof Date?Be.date:Be.object;default:return Be.unknown}},be=qt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class zn extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=t}format(t){const s=t||function(i){return i.message},a={_errors:[]},n=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)a._errors.push(s(o));else{let c=a,d=0;for(;d<o.path.length;){const h=o.path[d];d===o.path.length-1?(c[h]=c[h]||{_errors:[]},c[h]._errors.push(s(o))):c[h]=c[h]||{_errors:[]},c=c[h],d++}}};return n(this),a}static assert(t){if(!(t instanceof zn))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,qt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=s=>s.message){const s={},a=[];for(const n of this.issues)n.path.length>0?(s[n.path[0]]=s[n.path[0]]||[],s[n.path[0]].push(t(n))):a.push(t(n));return{formErrors:a,fieldErrors:s}}get formErrors(){return this.flatten()}}zn.create=r=>new zn(r);const eg=(r,t)=>{let s;switch(r.code){case be.invalid_type:r.received===Be.undefined?s="Required":s=`Expected ${r.expected}, received ${r.received}`;break;case be.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(r.expected,qt.jsonStringifyReplacer)}`;break;case be.unrecognized_keys:s=`Unrecognized key(s) in object: ${qt.joinValues(r.keys,", ")}`;break;case be.invalid_union:s="Invalid input";break;case be.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${qt.joinValues(r.options)}`;break;case be.invalid_enum_value:s=`Invalid enum value. Expected ${qt.joinValues(r.options)}, received '${r.received}'`;break;case be.invalid_arguments:s="Invalid function arguments";break;case be.invalid_return_type:s="Invalid function return type";break;case be.invalid_date:s="Invalid date";break;case be.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(s=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?s=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?s=`Invalid input: must end with "${r.validation.endsWith}"`:qt.assertNever(r.validation):r.validation!=="regex"?s=`Invalid ${r.validation}`:s="Invalid";break;case be.too_small:r.type==="array"?s=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?s=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?s=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?s=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:s="Invalid input";break;case be.too_big:r.type==="array"?s=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?s=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?s=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?s=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?s=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:s="Invalid input";break;case be.custom:s="Invalid input";break;case be.invalid_intersection_types:s="Intersection results could not be merged";break;case be.not_multiple_of:s=`Number must be a multiple of ${r.multipleOf}`;break;case be.not_finite:s="Number must be finite";break;default:s=t.defaultError,qt.assertNever(r)}return{message:s}};let H$=eg;function G$(){return H$}const K$=r=>{const{data:t,path:s,errorMaps:a,issueData:n}=r,i=[...s,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let c="";const d=a.filter(h=>!!h).slice().reverse();for(const h of d)c=h(o,{data:t,defaultError:c}).message;return{...n,path:i,message:c}};function De(r,t){const s=G$(),a=K$({issueData:t,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,s,s===eg?void 0:eg].filter(n=>!!n)});r.common.issues.push(a)}class ua{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,s){const a=[];for(const n of s){if(n.status==="aborted")return xt;n.status==="dirty"&&t.dirty(),a.push(n.value)}return{status:t.value,value:a}}static async mergeObjectAsync(t,s){const a=[];for(const n of s){const i=await n.key,o=await n.value;a.push({key:i,value:o})}return ua.mergeObjectSync(t,a)}static mergeObjectSync(t,s){const a={};for(const n of s){const{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return xt;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(a[i.value]=o.value)}return{status:t.value,value:a}}}const xt=Object.freeze({status:"aborted"}),qc=r=>({status:"dirty",value:r}),Aa=r=>({status:"valid",value:r}),$j=r=>r.status==="aborted",zj=r=>r.status==="dirty",$l=r=>r.status==="valid",Gh=r=>typeof Promise<"u"&&r instanceof Promise;var Ve;(function(r){r.errToObj=t=>typeof t=="string"?{message:t}:t||{},r.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ve||(Ve={}));class Ii{constructor(t,s,a,n){this._cachedPath=[],this.parent=t,this.data=s,this._path=a,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Bj=(r,t)=>{if($l(t))return{success:!0,data:t.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new zn(r.common.issues);return this._error=s,this._error}}};function At(r){if(!r)return{};const{errorMap:t,invalid_type_error:s,required_error:a,description:n}=r;if(t&&(s||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(o,c)=>{const{message:d}=r;return o.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??a??c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:d??s??c.defaultError}},description:n}}class Bt{get description(){return this._def.description}_getType(t){return oi(t.data)}_getOrReturnCtx(t,s){return s||{common:t.parent.common,data:t.data,parsedType:oi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ua,ctx:{common:t.parent.common,data:t.data,parsedType:oi(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const s=this._parse(t);if(Gh(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(t){const s=this._parse(t);return Promise.resolve(s)}parse(t,s){const a=this.safeParse(t,s);if(a.success)return a.data;throw a.error}safeParse(t,s){const a={common:{issues:[],async:(s==null?void 0:s.async)??!1,contextualErrorMap:s==null?void 0:s.errorMap},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:oi(t)},n=this._parseSync({data:t,path:a.path,parent:a});return Bj(a,n)}"~validate"(t){var a,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:oi(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:s});return $l(i)?{value:i.value}:{issues:s.common.issues}}catch(i){(n=(a=i==null?void 0:i.message)==null?void 0:a.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(i=>$l(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(t,s){const a=await this.safeParseAsync(t,s);if(a.success)return a.data;throw a.error}async safeParseAsync(t,s){const a={common:{issues:[],contextualErrorMap:s==null?void 0:s.errorMap,async:!0},path:(s==null?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:oi(t)},n=this._parse({data:t,path:a.path,parent:a}),i=await(Gh(n)?n:Promise.resolve(n));return Bj(a,i)}refine(t,s){const a=n=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(n):s;return this._refinement((n,i)=>{const o=t(n),c=()=>i.addIssue({code:be.custom,...a(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(t,s){return this._refinement((a,n)=>t(a)?!0:(n.addIssue(typeof s=="function"?s(a,n):s),!1))}_refinement(t){return new ql({schema:this,typeName:gt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s=>this["~validate"](s)}}optional(){return Ti.create(this,this._def)}nullable(){return Vl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return on.create(this)}promise(){return Jh.create(this,this._def)}or(t){return Qh.create([this,t],this._def)}and(t){return Yh.create(this,t,this._def)}transform(t){return new ql({...At(this._def),schema:this,typeName:gt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const s=typeof t=="function"?t:()=>t;return new rg({...At(this._def),innerType:this,defaultValue:s,typeName:gt.ZodDefault})}brand(){return new g8({typeName:gt.ZodBranded,type:this,...At(this._def)})}catch(t){const s=typeof t=="function"?t:()=>t;return new ag({...At(this._def),innerType:this,catchValue:s,typeName:gt.ZodCatch})}describe(t){const s=this.constructor;return new s({...this._def,description:t})}pipe(t){return jy.create(this,t)}readonly(){return ng.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Q$=/^c[^\s-]{8,}$/i,Y$=/^[0-9a-z]+$/,J$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Z$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,X$=/^[a-z0-9_-]{21}$/i,e8=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,t8=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,s8=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,r8="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Up;const a8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,n8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,i8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,o8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,l8=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,c8=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,u2="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",d8=new RegExp(`^${u2}$`);function h2(r){let t="[0-5]\\d";r.precision?t=`${t}\\.\\d{${r.precision}}`:r.precision==null&&(t=`${t}(\\.\\d+)?`);const s=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${s}`}function u8(r){return new RegExp(`^${h2(r)}$`)}function h8(r){let t=`${u2}T${h2(r)}`;const s=[];return s.push(r.local?"Z?":"Z"),r.offset&&s.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${s.join("|")})`,new RegExp(`^${t}$`)}function m8(r,t){return!!((t==="v4"||!t)&&a8.test(r)||(t==="v6"||!t)&&i8.test(r))}function f8(r,t){if(!e8.test(r))return!1;try{const[s]=r.split("."),a=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),n=JSON.parse(atob(a));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function p8(r,t){return!!((t==="v4"||!t)&&n8.test(r)||(t==="v6"||!t)&&o8.test(r))}class _i extends Bt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Be.string){const i=this._getOrReturnCtx(t);return De(i,{code:be.invalid_type,expected:Be.string,received:i.parsedType}),xt}const a=new ua;let n;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(n=this._getOrReturnCtx(t,n),De(n,{code:be.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="max")t.data.length>i.value&&(n=this._getOrReturnCtx(t,n),De(n,{code:be.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),a.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,c=t.data.length<i.value;(o||c)&&(n=this._getOrReturnCtx(t,n),o?De(n,{code:be.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&De(n,{code:be.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),a.dirty())}else if(i.kind==="email")s8.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"email",code:be.invalid_string,message:i.message}),a.dirty());else if(i.kind==="emoji")Up||(Up=new RegExp(r8,"u")),Up.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"emoji",code:be.invalid_string,message:i.message}),a.dirty());else if(i.kind==="uuid")Z$.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"uuid",code:be.invalid_string,message:i.message}),a.dirty());else if(i.kind==="nanoid")X$.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"nanoid",code:be.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid")Q$.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"cuid",code:be.invalid_string,message:i.message}),a.dirty());else if(i.kind==="cuid2")Y$.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"cuid2",code:be.invalid_string,message:i.message}),a.dirty());else if(i.kind==="ulid")J$.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"ulid",code:be.invalid_string,message:i.message}),a.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),De(n,{validation:"url",code:be.invalid_string,message:i.message}),a.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"regex",code:be.invalid_string,message:i.message}),a.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(t,n),De(n,{code:be.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),a.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(n=this._getOrReturnCtx(t,n),De(n,{code:be.invalid_string,validation:{startsWith:i.value},message:i.message}),a.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(n=this._getOrReturnCtx(t,n),De(n,{code:be.invalid_string,validation:{endsWith:i.value},message:i.message}),a.dirty()):i.kind==="datetime"?h8(i).test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{code:be.invalid_string,validation:"datetime",message:i.message}),a.dirty()):i.kind==="date"?d8.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{code:be.invalid_string,validation:"date",message:i.message}),a.dirty()):i.kind==="time"?u8(i).test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{code:be.invalid_string,validation:"time",message:i.message}),a.dirty()):i.kind==="duration"?t8.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"duration",code:be.invalid_string,message:i.message}),a.dirty()):i.kind==="ip"?m8(t.data,i.version)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"ip",code:be.invalid_string,message:i.message}),a.dirty()):i.kind==="jwt"?f8(t.data,i.alg)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"jwt",code:be.invalid_string,message:i.message}),a.dirty()):i.kind==="cidr"?p8(t.data,i.version)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"cidr",code:be.invalid_string,message:i.message}),a.dirty()):i.kind==="base64"?l8.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"base64",code:be.invalid_string,message:i.message}),a.dirty()):i.kind==="base64url"?c8.test(t.data)||(n=this._getOrReturnCtx(t,n),De(n,{validation:"base64url",code:be.invalid_string,message:i.message}),a.dirty()):qt.assertNever(i);return{status:a.value,value:t.data}}_regex(t,s,a){return this.refinement(n=>t.test(n),{validation:s,code:be.invalid_string,...Ve.errToObj(a)})}_addCheck(t){return new _i({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ve.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ve.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ve.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ve.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ve.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ve.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ve.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ve.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ve.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ve.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ve.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ve.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ve.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Ve.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ve.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ve.errToObj(t)})}regex(t,s){return this._addCheck({kind:"regex",regex:t,...Ve.errToObj(s)})}includes(t,s){return this._addCheck({kind:"includes",value:t,position:s==null?void 0:s.position,...Ve.errToObj(s==null?void 0:s.message)})}startsWith(t,s){return this._addCheck({kind:"startsWith",value:t,...Ve.errToObj(s)})}endsWith(t,s){return this._addCheck({kind:"endsWith",value:t,...Ve.errToObj(s)})}min(t,s){return this._addCheck({kind:"min",value:t,...Ve.errToObj(s)})}max(t,s){return this._addCheck({kind:"max",value:t,...Ve.errToObj(s)})}length(t,s){return this._addCheck({kind:"length",value:t,...Ve.errToObj(s)})}nonempty(t){return this.min(1,Ve.errToObj(t))}trim(){return new _i({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new _i({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new _i({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxLength(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}}_i.create=r=>new _i({checks:[],typeName:gt.ZodString,coerce:(r==null?void 0:r.coerce)??!1,...At(r)});function x8(r,t){const s=(r.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=s>a?s:a,i=Number.parseInt(r.toFixed(n).replace(".","")),o=Number.parseInt(t.toFixed(n).replace(".",""));return i%o/10**n}class zl extends Bt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Be.number){const i=this._getOrReturnCtx(t);return De(i,{code:be.invalid_type,expected:Be.number,received:i.parsedType}),xt}let a;const n=new ua;for(const i of this._def.checks)i.kind==="int"?qt.isInteger(t.data)||(a=this._getOrReturnCtx(t,a),De(a,{code:be.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),De(a,{code:be.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),De(a,{code:be.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?x8(t.data,i.value)!==0&&(a=this._getOrReturnCtx(t,a),De(a,{code:be.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(a=this._getOrReturnCtx(t,a),De(a,{code:be.not_finite,message:i.message}),n.dirty()):qt.assertNever(i);return{status:n.value,value:t.data}}gte(t,s){return this.setLimit("min",t,!0,Ve.toString(s))}gt(t,s){return this.setLimit("min",t,!1,Ve.toString(s))}lte(t,s){return this.setLimit("max",t,!0,Ve.toString(s))}lt(t,s){return this.setLimit("max",t,!1,Ve.toString(s))}setLimit(t,s,a,n){return new zl({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:a,message:Ve.toString(n)}]})}_addCheck(t){return new zl({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ve.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ve.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:Ve.toString(s)})}finite(t){return this._addCheck({kind:"finite",message:Ve.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ve.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ve.toString(t)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&qt.isInteger(t.value))}get isFinite(){let t=null,s=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(s===null||a.value>s)&&(s=a.value):a.kind==="max"&&(t===null||a.value<t)&&(t=a.value)}return Number.isFinite(s)&&Number.isFinite(t)}}zl.create=r=>new zl({checks:[],typeName:gt.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...At(r)});class yd extends Bt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Be.bigint)return this._getInvalidInput(t);let a;const n=new ua;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(a=this._getOrReturnCtx(t,a),De(a,{code:be.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(a=this._getOrReturnCtx(t,a),De(a,{code:be.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(a=this._getOrReturnCtx(t,a),De(a,{code:be.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):qt.assertNever(i);return{status:n.value,value:t.data}}_getInvalidInput(t){const s=this._getOrReturnCtx(t);return De(s,{code:be.invalid_type,expected:Be.bigint,received:s.parsedType}),xt}gte(t,s){return this.setLimit("min",t,!0,Ve.toString(s))}gt(t,s){return this.setLimit("min",t,!1,Ve.toString(s))}lte(t,s){return this.setLimit("max",t,!0,Ve.toString(s))}lt(t,s){return this.setLimit("max",t,!1,Ve.toString(s))}setLimit(t,s,a,n){return new yd({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:a,message:Ve.toString(n)}]})}_addCheck(t){return new yd({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ve.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ve.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ve.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ve.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:Ve.toString(s)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}}yd.create=r=>new yd({checks:[],typeName:gt.ZodBigInt,coerce:(r==null?void 0:r.coerce)??!1,...At(r)});class tg extends Bt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Be.boolean){const a=this._getOrReturnCtx(t);return De(a,{code:be.invalid_type,expected:Be.boolean,received:a.parsedType}),xt}return Aa(t.data)}}tg.create=r=>new tg({typeName:gt.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...At(r)});class Kh extends Bt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Be.date){const i=this._getOrReturnCtx(t);return De(i,{code:be.invalid_type,expected:Be.date,received:i.parsedType}),xt}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return De(i,{code:be.invalid_date}),xt}const a=new ua;let n;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(n=this._getOrReturnCtx(t,n),De(n,{code:be.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),a.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(n=this._getOrReturnCtx(t,n),De(n,{code:be.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),a.dirty()):qt.assertNever(i);return{status:a.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Kh({...this._def,checks:[...this._def.checks,t]})}min(t,s){return this._addCheck({kind:"min",value:t.getTime(),message:Ve.toString(s)})}max(t,s){return this._addCheck({kind:"max",value:t.getTime(),message:Ve.toString(s)})}get minDate(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t!=null?new Date(t):null}}Kh.create=r=>new Kh({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:gt.ZodDate,...At(r)});class qj extends Bt{_parse(t){if(this._getType(t)!==Be.symbol){const a=this._getOrReturnCtx(t);return De(a,{code:be.invalid_type,expected:Be.symbol,received:a.parsedType}),xt}return Aa(t.data)}}qj.create=r=>new qj({typeName:gt.ZodSymbol,...At(r)});class Vj extends Bt{_parse(t){if(this._getType(t)!==Be.undefined){const a=this._getOrReturnCtx(t);return De(a,{code:be.invalid_type,expected:Be.undefined,received:a.parsedType}),xt}return Aa(t.data)}}Vj.create=r=>new Vj({typeName:gt.ZodUndefined,...At(r)});class Wj extends Bt{_parse(t){if(this._getType(t)!==Be.null){const a=this._getOrReturnCtx(t);return De(a,{code:be.invalid_type,expected:Be.null,received:a.parsedType}),xt}return Aa(t.data)}}Wj.create=r=>new Wj({typeName:gt.ZodNull,...At(r)});class Hj extends Bt{constructor(){super(...arguments),this._any=!0}_parse(t){return Aa(t.data)}}Hj.create=r=>new Hj({typeName:gt.ZodAny,...At(r)});class Gj extends Bt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Aa(t.data)}}Gj.create=r=>new Gj({typeName:gt.ZodUnknown,...At(r)});class Di extends Bt{_parse(t){const s=this._getOrReturnCtx(t);return De(s,{code:be.invalid_type,expected:Be.never,received:s.parsedType}),xt}}Di.create=r=>new Di({typeName:gt.ZodNever,...At(r)});class Kj extends Bt{_parse(t){if(this._getType(t)!==Be.undefined){const a=this._getOrReturnCtx(t);return De(a,{code:be.invalid_type,expected:Be.void,received:a.parsedType}),xt}return Aa(t.data)}}Kj.create=r=>new Kj({typeName:gt.ZodVoid,...At(r)});class on extends Bt{_parse(t){const{ctx:s,status:a}=this._processInputParams(t),n=this._def;if(s.parsedType!==Be.array)return De(s,{code:be.invalid_type,expected:Be.array,received:s.parsedType}),xt;if(n.exactLength!==null){const o=s.data.length>n.exactLength.value,c=s.data.length<n.exactLength.value;(o||c)&&(De(s,{code:o?be.too_big:be.too_small,minimum:c?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),a.dirty())}if(n.minLength!==null&&s.data.length<n.minLength.value&&(De(s,{code:be.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),a.dirty()),n.maxLength!==null&&s.data.length>n.maxLength.value&&(De(s,{code:be.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),a.dirty()),s.common.async)return Promise.all([...s.data].map((o,c)=>n.type._parseAsync(new Ii(s,o,s.path,c)))).then(o=>ua.mergeArray(a,o));const i=[...s.data].map((o,c)=>n.type._parseSync(new Ii(s,o,s.path,c)));return ua.mergeArray(a,i)}get element(){return this._def.type}min(t,s){return new on({...this._def,minLength:{value:t,message:Ve.toString(s)}})}max(t,s){return new on({...this._def,maxLength:{value:t,message:Ve.toString(s)}})}length(t,s){return new on({...this._def,exactLength:{value:t,message:Ve.toString(s)}})}nonempty(t){return this.min(1,t)}}on.create=(r,t)=>new on({type:r,minLength:null,maxLength:null,exactLength:null,typeName:gt.ZodArray,...At(t)});function hl(r){if(r instanceof Es){const t={};for(const s in r.shape){const a=r.shape[s];t[s]=Ti.create(hl(a))}return new Es({...r._def,shape:()=>t})}else return r instanceof on?new on({...r._def,type:hl(r.element)}):r instanceof Ti?Ti.create(hl(r.unwrap())):r instanceof Vl?Vl.create(hl(r.unwrap())):r instanceof Ao?Ao.create(r.items.map(t=>hl(t))):r}class Es extends Bt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),s=qt.objectKeys(t);return this._cached={shape:t,keys:s},this._cached}_parse(t){if(this._getType(t)!==Be.object){const h=this._getOrReturnCtx(t);return De(h,{code:be.invalid_type,expected:Be.object,received:h.parsedType}),xt}const{status:a,ctx:n}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof Di&&this._def.unknownKeys==="strip"))for(const h in n.data)o.includes(h)||c.push(h);const d=[];for(const h of o){const m=i[h],f=n.data[h];d.push({key:{status:"valid",value:h},value:m._parse(new Ii(n,f,n.path,h)),alwaysSet:h in n.data})}if(this._def.catchall instanceof Di){const h=this._def.unknownKeys;if(h==="passthrough")for(const m of c)d.push({key:{status:"valid",value:m},value:{status:"valid",value:n.data[m]}});else if(h==="strict")c.length>0&&(De(n,{code:be.unrecognized_keys,keys:c}),a.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const m of c){const f=n.data[m];d.push({key:{status:"valid",value:m},value:h._parse(new Ii(n,f,n.path,m)),alwaysSet:m in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const h=[];for(const m of d){const f=await m.key,g=await m.value;h.push({key:f,value:g,alwaysSet:m.alwaysSet})}return h}).then(h=>ua.mergeObjectSync(a,h)):ua.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(t){return Ve.errToObj,new Es({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(s,a)=>{var i,o;const n=((o=(i=this._def).errorMap)==null?void 0:o.call(i,s,a).message)??a.defaultError;return s.code==="unrecognized_keys"?{message:Ve.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new Es({...this._def,unknownKeys:"strip"})}passthrough(){return new Es({...this._def,unknownKeys:"passthrough"})}extend(t){return new Es({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Es({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:gt.ZodObject})}setKey(t,s){return this.augment({[t]:s})}catchall(t){return new Es({...this._def,catchall:t})}pick(t){const s={};for(const a of qt.objectKeys(t))t[a]&&this.shape[a]&&(s[a]=this.shape[a]);return new Es({...this._def,shape:()=>s})}omit(t){const s={};for(const a of qt.objectKeys(this.shape))t[a]||(s[a]=this.shape[a]);return new Es({...this._def,shape:()=>s})}deepPartial(){return hl(this)}partial(t){const s={};for(const a of qt.objectKeys(this.shape)){const n=this.shape[a];t&&!t[a]?s[a]=n:s[a]=n.optional()}return new Es({...this._def,shape:()=>s})}required(t){const s={};for(const a of qt.objectKeys(this.shape))if(t&&!t[a])s[a]=this.shape[a];else{let i=this.shape[a];for(;i instanceof Ti;)i=i._def.innerType;s[a]=i}return new Es({...this._def,shape:()=>s})}keyof(){return m2(qt.objectKeys(this.shape))}}Es.create=(r,t)=>new Es({shape:()=>r,unknownKeys:"strip",catchall:Di.create(),typeName:gt.ZodObject,...At(t)});Es.strictCreate=(r,t)=>new Es({shape:()=>r,unknownKeys:"strict",catchall:Di.create(),typeName:gt.ZodObject,...At(t)});Es.lazycreate=(r,t)=>new Es({shape:r,unknownKeys:"strip",catchall:Di.create(),typeName:gt.ZodObject,...At(t)});class Qh extends Bt{_parse(t){const{ctx:s}=this._processInputParams(t),a=this._def.options;function n(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return s.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new zn(c.ctx.common.issues));return De(s,{code:be.invalid_union,unionErrors:o}),xt}if(s.common.async)return Promise.all(a.map(async i=>{const o={...s,common:{...s.common,issues:[]},parent:null};return{result:await i._parseAsync({data:s.data,path:s.path,parent:o}),ctx:o}})).then(n);{let i;const o=[];for(const d of a){const h={...s,common:{...s.common,issues:[]},parent:null},m=d._parseSync({data:s.data,path:s.path,parent:h});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:h}),h.common.issues.length&&o.push(h.common.issues)}if(i)return s.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(d=>new zn(d));return De(s,{code:be.invalid_union,unionErrors:c}),xt}}get options(){return this._def.options}}Qh.create=(r,t)=>new Qh({options:r,typeName:gt.ZodUnion,...At(t)});function sg(r,t){const s=oi(r),a=oi(t);if(r===t)return{valid:!0,data:r};if(s===Be.object&&a===Be.object){const n=qt.objectKeys(t),i=qt.objectKeys(r).filter(c=>n.indexOf(c)!==-1),o={...r,...t};for(const c of i){const d=sg(r[c],t[c]);if(!d.valid)return{valid:!1};o[c]=d.data}return{valid:!0,data:o}}else if(s===Be.array&&a===Be.array){if(r.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<r.length;i++){const o=r[i],c=t[i],d=sg(o,c);if(!d.valid)return{valid:!1};n.push(d.data)}return{valid:!0,data:n}}else return s===Be.date&&a===Be.date&&+r==+t?{valid:!0,data:r}:{valid:!1}}class Yh extends Bt{_parse(t){const{status:s,ctx:a}=this._processInputParams(t),n=(i,o)=>{if($j(i)||$j(o))return xt;const c=sg(i.value,o.value);return c.valid?((zj(i)||zj(o))&&s.dirty(),{status:s.value,value:c.data}):(De(a,{code:be.invalid_intersection_types}),xt)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}Yh.create=(r,t,s)=>new Yh({left:r,right:t,typeName:gt.ZodIntersection,...At(s)});class Ao extends Bt{_parse(t){const{status:s,ctx:a}=this._processInputParams(t);if(a.parsedType!==Be.array)return De(a,{code:be.invalid_type,expected:Be.array,received:a.parsedType}),xt;if(a.data.length<this._def.items.length)return De(a,{code:be.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),xt;!this._def.rest&&a.data.length>this._def.items.length&&(De(a,{code:be.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const i=[...a.data].map((o,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Ii(a,o,a.path,c)):null}).filter(o=>!!o);return a.common.async?Promise.all(i).then(o=>ua.mergeArray(s,o)):ua.mergeArray(s,i)}get items(){return this._def.items}rest(t){return new Ao({...this._def,rest:t})}}Ao.create=(r,t)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ao({items:r,typeName:gt.ZodTuple,rest:null,...At(t)})};class Qj extends Bt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:s,ctx:a}=this._processInputParams(t);if(a.parsedType!==Be.map)return De(a,{code:be.invalid_type,expected:Be.map,received:a.parsedType}),xt;const n=this._def.keyType,i=this._def.valueType,o=[...a.data.entries()].map(([c,d],h)=>({key:n._parse(new Ii(a,c,a.path,[h,"key"])),value:i._parse(new Ii(a,d,a.path,[h,"value"]))}));if(a.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of o){const h=await d.key,m=await d.value;if(h.status==="aborted"||m.status==="aborted")return xt;(h.status==="dirty"||m.status==="dirty")&&s.dirty(),c.set(h.value,m.value)}return{status:s.value,value:c}})}else{const c=new Map;for(const d of o){const h=d.key,m=d.value;if(h.status==="aborted"||m.status==="aborted")return xt;(h.status==="dirty"||m.status==="dirty")&&s.dirty(),c.set(h.value,m.value)}return{status:s.value,value:c}}}}Qj.create=(r,t,s)=>new Qj({valueType:t,keyType:r,typeName:gt.ZodMap,...At(s)});class vd extends Bt{_parse(t){const{status:s,ctx:a}=this._processInputParams(t);if(a.parsedType!==Be.set)return De(a,{code:be.invalid_type,expected:Be.set,received:a.parsedType}),xt;const n=this._def;n.minSize!==null&&a.data.size<n.minSize.value&&(De(a,{code:be.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),s.dirty()),n.maxSize!==null&&a.data.size>n.maxSize.value&&(De(a,{code:be.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),s.dirty());const i=this._def.valueType;function o(d){const h=new Set;for(const m of d){if(m.status==="aborted")return xt;m.status==="dirty"&&s.dirty(),h.add(m.value)}return{status:s.value,value:h}}const c=[...a.data.values()].map((d,h)=>i._parse(new Ii(a,d,a.path,h)));return a.common.async?Promise.all(c).then(d=>o(d)):o(c)}min(t,s){return new vd({...this._def,minSize:{value:t,message:Ve.toString(s)}})}max(t,s){return new vd({...this._def,maxSize:{value:t,message:Ve.toString(s)}})}size(t,s){return this.min(t,s).max(t,s)}nonempty(t){return this.min(1,t)}}vd.create=(r,t)=>new vd({valueType:r,minSize:null,maxSize:null,typeName:gt.ZodSet,...At(t)});class Yj extends Bt{get schema(){return this._def.getter()}_parse(t){const{ctx:s}=this._processInputParams(t);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}Yj.create=(r,t)=>new Yj({getter:r,typeName:gt.ZodLazy,...At(t)});class Jj extends Bt{_parse(t){if(t.data!==this._def.value){const s=this._getOrReturnCtx(t);return De(s,{received:s.data,code:be.invalid_literal,expected:this._def.value}),xt}return{status:"valid",value:t.data}}get value(){return this._def.value}}Jj.create=(r,t)=>new Jj({value:r,typeName:gt.ZodLiteral,...At(t)});function m2(r,t){return new Bl({values:r,typeName:gt.ZodEnum,...At(t)})}class Bl extends Bt{_parse(t){if(typeof t.data!="string"){const s=this._getOrReturnCtx(t),a=this._def.values;return De(s,{expected:qt.joinValues(a),received:s.parsedType,code:be.invalid_type}),xt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const s=this._getOrReturnCtx(t),a=this._def.values;return De(s,{received:s.data,code:be.invalid_enum_value,options:a}),xt}return Aa(t.data)}get options(){return this._def.values}get enum(){const t={};for(const s of this._def.values)t[s]=s;return t}get Values(){const t={};for(const s of this._def.values)t[s]=s;return t}get Enum(){const t={};for(const s of this._def.values)t[s]=s;return t}extract(t,s=this._def){return Bl.create(t,{...this._def,...s})}exclude(t,s=this._def){return Bl.create(this.options.filter(a=>!t.includes(a)),{...this._def,...s})}}Bl.create=m2;class Zj extends Bt{_parse(t){const s=qt.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(t);if(a.parsedType!==Be.string&&a.parsedType!==Be.number){const n=qt.objectValues(s);return De(a,{expected:qt.joinValues(n),received:a.parsedType,code:be.invalid_type}),xt}if(this._cache||(this._cache=new Set(qt.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=qt.objectValues(s);return De(a,{received:a.data,code:be.invalid_enum_value,options:n}),xt}return Aa(t.data)}get enum(){return this._def.values}}Zj.create=(r,t)=>new Zj({values:r,typeName:gt.ZodNativeEnum,...At(t)});class Jh extends Bt{unwrap(){return this._def.type}_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==Be.promise&&s.common.async===!1)return De(s,{code:be.invalid_type,expected:Be.promise,received:s.parsedType}),xt;const a=s.parsedType===Be.promise?s.data:Promise.resolve(s.data);return Aa(a.then(n=>this._def.type.parseAsync(n,{path:s.path,errorMap:s.common.contextualErrorMap})))}}Jh.create=(r,t)=>new Jh({type:r,typeName:gt.ZodPromise,...At(t)});class ql extends Bt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===gt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:s,ctx:a}=this._processInputParams(t),n=this._def.effect||null,i={addIssue:o=>{De(a,o),o.fatal?s.abort():s.dirty()},get path(){return a.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){const o=n.transform(a.data,i);if(a.common.async)return Promise.resolve(o).then(async c=>{if(s.value==="aborted")return xt;const d=await this._def.schema._parseAsync({data:c,path:a.path,parent:a});return d.status==="aborted"?xt:d.status==="dirty"||s.value==="dirty"?qc(d.value):d});{if(s.value==="aborted")return xt;const c=this._def.schema._parseSync({data:o,path:a.path,parent:a});return c.status==="aborted"?xt:c.status==="dirty"||s.value==="dirty"?qc(c.value):c}}if(n.type==="refinement"){const o=c=>{const d=n.refinement(c,i);if(a.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(a.common.async===!1){const c=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return c.status==="aborted"?xt:(c.status==="dirty"&&s.dirty(),o(c.value),{status:s.value,value:c.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(c=>c.status==="aborted"?xt:(c.status==="dirty"&&s.dirty(),o(c.value).then(()=>({status:s.value,value:c.value}))))}if(n.type==="transform")if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!$l(o))return xt;const c=n.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:c}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>$l(o)?Promise.resolve(n.transform(o.value,i)).then(c=>({status:s.value,value:c})):xt);qt.assertNever(n)}}ql.create=(r,t,s)=>new ql({schema:r,typeName:gt.ZodEffects,effect:t,...At(s)});ql.createWithPreprocess=(r,t,s)=>new ql({schema:t,effect:{type:"preprocess",transform:r},typeName:gt.ZodEffects,...At(s)});class Ti extends Bt{_parse(t){return this._getType(t)===Be.undefined?Aa(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ti.create=(r,t)=>new Ti({innerType:r,typeName:gt.ZodOptional,...At(t)});class Vl extends Bt{_parse(t){return this._getType(t)===Be.null?Aa(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Vl.create=(r,t)=>new Vl({innerType:r,typeName:gt.ZodNullable,...At(t)});class rg extends Bt{_parse(t){const{ctx:s}=this._processInputParams(t);let a=s.data;return s.parsedType===Be.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}rg.create=(r,t)=>new rg({innerType:r,typeName:gt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...At(t)});class ag extends Bt{_parse(t){const{ctx:s}=this._processInputParams(t),a={...s,common:{...s.common,issues:[]}},n=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Gh(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new zn(a.common.issues)},input:a.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new zn(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}ag.create=(r,t)=>new ag({innerType:r,typeName:gt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...At(t)});class Xj extends Bt{_parse(t){if(this._getType(t)!==Be.nan){const a=this._getOrReturnCtx(t);return De(a,{code:be.invalid_type,expected:Be.nan,received:a.parsedType}),xt}return{status:"valid",value:t.data}}}Xj.create=r=>new Xj({typeName:gt.ZodNaN,...At(r)});class g8 extends Bt{_parse(t){const{ctx:s}=this._processInputParams(t),a=s.data;return this._def.type._parse({data:a,path:s.path,parent:s})}unwrap(){return this._def.type}}class jy extends Bt{_parse(t){const{status:s,ctx:a}=this._processInputParams(t);if(a.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return i.status==="aborted"?xt:i.status==="dirty"?(s.dirty(),qc(i.value)):this._def.out._parseAsync({data:i.value,path:a.path,parent:a})})();{const n=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?xt:n.status==="dirty"?(s.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:a.path,parent:a})}}static create(t,s){return new jy({in:t,out:s,typeName:gt.ZodPipeline})}}class ng extends Bt{_parse(t){const s=this._def.innerType._parse(t),a=n=>($l(n)&&(n.value=Object.freeze(n.value)),n);return Gh(s)?s.then(n=>a(n)):a(s)}unwrap(){return this._def.innerType}}ng.create=(r,t)=>new ng({innerType:r,typeName:gt.ZodReadonly,...At(t)});Es.lazycreate;var gt;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(gt||(gt={}));const ys=_i.create,ig=zl.create,f2=tg.create;Di.create;on.create;const zi=Es.create;Es.strictCreate;Qh.create;Yh.create;Ao.create;const og=Bl.create;Jh.create;Ti.create;Vl.create;const y8=tc("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),vt=p.forwardRef(({className:r,variant:t,...s},a)=>e.jsx("div",{ref:a,role:"alert",className:Ie(y8({variant:t}),r),...s}));vt.displayName="Alert";const v8=p.forwardRef(({className:r,...t},s)=>e.jsx("h5",{ref:s,className:Ie("mb-1 font-medium leading-none tracking-tight",r),...t}));v8.displayName="AlertTitle";const wt=p.forwardRef(({className:r,...t},s)=>e.jsx("div",{ref:s,className:Ie("text-sm [&_p]:leading-relaxed",r),...t}));wt.displayName="AlertDescription";const w8=zi({rating:ig().min(1,"Please select a rating").max(5,"Rating must be between 1 and 5"),title:ys().min(5,"Title must be at least 5 characters").max(100,"Title must be less than 100 characters"),content:ys().min(20,"Review must be at least 20 characters").max(1e3,"Review must be less than 1000 characters")}),j8=({lawFirm:r,onReviewSubmitted:t,onCancel:s,className:a=""})=>{const[n,i]=p.useState(!1),[o,c]=p.useState(0),[d,h]=p.useState(0),{user:m}=ft(),{register:f,handleSubmit:g,setValue:y,watch:b,formState:{errors:w}}=Ui({resolver:$i(w8)}),S=b("content",""),N=async k=>{if(!m){te.error("Please log in to submit a review");return}i(!0);try{const I={law_firm_id:r.id,rating:k.rating,title:k.title,content:k.content};await Ur.createReview(I),te.success("Review submitted successfully! It will be published after moderation."),t==null||t()}catch(I){console.error("Error submitting review:",I),te.error("Failed to submit review: "+I.message)}finally{i(!1)}},v=k=>{c(k),y("rating",k)},j=()=>Array.from({length:5},(k,I)=>{const T=I+1,O=T<=(d||o);return e.jsx("button",{type:"button",className:`p-1 transition-colors ${O?"text-yellow-400":"text-gray-300 hover:text-yellow-300"}`,onMouseEnter:()=>h(T),onMouseLeave:()=>h(0),onClick:()=>v(T),children:e.jsx(Ot,{className:`h-8 w-8 ${O?"fill-current":""}`})},I)}),C=k=>({1:"Poor",2:"Fair",3:"Good",4:"Very Good",5:"Excellent"})[k]||"";return m?e.jsxs($,{className:a,children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(Ft,{className:"h-5 w-5"}),e.jsxs("span",{children:["Write a Review for ",r.name]})]}),e.jsx(ye,{children:"Share your experience to help others make informed decisions"})]}),e.jsx(z,{children:e.jsxs("form",{onSubmit:g(N),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{className:"text-base font-medium",children:"Overall Rating *"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex",children:j()}),o>0&&e.jsx("span",{className:"text-lg font-medium text-gray-700",children:C(o)})]}),w.rating&&e.jsx("p",{className:"text-red-500 text-sm",children:w.rating.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"title",className:"text-base font-medium",children:"Review Title *"}),e.jsx(Pe,{id:"title",...f("title"),placeholder:"Summarize your experience in a few words",className:"w-full"}),w.title&&e.jsx("p",{className:"text-red-500 text-sm",children:w.title.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"content",className:"text-base font-medium",children:"Your Review *"}),e.jsx(Sr,{id:"content",...f("content"),placeholder:"Tell others about your experience with this law firm. What services did you use? How was the communication? Would you recommend them?",rows:6,className:"w-full resize-none"}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[e.jsx("span",{children:w.content?e.jsx("span",{className:"text-red-500",children:w.content.message}):"Minimum 20 characters"}),e.jsxs("span",{children:[S.length,"/1000"]})]})]}),e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs(wt,{className:"text-sm",children:[e.jsx("strong",{children:"Review Guidelines:"}),e.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Be honest and constructive in your feedback"}),e.jsx("li",{children:"Focus on your personal experience with the law firm"}),e.jsx("li",{children:"Avoid sharing confidential or sensitive information"}),e.jsx("li",{children:"Reviews are moderated and may take time to appear"})]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(R,{type:"submit",disabled:n||o===0,className:"flex-1",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Kg,{className:"h-4 w-4 mr-2"}),"Submit Review"]})}),s&&e.jsx(R,{type:"button",variant:"outline",onClick:s,disabled:n,children:"Cancel"})]}),o>0&&e.jsxs(vt,{children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsxs(wt,{className:"text-sm",children:["Your ",o,"-star review will help other users make informed decisions about ",r.name,"."]})]})]})})]}):e.jsx($,{className:a,children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Ft,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sign in to write a review"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You need to be logged in to submit a review for this law firm."}),e.jsx(R,{onClick:()=>window.location.href="/login",children:"Sign In"})]})})},b8=()=>e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ca,{}),e.jsx(GS,{}),e.jsx(Ea,{})]}),by=()=>{const[r,t]=p.useState([]),[s,a]=p.useState(!1),n=async()=>{a(!0);const d=[],h={VITE_SUPABASE_URL:"https://kvlaydeyqidlfpfutbmp.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt2bGF5ZGV5cWlkbGZwZnV0Ym1wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyODgzNzAsImV4cCI6MjA2NTg2NDM3MH0.XVSO5W_0v6wW-MYlM7i0MTNKprOWp_O4ON-5LqqVnzw",VITE_APP_URL:"https://craftchatbot.com",NODE_ENV:void 0,MODE:"production"},m=Object.entries(h).filter(([b,w])=>!w);d.push({category:"Environment",name:"Environment Variables",status:m.length>0?"error":"success",message:m.length>0?`Missing: ${m.map(([b])=>b).join(", ")}`:"All environment variables present",details:h,fix:m.length>0?"Check your hosting platform environment variables configuration":void 0});const f=window.location.origin,g="https://craftchatbot.com";d.push({category:"Configuration",name:"URL Configuration",status:f===g?"success":"warning",message:`Current: ${f}, Configured: ${g}`,details:{currentUrl:f,configuredUrl:g},fix:f!==g?"Update VITE_APP_URL environment variable to match production URL":void 0});try{const{supabase:b}=await Ns(async()=>{const{supabase:N}=await Promise.resolve().then(()=>Ip);return{supabase:N}},void 0),{data:w,error:S}=await b.from("profiles").select("count").limit(1);d.push({category:"Database",name:"Supabase Connection",status:S?"error":"success",message:S?`Connection failed: ${S.message}`:"Connected successfully",details:{data:w,error:S},fix:S?"Check Supabase URL and API key configuration":void 0})}catch(b){d.push({category:"Database",name:"Supabase Connection",status:"error",message:`Import failed: ${b instanceof Error?b.message:"Unknown error"}`,details:b,fix:"Check if Supabase is properly configured and imported"})}try{const{supabase:b}=await Ns(async()=>{const{supabase:N}=await Promise.resolve().then(()=>Ip);return{supabase:N}},void 0),{data:{user:w},error:S}=await b.auth.getUser();d.push({category:"Authentication",name:"User Session",status:S?"error":w?"success":"warning",message:S?`Auth error: ${S.message}`:w?`Logged in as ${w.email}`:"Not authenticated",details:{user:w?{id:w.id,email:w.email}:null,error:S},fix:!w&&!S?"User needs to log in to access document features":void 0})}catch(b){d.push({category:"Authentication",name:"User Session",status:"error",message:`Auth check failed: ${b instanceof Error?b.message:"Unknown error"}`,details:b})}try{const{documentsApi:b}=await Ns(async()=>{const{documentsApi:S}=await Promise.resolve().then(()=>Az);return{documentsApi:S}},void 0),w=await b.getDocuments();d.push({category:"API",name:"Documents API",status:"success",message:`Successfully fetched ${w.length} documents`,details:{count:w.length,sample:w.slice(0,2)}})}catch(b){d.push({category:"API",name:"Documents API",status:"error",message:`API call failed: ${b instanceof Error?b.message:"Unknown error"}`,details:b,fix:"Check database schema and RLS policies for uploaded_documents table"})}try{const{supabase:b}=await Ns(async()=>{const{supabase:v}=await Promise.resolve().then(()=>Ip);return{supabase:v}},void 0),{data:w,error:S}=await b.storage.listBuckets(),N=w==null?void 0:w.find(v=>v.name==="documents");d.push({category:"Storage",name:"Documents Bucket",status:S?"error":N?"success":"error",message:S?`Storage error: ${S.message}`:N?"Documents bucket exists":"Documents bucket not found",details:{buckets:w==null?void 0:w.map(v=>v.name),error:S},fix:N?void 0:"Create documents storage bucket in Supabase dashboard"})}catch(b){d.push({category:"Storage",name:"Documents Bucket",status:"error",message:`Storage check failed: ${b instanceof Error?b.message:"Unknown error"}`,details:b})}const y=window.__consoleErrors||[];d.push({category:"Runtime",name:"Console Errors",status:y.length>0?"warning":"success",message:y.length>0?`${y.length} console errors detected`:"No console errors detected",details:y.slice(0,5),fix:y.length>0?"Check browser console for detailed error messages":void 0}),t(d),a(!1)};p.useEffect(()=>{const d=console.error;return window.__consoleErrors=[],console.error=(...h)=>{window.__consoleErrors.push(h.join(" ")),d.apply(console,h)},n(),()=>{console.error=d}},[]);const i=d=>{switch(d){case"success":return e.jsx(Ue,{className:"h-5 w-5 text-green-500"});case"error":return e.jsx(Qs,{className:"h-5 w-5 text-red-500"});case"warning":return e.jsx(It,{className:"h-5 w-5 text-yellow-500"});case"pending":return e.jsx(mr,{className:"h-5 w-5 text-blue-500 animate-spin"})}},o=d=>{switch(d){case"Environment":case"Configuration":return e.jsx(Wg,{className:"h-4 w-4"});case"Database":return e.jsx(Rh,{className:"h-4 w-4"});case"Authentication":return e.jsx(Dh,{className:"h-4 w-4"});case"Storage":return e.jsx(_r,{className:"h-4 w-4"});default:return e.jsx(It,{className:"h-4 w-4"})}},c=r.reduce((d,h)=>(d[h.category]||(d[h.category]=[]),d[h.category].push(h),d),{});return e.jsxs($,{className:"max-w-6xl mx-auto",children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center justify-between",children:["Production Diagnostics",e.jsxs(R,{onClick:n,disabled:s,size:"sm",children:[e.jsx(mr,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),s?"Running...":"Run Diagnostics"]})]})}),e.jsx(z,{children:e.jsx("div",{className:"space-y-6",children:Object.entries(c).map(([d,h])=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[o(d),e.jsx("span",{className:"ml-2",children:d})]}),e.jsx("div",{className:"space-y-2",children:h.map((m,f)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[i(m.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:m.name}),e.jsx("p",{className:"text-sm text-gray-600",children:m.message}),m.fix&&e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:[e.jsx("strong",{children:"Fix:"})," ",m.fix]}),!1]})]},f))})]},d))})})]})},_8=()=>{const[r,t]=p.useState(""),[s,a]=p.useState(!1),n=[{id:1,title:"Employment Contract Template",description:"Standard employment agreement template compliant with Singapore's Employment Act",category:"Employment",downloads:1250,rating:4.8,price:"Free",isPopular:!0},{id:2,title:"Tenancy Agreement",description:"Comprehensive rental agreement template for residential properties",category:"Property",downloads:980,rating:4.7,price:"$15",isPopular:!0},{id:3,title:"Non-Disclosure Agreement (NDA)",description:"Protect your confidential information with this legally binding NDA",category:"Corporate",downloads:750,rating:4.9,price:"$10",isPopular:!1},{id:4,title:"Power of Attorney",description:"Grant legal authority to act on your behalf in specific matters",category:"Personal",downloads:420,rating:4.6,price:"$20",isPopular:!1}],i=["All","Employment","Property","Corporate","Personal","Family","Immigration"],o=[{icon:Z5,title:"AI-Powered Analysis",description:"Upload any legal document for instant AI analysis and summary"},{icon:vs,title:"Singapore Law Compliant",description:"All templates are updated to comply with current Singapore regulations"},{icon:Ue,title:"Lawyer Reviewed",description:"Every template is reviewed and approved by qualified Singapore lawyers"}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ca,{}),e.jsx("section",{className:"bg-blue-900 text-white pt-24 pb-16",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Legal Documents & Analysis"}),e.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-3xl mx-auto",children:"Upload documents for AI-powered analysis or download customizable legal templates specific to Singapore law."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center max-w-md mx-auto",children:[e.jsxs(R,{size:"lg",className:"bg-yellow-500 hover:bg-yellow-600 text-blue-900 font-semibold",children:[e.jsx(_r,{className:"mr-2 h-5 w-5"}),"Analyze Document"]}),e.jsxs(R,{size:"lg",variant:"outline",className:"border-white text-white hover:bg-white hover:text-blue-900",children:[e.jsx(fs,{className:"mr-2 h-5 w-5"}),"Browse Templates"]})]})]})})}),e.jsx("section",{className:"py-16 bg-white",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:o.map((c,d)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mx-auto mb-4",children:e.jsx(c.icon,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:c.title}),e.jsx("p",{className:"text-gray-600",children:c.description})]},d))})})}),e.jsx("section",{className:"py-16 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Document Analysis"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Upload any legal document and get instant AI-powered analysis, key terms extraction, and risk assessment."})]}),e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx($,{className:"border-2 border-dashed border-gray-300 hover:border-blue-400 transition-colors",children:e.jsxs(z,{className:"p-12 text-center",children:[e.jsx(_r,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Upload Your Document"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Drag and drop your PDF, Word, or image file here, or click to browse"}),e.jsx(R,{className:"bg-blue-600 hover:bg-blue-700",children:"Choose File"}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Supported formats: PDF, DOC, DOCX, JPG, PNG (Max 10MB)"})]})})})]})}),e.jsx("section",{className:"py-16 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Document Templates"}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(Pe,{type:"text",placeholder:"Search templates...",value:r,onChange:c=>t(c.target.value),className:"pl-10 w-64"})]})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-8",children:i.map(c=>e.jsx(ae,{variant:c==="All"?"default":"outline",className:"cursor-pointer hover:bg-blue-50",children:c},c))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(c=>e.jsxs($,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(Z,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-lg font-semibold text-gray-900 mb-2",children:c.title}),c.isPopular&&e.jsx(ae,{className:"bg-yellow-100 text-yellow-800 mb-2",children:"Popular"})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-lg font-bold text-blue-600",children:c.price})})]}),e.jsx(ye,{className:"text-gray-600",children:c.description})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(ae,{variant:"secondary",children:c.category}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:c.downloads})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(Gt,{className:"h-4 w-4 mr-1"}),"Preview"]}),e.jsxs(R,{size:"sm",className:"flex-1 bg-blue-600 hover:bg-blue-700",children:[e.jsx(fs,{className:"h-4 w-4 mr-1"}),"Download"]})]})]})]},c.id))}),e.jsx("div",{className:"text-center mt-12",children:e.jsx(R,{variant:"outline",size:"lg",children:"View All Templates"})})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Debug Tools - Public Documents Page"}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>a(!1),children:"Close"})]}),e.jsx("div",{className:"p-4",children:e.jsx(by,{})})]})}),e.jsx(R,{onClick:()=>a(!0),className:"fixed bottom-4 right-4 z-[9999] bg-red-600 hover:bg-red-700 text-white shadow-lg border-2 border-white",size:"sm",children:"🐛 Debug"}),e.jsx(Ea,{})]})},Sn="https://kvlaydeyqidlfpfutbmp.supabase.co".includes("placeholder")||!1||!1||!1,ao=[{id:"1",name:"Employment Law",description:"Questions about workplace rights, contracts, and employment issues",icon:"briefcase",color:"#3B82F6",parent_id:null,order_index:1,is_active:!0,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",question_count:45},{id:"2",name:"Property Law",description:"Real estate transactions, property disputes, and housing matters",icon:"home",color:"#10B981",parent_id:null,order_index:2,is_active:!0,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",question_count:32},{id:"3",name:"Family Law",description:"Divorce, custody, marriage, and family-related legal matters",icon:"users",color:"#F59E0B",parent_id:null,order_index:3,is_active:!0,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",question_count:28},{id:"4",name:"Business Law",description:"Corporate law, contracts, and business-related legal issues",icon:"building",color:"#8B5CF6",parent_id:null,order_index:4,is_active:!0,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",question_count:38},{id:"5",name:"Criminal Law",description:"Criminal charges, court proceedings, and criminal defense",icon:"shield",color:"#EF4444",parent_id:null,order_index:5,is_active:!0,created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z",question_count:22}],eh=[{id:"1",user_id:"user1",category_id:"1",title:"Can my employer terminate me without notice during probation?",content:"I am currently on a 6-month probation period at my new job in Singapore. My employer mentioned they can terminate me without notice during this period. Is this legal? What are my rights as an employee during probation?",tags:["employment","probation","termination","singapore"],urgency_level:"high",location:"Singapore",is_anonymous:!1,status:"open",view_count:156,upvote_count:12,downvote_count:1,answer_count:3,has_expert_answer:!0,has_ai_answer:!0,featured:!0,moderation_status:"approved",created_at:"2024-01-15T10:30:00Z",updated_at:"2024-01-15T10:30:00Z",user:{id:"user1",full_name:"Sarah Chen",avatar_url:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150"},category:ao[0]},{id:"2",user_id:"user2",category_id:"2",title:"Property cooling measures - impact on first-time buyers",content:"With the recent property cooling measures announced by the government, how will this affect first-time home buyers in Singapore? Are there any exemptions or special considerations for citizens buying their first property?",tags:["property","cooling-measures","first-time-buyer","hdb"],urgency_level:"normal",location:"Singapore",is_anonymous:!1,status:"open",view_count:89,upvote_count:8,downvote_count:0,answer_count:2,has_expert_answer:!1,has_ai_answer:!0,featured:!1,moderation_status:"approved",created_at:"2024-01-14T14:20:00Z",updated_at:"2024-01-14T14:20:00Z",user:{id:"user2",full_name:"Michael Tan",avatar_url:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150"},category:ao[1]},{id:"3",user_id:"user3",category_id:"3",title:"Divorce proceedings and child custody arrangements",content:"My spouse and I are considering divorce. We have two young children (ages 5 and 8). What factors do Singapore courts consider when determining child custody? Can we arrange for joint custody?",tags:["divorce","child-custody","family-court","joint-custody"],urgency_level:"high",location:"Singapore",is_anonymous:!0,status:"open",view_count:234,upvote_count:15,downvote_count:2,answer_count:4,has_expert_answer:!0,has_ai_answer:!1,featured:!0,moderation_status:"approved",created_at:"2024-01-13T09:15:00Z",updated_at:"2024-01-13T09:15:00Z",user:{id:"user3",full_name:"Anonymous User",avatar_url:void 0},category:ao[2]},{id:"4",user_id:"user4",category_id:"4",title:"Setting up a private limited company in Singapore",content:"I want to incorporate a private limited company in Singapore. What are the minimum requirements, costs involved, and ongoing compliance obligations? Do I need a local director?",tags:["incorporation","private-limited","company-setup","compliance"],urgency_level:"normal",location:"Singapore",is_anonymous:!1,status:"open",view_count:67,upvote_count:6,downvote_count:0,answer_count:1,has_expert_answer:!1,has_ai_answer:!0,featured:!1,moderation_status:"approved",created_at:"2024-01-12T16:45:00Z",updated_at:"2024-01-12T16:45:00Z",user:{id:"user4",full_name:"David Lim",avatar_url:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150"},category:ao[3]},{id:"5",user_id:"user5",category_id:"5",title:"Traffic violation - what are my options?",content:"I received a traffic summons for speeding. This is my first offense. What are my options? Should I plead guilty or contest it in court? What are the potential penalties?",tags:["traffic-violation","speeding","summons","first-offense"],urgency_level:"low",location:"Singapore",is_anonymous:!1,status:"open",view_count:45,upvote_count:3,downvote_count:0,answer_count:0,has_expert_answer:!1,has_ai_answer:!1,featured:!1,moderation_status:"approved",created_at:"2024-01-11T11:30:00Z",updated_at:"2024-01-11T11:30:00Z",user:{id:"user5",full_name:"Jennifer Wong",avatar_url:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150"},category:ao[4]}],tr={async getCategories(){console.log("getCategories called, isPlaceholder:",Sn);try{const{data:r,error:t}=await D.from("legal_qa_categories").select("*").eq("is_active",!0).order("order_index");return t?(console.error("Error fetching Q&A categories:",t),console.log("Falling back to mock categories"),[...ao]):(console.log("Categories loaded from database:",r==null?void 0:r.length),r||[])}catch(r){return console.error("Exception in getCategories:",r),[...ao]}},async getCategoryWithQuestionCount(r){const{data:t,error:s}=await D.from("legal_qa_categories").select(`
        *,
        question_count:legal_questions(count)
      `).eq("id",r).eq("is_active",!0).single();if(s)throw console.error("Error fetching category:",s),new Error("Failed to fetch category");return t},async getQuestions(r={}){if(console.log("getQuestions called, isPlaceholder:",Sn),console.log("getQuestions filters:",r),Sn)return console.log("Returning mock questions with filters:",r),console.log("mockQuestions length:",eh.length),new Promise((o,c)=>{setTimeout(()=>{try{console.log("Mock questions timeout started");let d=[...eh];if(r.category_id&&(d=d.filter(b=>b.category_id===r.category_id)),r.status&&(d=d.filter(b=>b.status===r.status)),r.urgency_level&&(d=d.filter(b=>b.urgency_level===r.urgency_level)),r.has_expert_answer!==void 0&&(d=d.filter(b=>b.has_expert_answer===r.has_expert_answer)),r.has_ai_answer!==void 0&&(d=d.filter(b=>b.has_ai_answer===r.has_ai_answer)),r.featured!==void 0&&(d=d.filter(b=>b.featured===r.featured)),r.search){const b=r.search.toLowerCase();d=d.filter(w=>w.title.toLowerCase().includes(b)||w.content.toLowerCase().includes(b)||w.tags.some(S=>S.toLowerCase().includes(b)))}switch(r.sort_by){case"oldest":d.sort((b,w)=>new Date(b.created_at).getTime()-new Date(w.created_at).getTime());break;case"most_votes":d.sort((b,w)=>w.upvote_count-b.upvote_count);break;case"most_answers":d.sort((b,w)=>w.answer_count-b.answer_count);break;case"most_views":d.sort((b,w)=>w.view_count-b.view_count);break;case"newest":default:d.sort((b,w)=>new Date(w.created_at).getTime()-new Date(b.created_at).getTime());break}const h=r.page||1,m=r.limit||20,f=(h-1)*m,g=f+m,y=d.slice(f,g);console.log("Mock questions timeout resolved, returning:",y),console.log("Result length:",y.length),console.log("Result is array:",Array.isArray(y)),o(y)}catch(d){console.error("Error in mock questions timeout:",d),c(d)}},50)});let t=D.from("legal_questions").select(`
        *,
        user:profiles(id, full_name, avatar_url),
        category:legal_qa_categories(id, name, color)
      `).eq("moderation_status","approved");switch(r.category_id&&(t=t.eq("category_id",r.category_id)),r.status&&(t=t.eq("status",r.status)),r.urgency_level&&(t=t.eq("urgency_level",r.urgency_level)),r.has_expert_answer!==void 0&&(t=t.eq("has_expert_answer",r.has_expert_answer)),r.has_ai_answer!==void 0&&(t=t.eq("has_ai_answer",r.has_ai_answer)),r.featured!==void 0&&(t=t.eq("featured",r.featured)),r.location&&(t=t.ilike("location",`%${r.location}%`)),r.search&&(t=t.or(`title.ilike.%${r.search}%,content.ilike.%${r.search}%,tags.cs.{${r.search}}`)),r.tags&&r.tags.length>0&&(t=t.overlaps("tags",r.tags)),r.sort_by){case"oldest":t=t.order("created_at",{ascending:!0});break;case"most_votes":t=t.order("upvote_count",{ascending:!1});break;case"most_answers":t=t.order("answer_count",{ascending:!1});break;case"most_views":t=t.order("view_count",{ascending:!1});break;case"newest":default:t=t.order("created_at",{ascending:!1});break}const s=r.limit||20,a=((r.page||1)-1)*s;t=t.range(a,a+s-1);const{data:n,error:i}=await t;if(i)throw console.error("Error fetching questions:",i),new Error("Failed to fetch questions");return n||[]},async getQuestion(r){if(Sn)return new Promise((a,n)=>{setTimeout(()=>{const i=eh.find(o=>o.id===r);i?(i.view_count+=1,a(i)):n(new Error("Question not found"))},300)});const{data:t,error:s}=await D.from("legal_questions").select(`
        *,
        user:profiles(id, full_name, avatar_url),
        category:legal_qa_categories(id, name, color, description)
      `).eq("id",r).eq("moderation_status","approved").single();if(s)throw console.error("Error fetching question:",s),new Error("Failed to fetch question");return await D.from("legal_questions").update({view_count:t.view_count+1}).eq("id",r),t},async createQuestion(r){const{data:t,error:s}=await D.from("legal_questions").insert({...r,moderation_status:"pending"}).select(`
        *,
        user:profiles(id, full_name, avatar_url),
        category:legal_qa_categories(id, name, color)
      `).single();if(s)throw console.error("Error creating question:",s),new Error("Failed to create question");return t},async updateQuestion(r,t){const{data:s,error:a}=await D.from("legal_questions").update(t).eq("id",r).select(`
        *,
        user:profiles(id, full_name, avatar_url),
        category:legal_qa_categories(id, name, color)
      `).single();if(a)throw console.error("Error updating question:",a),new Error("Failed to update question");return s},async getAnswers(r={}){if(Sn)return new Promise(n=>{setTimeout(()=>{let o=[{id:"1",question_id:"1",user_id:"expert1",content:`During probation periods in Singapore, employers do have more flexibility in termination, but there are still legal requirements to follow:

**Key Points:**
1. **Notice Period**: While the Employment Act allows for shorter notice during probation, most employment contracts specify the exact terms.
2. **Just Cause**: Employers should still have valid reasons for termination, even during probation.
3. **Documentation**: Proper documentation of performance issues is recommended.

**Your Rights:**
- Right to receive any outstanding salary and benefits
- Right to proper notice as per your contract
- Protection against discriminatory termination

**Recommendation**: Review your employment contract carefully for specific probation terms and consider consulting with MOM if you believe the termination was unfair.`,answer_type:"expert",sources:["Employment Act (Singapore)","Ministry of Manpower Guidelines"],disclaimer:null,is_accepted:!0,expert_verified:!0,upvote_count:15,downvote_count:1,helpful_count:12,moderation_status:"approved",created_at:"2024-01-15T11:30:00Z",updated_at:"2024-01-15T11:30:00Z",user:{id:"expert1",full_name:"Sarah Lim, Employment Lawyer",avatar_url:"https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=150"}},{id:"2",question_id:"1",user_id:"ai",content:`Based on Singapore employment law, here's what you should know about probation period terminations:

**Legal Framework:**
- The Employment Act provides the basic framework for employment relationships
- Probation periods are contractual arrangements between employer and employee
- Different rules may apply based on your employment contract

**During Probation:**
- Employers generally have more flexibility to terminate
- Notice periods may be shorter (often 1 day to 1 week)
- Performance standards may be more strictly applied

**Important Considerations:**
- Check your specific employment contract terms
- Ensure termination is not discriminatory
- You're entitled to outstanding wages and benefits

**Next Steps:**
- Review your employment contract
- Document any relevant communications
- Consider seeking legal advice if you believe the termination was unfair`,answer_type:"ai",sources:["Singapore Employment Act","MOM Employment Guidelines"],disclaimer:"This AI-generated response is for informational purposes only and does not constitute legal advice.",is_accepted:!1,expert_verified:!1,upvote_count:8,downvote_count:0,helpful_count:6,moderation_status:"approved",created_at:"2024-01-15T12:00:00Z",updated_at:"2024-01-15T12:00:00Z",user:{id:"ai",full_name:"AI Assistant",avatar_url:void 0}}];switch(r.question_id&&(o=o.filter(c=>c.question_id===r.question_id)),r.answer_type&&(o=o.filter(c=>c.answer_type===r.answer_type)),r.expert_verified!==void 0&&(o=o.filter(c=>c.expert_verified===r.expert_verified)),r.is_accepted!==void 0&&(o=o.filter(c=>c.is_accepted===r.is_accepted)),r.sort_by){case"oldest":o.sort((c,d)=>new Date(c.created_at).getTime()-new Date(d.created_at).getTime());break;case"most_votes":o.sort((c,d)=>d.upvote_count-c.upvote_count);break;case"most_helpful":o.sort((c,d)=>d.helpful_count-c.helpful_count);break;case"newest":default:o.sort((c,d)=>new Date(d.created_at).getTime()-new Date(c.created_at).getTime());break}o.sort((c,d)=>(d.is_accepted?1:0)-(c.is_accepted?1:0)),n(o)},300)});let t=D.from("legal_answers").select(`
        *,
        user:profiles(id, full_name, avatar_url),
        expert:legal_experts(
          id,
          specializations,
          years_experience,
          verification_status,
          user:profiles(id, full_name, avatar_url),
          law_firm:law_firms(id, name, logo_url)
        )
      `).eq("moderation_status","approved");switch(r.question_id&&(t=t.eq("question_id",r.question_id)),r.answer_type&&(t=t.eq("answer_type",r.answer_type)),r.expert_verified!==void 0&&(t=t.eq("expert_verified",r.expert_verified)),r.is_accepted!==void 0&&(t=t.eq("is_accepted",r.is_accepted)),r.sort_by){case"oldest":t=t.order("created_at",{ascending:!0});break;case"most_votes":t=t.order("upvote_count",{ascending:!1});break;case"most_helpful":t=t.order("helpful_count",{ascending:!1});break;case"newest":default:t=t.order("created_at",{ascending:!1});break}t=t.order("is_accepted",{ascending:!1});const{data:s,error:a}=await t;if(a)throw console.error("Error fetching answers:",a),new Error("Failed to fetch answers");return s||[]},async createAnswer(r){const{data:t,error:s}=await D.from("legal_answers").insert({...r,moderation_status:"pending"}).select(`
        *,
        user:profiles(id, full_name, avatar_url)
      `).single();if(s)throw console.error("Error creating answer:",s),new Error("Failed to create answer");return t},async updateAnswer(r,t){const{data:s,error:a}=await D.from("legal_answers").update(t).eq("id",r).select(`
        *,
        user:profiles(id, full_name, avatar_url)
      `).single();if(a)throw console.error("Error updating answer:",a),new Error("Failed to update answer");return s},async generateAIAnswer(r){try{const t={content:`Based on Singapore law and the information provided, here's a general overview:

${r.question_content}

This appears to be related to ${r.category||"general legal matters"}. In Singapore, such matters are typically governed by relevant statutes and case law.

**Key considerations:**
1. Legal requirements and procedures
2. Relevant timeframes and deadlines
3. Potential consequences and remedies
4. Professional legal advice recommendations

**Next steps:**
- Consult with a qualified legal professional
- Gather relevant documentation
- Consider alternative dispute resolution if applicable`,sources:["Singapore Statutes Online","Singapore Law Reports","Legal Service Commission Guidelines"],disclaimer:"This AI-generated response is for informational purposes only and does not constitute legal advice. Please consult with a qualified legal professional for advice specific to your situation.",confidence_score:.75,suggested_experts:[]};return await this.createAnswer({question_id:r.question_id,content:t.content,answer_type:"ai",sources:t.sources,disclaimer:t.disclaimer,is_accepted:!1}),t}catch(t){throw console.error("Error generating AI answer:",t),new Error("Failed to generate AI answer")}},async voteOnQuestion(r,t){var a,n;if(Sn)return new Promise(i=>{setTimeout(()=>{const o=eh.find(c=>c.id===r);o&&(t==="upvote"?o.upvote_count+=1:o.downvote_count+=1),i()},200)});await D.from("legal_qa_votes").delete().eq("question_id",r).eq("user_id",(a=(await D.auth.getUser()).data.user)==null?void 0:a.id);const{error:s}=await D.from("legal_qa_votes").insert({question_id:r,vote_type:t,user_id:(n=(await D.auth.getUser()).data.user)==null?void 0:n.id});if(s)throw console.error("Error voting on question:",s),new Error("Failed to vote on question")},async voteOnAnswer(r,t){var a,n;if(Sn)return new Promise(i=>{setTimeout(()=>{console.log(`Mock vote on answer ${r}: ${t}`),i()},200)});await D.from("legal_qa_votes").delete().eq("answer_id",r).eq("vote_type",t).eq("user_id",(a=(await D.auth.getUser()).data.user)==null?void 0:a.id);const{error:s}=await D.from("legal_qa_votes").insert({answer_id:r,vote_type:t,user_id:(n=(await D.auth.getUser()).data.user)==null?void 0:n.id});if(s)throw console.error("Error voting on answer:",s),new Error("Failed to vote on answer")},async getUserVote(r,t){var o;const s=(o=(await D.auth.getUser()).data.user)==null?void 0:o.id;if(!s)return null;let a=D.from("legal_qa_votes").select("*").eq("user_id",s);r&&(a=a.eq("question_id",r)),t&&(a=a.eq("answer_id",t));const{data:n,error:i}=await a.single();return i&&i.code!=="PGRST116"?(console.error("Error fetching user vote:",i),null):n},async bookmarkQuestion(r){var s;if(Sn)return new Promise(a=>{setTimeout(()=>{console.log(`Mock bookmark question ${r}`),a()},200)});const{error:t}=await D.from("legal_qa_bookmarks").insert({question_id:r,user_id:(s=(await D.auth.getUser()).data.user)==null?void 0:s.id});if(t)throw console.error("Error bookmarking question:",t),new Error("Failed to bookmark question")},async unbookmarkQuestion(r){var s;if(Sn)return new Promise(a=>{setTimeout(()=>{console.log(`Mock unbookmark question ${r}`),a()},200)});const{error:t}=await D.from("legal_qa_bookmarks").delete().eq("question_id",r).eq("user_id",(s=(await D.auth.getUser()).data.user)==null?void 0:s.id);if(t)throw console.error("Error unbookmarking question:",t),new Error("Failed to unbookmark question")},async getUserBookmarks(){var a;const r=(a=(await D.auth.getUser()).data.user)==null?void 0:a.id;if(!r)return[];const{data:t,error:s}=await D.from("legal_qa_bookmarks").select(`
        question:legal_questions(
          *,
          user:profiles(id, full_name, avatar_url),
          category:legal_qa_categories(id, name, color)
        )
      `).eq("user_id",r).order("created_at",{ascending:!1});if(s)throw console.error("Error fetching bookmarks:",s),new Error("Failed to fetch bookmarks");return(t==null?void 0:t.map(n=>n.question).filter(Boolean))||[]},async getComments(r,t){let s=D.from("legal_qa_comments").select(`
        *,
        user:profiles(id, full_name, avatar_url)
      `).eq("moderation_status","approved").is("parent_id",null).order("created_at",{ascending:!0});r&&(s=s.eq("question_id",r)),t&&(s=s.eq("answer_id",t));const{data:a,error:n}=await s;if(n)throw console.error("Error fetching comments:",n),new Error("Failed to fetch comments");return a||[]},async createComment(r){const{data:t,error:s}=await D.from("legal_qa_comments").insert({...r,moderation_status:"approved"}).select(`
        *,
        user:profiles(id, full_name, avatar_url)
      `).single();if(s)throw console.error("Error creating comment:",s),new Error("Failed to create comment");return t},async getExperts(r){let t=D.from("legal_experts").select(`
        *,
        user:profiles(id, full_name, avatar_url, email),
        law_firm:law_firms(id, name, logo_url)
      `).eq("verification_status","verified").eq("is_active",!0).order("expertise_score",{ascending:!1});r&&(t=t.contains("specializations",[r]));const{data:s,error:a}=await t;if(a)throw console.error("Error fetching experts:",a),new Error("Failed to fetch experts");return s||[]},async createExpertProfile(r){const{data:t,error:s}=await D.from("legal_experts").insert({...r,verification_status:"pending"}).select(`
        *,
        user:profiles(id, full_name, avatar_url, email)
      `).single();if(s)throw console.error("Error creating expert profile:",s),new Error("Failed to create expert profile");return t},async reportContent(r){const{error:t}=await D.from("legal_qa_reports").insert({...r,status:"pending"});if(t)throw console.error("Error reporting content:",t),new Error("Failed to report content")},async searchQuestions(r,t={}){return this.getQuestions({...t,search:r})},async getTrendingQuestions(r=10){return this.getQuestions({sort_by:"most_views",limit:r,featured:!0})},async getRecentQuestions(r=10){return this.getQuestions({sort_by:"newest",limit:r})}},cd=[{id:"1",name:"Employment Law",description:"Questions about workplace rights, contracts, and employment disputes",icon:"💼",color:"#3B82F6",question_count:45,is_active:!0,order_index:1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"2",name:"Property Law",description:"Real estate transactions, landlord-tenant issues, and property disputes",icon:"🏠",color:"#10B981",question_count:32,is_active:!0,order_index:2,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"3",name:"Corporate Law",description:"Business formation, contracts, and corporate governance",icon:"🏢",color:"#8B5CF6",question_count:28,is_active:!0,order_index:3,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"4",name:"Family Law",description:"Divorce, custody, adoption, and family-related legal matters",icon:"👨‍👩‍👧‍👦",color:"#F59E0B",question_count:23,is_active:!0,order_index:4,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}],Fc=[{id:"1",title:"What are my rights if I'm terminated without notice?",content:"I was working for a company for 2 years and they suddenly terminated me without any notice period. They said it was due to restructuring but I suspect it might be because I raised concerns about workplace safety. What are my rights under Singapore employment law?",category:cd[0],tags:["termination","notice period","employment rights"],urgency_level:"high",status:"open",view_count:156,upvote_count:12,downvote_count:1,answer_count:3,has_expert_answer:!0,has_ai_answer:!1,featured:!0,is_anonymous:!1,location:"Singapore",moderation_status:"approved",created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5).toISOString(),user_id:"mock-user-1",category_id:"1",user:{id:"mock-user-1",full_name:"John Doe",avatar_url:null}},{id:"2",title:"Can my landlord increase rent during the lease period?",content:"I signed a 2-year lease agreement with my landlord 6 months ago. Now they want to increase the rent by 20% citing inflation and market rates. The lease agreement doesn't mention anything about rent increases during the lease period. Is this legal?",category:cd[1],tags:["rental","lease agreement","rent increase"],urgency_level:"normal",status:"answered",view_count:89,upvote_count:8,downvote_count:0,answer_count:2,has_expert_answer:!1,has_ai_answer:!0,featured:!1,is_anonymous:!0,location:"Singapore",moderation_status:"approved",created_at:new Date(Date.now()-1728e5).toISOString(),updated_at:new Date(Date.now()-1728e5).toISOString(),user_id:"mock-user-2",category_id:"2",user:{id:"mock-user-2",full_name:"Anonymous User",avatar_url:null}}],N8=({onAskQuestion:r,className:t=""})=>{const{user:s}=ft(),a=ps(),[n,i]=p.useState([]),[o,c]=p.useState([]),[d,h]=p.useState(!0),[m,f]=p.useState(null),[g,y]=p.useState(""),[b,w]=p.useState(""),[S,N]=p.useState("newest");p.useState(!1);const[v,j]=p.useState("all"),C=Array.isArray(n)?n:[];p.useState({page:1,limit:20});const k="https://kvlaydeyqidlfpfutbmp.supabase.co".includes("placeholder"),I=p.useCallback(async()=>{let W=!0;try{if(h(!0),f(null),k){console.log("Using mock data in development mode"),W&&(i(cd),c(Fc));return}console.log("Loading categories from API...");const q=await tr.getCategories();if(!W)return;Array.isArray(q)&&q.length>0?(console.log("Categories loaded successfully:",q.length),i(q)):(console.warn("Categories data is empty, using mock data"),i(cd)),console.log("Loading questions from API...");const K=await tr.getQuestions({page:1,limit:20});if(!W)return;Array.isArray(K)&&K.length>0?(console.log("Questions loaded successfully:",K.length),c(K)):(console.warn("Questions data is empty, using mock data"),c(Fc))}catch(q){console.error("Error initializing data:",q),W&&(console.log("API failed, falling back to mock data"),i(cd),c(Fc),f(null))}finally{W&&(console.log("Setting loading to false in initialization"),h(!1))}return()=>{W=!1}},[k]);p.useEffect(()=>{console.log("Initial useEffect triggered"),I()},[I]);const T=p.useCallback(async()=>{try{if(h(!0),console.log("Loading questions... activeTab:",v),k){console.log("Using filtered mock data");let K=[...Fc];switch(g&&(K=K.filter(Y=>Y.title.toLowerCase().includes(g.toLowerCase())||Y.content.toLowerCase().includes(g.toLowerCase()))),b&&(K=K.filter(Y=>Y.category_id===b)),v){case"trending":K=K.filter(Y=>Y.featured);break;case"expert":K=K.filter(Y=>Y.has_expert_answer);break;case"unanswered":K=K.filter(Y=>Y.status==="open");break;case"ai":K=K.filter(Y=>Y.has_ai_answer);break}c(K);return}const W={page:1,limit:20,search:g||void 0,category_id:b||void 0,sort_by:S};switch(v){case"trending":W.sort_by="most_views",W.featured=!0;break;case"expert":W.has_expert_answer=!0;break;case"unanswered":W.status="open",W.sort_by="oldest";break;case"ai":W.has_ai_answer=!0;break}console.log("Query filters:",W);const q=await tr.getQuestions(W);console.log("Questions loaded:",q),console.log("Questions count:",q.length),c(q)}catch(W){console.error("Error loading questions:",W),console.log("API failed, using mock data"),c(Fc)}finally{console.log("Setting loading to false"),h(!1)}},[k,v,g,b,S]);p.useEffect(()=>{d||n.length===0||(console.log("Filter useEffect triggered:",{searchQuery:g,selectedCategory:b,sortBy:S,activeTab:v}),(g||b||v!=="all")&&T())},[g,b,v,T,d,n.length,S]);const O=W=>{W.preventDefault(),T()},U=W=>{a(`/legal-qa/${W}`)},A=async(W,q)=>{if(!s){te.error("Please log in to vote");return}try{k||(await tr.voteOnQuestion(W,q),await T()),te.success("Vote recorded")}catch(K){console.error("Error voting:",K),te.error("Failed to record vote")}},L=async W=>{if(!s){te.error("Please log in to bookmark questions");return}try{k||await tr.bookmarkQuestion(W),te.success("Question bookmarked")}catch(q){console.error("Error bookmarking:",q),te.error("Failed to bookmark question")}},M=W=>{switch(W){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"normal":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},se=W=>{var q,K,Y,le;return e.jsx($,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>U(W.id),children:e.jsxs(z,{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 hover:text-blue-600",children:W.title}),W.featured&&e.jsx(Ot,{className:"h-4 w-4 text-yellow-500 fill-current"})]}),e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2 mb-3",children:W.content}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[W.category&&e.jsx(ae,{variant:"secondary",className:"text-xs",style:{backgroundColor:W.category.color+"20",color:W.category.color},children:W.category.name}),e.jsx(ae,{className:`text-xs ${M(W.urgency_level)}`,children:W.urgency_level}),W.tags.slice(0,3).map(Ne=>e.jsx(ae,{variant:"outline",className:"text-xs",children:Ne},Ne))]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsx("span",{children:W.answer_count})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Gt,{className:"h-4 w-4"}),e.jsx("span",{children:W.view_count})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(pd,{className:"h-4 w-4"}),e.jsx("span",{children:W.upvote_count})]}),W.has_expert_answer&&e.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[e.jsx(Ri,{className:"h-4 w-4"}),e.jsx("span",{children:"Expert"})]}),W.has_ai_answer&&e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[e.jsx(fd,{className:"h-4 w-4"}),e.jsx("span",{children:"AI"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(zr,{className:"h-6 w-6",children:[e.jsx($n,{src:(q=W.user)==null?void 0:q.avatar_url}),e.jsx(Br,{className:"text-xs",children:W.is_anonymous?"A":(Y=(K=W.user)==null?void 0:K.full_name)==null?void 0:Y.charAt(0)})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{children:W.is_anonymous?"Anonymous":(le=W.user)==null?void 0:le.full_name}),e.jsx("span",{className:"mx-1",children:"•"}),e.jsx("span",{children:Vt(new Date(W.created_at),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:Ne=>{Ne.stopPropagation(),A(W.id,"upvote")},disabled:!s,children:e.jsx(pd,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:Ne=>{Ne.stopPropagation(),L(W.id)},disabled:!s,children:e.jsx(sN,{className:"h-4 w-4"})})]})]})]})]})},W.id)};return m?e.jsx("div",{className:`space-y-6 ${t}`,children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Legal Q&A"}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("p",{className:"text-red-800",children:["Error: ",m]}),e.jsx(R,{onClick:()=>{f(null),h(!0),window.location.reload()},className:"mt-2",children:"Try Again"})]})]})}):e.jsxs("div",{className:`space-y-6 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Legal Q&A"}),e.jsxs("p",{className:"text-gray-600",children:["Get answers to your legal questions from the community and experts",k&&e.jsx("span",{className:"ml-2 text-sm text-blue-600",children:"(Demo Mode)"})]})]}),e.jsxs(R,{onClick:r,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Ask Question"]})]}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsx("form",{onSubmit:O,className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Pe,{placeholder:"Search legal questions...",value:g,onChange:W=>y(W.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs(it,{value:b,onValueChange:w,children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"All categories"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"All categories"}),C.map(W=>W&&W.id&&W.name?e.jsx(ne,{value:W.id,children:W.name},W.id):null)]})]})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs(it,{value:S,onValueChange:W=>N(W),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Sort by"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"newest",children:"Newest"}),e.jsx(ne,{value:"oldest",children:"Oldest"}),e.jsx(ne,{value:"most_votes",children:"Most Votes"}),e.jsx(ne,{value:"most_answers",children:"Most Answers"}),e.jsx(ne,{value:"most_views",children:"Most Views"})]})]})}),e.jsx(R,{type:"submit",children:"Search"})]})})})}),e.jsxs(fr,{value:v,onValueChange:j,children:[e.jsxs(nr,{className:"grid w-full grid-cols-5",children:[e.jsx(Ge,{value:"all",children:"All Questions"}),e.jsx(Ge,{value:"trending",children:"Trending"}),e.jsx(Ge,{value:"expert",children:"Expert Answered"}),e.jsx(Ge,{value:"unanswered",children:"Unanswered"}),e.jsx(Ge,{value:"ai",children:"AI Answered"})]}),e.jsx(He,{value:v,className:"mt-6",children:e.jsx("div",{className:"space-y-4",children:d?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((W,q)=>e.jsx($,{className:"animate-pulse",children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"})]})]})})},q))}):o.length>0?o.map(se):e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Ft,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No questions found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:g||b?"Try adjusting your search criteria or browse different categories.":"Be the first to ask a question in this category."}),r&&e.jsxs(R,{onClick:r,children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Ask First Question"]})]})})})})]})]})},S8=({onClose:r,onQuestionCreated:t,initialCategory:s})=>{const{user:a}=ft(),[n,i]=p.useState([]),[o,c]=p.useState(!1),[d,h]=p.useState(""),m=Array.isArray(n)?n:[],[f,g]=p.useState({title:"",content:"",category_id:s||"",tags:[],urgency_level:"normal",location:"Singapore",is_anonymous:!1});p.useEffect(()=>{y()},[]);const y=async()=>{try{console.log("AskQuestionForm: Loading categories...");const j=await tr.getCategories();if(console.log("AskQuestionForm: Categories loaded:",j),console.log("AskQuestionForm: Categories is array:",Array.isArray(j)),!Array.isArray(j))throw new Error("Categories data is not an array");i(j)}catch(j){console.error("AskQuestionForm: Error loading categories:",j),te.error("Failed to load categories"),i([])}},b=async j=>{if(j.preventDefault(),!a){te.error("Please log in to ask a question");return}if(!f.title.trim()||!f.content.trim()){te.error("Please fill in all required fields");return}try{c(!0);const C={...f,user_id:a.id,status:"open",view_count:0,upvote_count:0,downvote_count:0,answer_count:0,has_expert_answer:!1,has_ai_answer:!1,featured:!1},k=await tr.createQuestion(C);te.success("Question submitted successfully! It will be reviewed before being published."),t(k)}catch(C){console.error("Error creating question:",C),te.error("Failed to submit question. Please try again.")}finally{c(!1)}},w=(j,C)=>{g(k=>({...k,[j]:C}))},S=()=>{d.trim()&&!f.tags.includes(d.trim())&&(g(j=>({...j,tags:[...j.tags,d.trim()]})),h(""))},N=j=>{g(C=>({...C,tags:C.tags.filter(k=>k!==j)}))},v=j=>{j.key==="Enter"&&(j.preventDefault(),S())};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs($,{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(X,{children:"Ask a Legal Question"}),e.jsx(ye,{children:"Get help from the community and legal experts"})]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:r,children:e.jsx(Vs,{className:"h-4 w-4"})})]}),e.jsx(z,{children:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(It,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-800 mb-1",children:"Important Legal Disclaimer"}),e.jsx("p",{className:"text-yellow-700",children:"This platform provides general information only and does not constitute legal advice. For specific legal matters, please consult with a qualified legal professional."})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"title",children:"Question Title *"}),e.jsx(Pe,{id:"title",value:f.title,onChange:j=>w("title",j.target.value),placeholder:"Briefly describe your legal question...",maxLength:200,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500",children:[f.title.length,"/200 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"content",children:"Question Details *"}),e.jsx(Sr,{id:"content",value:f.content,onChange:j=>w("content",j.target.value),placeholder:"Provide detailed information about your legal question. Include relevant facts, dates, and any specific circumstances...",rows:8,maxLength:5e3,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500",children:[f.content.length,"/5000 characters"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"category",children:"Category"}),e.jsxs(it,{value:f.category_id,onValueChange:j=>w("category_id",j),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Select a category"})}),e.jsx(at,{children:m.map(j=>j&&j.id&&j.name?e.jsx(ne,{value:j.id,children:j.name},j.id):null)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"urgency",children:"Urgency Level"}),e.jsxs(it,{value:f.urgency_level,onValueChange:j=>w("urgency_level",j),children:[e.jsx(rt,{children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"low",children:"Low - General inquiry"}),e.jsx(ne,{value:"normal",children:"Normal - Standard question"}),e.jsx(ne,{value:"high",children:"High - Time-sensitive"}),e.jsx(ne,{value:"urgent",children:"Urgent - Immediate attention needed"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"location",children:"Location (Optional)"}),e.jsx(Pe,{id:"location",value:f.location,onChange:j=>w("location",j.target.value),placeholder:"e.g., Singapore, Orchard Road"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Specify location if relevant to your legal question"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"tags",children:"Tags (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:f.tags.map(j=>e.jsxs(ae,{variant:"secondary",className:"flex items-center space-x-1",children:[e.jsx("span",{children:j}),e.jsx("button",{type:"button",onClick:()=>N(j),className:"ml-1 hover:text-red-600",children:e.jsx(Vs,{className:"h-3 w-3"})})]},j))}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Pe,{value:d,onChange:j=>h(j.target.value),onKeyPress:v,placeholder:"Add tags to help categorize your question...",maxLength:30}),e.jsx(R,{type:"button",onClick:S,variant:"outline",size:"sm",children:e.jsx(da,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:'Add relevant tags like "contract", "employment", "property", etc.'})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:"anonymous",checked:f.is_anonymous,onCheckedChange:j=>w("is_anonymous",j)}),e.jsx("label",{htmlFor:"anonymous",className:"text-sm text-gray-700",children:"Post anonymously"})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Your name will not be displayed with this question"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Sm,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-800 mb-2",children:"Tips for Better Answers"}),e.jsxs("ul",{className:"text-blue-700 space-y-1 text-xs",children:[e.jsx("li",{children:"• Be specific about your situation and provide relevant details"}),e.jsx("li",{children:"• Include relevant dates, amounts, and parties involved"}),e.jsx("li",{children:"• Mention any documents or agreements related to your question"}),e.jsx("li",{children:"• Avoid sharing personal identifying information"}),e.jsx("li",{children:"• Use clear, simple language to describe your situation"})]})]})]})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(R,{type:"button",variant:"outline",onClick:r,className:"flex-1",disabled:o,children:"Cancel"}),e.jsx(R,{type:"submit",className:"flex-1",disabled:o||!f.title.trim()||!f.content.trim(),children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(mx,{className:"h-4 w-4 mr-2"}),"Submit Question"]})})]})]})})]})})},k8=({questionId:r})=>{var M,se,W,q;const{id:t}=Fi(),s=ps(),{user:a}=ft(),n=r||t,[i,o]=p.useState(null),[c,d]=p.useState([]),[h,m]=p.useState(!0),[f,g]=p.useState(!1),[y,b]=p.useState(""),[w,S]=p.useState(!1),[N,v]=p.useState(!1);p.useEffect(()=>{n&&(j(),C())},[n]);const j=async()=>{if(n)try{m(!0);const K=await tr.getQuestion(n);o(K)}catch(K){console.error("Error loading question:",K),te.error("Failed to load question"),s("/legal-qa")}finally{m(!1)}},C=async()=>{if(n)try{g(!0);const K=await tr.getAnswers({question_id:n});d(K)}catch(K){console.error("Error loading answers:",K),te.error("Failed to load answers")}finally{g(!1)}},k=async K=>{if(!a||!i){te.error("Please log in to vote");return}try{await tr.voteOnQuestion(i.id,K),await j(),te.success("Vote recorded")}catch(Y){console.error("Error voting:",Y),te.error("Failed to record vote")}},I=async(K,Y)=>{if(!a){te.error("Please log in to vote");return}try{await tr.voteOnAnswer(K,Y),await C(),te.success("Vote recorded")}catch(le){console.error("Error voting:",le),te.error("Failed to record vote")}},T=async()=>{if(!a||!i){te.error("Please log in to bookmark questions");return}try{N?(await tr.unbookmarkQuestion(i.id),v(!1),te.success("Bookmark removed")):(await tr.bookmarkQuestion(i.id),v(!0),te.success("Question bookmarked"))}catch(K){console.error("Error bookmarking:",K),te.error("Failed to update bookmark")}},O=async()=>{if(!a||!i||!y.trim()){te.error("Please log in and provide an answer");return}try{S(!0),await tr.createAnswer({question_id:i.id,user_id:a.id,content:y.trim(),answer_type:"community",is_accepted:!1}),b(""),await C(),te.success("Answer submitted successfully!")}catch(K){console.error("Error submitting answer:",K),te.error("Failed to submit answer")}finally{S(!1)}},U=async()=>{var K;if(i)try{te.info("Generating AI answer..."),await tr.generateAIAnswer({question_id:i.id,question_title:i.title,question_content:i.content,category:(K=i.category)==null?void 0:K.name,tags:i.tags,location:i.location}),await C(),te.success("AI answer generated successfully!")}catch(Y){console.error("Error generating AI answer:",Y),te.error("Failed to generate AI answer")}},A=K=>{switch(K){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"normal":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},L=K=>{switch(K){case"expert":case"verified":return e.jsx(Ri,{className:"h-4 w-4 text-green-600"});case"ai":return e.jsx(fd,{className:"h-4 w-4 text-blue-600"});default:return e.jsx(cn,{className:"h-4 w-4 text-gray-600"})}};return h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading question..."})]})}):i?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(R,{variant:"outline",onClick:()=>s("/legal-qa"),className:"mb-4",children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to Q&A"]})}),e.jsxs($,{className:"mb-6",children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(X,{className:"text-2xl mb-3",children:i.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[i.category&&e.jsx(ae,{variant:"secondary",style:{backgroundColor:i.category.color+"20",color:i.category.color},children:i.category.name}),e.jsx(ae,{className:A(i.urgency_level),children:i.urgency_level}),i.featured&&e.jsxs(ae,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:[e.jsx(Ot,{className:"h-3 w-3 mr-1 fill-current"}),"Featured"]}),i.tags.map(K=>e.jsx(ae,{variant:"outline",className:"text-xs",children:K},K))]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Gt,{className:"h-4 w-4"}),e.jsxs("span",{children:[i.view_count," views"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs("span",{children:[i.answer_count," answers"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsxs("span",{children:["Asked ",Vt(new Date(i.created_at),{addSuffix:!0})]})]}),i.location&&e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("span",{children:["📍 ",i.location]})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>k("upvote"),disabled:!a,children:[e.jsx(pd,{className:"h-4 w-4 mr-1"}),i.upvote_count]}),e.jsx(R,{variant:"outline",size:"sm",onClick:T,disabled:!a,children:N?e.jsx(D5,{className:"h-4 w-4"}):e.jsx(sN,{className:"h-4 w-4"})}),e.jsx(R,{variant:"outline",size:"sm",children:e.jsx(Od,{className:"h-4 w-4"})})]})]})}),e.jsxs(z,{children:[e.jsx("div",{className:"prose max-w-none mb-6",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:i.content})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(zr,{children:[e.jsx($n,{src:(M=i.user)==null?void 0:M.avatar_url}),e.jsx(Br,{children:i.is_anonymous?"A":(W=(se=i.user)==null?void 0:se.full_name)==null?void 0:W.charAt(0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:i.is_anonymous?"Anonymous":(q=i.user)==null?void 0:q.full_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Asked ",Vt(new Date(i.created_at),{addSuffix:!0})]})]})]}),!i.has_ai_answer&&e.jsxs(R,{variant:"outline",onClick:U,className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:[e.jsx(fd,{className:"h-4 w-4 mr-2"}),"Get AI Answer"]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[i.answer_count," Answer",i.answer_count!==1?"s":""]})}),f?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((K,Y)=>e.jsx($,{className:"animate-pulse",children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})},Y))}):c.length>0?c.map(K=>{var Y,le,Ne,Ke;return e.jsx($,{className:K.is_accepted?"border-green-500 bg-green-50":"",children:e.jsxs(z,{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[L(K.answer_type),e.jsxs("span",{className:"text-sm font-medium capitalize text-gray-700",children:[K.answer_type," Answer"]}),K.is_accepted&&e.jsxs(ae,{className:"bg-green-100 text-green-800",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Accepted"]}),K.expert_verified&&e.jsxs(ae,{className:"bg-blue-100 text-blue-800",children:[e.jsx(qg,{className:"h-3 w-3 mr-1"}),"Expert Verified"]})]})}),e.jsx("div",{className:"prose max-w-none mb-4",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:K.content})}),K.answer_type==="ai"&&K.disclaimer&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-xs text-yellow-800",children:K.disclaimer})}),K.sources&&K.sources.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Sources:"}),e.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:K.sources.map((ke,$e)=>e.jsxs("li",{children:["• ",ke]},$e))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>I(K.id,"upvote"),disabled:!a,children:[e.jsx(pd,{className:"h-4 w-4 mr-1"}),K.upvote_count]}),e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>I(K.id,"helpful"),disabled:!a,children:[e.jsx(Ot,{className:"h-4 w-4 mr-1"}),K.helpful_count," Helpful"]}),e.jsxs(R,{variant:"ghost",size:"sm",children:[e.jsx(Ft,{className:"h-4 w-4 mr-1"}),"Comment"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(zr,{className:"h-6 w-6",children:[e.jsx($n,{src:(Y=K.user)==null?void 0:Y.avatar_url}),e.jsx(Br,{className:"text-xs",children:K.answer_type==="ai"?"AI":(Ne=(le=K.user)==null?void 0:le.full_name)==null?void 0:Ne.charAt(0)})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{children:K.answer_type==="ai"?"AI Assistant":(Ke=K.user)==null?void 0:Ke.full_name}),e.jsx("span",{className:"mx-1",children:"•"}),e.jsx("span",{children:Vt(new Date(K.created_at),{addSuffix:!0})})]})]})]})]})},K.id)}):e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Ft,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No answers yet"}),e.jsx("p",{className:"text-gray-500",children:"Be the first to answer this question!"})]})}),a&&e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-lg",children:"Your Answer"}),e.jsx(ye,{children:"Share your knowledge and help the community"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Sr,{value:y,onChange:K=>b(K.target.value),placeholder:"Provide a helpful answer to this legal question...",rows:6,maxLength:5e3}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[y.length,"/5000 characters"]}),e.jsx(R,{onClick:O,disabled:!y.trim()||w,children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Kg,{className:"h-4 w-4 mr-2"}),"Submit Answer"]})})]})]})})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Question Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The question you're looking for doesn't exist or has been removed."}),e.jsxs(R,{onClick:()=>s("/legal-qa"),children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to Q&A"]})]})})},C8=()=>{const[r,t]=p.useState({}),[s,a]=p.useState(!0);return p.useEffect(()=>{(async()=>{console.log("Running QA API tests...");try{const i="https://kvlaydeyqidlfpfutbmp.supabase.co",o=i==null?void 0:i.includes("placeholder");console.log("Environment:",{supabaseUrl:i,isPlaceholder:o}),console.log("Testing getCategories...");const c=await tr.getCategories();console.log("Categories result:",c),console.log("Testing getQuestions...");const d=await tr.getQuestions();console.log("Questions result:",d),t({environment:{supabaseUrl:i,isPlaceholder:o},categories:c,questions:d,success:!0})}catch(i){console.error("Test error:",i),t({error:i.message,success:!1})}finally{a(!1)}})()},[]),s?e.jsx("div",{className:"p-4",children:"Running tests..."}):e.jsxs("div",{className:"p-4 bg-gray-50 rounded",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"QA API Test Results"}),e.jsx("pre",{className:"bg-white p-4 rounded text-sm overflow-auto max-h-96",children:JSON.stringify(r,null,2)})]})},E8=()=>{const[r,t]=p.useState(!1),s=a=>{t(!1)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ca,{}),e.jsx("main",{className:"py-8 pt-20",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("p",{className:"text-blue-800",children:"Legal Q&A Page Loaded Successfully"}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Environment: ","production"]}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Supabase URL: ","https://kvlaydeyqidlfpfutbmp.supabase.co"]})]}),e.jsx(C8,{}),e.jsx(N8,{onAskQuestion:()=>t(!0)})]})}),e.jsx(Ea,{}),r&&e.jsx(S8,{onClose:()=>t(!1),onQuestionCreated:s})]})};class A8{constructor(){rs(this,"MAX_LOGIN_ATTEMPTS",5);rs(this,"LOCKOUT_DURATION",15*60*1e3);rs(this,"SESSION_TIMEOUT",24*60*60*1e3);rs(this,"SUSPICIOUS_ACTIVITY_THRESHOLD",10)}async trackSession(t,s){try{const a=await this.getSessionInfo(),{error:n}=await D.from("user_sessions").upsert({id:t,user_id:s,ip_address:a.ipAddress,user_agent:a.userAgent,device_type:a.deviceType,browser:a.browser,os:a.os,location:a.location,last_active_at:new Date().toISOString(),expires_at:new Date(Date.now()+this.SESSION_TIMEOUT).toISOString()});n&&console.error("Error tracking session:",n)}catch(a){console.error("Error in trackSession:",a)}}async getSessionInfo(){const t=navigator.userAgent,s=await this.getUserIP();return{ipAddress:s,userAgent:t,deviceType:this.getDeviceType(t),browser:this.getBrowser(t),os:this.getOS(t),location:await this.getLocation(s)}}async getUserIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch(t){return console.error("Error getting IP address:",t),"unknown"}}getDeviceType(t){return/Mobile|Android|iPhone|iPad/.test(t)?/iPad/.test(t)?"tablet":"mobile":"desktop"}getBrowser(t){return t.includes("Chrome")?"Chrome":t.includes("Firefox")?"Firefox":t.includes("Safari")?"Safari":t.includes("Edge")?"Edge":"Unknown"}getOS(t){return t.includes("Windows")?"Windows":t.includes("Mac")?"macOS":t.includes("Linux")?"Linux":t.includes("Android")?"Android":t.includes("iOS")?"iOS":"Unknown"}async getLocation(t){try{const a=await(await fetch(`https://ipapi.co/${t}/json/`)).json();return a.city&&a.country_name?`${a.city}, ${a.country_name}`:a.country_name||void 0}catch(s){console.error("Error getting location:",s);return}}async logSecurityEvent(t,s){try{const{data:{user:a}}=await D.auth.getUser();if(!a)return;const n=await this.getSessionInfo(),{error:i}=await D.from("security_events").insert({user_id:a.id,event_type:t,ip_address:n.ipAddress,user_agent:n.userAgent,location:n.location,metadata:s||{}});i&&console.error("Error logging security event:",i)}catch(a){console.error("Error in logSecurityEvent:",a)}}async checkSuspiciousActivity(t,s){try{const{data:a,error:n}=await D.from("security_events").select("*").eq("ip_address",t).eq("event_type","failed_login").gte("created_at",new Date(Date.now()-36e5).toISOString()).order("created_at",{ascending:!1});if(n)return console.error("Error checking suspicious activity:",n),!1;if(a&&a.length>=this.SUSPICIOUS_ACTIVITY_THRESHOLD)return!0;if(s){const{data:i}=await D.from("security_events").select("location").eq("user_id",s).eq("event_type","login").gte("created_at",new Date(Date.now()-864e5).toISOString()).not("location","is",null);if(i&&new Set(i.map(c=>c.location)).size>3)return!0}return!1}catch(a){return console.error("Error in checkSuspiciousActivity:",a),!1}}async getUserSessions(t){var s;try{const{data:a,error:n}=await D.from("user_sessions").select("*").eq("user_id",t).gt("expires_at",new Date().toISOString()).order("last_active_at",{ascending:!1});if(n)return console.error("Error getting user sessions:",n),[];const o=(s=(await D.auth.getSession()).data.session)==null?void 0:s.access_token;return(a||[]).map(c=>({id:c.id,userId:c.user_id,ipAddress:c.ip_address,userAgent:c.user_agent,location:c.location,deviceType:c.device_type,browser:c.browser,os:c.os,isCurrentSession:c.id===o,createdAt:c.created_at,lastActiveAt:c.last_active_at,expiresAt:c.expires_at}))}catch(a){return console.error("Error in getUserSessions:",a),[]}}async revokeSession(t){try{const{error:s}=await D.from("user_sessions").delete().eq("id",t);if(s)throw console.error("Error revoking session:",s),new Error("Failed to revoke session")}catch(s){throw console.error("Error in revokeSession:",s),s}}async revokeAllOtherSessions(t,s){try{const{error:a}=await D.from("user_sessions").delete().eq("user_id",t).neq("id",s);if(a)throw console.error("Error revoking other sessions:",a),new Error("Failed to revoke other sessions");await this.logSecurityEvent("logout",{action:"revoke_all_sessions",sessions_revoked:"all_others"})}catch(a){throw console.error("Error in revokeAllOtherSessions:",a),a}}async getSecurityEvents(t,s=50){try{const{data:a,error:n}=await D.from("security_events").select("*").eq("user_id",t).order("created_at",{ascending:!1}).limit(s);return n?(console.error("Error getting security events:",n),[]):(a||[]).map(i=>({id:i.id,userId:i.user_id,eventType:i.event_type,ipAddress:i.ip_address,userAgent:i.user_agent,location:i.location,metadata:i.metadata,createdAt:i.created_at}))}catch(a){return console.error("Error in getSecurityEvents:",a),[]}}async checkRateLimit(t){try{const{data:s,error:a}=await D.from("login_attempts").select("*").eq("ip_address",t).single();if(a&&a.code!=="PGRST116")return console.error("Error checking rate limit:",a),{allowed:!0,attemptsRemaining:this.MAX_LOGIN_ATTEMPTS};if(!s)return{allowed:!0,attemptsRemaining:this.MAX_LOGIN_ATTEMPTS};const n=new Date,i=new Date(s.last_attempt),o=n.getTime()-i.getTime();if(s.blocked_until&&new Date(s.blocked_until)>n)return{allowed:!1,attemptsRemaining:0,resetTime:new Date(s.blocked_until)};if(o>this.LOCKOUT_DURATION)return await this.resetLoginAttempts(t),{allowed:!0,attemptsRemaining:this.MAX_LOGIN_ATTEMPTS};const c=Math.max(0,this.MAX_LOGIN_ATTEMPTS-s.attempts);return{allowed:c>0,attemptsRemaining:c,resetTime:c===0?new Date(i.getTime()+this.LOCKOUT_DURATION):void 0}}catch(s){return console.error("Error in checkRateLimit:",s),{allowed:!0,attemptsRemaining:this.MAX_LOGIN_ATTEMPTS}}}async recordFailedLogin(t){try{const{data:s}=await D.from("login_attempts").select("*").eq("ip_address",t).single(),a=new Date,n=s?s.attempts+1:1,i=n>=this.MAX_LOGIN_ATTEMPTS?new Date(a.getTime()+this.LOCKOUT_DURATION).toISOString():null,{error:o}=await D.from("login_attempts").upsert({ip_address:t,attempts:n,last_attempt:a.toISOString(),blocked_until:i});o&&console.error("Error recording failed login:",o)}catch(s){console.error("Error in recordFailedLogin:",s)}}async resetLoginAttempts(t){try{const{error:s}=await D.from("login_attempts").delete().eq("ip_address",t);s&&console.error("Error resetting login attempts:",s)}catch(s){console.error("Error in resetLoginAttempts:",s)}}}const Ni=new A8;var T8="Separator",eb="horizontal",R8=["horizontal","vertical"],p2=p.forwardRef((r,t)=>{const{decorative:s,orientation:a=eb,...n}=r,i=P8(a)?a:eb,c=s?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(zt.div,{"data-orientation":i,...c,...n,ref:t})});p2.displayName=T8;function P8(r){return R8.includes(r)}var x2=p2;const Ts=p.forwardRef(({className:r,orientation:t="horizontal",decorative:s=!0,...a},n)=>e.jsx(x2,{ref:n,decorative:s,orientation:t,className:Ie("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",r),...a}));Ts.displayName=x2.displayName;const cc=x_,Bd=g_,I8=p_,g2=p.forwardRef(({className:r,...t},s)=>e.jsx(xm,{ref:s,className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...t}));g2.displayName=xm.displayName;const Mo=p.forwardRef(({className:r,children:t,...s},a)=>e.jsxs(I8,{children:[e.jsx(g2,{}),e.jsxs(gm,{ref:a,className:Ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...s,children:[t,e.jsxs(f_,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Mo.displayName=gm.displayName;const Lo=({className:r,...t})=>e.jsx("div",{className:Ie("flex flex-col space-y-1.5 text-center sm:text-left",r),...t});Lo.displayName="DialogHeader";const y2=({className:r,...t})=>e.jsx("div",{className:Ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t});y2.displayName="DialogFooter";const Uo=p.forwardRef(({className:r,...t},s)=>e.jsx(ym,{ref:s,className:Ie("text-lg font-semibold leading-none tracking-tight",r),...t}));Uo.displayName=ym.displayName;const $o=p.forwardRef(({className:r,...t},s)=>e.jsx(vm,{ref:s,className:Ie("text-sm text-muted-foreground",r),...t}));$o.displayName=vm.displayName;var qd={},D8=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},v2={},ha={};let _y;const F8=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];ha.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};ha.getSymbolTotalCodewords=function(t){return F8[t]};ha.getBCHDigit=function(r){let t=0;for(;r!==0;)t++,r>>>=1;return t};ha.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');_y=t};ha.isKanjiModeEnabled=function(){return typeof _y<"u"};ha.toSJIS=function(t){return _y(t)};var Vm={};(function(r){r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2};function t(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw new Error("Unknown EC Level: "+s)}}r.isValid=function(a){return a&&typeof a.bit<"u"&&a.bit>=0&&a.bit<4},r.from=function(a,n){if(r.isValid(a))return a;try{return t(a)}catch{return n}}})(Vm);function w2(){this.buffer=[],this.length=0}w2.prototype={get:function(r){const t=Math.floor(r/8);return(this.buffer[t]>>>7-r%8&1)===1},put:function(r,t){for(let s=0;s<t;s++)this.putBit((r>>>t-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),r&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var O8=w2;function Vd(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}Vd.prototype.set=function(r,t,s,a){const n=r*this.size+t;this.data[n]=s,a&&(this.reservedBit[n]=!0)};Vd.prototype.get=function(r,t){return this.data[r*this.size+t]};Vd.prototype.xor=function(r,t,s){this.data[r*this.size+t]^=s};Vd.prototype.isReserved=function(r,t){return this.reservedBit[r*this.size+t]};var M8=Vd,j2={};(function(r){const t=ha.getSymbolSize;r.getRowColCoords=function(a){if(a===1)return[];const n=Math.floor(a/7)+2,i=t(a),o=i===145?26:Math.ceil((i-13)/(2*n-2))*2,c=[i-7];for(let d=1;d<n-1;d++)c[d]=c[d-1]-o;return c.push(6),c.reverse()},r.getPositions=function(a){const n=[],i=r.getRowColCoords(a),o=i.length;for(let c=0;c<o;c++)for(let d=0;d<o;d++)c===0&&d===0||c===0&&d===o-1||c===o-1&&d===0||n.push([i[c],i[d]]);return n}})(j2);var b2={};const L8=ha.getSymbolSize,tb=7;b2.getPositions=function(t){const s=L8(t);return[[0,0],[s-tb,0],[0,s-tb]]};var _2={};(function(r){r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};r.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},r.from=function(n){return r.isValid(n)?parseInt(n,10):void 0},r.getPenaltyN1=function(n){const i=n.size;let o=0,c=0,d=0,h=null,m=null;for(let f=0;f<i;f++){c=d=0,h=m=null;for(let g=0;g<i;g++){let y=n.get(f,g);y===h?c++:(c>=5&&(o+=t.N1+(c-5)),h=y,c=1),y=n.get(g,f),y===m?d++:(d>=5&&(o+=t.N1+(d-5)),m=y,d=1)}c>=5&&(o+=t.N1+(c-5)),d>=5&&(o+=t.N1+(d-5))}return o},r.getPenaltyN2=function(n){const i=n.size;let o=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const h=n.get(c,d)+n.get(c,d+1)+n.get(c+1,d)+n.get(c+1,d+1);(h===4||h===0)&&o++}return o*t.N2},r.getPenaltyN3=function(n){const i=n.size;let o=0,c=0,d=0;for(let h=0;h<i;h++){c=d=0;for(let m=0;m<i;m++)c=c<<1&2047|n.get(h,m),m>=10&&(c===1488||c===93)&&o++,d=d<<1&2047|n.get(m,h),m>=10&&(d===1488||d===93)&&o++}return o*t.N3},r.getPenaltyN4=function(n){let i=0;const o=n.data.length;for(let d=0;d<o;d++)i+=n.data[d];return Math.abs(Math.ceil(i*100/o/5)-10)*t.N4};function s(a,n,i){switch(a){case r.Patterns.PATTERN000:return(n+i)%2===0;case r.Patterns.PATTERN001:return n%2===0;case r.Patterns.PATTERN010:return i%3===0;case r.Patterns.PATTERN011:return(n+i)%3===0;case r.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2===0;case r.Patterns.PATTERN101:return n*i%2+n*i%3===0;case r.Patterns.PATTERN110:return(n*i%2+n*i%3)%2===0;case r.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2===0;default:throw new Error("bad maskPattern:"+a)}}r.applyMask=function(n,i){const o=i.size;for(let c=0;c<o;c++)for(let d=0;d<o;d++)i.isReserved(d,c)||i.xor(d,c,s(n,d,c))},r.getBestMask=function(n,i){const o=Object.keys(r.Patterns).length;let c=0,d=1/0;for(let h=0;h<o;h++){i(h),r.applyMask(h,n);const m=r.getPenaltyN1(n)+r.getPenaltyN2(n)+r.getPenaltyN3(n)+r.getPenaltyN4(n);r.applyMask(h,n),m<d&&(d=m,c=h)}return c}})(_2);var Wm={};const Si=Vm,th=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],sh=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Wm.getBlocksCount=function(t,s){switch(s){case Si.L:return th[(t-1)*4+0];case Si.M:return th[(t-1)*4+1];case Si.Q:return th[(t-1)*4+2];case Si.H:return th[(t-1)*4+3];default:return}};Wm.getTotalCodewordsCount=function(t,s){switch(s){case Si.L:return sh[(t-1)*4+0];case Si.M:return sh[(t-1)*4+1];case Si.Q:return sh[(t-1)*4+2];case Si.H:return sh[(t-1)*4+3];default:return}};var N2={},Hm={};const dd=new Uint8Array(512),Zh=new Uint8Array(256);(function(){let t=1;for(let s=0;s<255;s++)dd[s]=t,Zh[t]=s,t<<=1,t&256&&(t^=285);for(let s=255;s<512;s++)dd[s]=dd[s-255]})();Hm.log=function(t){if(t<1)throw new Error("log("+t+")");return Zh[t]};Hm.exp=function(t){return dd[t]};Hm.mul=function(t,s){return t===0||s===0?0:dd[Zh[t]+Zh[s]]};(function(r){const t=Hm;r.mul=function(a,n){const i=new Uint8Array(a.length+n.length-1);for(let o=0;o<a.length;o++)for(let c=0;c<n.length;c++)i[o+c]^=t.mul(a[o],n[c]);return i},r.mod=function(a,n){let i=new Uint8Array(a);for(;i.length-n.length>=0;){const o=i[0];for(let d=0;d<n.length;d++)i[d]^=t.mul(n[d],o);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},r.generateECPolynomial=function(a){let n=new Uint8Array([1]);for(let i=0;i<a;i++)n=r.mul(n,new Uint8Array([1,t.exp(i)]));return n}})(N2);const S2=N2;function Ny(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}Ny.prototype.initialize=function(t){this.degree=t,this.genPoly=S2.generateECPolynomial(this.degree)};Ny.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(t.length+this.degree);s.set(t);const a=S2.mod(s,this.genPoly),n=this.degree-a.length;if(n>0){const i=new Uint8Array(this.degree);return i.set(a,n),i}return a};var U8=Ny,k2={},Bi={},Sy={};Sy.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var un={};const C2="[0-9]+",$8="[A-Z $%*+\\-./:]+";let wd="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";wd=wd.replace(/u/g,"\\u");const z8="(?:(?![A-Z0-9 $%*+\\-./:]|"+wd+`)(?:.|[\r
]))+`;un.KANJI=new RegExp(wd,"g");un.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");un.BYTE=new RegExp(z8,"g");un.NUMERIC=new RegExp(C2,"g");un.ALPHANUMERIC=new RegExp($8,"g");const B8=new RegExp("^"+wd+"$"),q8=new RegExp("^"+C2+"$"),V8=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");un.testKanji=function(t){return B8.test(t)};un.testNumeric=function(t){return q8.test(t)};un.testAlphanumeric=function(t){return V8.test(t)};(function(r){const t=Sy,s=un;r.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},r.getBestModeForData=function(i){return s.testNumeric(i)?r.NUMERIC:s.testAlphanumeric(i)?r.ALPHANUMERIC:s.testKanji(i)?r.KANJI:r.BYTE},r.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},r.isValid=function(i){return i&&i.bit&&i.ccBits};function a(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw new Error("Unknown mode: "+n)}}r.from=function(i,o){if(r.isValid(i))return i;try{return a(i)}catch{return o}}})(Bi);(function(r){const t=ha,s=Wm,a=Vm,n=Bi,i=Sy,o=7973,c=t.getBCHDigit(o);function d(g,y,b){for(let w=1;w<=40;w++)if(y<=r.getCapacity(w,b,g))return w}function h(g,y){return n.getCharCountIndicator(g,y)+4}function m(g,y){let b=0;return g.forEach(function(w){const S=h(w.mode,y);b+=S+w.getBitsLength()}),b}function f(g,y){for(let b=1;b<=40;b++)if(m(g,b)<=r.getCapacity(b,y,n.MIXED))return b}r.from=function(y,b){return i.isValid(y)?parseInt(y,10):b},r.getCapacity=function(y,b,w){if(!i.isValid(y))throw new Error("Invalid QR Code version");typeof w>"u"&&(w=n.BYTE);const S=t.getSymbolTotalCodewords(y),N=s.getTotalCodewordsCount(y,b),v=(S-N)*8;if(w===n.MIXED)return v;const j=v-h(w,y);switch(w){case n.NUMERIC:return Math.floor(j/10*3);case n.ALPHANUMERIC:return Math.floor(j/11*2);case n.KANJI:return Math.floor(j/13);case n.BYTE:default:return Math.floor(j/8)}},r.getBestVersionForData=function(y,b){let w;const S=a.from(b,a.M);if(Array.isArray(y)){if(y.length>1)return f(y,S);if(y.length===0)return 1;w=y[0]}else w=y;return d(w.mode,w.getLength(),S)},r.getEncodedBits=function(y){if(!i.isValid(y)||y<7)throw new Error("Invalid QR Code version");let b=y<<12;for(;t.getBCHDigit(b)-c>=0;)b^=o<<t.getBCHDigit(b)-c;return y<<12|b}})(k2);var E2={};const lg=ha,A2=1335,W8=21522,sb=lg.getBCHDigit(A2);E2.getEncodedBits=function(t,s){const a=t.bit<<3|s;let n=a<<10;for(;lg.getBCHDigit(n)-sb>=0;)n^=A2<<lg.getBCHDigit(n)-sb;return(a<<10|n)^W8};var T2={};const H8=Bi;function Wl(r){this.mode=H8.NUMERIC,this.data=r.toString()}Wl.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Wl.prototype.getLength=function(){return this.data.length};Wl.prototype.getBitsLength=function(){return Wl.getBitsLength(this.data.length)};Wl.prototype.write=function(t){let s,a,n;for(s=0;s+3<=this.data.length;s+=3)a=this.data.substr(s,3),n=parseInt(a,10),t.put(n,10);const i=this.data.length-s;i>0&&(a=this.data.substr(s),n=parseInt(a,10),t.put(n,i*3+1))};var G8=Wl;const K8=Bi,$p=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Hl(r){this.mode=K8.ALPHANUMERIC,this.data=r}Hl.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};Hl.prototype.getLength=function(){return this.data.length};Hl.prototype.getBitsLength=function(){return Hl.getBitsLength(this.data.length)};Hl.prototype.write=function(t){let s;for(s=0;s+2<=this.data.length;s+=2){let a=$p.indexOf(this.data[s])*45;a+=$p.indexOf(this.data[s+1]),t.put(a,11)}this.data.length%2&&t.put($p.indexOf(this.data[s]),6)};var Q8=Hl;const Y8=Bi;function Gl(r){this.mode=Y8.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}Gl.getBitsLength=function(t){return t*8};Gl.prototype.getLength=function(){return this.data.length};Gl.prototype.getBitsLength=function(){return Gl.getBitsLength(this.data.length)};Gl.prototype.write=function(r){for(let t=0,s=this.data.length;t<s;t++)r.put(this.data[t],8)};var J8=Gl;const Z8=Bi,X8=ha;function Kl(r){this.mode=Z8.KANJI,this.data=r}Kl.getBitsLength=function(t){return t*13};Kl.prototype.getLength=function(){return this.data.length};Kl.prototype.getBitsLength=function(){return Kl.getBitsLength(this.data.length)};Kl.prototype.write=function(r){let t;for(t=0;t<this.data.length;t++){let s=X8.toSJIS(this.data[t]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),r.put(s,13)}};var ez=Kl,R2={exports:{}};(function(r){var t={single_source_shortest_paths:function(s,a,n){var i={},o={};o[a]=0;var c=t.PriorityQueue.make();c.push(a,0);for(var d,h,m,f,g,y,b,w,S;!c.empty();){d=c.pop(),h=d.value,f=d.cost,g=s[h]||{};for(m in g)g.hasOwnProperty(m)&&(y=g[m],b=f+y,w=o[m],S=typeof o[m]>"u",(S||w>b)&&(o[m]=b,c.push(m,b),i[m]=h))}if(typeof n<"u"&&typeof o[n]>"u"){var N=["Could not find a path from ",a," to ",n,"."].join("");throw new Error(N)}return i},extract_shortest_path_from_predecessor_list:function(s,a){for(var n=[],i=a;i;)n.push(i),s[i],i=s[i];return n.reverse(),n},find_path:function(s,a,n){var i=t.single_source_shortest_paths(s,a,n);return t.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(s){var a=t.PriorityQueue,n={},i;s=s||{};for(i in a)a.hasOwnProperty(i)&&(n[i]=a[i]);return n.queue=[],n.sorter=s.sorter||a.default_sorter,n},default_sorter:function(s,a){return s.cost-a.cost},push:function(s,a){var n={value:s,cost:a};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};r.exports=t})(R2);var tz=R2.exports;(function(r){const t=Bi,s=G8,a=Q8,n=J8,i=ez,o=un,c=ha,d=tz;function h(N){return unescape(encodeURIComponent(N)).length}function m(N,v,j){const C=[];let k;for(;(k=N.exec(j))!==null;)C.push({data:k[0],index:k.index,mode:v,length:k[0].length});return C}function f(N){const v=m(o.NUMERIC,t.NUMERIC,N),j=m(o.ALPHANUMERIC,t.ALPHANUMERIC,N);let C,k;return c.isKanjiModeEnabled()?(C=m(o.BYTE,t.BYTE,N),k=m(o.KANJI,t.KANJI,N)):(C=m(o.BYTE_KANJI,t.BYTE,N),k=[]),v.concat(j,C,k).sort(function(T,O){return T.index-O.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function g(N,v){switch(v){case t.NUMERIC:return s.getBitsLength(N);case t.ALPHANUMERIC:return a.getBitsLength(N);case t.KANJI:return i.getBitsLength(N);case t.BYTE:return n.getBitsLength(N)}}function y(N){return N.reduce(function(v,j){const C=v.length-1>=0?v[v.length-1]:null;return C&&C.mode===j.mode?(v[v.length-1].data+=j.data,v):(v.push(j),v)},[])}function b(N){const v=[];for(let j=0;j<N.length;j++){const C=N[j];switch(C.mode){case t.NUMERIC:v.push([C,{data:C.data,mode:t.ALPHANUMERIC,length:C.length},{data:C.data,mode:t.BYTE,length:C.length}]);break;case t.ALPHANUMERIC:v.push([C,{data:C.data,mode:t.BYTE,length:C.length}]);break;case t.KANJI:v.push([C,{data:C.data,mode:t.BYTE,length:h(C.data)}]);break;case t.BYTE:v.push([{data:C.data,mode:t.BYTE,length:h(C.data)}])}}return v}function w(N,v){const j={},C={start:{}};let k=["start"];for(let I=0;I<N.length;I++){const T=N[I],O=[];for(let U=0;U<T.length;U++){const A=T[U],L=""+I+U;O.push(L),j[L]={node:A,lastCount:0},C[L]={};for(let M=0;M<k.length;M++){const se=k[M];j[se]&&j[se].node.mode===A.mode?(C[se][L]=g(j[se].lastCount+A.length,A.mode)-g(j[se].lastCount,A.mode),j[se].lastCount+=A.length):(j[se]&&(j[se].lastCount=A.length),C[se][L]=g(A.length,A.mode)+4+t.getCharCountIndicator(A.mode,v))}}k=O}for(let I=0;I<k.length;I++)C[k[I]].end=0;return{map:C,table:j}}function S(N,v){let j;const C=t.getBestModeForData(N);if(j=t.from(v,C),j!==t.BYTE&&j.bit<C.bit)throw new Error('"'+N+'" cannot be encoded with mode '+t.toString(j)+`.
 Suggested mode is: `+t.toString(C));switch(j===t.KANJI&&!c.isKanjiModeEnabled()&&(j=t.BYTE),j){case t.NUMERIC:return new s(N);case t.ALPHANUMERIC:return new a(N);case t.KANJI:return new i(N);case t.BYTE:return new n(N)}}r.fromArray=function(v){return v.reduce(function(j,C){return typeof C=="string"?j.push(S(C,null)):C.data&&j.push(S(C.data,C.mode)),j},[])},r.fromString=function(v,j){const C=f(v,c.isKanjiModeEnabled()),k=b(C),I=w(k,j),T=d.find_path(I.map,"start","end"),O=[];for(let U=1;U<T.length-1;U++)O.push(I.table[T[U]].node);return r.fromArray(y(O))},r.rawSplit=function(v){return r.fromArray(f(v,c.isKanjiModeEnabled()))}})(T2);const Gm=ha,zp=Vm,sz=O8,rz=M8,az=j2,nz=b2,cg=_2,dg=Wm,iz=U8,Xh=k2,oz=E2,lz=Bi,Bp=T2;function cz(r,t){const s=r.size,a=nz.getPositions(t);for(let n=0;n<a.length;n++){const i=a[n][0],o=a[n][1];for(let c=-1;c<=7;c++)if(!(i+c<=-1||s<=i+c))for(let d=-1;d<=7;d++)o+d<=-1||s<=o+d||(c>=0&&c<=6&&(d===0||d===6)||d>=0&&d<=6&&(c===0||c===6)||c>=2&&c<=4&&d>=2&&d<=4?r.set(i+c,o+d,!0,!0):r.set(i+c,o+d,!1,!0))}}function dz(r){const t=r.size;for(let s=8;s<t-8;s++){const a=s%2===0;r.set(s,6,a,!0),r.set(6,s,a,!0)}}function uz(r,t){const s=az.getPositions(t);for(let a=0;a<s.length;a++){const n=s[a][0],i=s[a][1];for(let o=-2;o<=2;o++)for(let c=-2;c<=2;c++)o===-2||o===2||c===-2||c===2||o===0&&c===0?r.set(n+o,i+c,!0,!0):r.set(n+o,i+c,!1,!0)}}function hz(r,t){const s=r.size,a=Xh.getEncodedBits(t);let n,i,o;for(let c=0;c<18;c++)n=Math.floor(c/3),i=c%3+s-8-3,o=(a>>c&1)===1,r.set(n,i,o,!0),r.set(i,n,o,!0)}function qp(r,t,s){const a=r.size,n=oz.getEncodedBits(t,s);let i,o;for(i=0;i<15;i++)o=(n>>i&1)===1,i<6?r.set(i,8,o,!0):i<8?r.set(i+1,8,o,!0):r.set(a-15+i,8,o,!0),i<8?r.set(8,a-i-1,o,!0):i<9?r.set(8,15-i-1+1,o,!0):r.set(8,15-i-1,o,!0);r.set(a-8,8,1,!0)}function mz(r,t){const s=r.size;let a=-1,n=s-1,i=7,o=0;for(let c=s-1;c>0;c-=2)for(c===6&&c--;;){for(let d=0;d<2;d++)if(!r.isReserved(n,c-d)){let h=!1;o<t.length&&(h=(t[o]>>>i&1)===1),r.set(n,c-d,h),i--,i===-1&&(o++,i=7)}if(n+=a,n<0||s<=n){n-=a,a=-a;break}}}function fz(r,t,s){const a=new sz;s.forEach(function(d){a.put(d.mode.bit,4),a.put(d.getLength(),lz.getCharCountIndicator(d.mode,r)),d.write(a)});const n=Gm.getSymbolTotalCodewords(r),i=dg.getTotalCodewordsCount(r,t),o=(n-i)*8;for(a.getLengthInBits()+4<=o&&a.put(0,4);a.getLengthInBits()%8!==0;)a.putBit(0);const c=(o-a.getLengthInBits())/8;for(let d=0;d<c;d++)a.put(d%2?17:236,8);return pz(a,r,t)}function pz(r,t,s){const a=Gm.getSymbolTotalCodewords(t),n=dg.getTotalCodewordsCount(t,s),i=a-n,o=dg.getBlocksCount(t,s),c=a%o,d=o-c,h=Math.floor(a/o),m=Math.floor(i/o),f=m+1,g=h-m,y=new iz(g);let b=0;const w=new Array(o),S=new Array(o);let N=0;const v=new Uint8Array(r.buffer);for(let T=0;T<o;T++){const O=T<d?m:f;w[T]=v.slice(b,b+O),S[T]=y.encode(w[T]),b+=O,N=Math.max(N,O)}const j=new Uint8Array(a);let C=0,k,I;for(k=0;k<N;k++)for(I=0;I<o;I++)k<w[I].length&&(j[C++]=w[I][k]);for(k=0;k<g;k++)for(I=0;I<o;I++)j[C++]=S[I][k];return j}function xz(r,t,s,a){let n;if(Array.isArray(r))n=Bp.fromArray(r);else if(typeof r=="string"){let h=t;if(!h){const m=Bp.rawSplit(r);h=Xh.getBestVersionForData(m,s)}n=Bp.fromString(r,h||40)}else throw new Error("Invalid data");const i=Xh.getBestVersionForData(n,s);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=fz(t,s,n),c=Gm.getSymbolSize(t),d=new rz(c);return cz(d,t),dz(d),uz(d,t),qp(d,s,0),t>=7&&hz(d,t),mz(d,o),isNaN(a)&&(a=cg.getBestMask(d,qp.bind(null,d,s))),cg.applyMask(a,d),qp(d,s,a),{modules:d,version:t,errorCorrectionLevel:s,maskPattern:a,segments:n}}v2.create=function(t,s){if(typeof t>"u"||t==="")throw new Error("No input text");let a=zp.M,n,i;return typeof s<"u"&&(a=zp.from(s.errorCorrectionLevel,zp.M),n=Xh.from(s.version),i=cg.from(s.maskPattern),s.toSJISFunc&&Gm.setToSJISFunction(s.toSJISFunc)),xz(t,n,a,i)};var P2={},ky={};(function(r){function t(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let a=s.slice().replace("#","").split("");if(a.length<3||a.length===5||a.length>8)throw new Error("Invalid hex color: "+s);(a.length===3||a.length===4)&&(a=Array.prototype.concat.apply([],a.map(function(i){return[i,i]}))),a.length===6&&a.push("F","F");const n=parseInt(a.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+a.slice(0,6).join("")}}r.getOptions=function(a){a||(a={}),a.color||(a.color={});const n=typeof a.margin>"u"||a.margin===null||a.margin<0?4:a.margin,i=a.width&&a.width>=21?a.width:void 0,o=a.scale||4;return{width:i,scale:i?4:o,margin:n,color:{dark:t(a.color.dark||"#000000ff"),light:t(a.color.light||"#ffffffff")},type:a.type,rendererOpts:a.rendererOpts||{}}},r.getScale=function(a,n){return n.width&&n.width>=a+n.margin*2?n.width/(a+n.margin*2):n.scale},r.getImageWidth=function(a,n){const i=r.getScale(a,n);return Math.floor((a+n.margin*2)*i)},r.qrToImageData=function(a,n,i){const o=n.modules.size,c=n.modules.data,d=r.getScale(o,i),h=Math.floor((o+i.margin*2)*d),m=i.margin*d,f=[i.color.light,i.color.dark];for(let g=0;g<h;g++)for(let y=0;y<h;y++){let b=(g*h+y)*4,w=i.color.light;if(g>=m&&y>=m&&g<h-m&&y<h-m){const S=Math.floor((g-m)/d),N=Math.floor((y-m)/d);w=f[c[S*o+N]?1:0]}a[b++]=w.r,a[b++]=w.g,a[b++]=w.b,a[b]=w.a}}})(ky);(function(r){const t=ky;function s(n,i,o){n.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function a(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}r.render=function(i,o,c){let d=c,h=o;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),o||(h=a()),d=t.getOptions(d);const m=t.getImageWidth(i.modules.size,d),f=h.getContext("2d"),g=f.createImageData(m,m);return t.qrToImageData(g.data,i,d),s(f,h,m),f.putImageData(g,0,0),h},r.renderToDataURL=function(i,o,c){let d=c;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),d||(d={});const h=r.render(i,o,d),m=d.type||"image/png",f=d.rendererOpts||{};return h.toDataURL(m,f.quality)}})(P2);var I2={};const gz=ky;function rb(r,t){const s=r.a/255,a=t+'="'+r.hex+'"';return s<1?a+" "+t+'-opacity="'+s.toFixed(2).slice(1)+'"':a}function Vp(r,t,s){let a=r+t;return typeof s<"u"&&(a+=" "+s),a}function yz(r,t,s){let a="",n=0,i=!1,o=0;for(let c=0;c<r.length;c++){const d=Math.floor(c%t),h=Math.floor(c/t);!d&&!i&&(i=!0),r[c]?(o++,c>0&&d>0&&r[c-1]||(a+=i?Vp("M",d+s,.5+h+s):Vp("m",n,0),n=0,i=!1),d+1<t&&r[c+1]||(a+=Vp("h",o),o=0)):n++}return a}I2.render=function(t,s,a){const n=gz.getOptions(s),i=t.modules.size,o=t.modules.data,c=i+n.margin*2,d=n.color.light.a?"<path "+rb(n.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",h="<path "+rb(n.color.dark,"stroke")+' d="'+yz(o,i,n.margin)+'"/>',m='viewBox="0 0 '+c+" "+c+'"',g='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+m+' shape-rendering="crispEdges">'+d+h+`</svg>
`;return typeof a=="function"&&a(null,g),g};const vz=D8,ug=v2,D2=P2,wz=I2;function Cy(r,t,s,a,n){const i=[].slice.call(arguments,1),o=i.length,c=typeof i[o-1]=="function";if(!c&&!vz())throw new Error("Callback required as last argument");if(c){if(o<2)throw new Error("Too few arguments provided");o===2?(n=s,s=t,t=a=void 0):o===3&&(t.getContext&&typeof n>"u"?(n=a,a=void 0):(n=a,a=s,s=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(s=t,t=a=void 0):o===2&&!t.getContext&&(a=s,s=t,t=void 0),new Promise(function(d,h){try{const m=ug.create(s,a);d(r(m,t,a))}catch(m){h(m)}})}try{const d=ug.create(s,a);n(null,r(d,t,a))}catch(d){n(d)}}qd.create=ug.create;qd.toCanvas=Cy.bind(null,D2.render);qd.toDataURL=Cy.bind(null,D2.renderToDataURL);qd.toString=Cy.bind(null,function(r,t,s){return wz.render(r,s)});class jz{async setupTwoFactor(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");try{const{data:s,error:a}=await D.functions.invoke("two-factor-setup",{body:{userId:t.id}});if(a)throw new Error(a.message||"Failed to setup 2FA");const n=await qd.toDataURL(s.qrCodeData);return{secret:s.secret,qrCodeUrl:n,backupCodes:s.backupCodes}}catch(s){throw console.error("Error setting up 2FA:",s),new Error("Failed to setup two-factor authentication")}}async enableTwoFactor(t,s){const{data:{user:a}}=await D.auth.getUser();if(!a)throw new Error("User must be authenticated");try{const{error:n}=await D.functions.invoke("two-factor-enable",{body:{userId:a.id,token:t,secret:s}});if(n)throw new Error(n.message||"Invalid verification code");await D.auth.updateUser({data:{two_factor_enabled:!0}})}catch(n){throw console.error("Error enabling 2FA:",n),new Error("Failed to enable two-factor authentication")}}async disableTwoFactor(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("User must be authenticated");try{const{error:a}=await D.auth.signInWithPassword({email:s.email,password:t});if(a)throw new Error("Invalid password");const{error:n}=await D.functions.invoke("two-factor-disable",{body:{userId:s.id}});if(n)throw new Error(n.message||"Failed to disable 2FA");await D.auth.updateUser({data:{two_factor_enabled:!1}})}catch(a){throw console.error("Error disabling 2FA:",a),new Error("Failed to disable two-factor authentication")}}async verifyTwoFactor(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("User must be authenticated");try{const{data:a,error:n}=await D.functions.invoke("two-factor-verify",{body:{userId:s.id,token:t.token,backupCode:t.backupCode}});if(n)throw new Error(n.message||"Invalid verification code");return a.verified}catch(a){throw console.error("Error verifying 2FA:",a),new Error("Failed to verify two-factor authentication")}}async getTwoFactorStatus(){var s;const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");try{const{data:a,error:n}=await D.functions.invoke("two-factor-status",{body:{userId:t.id}});if(n)throw new Error(n.message||"Failed to get 2FA status");return{isEnabled:a.isEnabled||!1,hasBackupCodes:a.hasBackupCodes||!1,lastUsed:a.lastUsed}}catch(a){return console.error("Error getting 2FA status:",a),{isEnabled:((s=t.user_metadata)==null?void 0:s.two_factor_enabled)||!1,hasBackupCodes:!1}}}async generateBackupCodes(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");try{const{data:s,error:a}=await D.functions.invoke("two-factor-backup-codes",{body:{userId:t.id}});if(a)throw new Error(a.message||"Failed to generate backup codes");return s.backupCodes}catch(s){throw console.error("Error generating backup codes:",s),new Error("Failed to generate backup codes")}}isTwoFactorEnabled(t){var s;return((s=t==null?void 0:t.user_metadata)==null?void 0:s.two_factor_enabled)===!0}mockSetup(){return{secret:"JBSWY3DPEHPK3PXP",qrCodeUrl:"",backupCodes:["12345678","87654321","11111111","22222222","33333333","44444444","55555555","66666666"]}}async setupTwoFactorDev(){return this.setupTwoFactor()}async verifyTwoFactorDev(t){return this.verifyTwoFactor({token:t})}}const no=new jz,bz=({onVerificationSuccess:r,onBack:t,userEmail:s})=>{const[a,n]=p.useState(""),[i,o]=p.useState(""),[c,d]=p.useState(!1),[h,m]=p.useState(null),[f,g]=p.useState(!1),y=async()=>{if(!a&&!i){m("Please enter a verification code");return}d(!0),m(null);try{let N=!1;if(N=await no.verifyTwoFactor({token:a,backupCode:f?i:void 0}),N)te.success("Two-factor authentication verified successfully"),r();else throw new Error("Invalid verification code")}catch(N){console.error("Error verifying 2FA:",N),m(N.message||"Invalid verification code")}finally{d(!1)}},b=N=>{const v=N.replace(/\D/g,"").slice(0,6);n(v),m(null)},w=N=>{const v=N.replace(/\D/g,"").slice(0,8);o(v),m(null)},S=()=>{g(!f),n(""),o(""),m(null)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Z,{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(vs,{className:"h-6 w-6 text-blue-600"})})}),e.jsx(X,{className:"text-2xl font-bold text-center",children:"Two-Factor Authentication"}),e.jsx(ye,{className:"text-center",children:f?"Enter one of your backup codes to continue":"Enter the verification code from your authenticator app"}),s&&e.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["Signing in as ",s]})]}),e.jsxs(z,{className:"space-y-4",children:[h&&e.jsxs(vt,{variant:"destructive",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:h})]}),e.jsxs("div",{className:"space-y-4",children:[f?e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"backup-code",children:"Backup Code"}),e.jsx(Pe,{id:"backup-code",type:"text",value:i,onChange:N=>w(N.target.value),placeholder:"12345678",maxLength:8,className:"text-center text-lg tracking-widest",autoComplete:"one-time-code",autoFocus:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 text-center",children:"Enter one of your 8-digit backup codes"})]}):e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"verification-code",children:"Verification Code"}),e.jsx(Pe,{id:"verification-code",type:"text",value:a,onChange:N=>b(N.target.value),placeholder:"000000",maxLength:6,className:"text-center text-lg tracking-widest",autoComplete:"one-time-code",autoFocus:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 text-center",children:"Enter the 6-digit code from your authenticator app"})]}),e.jsxs(R,{onClick:y,disabled:c||!f&&a.length!==6||f&&i.length!==8,className:"w-full",children:[c?e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Verify and Continue"]}),e.jsx(Ts,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{variant:"ghost",onClick:S,className:"w-full text-sm",children:f?e.jsxs(e.Fragment,{children:[e.jsx(Qg,{className:"h-4 w-4 mr-2"}),"Use authenticator app instead"]}):e.jsxs(e.Fragment,{children:[e.jsx(Dh,{className:"h-4 w-4 mr-2"}),"Use backup code instead"]})}),t&&e.jsxs(R,{variant:"outline",onClick:t,className:"w-full text-sm",children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to login"]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs(cc,{children:[e.jsx(Bd,{asChild:!0,children:e.jsx(R,{variant:"link",className:"text-sm",children:"Need help?"})}),e.jsxs(Mo,{children:[e.jsxs(Lo,{children:[e.jsx(Uo,{children:"Two-Factor Authentication Help"}),e.jsx($o,{children:"Having trouble with your verification code?"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Authenticator App Issues:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Make sure your device's time is synchronized"}),e.jsx("li",{children:"• Check that you're using the correct account in your app"}),e.jsx("li",{children:"• Try refreshing the code in your authenticator app"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Lost Access?"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Use one of your backup codes"}),e.jsx("li",{children:"• Contact support if you've lost both your device and backup codes"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Backup Codes:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Each backup code can only be used once"}),e.jsx("li",{children:"• Generate new backup codes after using them"}),e.jsx("li",{children:"• Store them in a safe place"})]})]})]})]})]})})]})]})})},_z=zi({email:ys().email("Please enter a valid email address"),password:ys().min(6,"Password must be at least 6 characters")}),Nz=()=>{var C;const[r,t]=p.useState(!1),[s,a]=p.useState(!1),[n,i]=p.useState(null),[o,c]=p.useState(!1),[d,h]=p.useState(""),[m,f]=p.useState(null),{signIn:g}=ft(),y=ps();p.useEffect(()=>{(async()=>{try{const I=await fetch("https://api.ipify.org?format=json");if(!(I!=null&&I.ok)){console.warn("Failed to get IP address, using fallback");const U=await Ni.checkRateLimit("127.0.0.1");f({attemptsRemaining:U.attemptsRemaining,resetTime:U.resetTime,isBlocked:!U.allowed});return}const T=await I.json();if(!(T!=null&&T.ip)){console.warn("Invalid IP response, using fallback");const U=await Ni.checkRateLimit("127.0.0.1");f({attemptsRemaining:U.attemptsRemaining,resetTime:U.resetTime,isBlocked:!U.allowed});return}const O=await Ni.checkRateLimit(T.ip);f({attemptsRemaining:O.attemptsRemaining,resetTime:O.resetTime,isBlocked:!O.allowed})}catch(I){console.error("Error checking rate limit:",I);try{const T=await Ni.checkRateLimit("127.0.0.1");f({attemptsRemaining:T.attemptsRemaining,resetTime:T.resetTime,isBlocked:!T.allowed})}catch(T){console.error("Fallback rate limit check failed:",T),f({attemptsRemaining:5,resetTime:void 0,isBlocked:!1})}}})()},[]);const{register:b,handleSubmit:w,formState:{errors:S}}=Ui({resolver:$i(_z)}),N=async k=>{a(!0),i(null);try{(await g(k.email,k.password)).requiresTwoFactor?(h(k.email),c(!0)):y(Ye.dashboard)}catch(I){i(I.message??"An error occurred during login")}finally{a(!1)}},v=()=>{c(!1),y(Ye.dashboard)},j=()=>{c(!1),h("")};return o?e.jsx(bz,{onVerificationSuccess:v,onBack:j,userEmail:d}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Z,{className:"space-y-1",children:[e.jsx(X,{className:"text-2xl font-bold text-center",children:"Sign in"}),e.jsx(ye,{className:"text-center",children:"Enter your email and password to access your account"})]}),e.jsxs("form",{onSubmit:w(N),children:[e.jsxs(z,{className:"space-y-4",children:[n&&e.jsx(vt,{variant:"destructive",children:e.jsx(wt,{children:n})}),(m==null?void 0:m.isBlocked)&&e.jsxs(vt,{variant:"destructive",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs(wt,{children:["Too many failed login attempts. Please try again ",(C=m.resetTime)==null?void 0:C.toLocaleTimeString(),"."]})]}),m&&!m.isBlocked&&m.attemptsRemaining<3&&e.jsxs(vt,{children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsxs(wt,{children:[m.attemptsRemaining," login attempts remaining before temporary lockout."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"email",children:"Email"}),e.jsx(Pe,{id:"email",type:"email",placeholder:"Enter your email",...b("email"),disabled:s}),S.email&&e.jsx("p",{className:"text-sm text-red-600",children:S.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{id:"password",type:r?"text":"password",placeholder:"Enter your password",...b("password"),disabled:s}),e.jsx(R,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>t(!r),disabled:s,children:r?e.jsx(Pi,{className:"h-4 w-4"}):e.jsx(Gt,{className:"h-4 w-4"})})]}),S.password&&e.jsx("p",{className:"text-sm text-red-600",children:S.password.message})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(gs,{to:Ye.forgotPassword,className:"text-sm text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]}),e.jsxs(Ul,{className:"flex flex-col space-y-4",children:[e.jsxs(R,{type:"submit",className:"w-full",disabled:s||(m==null?void 0:m.isBlocked),children:[s&&e.jsx(ds,{className:"mr-2 h-4 w-4 animate-spin"}),m!=null&&m.isBlocked?"Account Temporarily Locked":"Sign in"]}),e.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Don't have an account?"," ",e.jsx(gs,{to:Ye.register,className:"text-blue-600 hover:text-blue-500 font-medium",children:"Sign up"})]})]})]})]})})},F2=({children:r,requireAuth:t=!0,redirectTo:s=Ye.login})=>{const{user:a,loading:n}=ft(),i=Ug();return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(ds,{className:"h-8 w-8 animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading..."})]})}):t&&!a?e.jsx(Lw,{to:s,state:{from:i},replace:!0}):!t&&a?e.jsx(Lw,{to:Ye.dashboard,replace:!0}):e.jsx(e.Fragment,{children:r})},Ey=({children:r})=>e.jsx(F2,{requireAuth:!0,children:r}),Ay=({children:r})=>e.jsx(F2,{requireAuth:!1,children:r}),Sz=()=>e.jsx(Ay,{children:e.jsx(Nz,{})}),kz=()=>{const[r,t]=p.useState("loading"),[s,a]=p.useState(null),[n,i]=p.useState("loading"),[o,c]=p.useState("loading");p.useEffect(()=>{(async()=>{try{const{error:m}=await D.auth.getSession();if(m){t("error"),a(m.message);return}t("success");const{data:{user:f},error:g}=await D.auth.getUser();if(g)i("unauthenticated"),c("missing");else if(f){i("authenticated");const{error:y}=await D.from("profiles").select("*").eq("id",f.id).single();y?y.code==="PGRST116"?c("missing"):c("error"):c("exists")}else i("unauthenticated"),c("missing")}catch(m){console.error("Connection test error:",m),t("error"),a(m.message),i("unauthenticated"),c("missing")}})()},[]);const d=(h,m,f,g)=>{switch(h){case"success":case"exists":case"authenticated":return e.jsxs(ae,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(Ue,{className:"w-3 h-3 mr-1"}),m]});case"error":case"missing":return e.jsxs(ae,{variant:"destructive",children:[e.jsx(Qs,{className:"w-3 h-3 mr-1"}),f]});case"unauthenticated":return e.jsxs(ae,{variant:"secondary",children:[e.jsx(Qs,{className:"w-3 h-3 mr-1"}),"Not Authenticated"]});default:return e.jsxs(ae,{variant:"outline",children:[e.jsx(ds,{className:"w-3 h-3 mr-1 animate-spin"}),g]})}};return e.jsxs($,{className:"w-full max-w-md mx-auto",children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Supabase Connection Status"}),e.jsx(ye,{children:"Debug information for authentication issues"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Database Connection:"}),d(r,"Connected","Failed","Testing...")]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Authentication:"}),d(n,"Authenticated","Error","Checking...")]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Profile:"}),d(o,"Exists","Missing","Loading...")]}),s&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Error Details:"}),e.jsx("p",{className:"text-xs text-red-600 mt-1",children:s})]}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Project:"})," kvlaydeyqidlfpfutbmp"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"URL:"})," ","https://kvlaydeyqidlfpfutbmp.supabase.co"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Environment:"})," ","production"]})]})]})]})},Cz=()=>{const[r,t]=p.useState([]),[s,a]=p.useState(!1);p.useState(null);const n=async()=>{a(!0);const d=[];try{const h=sn();d.push({name:"App URL",expected:"http://localhost:8082",actual:h,status:h==="http://localhost:8082"?"pass":"fail",description:"Application base URL should match development server"});const m=ly();d.push({name:"Supabase Site URL",expected:"http://localhost:8082",actual:m,status:m==="http://localhost:8082"?"pass":"fail",description:"Supabase site URL should match app URL"});const f=Mm(),g=f.includes("http://localhost:8082");d.push({name:"Auth Redirect URLs",expected:"Contains http://localhost:8082",actual:f.join(", "),status:g?"pass":"fail",description:"Redirect URLs should include the development server URL"});const y="https://craftchatbot.com";if(d.push({name:"Environment VITE_APP_URL",expected:"http://localhost:8082",actual:y||"undefined",status:y==="http://localhost:8082"?"pass":"warning",description:"Environment variable should match development server"}),typeof window<"u"){const S=window.location.origin;d.push({name:"Window Origin",expected:"http://localhost:8082",actual:S,status:S==="http://localhost:8082"?"pass":"warning",description:"Browser window origin should match expected URL"})}const b=ii.getSignInOptions(),w="http://localhost:8082/dashboard";d.push({name:"Sign-in Redirect",expected:w,actual:b.redirectTo,status:b.redirectTo===w?"pass":"fail",description:"Sign-in should redirect to dashboard"});try{const{data:S,error:N}=await D.auth.getSession();d.push({name:"Supabase Connection",expected:"No error",actual:N?N.message:"Connected",status:N?"fail":"pass",description:"Supabase client should connect successfully"})}catch(S){d.push({name:"Supabase Connection",expected:"No error",actual:S instanceof Error?S.message:"Unknown error",status:"fail",description:"Supabase client should connect successfully"})}t(d)}catch(h){console.error("Error running URL tests:",h)}finally{a(!1)}},i=()=>{console.log("Auth Config:",{siteUrl:ii.getSiteUrl(),redirectUrls:ii.getRedirectUrls(),signInOptions:ii.getSignInOptions(),signUpOptions:ii.getSignUpOptions(),passwordResetOptions:ii.getPasswordResetOptions()})};p.useEffect(()=>{n()},[]);const o=d=>{switch(d){case"pass":return e.jsx(Ue,{className:"h-4 w-4 text-green-500"});case"fail":return e.jsx(Qs,{className:"h-4 w-4 text-red-500"});case"warning":return e.jsx(is,{className:"h-4 w-4 text-yellow-500"});default:return null}},c=d=>{const h={pass:"default",fail:"destructive",warning:"secondary"};return e.jsx(ae,{variant:h[d]||"secondary",children:d.toUpperCase()})};return e.jsxs($,{className:"w-full max-w-4xl",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:["Authentication URL Configuration Test",s&&e.jsx(mr,{className:"h-4 w-4 animate-spin"})]}),e.jsx(ye,{children:"Verify that all URL configurations are properly set for authentication"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{onClick:n,disabled:s,size:"sm",children:s?"Running Tests...":"Run Tests"}),e.jsx(R,{onClick:i,variant:"outline",size:"sm",children:"Debug Config"})]})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:r.map((d,h)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:o(d.status)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:d.name}),c(d.status)]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:d.description}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Expected:"})," ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:d.expected})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Actual:"})," ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:d.actual})]})]})]})]},h))})})]})},Ez=()=>e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-8",children:"Debug Information"}),e.jsxs($,{className:"mb-6",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500"}),"System Status"]}),e.jsx(ye,{children:"Recent fixes applied to resolve loading issues"})]}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"✅ Navigation Fixed"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"✅ Auth Integration"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"✅ MCP Server Ready"})})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(kz,{}),e.jsx(Cz,{})]})]})}),Ds={async getDocuments(){try{const{data:r,error:t}=await D.from("uploaded_documents").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Error fetching documents:",t),t;return Array.isArray(r)?r.filter(a=>!a||typeof a!="object"?(console.warn("Invalid document object:",a),!1):a.id&&a.filename).map(a=>({...a,processing_status:a.processing_status||"pending",document_structure:a.document_structure||{}})):(console.warn("Documents data is not an array:",r),[])}catch(r){throw console.error("Failed to fetch documents:",r),r}},async getDocument(r){const{data:t,error:s}=await D.from("uploaded_documents").select("*").eq("id",r).single();if(s)throw s;return t},async uploadDocument(r,t){const s=await D.auth.getUser();if(!s.data.user)throw new Error("User not authenticated");const{usageTrackingService:a}=await Ns(async()=>{const{usageTrackingService:m}=await Promise.resolve().then(()=>an);return{usageTrackingService:m}},void 0),n=await a.checkUsageLimit("document_upload");if(!n.allowed)throw new Error(`Upload limit exceeded. You have used ${n.current}/${n.limit} document uploads this month. Please upgrade your plan to continue.`);const i=`${s.data.user.id}/${Date.now()}-${r.name}`,{error:o}=await D.storage.from("documents").upload(i,r);if(o)throw o;const{data:{publicUrl:c}}=D.storage.from("documents").getPublicUrl(i),{data:d,error:h}=await D.from("uploaded_documents").insert({user_id:s.data.user.id,filename:r.name,file_url:c,file_size:r.size,document_type:t,processing_status:"pending"}).select().single();if(h)throw h;return d},async updateDocument(r,t){const{data:s,error:a}=await D.from("uploaded_documents").update(t).eq("id",r).select().single();if(a)throw a;return s},async deleteDocument(r){const s=(await this.getDocument(r)).file_url.split("/").pop();s&&await D.storage.from("documents").remove([s]);const{error:a}=await D.from("uploaded_documents").delete().eq("id",r);if(a)throw a},async searchDocuments(r){try{if(!r||r.trim().length<2)return[];const{data:t,error:s}=await D.from("uploaded_documents").select("*").or(`filename.ilike.%${r}%,ocr_text.ilike.%${r}%`).order("created_at",{ascending:!1});if(s)throw console.error("Error searching documents:",s),s;return Array.isArray(t)?t.filter(n=>!n||typeof n!="object"?(console.warn("Invalid document object in search:",n),!1):n.id&&n.filename).map(n=>({...n,processing_status:n.processing_status||"pending",document_structure:n.document_structure||{}})):(console.warn("Search results data is not an array:",t),[])}catch(t){throw console.error("Failed to search documents:",t),t}},async getDocumentsByStatus(r){const{data:t,error:s}=await D.from("uploaded_documents").select("*").eq("processing_status",r).order("created_at",{ascending:!1});if(s)throw s;return t},async downloadDocument(r,t=!0){var c,d;if(!(await D.auth.getUser()).data.user)throw new Error("User not authenticated");const a=await this.getDocument(r);if(t){const{usageTrackingService:h}=await Ns(async()=>{const{usageTrackingService:f}=await Promise.resolve().then(()=>an);return{usageTrackingService:f}},void 0),m=await h.checkAndIncrementUsage("document_download",r,{filename:a.filename,document_type:a.document_type,file_size:a.file_size});if(!m.allowed)throw new Error(`Download limit exceeded. You have used ${(c=m.limit)==null?void 0:c.current}/${(d=m.limit)==null?void 0:d.limit} document downloads this month. Please upgrade your plan to continue.`)}const n=a.file_url.split("/").pop();if(!n)throw new Error("Invalid file URL");const{data:i,error:o}=await D.storage.from("documents").download(n);if(o)throw o;return{data:i,filename:a.filename,contentType:`application/${a.document_type}`}},async getDocumentUsage(){const{usageTrackingService:r}=await Ns(async()=>{const{usageTrackingService:t}=await Promise.resolve().then(()=>an);return{usageTrackingService:t}},void 0);return await r.getUsageStats()}},Az=Object.freeze(Object.defineProperty({__proto__:null,documentsApi:Ds},Symbol.toStringTag,{value:"Module"}));class Tz{async checkUsageLimit(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("User must be authenticated");const{data:a,error:n}=await D.rpc("check_subscription_limit",{p_user_id:s.id,p_resource_type:t});if(n)throw console.error("Error checking usage limit:",n),new Error(`Failed to check usage limit: ${n.message}`);const i=a;return{allowed:i.allowed,limit:i.limit,current:i.current_usage,remaining:i.remaining,tier:i.tier,percentage:i.limit>0?i.current_usage/i.limit*100:0}}async incrementUsage(t,s,a){const{data:{user:n}}=await D.auth.getUser();if(!n)throw new Error("User must be authenticated");const{error:i}=await D.rpc("increment_usage",{p_user_id:n.id,p_resource_type:t,p_resource_id:s||null,p_metadata:a||{}});if(i)throw console.error("Error incrementing usage:",i),new Error(`Failed to increment usage: ${i.message}`);await this.checkAndCreateUsageAlerts(n.id,t)}async getUsageStats(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");const s=new Date().toISOString().slice(0,7),a=this.getNextMonth(s),{data:n,error:i}=await D.from("usage_tracking").select("resource_type, usage_count").eq("user_id",t.id).gte("usage_date",`${s}-01`).lt("usage_date",`${a}-01`);if(i)throw console.error("Error fetching usage stats:",i),new Error(`Failed to fetch usage stats: ${i.message}`);const o={ai_queries:0,document_uploads:0,document_downloads:0,custom_documents:0};return n==null||n.forEach(c=>{c.resource_type in o&&(o[c.resource_type]+=c.usage_count)}),o}async getUserLimits(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");const{data:s}=await D.from("profiles").select("subscription_tier").eq("id",t.id).single(),a=(s==null?void 0:s.subscription_tier)||"free",n=Pn[a];return{ai_query:n.limits.monthlyAiRequests,document_upload:n.limits.monthlyDocumentUploads,document_download:n.limits.monthlyDocumentUploads,custom_document:n.limits.customDocumentDownloads}}async checkAndCreateUsageAlerts(t,s){try{const a=await this.checkUsageLimit(s);a.percentage>=80&&a.percentage<100&&await D.rpc("create_billing_alert",{p_user_id:t,p_alert_type:"usage_limit_warning",p_resource_type:s,p_threshold_percentage:Math.round(a.percentage)}),a.percentage>=100&&await D.rpc("create_billing_alert",{p_user_id:t,p_alert_type:"usage_limit_reached",p_resource_type:s,p_threshold_percentage:100})}catch(a){console.error("Error checking usage alerts:",a)}}async getBillingAlerts(t=!1){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("User must be authenticated");let a=D.from("billing_alerts").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});t&&(a=a.eq("is_read",!1));const{data:n,error:i}=await a;if(i)throw console.error("Error fetching billing alerts:",i),new Error(`Failed to fetch billing alerts: ${i.message}`);return n||[]}async markAlertAsRead(t){const{error:s}=await D.from("billing_alerts").update({is_read:!0}).eq("id",t);if(s)throw console.error("Error marking alert as read:",s),new Error(`Failed to mark alert as read: ${s.message}`)}async checkAndIncrementUsage(t,s,a){const n=await this.checkUsageLimit(t);return n.allowed?(await this.incrementUsage(t,s,a),{allowed:!0,limit:n}):{allowed:!1,limit:n}}getNextMonth(t){const[s,a]=t.split("-").map(Number),n=a===12?1:a+1;return`${a===12?s+1:s}-${n.toString().padStart(2,"0")}`}}const aa=new Tz,an=Object.freeze(Object.defineProperty({__proto__:null,usageTrackingService:aa},Symbol.toStringTag,{value:"Module"})),O2=()=>{const{user:r,profile:t,loading:s,refreshProfile:a}=ft(),[n,i]=p.useState([]),[o,c]=p.useState(!1),d=f=>{i(g=>[...g,`${new Date().toLocaleTimeString()}: ${f}`])},h=async()=>{c(!0),i([]);try{if(d("Starting upload diagnostics..."),d("1. Checking authentication..."),!r){d("❌ User not authenticated");return}if(d(`✅ User authenticated: ${r.email}`),d("2. Checking user profile..."),!t){d("❌ User profile not loaded");return}d(`✅ Profile loaded: ${t.email}, Tier: ${t.subscription_tier||"free"}`),d("3. Testing Supabase connection...");try{const{data:f,error:g}=await D.from("profiles").select("id").limit(1);if(g)throw g;d("✅ Supabase connection working")}catch(f){d(`❌ Supabase connection failed: ${f.message}`);return}d("4. Checking storage buckets...");try{const{data:f,error:g}=await D.storage.listBuckets();if(g)throw g;if(!f.find(b=>b.id==="documents")){d("❌ Documents bucket not found");return}d("✅ Documents bucket exists")}catch(f){d(`❌ Storage bucket check failed: ${f.message}`);return}d("5. Testing usage tracking...");try{const f=await aa.checkUsageLimit("document_upload");d(`✅ Usage check successful: ${f.current}/${f.limit} used`),f.allowed||d("⚠️ Upload limit reached")}catch(f){d(`❌ Usage tracking failed: ${f.message}`)}d("6. Testing file upload...");try{const f=new File(["test content"],"test.txt",{type:"text/plain"});if(!(await aa.checkUsageLimit("document_upload")).allowed)d("⚠️ Skipping upload test - usage limit reached");else{const y=await Ds.uploadDocument(f,"other");d(`✅ Test upload successful: ${y.id}`);try{await Ds.deleteDocument(y.id),d("✅ Test file cleaned up")}catch(b){d(`⚠️ Cleanup failed: ${b.message}`)}}}catch(f){d(`❌ Upload test failed: ${f.message}`)}d("🎉 Diagnostics completed!")}catch(f){d(`❌ Diagnostics failed: ${f.message}`)}finally{c(!1)}},m=async()=>{c(!0),i([]);try{d("Testing storage permissions...");const f=new File(["test"],"test.txt",{type:"text/plain"}),g=`${r==null?void 0:r.id}/test-${Date.now()}.txt`,{error:y}=await D.storage.from("documents").upload(g,f);if(y)d(`❌ Storage upload failed: ${y.message}`);else{d("✅ Storage upload successful");const{error:b}=await D.storage.from("documents").remove([g]);d(b?`⚠️ Cleanup failed: ${b.message}`:"✅ Cleanup successful")}}catch(f){d(`❌ Storage test failed: ${f.message}`)}finally{c(!1)}};return s?e.jsx("div",{children:"Loading auth state..."}):e.jsxs($,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(Z,{children:e.jsx(X,{children:"Upload Diagnostics"})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{onClick:h,disabled:o||!r,children:o?"Running...":"Run Full Diagnostics"}),e.jsx(R,{onClick:m,disabled:o||!r,variant:"outline",children:"Test Storage Only"}),e.jsx(R,{onClick:a,disabled:o||!r,variant:"outline",children:"Refresh Profile"})]}),!r&&e.jsx(vt,{children:e.jsx(wt,{children:"Please log in to run upload diagnostics."})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold",children:"Current State:"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["User: ",r?r.email:"Not authenticated"]}),e.jsxs("div",{children:["Profile: ",t?`${t.email} (${t.subscription_tier||"free"})`:"Not loaded"]}),e.jsxs("div",{children:["Loading: ",s?"Yes":"No"]})]})]}),n.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold",children:"Test Results:"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg max-h-96 overflow-y-auto",children:n.map((f,g)=>e.jsx("div",{className:"text-sm font-mono",children:f},g))})]})]})]})},Rz=()=>e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(_r,{className:"h-8 w-8 text-blue-600"}),"Upload Debug & Testing"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Test and debug document upload functionality"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{asChild:!0,variant:"outline",children:e.jsx(gs,{to:"/debug",children:"← Back to Debug"})}),e.jsx(R,{asChild:!0,variant:"outline",children:e.jsx(gs,{to:"/dashboard/documents",children:"Dashboard Documents"})})]})]}),e.jsxs($,{className:"mb-6",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500"}),"Upload System Status"]}),e.jsx(ye,{children:"Current status of upload functionality and recent fixes"})]}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"✅ Upload Component"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"✅ File Validation"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"✅ Supabase Storage"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ae,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:"⚠️ Testing Required"})})]})})]}),e.jsxs($,{className:"mb-6",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(_r,{className:"h-5 w-5 text-blue-500"}),"Upload Testing"]}),e.jsx(ye,{children:"Test document upload functionality with detailed debugging"})]}),e.jsx(z,{children:e.jsx(O2,{})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-5 w-5 text-orange-500"}),"System Diagnostics"]}),e.jsx(ye,{children:"Comprehensive system health check and diagnostics"})]}),e.jsx(z,{children:e.jsx(by,{})})]})]})}),Pz=zi({firstName:ys().min(2,"First name must be at least 2 characters"),lastName:ys().min(2,"Last name must be at least 2 characters"),email:ys().email("Please enter a valid email address"),password:ys().min(8,"Password must be at least 8 characters"),confirmPassword:ys()}).refine(r=>r.password===r.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),Iz=()=>{const[r,t]=p.useState(!1),[s,a]=p.useState(!1),[n,i]=p.useState(!1),[o,c]=p.useState(null),[d,h]=p.useState(!1),{signUp:m}=ft(),f=ps(),{register:g,handleSubmit:y,formState:{errors:b}}=Ui({resolver:$i(Pz)}),w=async S=>{i(!0),c(null);try{await m(S.email,S.password,{first_name:S.firstName,last_name:S.lastName}),h(!0)}catch(N){c(N.message||"An error occurred during registration")}finally{i(!1)}};return d?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Z,{className:"space-y-1",children:[e.jsx(X,{className:"text-2xl font-bold text-center text-green-600",children:"Registration Successful!"}),e.jsx(ye,{className:"text-center",children:"Please check your email to verify your account before signing in."})]}),e.jsx(Ul,{children:e.jsx(R,{onClick:()=>f(Ye.login),className:"w-full",children:"Go to Sign In"})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Z,{className:"space-y-1",children:[e.jsx(X,{className:"text-2xl font-bold text-center",children:"Create Account"}),e.jsx(ye,{className:"text-center",children:"Enter your information to create your account"})]}),e.jsxs("form",{onSubmit:y(w),children:[e.jsxs(z,{className:"space-y-4",children:[o&&e.jsx(vt,{variant:"destructive",children:e.jsx(wt,{children:o})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"firstName",children:"First Name"}),e.jsx(Pe,{id:"firstName",placeholder:"John",...g("firstName"),disabled:n}),b.firstName&&e.jsx("p",{className:"text-sm text-red-600",children:b.firstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"lastName",children:"Last Name"}),e.jsx(Pe,{id:"lastName",placeholder:"Doe",...g("lastName"),disabled:n}),b.lastName&&e.jsx("p",{className:"text-sm text-red-600",children:b.lastName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"email",children:"Email"}),e.jsx(Pe,{id:"email",type:"email",placeholder:"john@example.com",...g("email"),disabled:n}),b.email&&e.jsx("p",{className:"text-sm text-red-600",children:b.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{id:"password",type:r?"text":"password",placeholder:"Create a password",...g("password"),disabled:n}),e.jsx(R,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>t(!r),disabled:n,children:r?e.jsx(Pi,{className:"h-4 w-4"}):e.jsx(Gt,{className:"h-4 w-4"})})]}),b.password&&e.jsx("p",{className:"text-sm text-red-600",children:b.password.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{id:"confirmPassword",type:s?"text":"password",placeholder:"Confirm your password",...g("confirmPassword"),disabled:n}),e.jsx(R,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>a(!s),disabled:n,children:s?e.jsx(Pi,{className:"h-4 w-4"}):e.jsx(Gt,{className:"h-4 w-4"})})]}),b.confirmPassword&&e.jsx("p",{className:"text-sm text-red-600",children:b.confirmPassword.message})]})]}),e.jsxs(Ul,{className:"flex flex-col space-y-4",children:[e.jsxs(R,{type:"submit",className:"w-full",disabled:n,children:[n&&e.jsx(ds,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Account"]}),e.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(gs,{to:Ye.login,className:"text-blue-600 hover:text-blue-500 font-medium",children:"Sign in"})]})]})]})]})})},Dz=()=>e.jsx(Ay,{children:e.jsx(Iz,{})}),Fz=zi({email:ys().email("Please enter a valid email address")}),Oz=()=>{const[r,t]=p.useState(!1),[s,a]=p.useState(null),[n,i]=p.useState(!1),[o,c]=p.useState(""),{resetPassword:d}=ft(),{register:h,handleSubmit:m,formState:{errors:f}}=Ui({resolver:$i(Fz)}),g=async y=>{t(!0),a(null);try{await d(y.email),i(!0),c(y.email)}catch(b){a(b.message??"An error occurred while sending the reset email")}finally{t(!1)}};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Z,{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Ue,{className:"h-6 w-6 text-green-600"})})}),e.jsx(X,{className:"text-2xl font-bold text-center",children:"Check Your Email"}),e.jsx(ye,{className:"text-center",children:"We've sent a password reset link to your email address"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs(vt,{children:[e.jsx(qa,{className:"h-4 w-4"}),e.jsxs(wt,{children:["A password reset link has been sent to ",e.jsx("strong",{children:o}),". Please check your email and follow the instructions to reset your password."]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("p",{children:"Didn't receive the email?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[e.jsx("li",{children:"Check your spam or junk folder"}),e.jsx("li",{children:"Make sure you entered the correct email address"}),e.jsx("li",{children:"Wait a few minutes for the email to arrive"})]})]})]}),e.jsxs(Ul,{className:"flex flex-col space-y-4",children:[e.jsxs(R,{onClick:()=>{i(!1),c(""),a(null)},variant:"outline",className:"w-full",children:[e.jsx(qa,{className:"mr-2 h-4 w-4"}),"Send Another Email"]}),e.jsx(gs,{to:Ye.login,className:"w-full",children:e.jsxs(R,{variant:"ghost",className:"w-full",children:[e.jsx($r,{className:"mr-2 h-4 w-4"}),"Back to Sign In"]})})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Z,{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(qa,{className:"h-6 w-6 text-blue-600"})})}),e.jsx(X,{className:"text-2xl font-bold text-center",children:"Forgot Password?"}),e.jsx(ye,{className:"text-center",children:"Enter your email address and we'll send you a link to reset your password"})]}),e.jsxs("form",{onSubmit:m(g),children:[e.jsxs(z,{className:"space-y-4",children:[s&&e.jsx(vt,{variant:"destructive",children:e.jsx(wt,{children:s})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"email",children:"Email Address"}),e.jsx(Pe,{id:"email",type:"email",placeholder:"Enter your email address",...h("email"),className:f.email?"border-red-500":"",autoComplete:"email",autoFocus:!0}),f.email&&e.jsx("p",{className:"text-sm text-red-600",children:f.email.message})]}),e.jsx("div",{className:"text-sm text-gray-600",children:e.jsx("p",{children:"We'll send you an email with instructions to reset your password. The link will be valid for 24 hours."})})]}),e.jsxs(Ul,{className:"flex flex-col space-y-4",children:[e.jsxs(R,{type:"submit",className:"w-full",disabled:r,children:[r&&e.jsx(ds,{className:"mr-2 h-4 w-4 animate-spin"}),"Send Reset Link"]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm",children:[e.jsxs(gs,{to:Ye.login,className:"text-blue-600 hover:text-blue-500 font-medium",children:[e.jsx($r,{className:"inline h-4 w-4 mr-1"}),"Back to Sign In"]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx(gs,{to:Ye.register,className:"text-blue-600 hover:text-blue-500 font-medium",children:"Create Account"})]})]})]})]})})},Mz=()=>e.jsx(Ay,{children:e.jsx(Oz,{})}),Lz=C$,M2=p.createContext({}),ab=({...r})=>e.jsx(M2.Provider,{value:{name:r.name},children:e.jsx(R$,{...r})}),Km=()=>{const r=p.useContext(M2),t=p.useContext(L2),{getFieldState:s,formState:a}=qm(),n=s(r.name,a);if(!r)throw new Error("useFormField should be used within <FormField>");const{id:i}=t;return{id:i,name:r.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...n}},L2=p.createContext({}),hg=p.forwardRef(({className:r,...t},s)=>{const a=p.useId();return e.jsx(L2.Provider,{value:{id:a},children:e.jsx("div",{ref:s,className:Ie("space-y-2",r),...t})})});hg.displayName="FormItem";const mg=p.forwardRef(({className:r,...t},s)=>{const{error:a,formItemId:n}=Km();return e.jsx(Te,{ref:s,className:Ie(a&&"text-destructive",r),htmlFor:n,...t})});mg.displayName="FormLabel";const fg=p.forwardRef(({...r},t)=>{const{error:s,formItemId:a,formDescriptionId:n,formMessageId:i}=Km();return e.jsx(pm,{ref:t,id:a,"aria-describedby":s?`${n} ${i}`:`${n}`,"aria-invalid":!!s,...r})});fg.displayName="FormControl";const Uz=p.forwardRef(({className:r,...t},s)=>{const{formDescriptionId:a}=Km();return e.jsx("p",{ref:s,id:a,className:Ie("text-sm text-muted-foreground",r),...t})});Uz.displayName="FormDescription";const pg=p.forwardRef(({className:r,children:t,...s},a)=>{const{error:n,formMessageId:i}=Km(),o=n?String(n==null?void 0:n.message):t;return o?e.jsx("p",{ref:a,id:i,className:Ie("text-sm font-medium text-destructive",r),...s,children:o}):null});pg.displayName="FormMessage";const $z=zi({password:ys().min(8,"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:ys()}).refine(r=>r.password===r.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),zz=()=>{const r=ps(),[t]=Dd(),[s,a]=p.useState(!1),[n,i]=p.useState(!1),[o,c]=p.useState(!1),d=Ui({resolver:$i($z),defaultValues:{password:"",confirmPassword:""}});p.useEffect(()=>{const m=t.get("access_token"),f=t.get("refresh_token");if(!m||!f){te.error("Invalid reset link. Please request a new password reset."),r("/auth/forgot-password");return}D.auth.setSession({access_token:m,refresh_token:f})},[t,r]);const h=async m=>{try{a(!0);const{error:f}=await D.auth.updateUser({password:m.password});if(f)throw f;te.success("Password updated successfully!"),await D.auth.signOut(),r("/auth/login",{state:{message:"Password updated successfully. Please log in with your new password."}})}catch(f){console.error("Password reset error:",f),te.error(f.message||"Failed to update password. Please try again.")}finally{a(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs($,{className:"w-full max-w-md",children:[e.jsxs(Z,{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>r("/auth/login"),className:"p-2",children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gg,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-900",children:"LawMattersSG"})]})]}),e.jsx(X,{className:"text-2xl font-bold text-center",children:"Reset Password"}),e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Enter your new password below"})]}),e.jsxs(z,{children:[e.jsx(Lz,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(h),className:"space-y-4",children:[e.jsx(ab,{control:d.control,name:"password",render:({field:m})=>e.jsxs(hg,{children:[e.jsx(mg,{children:"New Password"}),e.jsx(fg,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{...m,type:n?"text":"password",placeholder:"Enter your new password",disabled:s}),e.jsx(R,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>i(!n),disabled:s,children:n?e.jsx(Pi,{className:"h-4 w-4"}):e.jsx(Gt,{className:"h-4 w-4"})})]})}),e.jsx(pg,{})]})}),e.jsx(ab,{control:d.control,name:"confirmPassword",render:({field:m})=>e.jsxs(hg,{children:[e.jsx(mg,{children:"Confirm New Password"}),e.jsx(fg,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{...m,type:o?"text":"password",placeholder:"Confirm your new password",disabled:s}),e.jsx(R,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>c(!o),disabled:s,children:o?e.jsx(Pi,{className:"h-4 w-4"}):e.jsx(Gt,{className:"h-4 w-4"})})]})}),e.jsx(pg,{})]})}),e.jsx(R,{type:"submit",className:"w-full",disabled:s,children:s?"Updating Password...":"Update Password"})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Remember your password?"," ",e.jsx(R,{variant:"link",className:"p-0 h-auto font-normal",onClick:()=>r("/auth/login"),children:"Sign in"})]})})]})]})})},Bz=()=>{const{user:r,profile:t,signOut:s,loading:a}=ft(),n=ps();console.log("Dashboard - User:",r==null?void 0:r.email),console.log("Dashboard - Profile:",t),console.log("Dashboard - Profile Role:",t==null?void 0:t.role),console.log("Dashboard - Profile Subscription:",t==null?void 0:t.subscription_tier),console.log("Dashboard - Loading:",a);const i=async()=>{try{await s()}catch(o){console.error("Error signing out:",o)}};return e.jsx(Ey,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>n("/"),className:"flex items-center space-x-2",children:[e.jsx(Nm,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Homepage"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",(t==null?void 0:t.first_name)||(r==null?void 0:r.email),"!"]})]})]}),e.jsx(R,{onClick:i,variant:"outline",children:"Sign Out"})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs($,{children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Documents"}),e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total uploaded documents"})]})]}),e.jsxs($,{children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"AI Chats"}),e.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AI conversations this month"})]})]}),e.jsxs($,{children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Templates"}),e.jsx(px,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Custom templates created"})]})]}),e.jsxs($,{children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:(t==null?void 0:t.role)==="super_admin"||(t==null?void 0:t.role)==="admin"?"Role":"Subscription"}),e.jsx(cn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold capitalize",children:(t==null?void 0:t.role)==="super_admin"?"Super Admin":(t==null?void 0:t.role)==="admin"?"Admin":(t==null?void 0:t.subscription_tier)||"Free"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:(t==null?void 0:t.role)==="super_admin"||(t==null?void 0:t.role)==="admin"?"Administrative access":"Current plan"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Upload Documents"}),e.jsx(ye,{children:"Upload and process your legal documents with AI"})]}),e.jsx(z,{children:e.jsx(gs,{to:Ye.documents,children:e.jsxs(R,{className:"w-full",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Upload Document"]})})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"AI Assistant"}),e.jsx(ye,{children:"Get legal insights and answers from our AI"})]}),e.jsx(z,{children:e.jsxs(R,{className:"w-full",children:[e.jsx(Ft,{className:"mr-2 h-4 w-4"}),"Start Chat"]})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Browse Templates"}),e.jsx(ye,{children:"Explore legal document templates"})]}),e.jsx(z,{children:e.jsxs(R,{className:"w-full",children:[e.jsx(px,{className:"mr-2 h-4 w-4"}),"View Templates"]})})]})]})]})})]})})},qz=p.createContext(null),Wp={didCatch:!1,error:null};let U2=class extends p.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Wp}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var s,a,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(s=(a=this.props).onReset)===null||s===void 0||s.call(a,{args:i,reason:"imperative-api"}),this.setState(Wp)}}componentDidCatch(t,s){var a,n;(a=(n=this.props).onError)===null||a===void 0||a.call(n,t,s)}componentDidUpdate(t,s){const{didCatch:a}=this.state,{resetKeys:n}=this.props;if(a&&s.error!==null&&Vz(t.resetKeys,n)){var i,o;(i=(o=this.props).onReset)===null||i===void 0||i.call(o,{next:n,prev:t.resetKeys,reason:"keys"}),this.setState(Wp)}}render(){const{children:t,fallbackRender:s,FallbackComponent:a,fallback:n}=this.props,{didCatch:i,error:o}=this.state;let c=t;if(i){const d={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof s=="function")c=s(d);else if(a)c=p.createElement(a,d);else if(n!==void 0)c=n;else throw o}return p.createElement(qz.Provider,{value:{didCatch:i,error:o,resetErrorBoundary:this.resetErrorBoundary}},c)}};function Vz(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return r.length!==t.length||r.some((s,a)=>!Object.is(s,t[a]))}var $2={exports:{}},Wz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Hz=Wz,Gz=Hz;function z2(){}function B2(){}B2.resetWarningCache=z2;var Kz=function(){function r(a,n,i,o,c,d){if(d!==Gz){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}r.isRequired=r;function t(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:t,element:r,elementType:r,instanceOf:t,node:r,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:B2,resetWarningCache:z2};return s.PropTypes=s,s};$2.exports=Kz();var Qz=$2.exports;const ns=XD(Qz),Yz=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Ql(r,t,s){const a=Jz(r),{webkitRelativePath:n}=r,i=typeof t=="string"?t:typeof n=="string"&&n.length>0?n:`./${r.name}`;return typeof a.path!="string"&&nb(a,"path",i),nb(a,"relativePath",i),a}function Jz(r){const{name:t}=r;if(t&&t.lastIndexOf(".")!==-1&&!r.type){const a=t.split(".").pop().toLowerCase(),n=Yz.get(a);n&&Object.defineProperty(r,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return r}function nb(r,t,s){Object.defineProperty(r,t,{value:s,writable:!1,configurable:!1,enumerable:!0})}const Zz=[".DS_Store","Thumbs.db"];function Xz(r){return Do(this,void 0,void 0,function*(){return em(r)&&eB(r.dataTransfer)?aB(r.dataTransfer,r.type):tB(r)?sB(r):Array.isArray(r)&&r.every(t=>"getFile"in t&&typeof t.getFile=="function")?rB(r):[]})}function eB(r){return em(r)}function tB(r){return em(r)&&em(r.target)}function em(r){return typeof r=="object"&&r!==null}function sB(r){return xg(r.target.files).map(t=>Ql(t))}function rB(r){return Do(this,void 0,void 0,function*(){return(yield Promise.all(r.map(s=>s.getFile()))).map(s=>Ql(s))})}function aB(r,t){return Do(this,void 0,void 0,function*(){if(r.items){const s=xg(r.items).filter(n=>n.kind==="file");if(t!=="drop")return s;const a=yield Promise.all(s.map(nB));return ib(q2(a))}return ib(xg(r.files).map(s=>Ql(s)))})}function ib(r){return r.filter(t=>Zz.indexOf(t.name)===-1)}function xg(r){if(r===null)return[];const t=[];for(let s=0;s<r.length;s++){const a=r[s];t.push(a)}return t}function nB(r){if(typeof r.webkitGetAsEntry!="function")return ob(r);const t=r.webkitGetAsEntry();return t&&t.isDirectory?V2(t):ob(r,t)}function q2(r){return r.reduce((t,s)=>[...t,...Array.isArray(s)?q2(s):[s]],[])}function ob(r,t){return Do(this,void 0,void 0,function*(){var s;if(globalThis.isSecureContext&&typeof r.getAsFileSystemHandle=="function"){const i=yield r.getAsFileSystemHandle();if(i===null)throw new Error(`${r} is not a File`);if(i!==void 0){const o=yield i.getFile();return o.handle=i,Ql(o)}}const a=r.getAsFile();if(!a)throw new Error(`${r} is not a File`);return Ql(a,(s=t==null?void 0:t.fullPath)!==null&&s!==void 0?s:void 0)})}function iB(r){return Do(this,void 0,void 0,function*(){return r.isDirectory?V2(r):oB(r)})}function V2(r){const t=r.createReader();return new Promise((s,a)=>{const n=[];function i(){t.readEntries(o=>Do(this,void 0,void 0,function*(){if(o.length){const c=Promise.all(o.map(iB));n.push(c),i()}else try{const c=yield Promise.all(n);s(c)}catch(c){a(c)}}),o=>{a(o)})}i()})}function oB(r){return Do(this,void 0,void 0,function*(){return new Promise((t,s)=>{r.file(a=>{const n=Ql(a,r.fullPath);t(n)},a=>{s(a)})})})}var Hp=function(r,t){if(r&&t){var s=Array.isArray(t)?t:t.split(",");if(s.length===0)return!0;var a=r.name||"",n=(r.type||"").toLowerCase(),i=n.replace(/\/.*$/,"");return s.some(function(o){var c=o.trim().toLowerCase();return c.charAt(0)==="."?a.toLowerCase().endsWith(c):c.endsWith("/*")?i===c.replace(/\/.*$/,""):n===c})}return!0};function lb(r){return dB(r)||cB(r)||H2(r)||lB()}function lB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cB(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function dB(r){if(Array.isArray(r))return gg(r)}function cb(r,t){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),s.push.apply(s,a)}return s}function db(r){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?cb(Object(s),!0).forEach(function(a){W2(r,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):cb(Object(s)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(s,a))})}return r}function W2(r,t,s){return t in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}function jd(r,t){return mB(r)||hB(r,t)||H2(r,t)||uB()}function uB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H2(r,t){if(r){if(typeof r=="string")return gg(r,t);var s=Object.prototype.toString.call(r).slice(8,-1);if(s==="Object"&&r.constructor&&(s=r.constructor.name),s==="Map"||s==="Set")return Array.from(r);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return gg(r,t)}}function gg(r,t){(t==null||t>r.length)&&(t=r.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=r[s];return a}function hB(r,t){var s=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(s!=null){var a=[],n=!0,i=!1,o,c;try{for(s=s.call(r);!(n=(o=s.next()).done)&&(a.push(o.value),!(t&&a.length===t));n=!0);}catch(d){i=!0,c=d}finally{try{!n&&s.return!=null&&s.return()}finally{if(i)throw c}}return a}}function mB(r){if(Array.isArray(r))return r}var fB=typeof Hp=="function"?Hp:Hp.default,pB="file-invalid-type",xB="file-too-large",gB="file-too-small",yB="too-many-files",vB=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=t.split(","),a=s.length>1?"one of ".concat(s.join(", ")):s[0];return{code:pB,message:"File type must be ".concat(a)}},ub=function(t){return{code:xB,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},hb=function(t){return{code:gB,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},wB={code:yB,message:"Too many files"};function G2(r,t){var s=r.type==="application/x-moz-file"||fB(r,t);return[s,s?null:vB(t)]}function K2(r,t,s){if(io(r.size))if(io(t)&&io(s)){if(r.size>s)return[!1,ub(s)];if(r.size<t)return[!1,hb(t)]}else{if(io(t)&&r.size<t)return[!1,hb(t)];if(io(s)&&r.size>s)return[!1,ub(s)]}return[!0,null]}function io(r){return r!=null}function jB(r){var t=r.files,s=r.accept,a=r.minSize,n=r.maxSize,i=r.multiple,o=r.maxFiles,c=r.validator;return!i&&t.length>1||i&&o>=1&&t.length>o?!1:t.every(function(d){var h=G2(d,s),m=jd(h,1),f=m[0],g=K2(d,a,n),y=jd(g,1),b=y[0],w=c?c(d):null;return f&&b&&!w})}function tm(r){return typeof r.isPropagationStopped=="function"?r.isPropagationStopped():typeof r.cancelBubble<"u"?r.cancelBubble:!1}function rh(r){return r.dataTransfer?Array.prototype.some.call(r.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!r.target&&!!r.target.files}function mb(r){r.preventDefault()}function bB(r){return r.indexOf("MSIE")!==-1||r.indexOf("Trident/")!==-1}function _B(r){return r.indexOf("Edge/")!==-1}function NB(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return bB(r)||_B(r)}function Qa(){for(var r=arguments.length,t=new Array(r),s=0;s<r;s++)t[s]=arguments[s];return function(a){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.some(function(c){return!tm(a)&&c&&c.apply(void 0,[a].concat(i)),tm(a)})}}function SB(){return"showOpenFilePicker"in window}function kB(r){if(io(r)){var t=Object.entries(r).filter(function(s){var a=jd(s,2),n=a[0],i=a[1],o=!0;return Q2(n)||(console.warn('Skipped "'.concat(n,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(i)||!i.every(Y2))&&(console.warn('Skipped "'.concat(n,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(s,a){var n=jd(a,2),i=n[0],o=n[1];return db(db({},s),{},W2({},i,o))},{});return[{description:"Files",accept:t}]}return r}function CB(r){if(io(r))return Object.entries(r).reduce(function(t,s){var a=jd(s,2),n=a[0],i=a[1];return[].concat(lb(t),[n],lb(i))},[]).filter(function(t){return Q2(t)||Y2(t)}).join(",")}function EB(r){return r instanceof DOMException&&(r.name==="AbortError"||r.code===r.ABORT_ERR)}function AB(r){return r instanceof DOMException&&(r.name==="SecurityError"||r.code===r.SECURITY_ERR)}function Q2(r){return r==="audio/*"||r==="video/*"||r==="image/*"||r==="text/*"||r==="application/*"||/\w+\/[-+.\w]+/g.test(r)}function Y2(r){return/^.*\.[\w]+$/.test(r)}var TB=["children"],RB=["open"],PB=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],IB=["refKey","onChange","onClick"];function DB(r){return MB(r)||OB(r)||J2(r)||FB()}function FB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OB(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function MB(r){if(Array.isArray(r))return yg(r)}function Gp(r,t){return $B(r)||UB(r,t)||J2(r,t)||LB()}function LB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J2(r,t){if(r){if(typeof r=="string")return yg(r,t);var s=Object.prototype.toString.call(r).slice(8,-1);if(s==="Object"&&r.constructor&&(s=r.constructor.name),s==="Map"||s==="Set")return Array.from(r);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return yg(r,t)}}function yg(r,t){(t==null||t>r.length)&&(t=r.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=r[s];return a}function UB(r,t){var s=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(s!=null){var a=[],n=!0,i=!1,o,c;try{for(s=s.call(r);!(n=(o=s.next()).done)&&(a.push(o.value),!(t&&a.length===t));n=!0);}catch(d){i=!0,c=d}finally{try{!n&&s.return!=null&&s.return()}finally{if(i)throw c}}return a}}function $B(r){if(Array.isArray(r))return r}function fb(r,t){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),s.push.apply(s,a)}return s}function js(r){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?fb(Object(s),!0).forEach(function(a){vg(r,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):fb(Object(s)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(s,a))})}return r}function vg(r,t,s){return t in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}function sm(r,t){if(r==null)return{};var s=zB(r,t),a,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)a=i[n],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(r,a)&&(s[a]=r[a])}return s}function zB(r,t){if(r==null)return{};var s={},a=Object.keys(r),n,i;for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&(s[n]=r[n]);return s}var Ty=p.forwardRef(function(r,t){var s=r.children,a=sm(r,TB),n=Qm(a),i=n.open,o=sm(n,RB);return p.useImperativeHandle(t,function(){return{open:i}},[i]),xe.createElement(p.Fragment,null,s(js(js({},o),{},{open:i})))});Ty.displayName="Dropzone";var Z2={disabled:!1,getFilesFromEvent:Xz,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Ty.defaultProps=Z2;Ty.propTypes={children:ns.func,accept:ns.objectOf(ns.arrayOf(ns.string)),multiple:ns.bool,preventDropOnDocument:ns.bool,noClick:ns.bool,noKeyboard:ns.bool,noDrag:ns.bool,noDragEventsBubbling:ns.bool,minSize:ns.number,maxSize:ns.number,maxFiles:ns.number,disabled:ns.bool,getFilesFromEvent:ns.func,onFileDialogCancel:ns.func,onFileDialogOpen:ns.func,useFsAccessApi:ns.bool,autoFocus:ns.bool,onDragEnter:ns.func,onDragLeave:ns.func,onDragOver:ns.func,onDrop:ns.func,onDropAccepted:ns.func,onDropRejected:ns.func,onError:ns.func,validator:ns.func};var wg={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Qm(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=js(js({},Z2),r),s=t.accept,a=t.disabled,n=t.getFilesFromEvent,i=t.maxSize,o=t.minSize,c=t.multiple,d=t.maxFiles,h=t.onDragEnter,m=t.onDragLeave,f=t.onDragOver,g=t.onDrop,y=t.onDropAccepted,b=t.onDropRejected,w=t.onFileDialogCancel,S=t.onFileDialogOpen,N=t.useFsAccessApi,v=t.autoFocus,j=t.preventDropOnDocument,C=t.noClick,k=t.noKeyboard,I=t.noDrag,T=t.noDragEventsBubbling,O=t.onError,U=t.validator,A=p.useMemo(function(){return CB(s)},[s]),L=p.useMemo(function(){return kB(s)},[s]),M=p.useMemo(function(){return typeof S=="function"?S:pb},[S]),se=p.useMemo(function(){return typeof w=="function"?w:pb},[w]),W=p.useRef(null),q=p.useRef(null),K=p.useReducer(BB,wg),Y=Gp(K,2),le=Y[0],Ne=Y[1],Ke=le.isFocused,ke=le.isFileDialogActive,$e=p.useRef(typeof window<"u"&&window.isSecureContext&&N&&SB()),ce=function(){!$e.current&&ke&&setTimeout(function(){if(q.current){var je=q.current.files;je.length||(Ne({type:"closeDialog"}),se())}},300)};p.useEffect(function(){return window.addEventListener("focus",ce,!1),function(){window.removeEventListener("focus",ce,!1)}},[q,ke,se,$e]);var Re=p.useRef([]),Qe=function(je){W.current&&W.current.contains(je.target)||(je.preventDefault(),Re.current=[])};p.useEffect(function(){return j&&(document.addEventListener("dragover",mb,!1),document.addEventListener("drop",Qe,!1)),function(){j&&(document.removeEventListener("dragover",mb),document.removeEventListener("drop",Qe))}},[W,j]),p.useEffect(function(){return!a&&v&&W.current&&W.current.focus(),function(){}},[W,v,a]);var nt=p.useCallback(function(de){O?O(de):console.error(de)},[O]),We=p.useCallback(function(de){de.preventDefault(),de.persist(),oe(de),Re.current=[].concat(DB(Re.current),[de.target]),rh(de)&&Promise.resolve(n(de)).then(function(je){if(!(tm(de)&&!T)){var mt=je.length,et=mt>0&&jB({files:je,accept:A,minSize:o,maxSize:i,multiple:c,maxFiles:d,validator:U}),Wt=mt>0&&!et;Ne({isDragAccept:et,isDragReject:Wt,isDragActive:!0,type:"setDraggedFiles"}),h&&h(de)}}).catch(function(je){return nt(je)})},[n,h,nt,T,A,o,i,c,d,U]),ct=p.useCallback(function(de){de.preventDefault(),de.persist(),oe(de);var je=rh(de);if(je&&de.dataTransfer)try{de.dataTransfer.dropEffect="copy"}catch{}return je&&f&&f(de),!1},[f,T]),he=p.useCallback(function(de){de.preventDefault(),de.persist(),oe(de);var je=Re.current.filter(function(et){return W.current&&W.current.contains(et)}),mt=je.indexOf(de.target);mt!==-1&&je.splice(mt,1),Re.current=je,!(je.length>0)&&(Ne({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),rh(de)&&m&&m(de))},[W,m,T]),fe=p.useCallback(function(de,je){var mt=[],et=[];de.forEach(function(Wt){var Ws=G2(Wt,A),Js=Gp(Ws,2),qr=Js[0],ma=Js[1],Vr=K2(Wt,o,i),fa=Gp(Vr,2),kr=fa[0],ir=fa[1],mn=U?U(Wt):null;if(qr&&kr&&!mn)mt.push(Wt);else{var dt=[ma,ir];mn&&(dt=dt.concat(mn)),et.push({file:Wt,errors:dt.filter(function(Zt){return Zt})})}}),(!c&&mt.length>1||c&&d>=1&&mt.length>d)&&(mt.forEach(function(Wt){et.push({file:Wt,errors:[wB]})}),mt.splice(0)),Ne({acceptedFiles:mt,fileRejections:et,isDragReject:et.length>0,type:"setFiles"}),g&&g(mt,et,je),et.length>0&&b&&b(et,je),mt.length>0&&y&&y(mt,je)},[Ne,c,A,o,i,d,g,y,b,U]),Me=p.useCallback(function(de){de.preventDefault(),de.persist(),oe(de),Re.current=[],rh(de)&&Promise.resolve(n(de)).then(function(je){tm(de)&&!T||fe(je,de)}).catch(function(je){return nt(je)}),Ne({type:"reset"})},[n,fe,nt,T]),ze=p.useCallback(function(){if($e.current){Ne({type:"openDialog"}),M();var de={multiple:c,types:L};window.showOpenFilePicker(de).then(function(je){return n(je)}).then(function(je){fe(je,null),Ne({type:"closeDialog"})}).catch(function(je){EB(je)?(se(je),Ne({type:"closeDialog"})):AB(je)?($e.current=!1,q.current?(q.current.value=null,q.current.click()):nt(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):nt(je)});return}q.current&&(Ne({type:"openDialog"}),M(),q.current.value=null,q.current.click())},[Ne,M,se,N,fe,nt,L,c]),ts=p.useCallback(function(de){!W.current||!W.current.isEqualNode(de.target)||(de.key===" "||de.key==="Enter"||de.keyCode===32||de.keyCode===13)&&(de.preventDefault(),ze())},[W,ze]),Tt=p.useCallback(function(){Ne({type:"focus"})},[]),Os=p.useCallback(function(){Ne({type:"blur"})},[]),Ms=p.useCallback(function(){C||(NB()?setTimeout(ze,0):ze())},[C,ze]),os=function(je){return a?null:je},V=function(je){return k?null:os(je)},ee=function(je){return I?null:os(je)},oe=function(je){T&&je.stopPropagation()},Se=p.useMemo(function(){return function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},je=de.refKey,mt=je===void 0?"ref":je,et=de.role,Wt=de.onKeyDown,Ws=de.onFocus,Js=de.onBlur,qr=de.onClick,ma=de.onDragEnter,Vr=de.onDragOver,fa=de.onDragLeave,kr=de.onDrop,ir=sm(de,PB);return js(js(vg({onKeyDown:V(Qa(Wt,ts)),onFocus:V(Qa(Ws,Tt)),onBlur:V(Qa(Js,Os)),onClick:os(Qa(qr,Ms)),onDragEnter:ee(Qa(ma,We)),onDragOver:ee(Qa(Vr,ct)),onDragLeave:ee(Qa(fa,he)),onDrop:ee(Qa(kr,Me)),role:typeof et=="string"&&et!==""?et:"presentation"},mt,W),!a&&!k?{tabIndex:0}:{}),ir)}},[W,ts,Tt,Os,Ms,We,ct,he,Me,k,I,a]),_e=p.useCallback(function(de){de.stopPropagation()},[]),we=p.useMemo(function(){return function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},je=de.refKey,mt=je===void 0?"ref":je,et=de.onChange,Wt=de.onClick,Ws=sm(de,IB),Js=vg({accept:A,multiple:c,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:os(Qa(et,Me)),onClick:os(Qa(Wt,_e)),tabIndex:-1},mt,q);return js(js({},Js),Ws)}},[q,s,c,Me,a]);return js(js({},le),{},{isFocused:Ke&&!a,getRootProps:Se,getInputProps:we,rootRef:W,inputRef:q,open:os(ze)})}function BB(r,t){switch(t.type){case"focus":return js(js({},r),{},{isFocused:!0});case"blur":return js(js({},r),{},{isFocused:!1});case"openDialog":return js(js({},wg),{},{isFileDialogActive:!0});case"closeDialog":return js(js({},r),{},{isFileDialogActive:!1});case"setDraggedFiles":return js(js({},r),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return js(js({},r),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return js({},wg);default:return r}}function pb(){}function qB(r,t=[]){let s=[];function a(i,o){const c=p.createContext(o),d=s.length;s=[...s,o];function h(f){const{scope:g,children:y,...b}=f,w=(g==null?void 0:g[r][d])||c,S=p.useMemo(()=>b,Object.values(b));return e.jsx(w.Provider,{value:S,children:y})}function m(f,g){const y=(g==null?void 0:g[r][d])||c,b=p.useContext(y);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return h.displayName=i+"Provider",[h,m]}const n=()=>{const i=s.map(o=>p.createContext(o));return function(c){const d=(c==null?void 0:c[r])||i;return p.useMemo(()=>({[`__scope${r}`]:{...c,[r]:d}}),[c,d])}};return n.scopeName=r,[a,VB(n,...t)]}function VB(...r){const t=r[0];if(r.length===1)return t;const s=()=>{const a=r.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const o=a.reduce((c,{useScope:d,scopeName:h})=>{const f=d(i)[`__scope${h}`];return{...c,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return s.scopeName=t.scopeName,s}var Ry="Progress",Py=100,[WB,zW]=qB(Ry),[HB,GB]=WB(Ry),X2=p.forwardRef((r,t)=>{const{__scopeProgress:s,value:a=null,max:n,getValueLabel:i=KB,...o}=r;(n||n===0)&&!xb(n)&&console.error(QB(`${n}`,"Progress"));const c=xb(n)?n:Py;a!==null&&!gb(a,c)&&console.error(YB(`${a}`,"Progress"));const d=gb(a,c)?a:null,h=rm(d)?i(d,c):void 0;return e.jsx(HB,{scope:s,value:d,max:c,children:e.jsx(zt.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":rm(d)?d:void 0,"aria-valuetext":h,role:"progressbar","data-state":sk(d,c),"data-value":d??void 0,"data-max":c,...o,ref:t})})});X2.displayName=Ry;var ek="ProgressIndicator",tk=p.forwardRef((r,t)=>{const{__scopeProgress:s,...a}=r,n=GB(ek,s);return e.jsx(zt.div,{"data-state":sk(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...a,ref:t})});tk.displayName=ek;function KB(r,t){return`${Math.round(r/t*100)}%`}function sk(r,t){return r==null?"indeterminate":r===t?"complete":"loading"}function rm(r){return typeof r=="number"}function xb(r){return rm(r)&&!isNaN(r)&&r>0}function gb(r,t){return rm(r)&&!isNaN(r)&&r<=t&&r>=0}function QB(r,t){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Py}\`.`}function YB(r,t){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Py} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var rk=X2,JB=tk;const na=p.forwardRef(({className:r,value:t,...s},a)=>e.jsx(rk,{ref:a,className:Ie("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...s,children:e.jsx(JB,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));na.displayName=rk.displayName;async function ZB(r,t){const s=Date.now();try{t==null||t({status:"initializing",progress:0,message:"Loading PDF..."});const{getPdfJs:a}=await Ns(async()=>{const{getPdfJs:f}=await import("./pdfWorker-U21o7yO1.js");return{getPdfJs:f}},__vite__mapDeps([0,1,2,3])),n=await a();if(!n)throw new Error("PDF.js failed to load");const i=await r.arrayBuffer(),o=await n.getDocument({data:i}).promise,c=o.numPages,d=[];let h="";for(let f=1;f<=c;f++){t==null||t({status:"processing",progress:(f-1)/c*100,currentPage:f,totalPages:c,message:`Processing page ${f} of ${c}...`});const b=(await(await o.getPage(f)).getTextContent()).items.map(w=>w.str).join(" ").trim();d.push({pageNumber:f,text:b,confidence:.95}),h+=b+`
`}const m=Date.now()-s;return t==null||t({status:"completed",progress:100,message:"PDF processing completed"}),{text:h.trim(),confidence:.95,pages:d,metadata:{processingTime:m,fileSize:r.size,pageCount:c}}}catch(a){throw console.error("Error extracting text from PDF:",a),t==null||t({status:"error",progress:0,message:"Failed to process PDF"}),new Error("Failed to extract text from PDF")}}async function XB(r,t){const s=Date.now();try{t==null||t({status:"initializing",progress:0,message:"Initializing OCR..."});const n=await(await Ns(()=>import("./ocr-worker-BKso6bwf.js").then(o=>o.i),[])).recognize(r,"eng",{logger:o=>{o.status==="recognizing text"&&(t==null||t({status:"processing",progress:o.progress*100,message:`OCR processing: ${Math.round(o.progress*100)}%`}))}}),i=Date.now()-s;return t==null||t({status:"completed",progress:100,message:"OCR processing completed"}),{text:n.data.text,confidence:n.data.confidence/100,pages:[{pageNumber:1,text:n.data.text,confidence:n.data.confidence/100}],metadata:{processingTime:i,fileSize:r.size,pageCount:1}}}catch(a){throw console.error("Error performing OCR:",a),t==null||t({status:"error",progress:0,message:"OCR processing failed"}),new Error("Failed to perform OCR on image")}}async function ak(r,t){const s=r.type.toLowerCase(),a=r.name.toLowerCase();if(s==="application/pdf"||a.endsWith(".pdf"))return ZB(r,t);if(s.startsWith("image/")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".png")||a.endsWith(".gif")||a.endsWith(".bmp")||a.endsWith(".tiff"))return XB(r,t);if(s==="text/plain"||a.endsWith(".txt")){const n=Date.now();t==null||t({status:"processing",progress:50,message:"Reading text file..."});const i=await r.text(),o=Date.now()-n;return t==null||t({status:"completed",progress:100,message:"Text file processed"}),{text:i,confidence:1,pages:[{pageNumber:1,text:i,confidence:1}],metadata:{processingTime:o,fileSize:r.size,pageCount:1}}}throw new Error(`Unsupported file type: ${s}`)}function nk(r){const{text:t,confidence:s}=r,a=[];s<.7&&a.push("Low confidence detected. Consider rescanning with higher resolution.");const i=[/[0O]{3,}/,/[1Il]{3,}/,/\s{5,}/,/[^\w\s.,;:!?()-]{3,}/].some(c=>c.test(t));i&&a.push("Potential OCR errors detected. Review the extracted text carefully."),t.length<50&&a.push("Very little text extracted. Ensure the document contains readable text.");let o=s;return i&&(o-=.2),t.length<50&&(o-=.3),o=Math.max(0,Math.min(1,o)),{isGoodQuality:o>=.7,suggestions:a,qualityScore:o}}function ik(r){return r.replace(/\s+/g," ").replace(/[^\w\s.,;:!?()"-]/g,"").replace(/0/g,"O").replace(/1/g,"I").replace(/\n+/g,`
`).trim()}function ut(r,t,s,a,n){if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(r,s),s}function re(r,t,s,a){if(s==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!a:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?a:s==="a"?a.call(r):a?a.value:t.get(r)}let ok=function(){const{crypto:r}=globalThis;if(r!=null&&r.randomUUID)return ok=r.randomUUID.bind(r),r.randomUUID();const t=new Uint8Array(1),s=r?()=>r.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(+a^s()&15>>+a/4).toString(16))};function jg(r){return typeof r=="object"&&r!==null&&("name"in r&&r.name==="AbortError"||"message"in r&&String(r.message).includes("FetchRequestCanceledException"))}const bg=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null){try{if(Object.prototype.toString.call(r)==="[object Error]"){const t=new Error(r.message,r.cause?{cause:r.cause}:{});return r.stack&&(t.stack=r.stack),r.cause&&!t.cause&&(t.cause=r.cause),r.name&&(t.name=r.name),t}}catch{}try{return new Error(JSON.stringify(r))}catch{}}return new Error(r)};class lt extends Error{}class ar extends lt{constructor(t,s,a,n){super(`${ar.makeMessage(t,s,a)}`),this.status=t,this.headers=n,this.requestID=n==null?void 0:n.get("x-request-id"),this.error=s;const i=s;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(t,s,a){const n=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):a;return t&&n?`${t} ${n}`:t?`${t} status code (no body)`:n||"(no status code or body)"}static generate(t,s,a,n){if(!t||!n)return new Ym({message:a,cause:bg(s)});const i=s==null?void 0:s.error;return t===400?new lk(t,i,a,n):t===401?new ck(t,i,a,n):t===403?new dk(t,i,a,n):t===404?new uk(t,i,a,n):t===409?new hk(t,i,a,n):t===422?new mk(t,i,a,n):t===429?new fk(t,i,a,n):t>=500?new pk(t,i,a,n):new ar(t,i,a,n)}}class ka extends ar{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Ym extends ar{constructor({message:t,cause:s}){super(void 0,void 0,t||"Connection error.",void 0),s&&(this.cause=s)}}class Iy extends Ym{constructor({message:t}={}){super({message:t??"Request timed out."})}}class lk extends ar{}class ck extends ar{}class dk extends ar{}class uk extends ar{}class hk extends ar{}class mk extends ar{}class fk extends ar{}class pk extends ar{}class xk extends lt{constructor(){super("Could not parse response content as the length limit was reached")}}class gk extends lt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}const eq=/^[a-z][a-z0-9+.-]*:/i,tq=r=>eq.test(r);let Mr=r=>(Mr=Array.isArray,Mr(r)),yb=Mr;function sq(r){return typeof r!="object"?{}:r??{}}function rq(r){if(!r)return!0;for(const t in r)return!1;return!0}function aq(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function Kp(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}const nq=(r,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new lt(`${r} must be an integer`);if(t<0)throw new lt(`${r} must be a positive integer`);return t},iq=r=>{try{return JSON.parse(r)}catch{return}},Wd=r=>new Promise(t=>setTimeout(t,r)),ml="5.5.1",oq=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function lq(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const cq=()=>{var s;const r=lq();if(r==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ml,"X-Stainless-OS":wb(Deno.build.os),"X-Stainless-Arch":vb(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((s=Deno.version)==null?void 0:s.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ml,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(r==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ml,"X-Stainless-OS":wb(globalThis.process.platform??"unknown"),"X-Stainless-Arch":vb(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=dq();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ml,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ml,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function dq(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:s}of r){const a=s.exec(navigator.userAgent);if(a){const n=a[1]||0,i=a[2]||0,o=a[3]||0;return{browser:t,version:`${n}.${i}.${o}`}}}return null}const vb=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",wb=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let jb;const uq=()=>jb??(jb=cq());function hq(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function yk(...r){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...r)}function vk(r){let t=Symbol.asyncIterator in r?r[Symbol.asyncIterator]():r[Symbol.iterator]();return yk({start(){},async pull(s){const{done:a,value:n}=await t.next();a?s.close():s.enqueue(n)},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}function wk(r){if(r[Symbol.asyncIterator])return r;const t=r.getReader();return{async next(){try{const s=await t.read();return s!=null&&s.done&&t.releaseLock(),s}catch(s){throw t.releaseLock(),s}},async return(){const s=t.cancel();return t.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function mq(r){var a,n;if(r===null||typeof r!="object")return;if(r[Symbol.asyncIterator]){await((n=(a=r[Symbol.asyncIterator]()).return)==null?void 0:n.call(a));return}const t=r.getReader(),s=t.cancel();t.releaseLock(),await s}const fq=({headers:r,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),jk="RFC3986",bk=r=>String(r),bb={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:bk},pq="RFC1738";let _g=(r,t)=>(_g=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),_g(r,t));const Ya=(()=>{const r=[];for(let t=0;t<256;++t)r.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return r})(),Qp=1024,xq=(r,t,s,a,n)=>{if(r.length===0)return r;let i=r;if(typeof r=="symbol"?i=Symbol.prototype.toString.call(r):typeof r!="string"&&(i=String(r)),s==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let o="";for(let c=0;c<i.length;c+=Qp){const d=i.length>=Qp?i.slice(c,c+Qp):i,h=[];for(let m=0;m<d.length;++m){let f=d.charCodeAt(m);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||n===pq&&(f===40||f===41)){h[h.length]=d.charAt(m);continue}if(f<128){h[h.length]=Ya[f];continue}if(f<2048){h[h.length]=Ya[192|f>>6]+Ya[128|f&63];continue}if(f<55296||f>=57344){h[h.length]=Ya[224|f>>12]+Ya[128|f>>6&63]+Ya[128|f&63];continue}m+=1,f=65536+((f&1023)<<10|d.charCodeAt(m)&1023),h[h.length]=Ya[240|f>>18]+Ya[128|f>>12&63]+Ya[128|f>>6&63]+Ya[128|f&63]}o+=h.join("")}return o};function gq(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function _b(r,t){if(Mr(r)){const s=[];for(let a=0;a<r.length;a+=1)s.push(t(r[a]));return s}return t(r)}const _k={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,t){return String(r)+"["+t+"]"},repeat(r){return String(r)}},Nk=function(r,t){Array.prototype.push.apply(r,Mr(t)?t:[t])};let Nb;const Bs={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:xq,encodeValuesOnly:!1,format:jk,formatter:bk,indices:!1,serializeDate(r){return(Nb??(Nb=Function.prototype.call.bind(Date.prototype.toISOString)))(r)},skipNulls:!1,strictNullHandling:!1};function yq(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}const Yp={};function Sk(r,t,s,a,n,i,o,c,d,h,m,f,g,y,b,w,S,N){let v=r,j=N,C=0,k=!1;for(;(j=j.get(Yp))!==void 0&&!k;){const A=j.get(r);if(C+=1,typeof A<"u"){if(A===C)throw new RangeError("Cyclic object value");k=!0}typeof j.get(Yp)>"u"&&(C=0)}if(typeof h=="function"?v=h(t,v):v instanceof Date?v=g==null?void 0:g(v):s==="comma"&&Mr(v)&&(v=_b(v,function(A){return A instanceof Date?g==null?void 0:g(A):A})),v===null){if(i)return d&&!w?d(t,Bs.encoder,S,"key",y):t;v=""}if(yq(v)||gq(v)){if(d){const A=w?t:d(t,Bs.encoder,S,"key",y);return[(b==null?void 0:b(A))+"="+(b==null?void 0:b(d(v,Bs.encoder,S,"value",y)))]}return[(b==null?void 0:b(t))+"="+(b==null?void 0:b(String(v)))]}const I=[];if(typeof v>"u")return I;let T;if(s==="comma"&&Mr(v))w&&d&&(v=_b(v,d)),T=[{value:v.length>0?v.join(",")||null:void 0}];else if(Mr(h))T=h;else{const A=Object.keys(v);T=m?A.sort(m):A}const O=c?String(t).replace(/\./g,"%2E"):String(t),U=a&&Mr(v)&&v.length===1?O+"[]":O;if(n&&Mr(v)&&v.length===0)return U+"[]";for(let A=0;A<T.length;++A){const L=T[A],M=typeof L=="object"&&typeof L.value<"u"?L.value:v[L];if(o&&M===null)continue;const se=f&&c?L.replace(/\./g,"%2E"):L,W=Mr(v)?typeof s=="function"?s(U,se):U:U+(f?"."+se:"["+se+"]");N.set(r,C);const q=new WeakMap;q.set(Yp,N),Nk(I,Sk(M,W,s,a,n,i,o,c,s==="comma"&&w&&Mr(v)?null:d,h,m,f,g,y,b,w,S,q))}return I}function vq(r=Bs){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=r.charset||Bs.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let s=jk;if(typeof r.format<"u"){if(!_g(bb,r.format))throw new TypeError("Unknown format option provided.");s=r.format}const a=bb[s];let n=Bs.filter;(typeof r.filter=="function"||Mr(r.filter))&&(n=r.filter);let i;if(r.arrayFormat&&r.arrayFormat in _k?i=r.arrayFormat:"indices"in r?i=r.indices?"indices":"repeat":i=Bs.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:Bs.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:Bs.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:Bs.allowEmptyArrays,arrayFormat:i,charset:t,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:Bs.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?Bs.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:Bs.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:Bs.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:Bs.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:Bs.encodeValuesOnly,filter:n,format:s,formatter:a,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:Bs.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:Bs.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:Bs.strictNullHandling}}function wq(r,t={}){let s=r;const a=vq(t);let n,i;typeof a.filter=="function"?(i=a.filter,s=i("",s)):Mr(a.filter)&&(i=a.filter,n=i);const o=[];if(typeof s!="object"||s===null)return"";const c=_k[a.arrayFormat],d=c==="comma"&&a.commaRoundTrip;n||(n=Object.keys(s)),a.sort&&n.sort(a.sort);const h=new WeakMap;for(let g=0;g<n.length;++g){const y=n[g];a.skipNulls&&s[y]===null||Nk(o,Sk(s[y],y,c,d,a.allowEmptyArrays,a.strictNullHandling,a.skipNulls,a.encodeDotInKeys,a.encode?a.encoder:null,a.filter,a.sort,a.allowDots,a.serializeDate,a.format,a.formatter,a.encodeValuesOnly,a.charset,h))}const m=o.join(a.delimiter);let f=a.addQueryPrefix===!0?"?":"";return a.charsetSentinel&&(a.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),m.length>0?f+m:""}function jq(r){let t=0;for(const n of r)t+=n.length;const s=new Uint8Array(t);let a=0;for(const n of r)s.set(n,a),a+=n.length;return s}let Sb;function Dy(r){let t;return(Sb??(t=new globalThis.TextEncoder,Sb=t.encode.bind(t)))(r)}let kb;function Cb(r){let t;return(kb??(t=new globalThis.TextDecoder,kb=t.decode.bind(t)))(r)}var Xr,ea;class Jm{constructor(){Xr.set(this,void 0),ea.set(this,void 0),ut(this,Xr,new Uint8Array),ut(this,ea,null)}decode(t){if(t==null)return[];const s=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?Dy(t):t;ut(this,Xr,jq([re(this,Xr,"f"),s]));const a=[];let n;for(;(n=bq(re(this,Xr,"f"),re(this,ea,"f")))!=null;){if(n.carriage&&re(this,ea,"f")==null){ut(this,ea,n.index);continue}if(re(this,ea,"f")!=null&&(n.index!==re(this,ea,"f")+1||n.carriage)){a.push(Cb(re(this,Xr,"f").subarray(0,re(this,ea,"f")-1))),ut(this,Xr,re(this,Xr,"f").subarray(re(this,ea,"f"))),ut(this,ea,null);continue}const i=re(this,ea,"f")!==null?n.preceding-1:n.preceding,o=Cb(re(this,Xr,"f").subarray(0,i));a.push(o),ut(this,Xr,re(this,Xr,"f").subarray(n.index)),ut(this,ea,null)}return a}flush(){return re(this,Xr,"f").length?this.decode(`
`):[]}}Xr=new WeakMap,ea=new WeakMap;Jm.NEWLINE_CHARS=new Set([`
`,"\r"]);Jm.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function bq(r,t){for(let n=t??0;n<r.length;n++){if(r[n]===10)return{preceding:n,index:n+1,carriage:!1};if(r[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function _q(r){for(let a=0;a<r.length-1;a++){if(r[a]===10&&r[a+1]===10||r[a]===13&&r[a+1]===13)return a+2;if(r[a]===13&&r[a+1]===10&&a+3<r.length&&r[a+2]===13&&r[a+3]===10)return a+4}return-1}class nn{constructor(t,s){this.iterator=t,this.controller=s}static fromSSEResponse(t,s){let a=!1;async function*n(){if(a)throw new lt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let i=!1;try{for await(const o of Nq(t,s))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let c;try{c=JSON.parse(o.data)}catch(d){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),d}if(c&&c.error)throw new ar(void 0,c.error,void 0,t.headers);yield c}else{let c;try{c=JSON.parse(o.data)}catch(d){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),d}if(o.event=="error")throw new ar(void 0,c.error,c.message,void 0);yield{event:o.event,data:c}}}i=!0}catch(o){if(jg(o))return;throw o}finally{i||s.abort()}}return new nn(n,s)}static fromReadableStream(t,s){let a=!1;async function*n(){const o=new Jm,c=wk(t);for await(const d of c)for(const h of o.decode(d))yield h;for(const d of o.flush())yield d}async function*i(){if(a)throw new lt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let o=!1;try{for await(const c of n())o||c&&(yield JSON.parse(c));o=!0}catch(c){if(jg(c))return;throw c}finally{o||s.abort()}}return new nn(i,s)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],s=[],a=this.iterator(),n=i=>({next:()=>{if(i.length===0){const o=a.next();t.push(o),s.push(o)}return i.shift()}});return[new nn(()=>n(t),this.controller),new nn(()=>n(s),this.controller)]}toReadableStream(){const t=this;let s;return yk({async start(){s=t[Symbol.asyncIterator]()},async pull(a){try{const{value:n,done:i}=await s.next();if(i)return a.close();const o=Dy(JSON.stringify(n)+`
`);a.enqueue(o)}catch(n){a.error(n)}},async cancel(){var a;await((a=s.return)==null?void 0:a.call(s))}})}}async function*Nq(r,t){if(!r.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new lt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new lt("Attempted to iterate over a response with no body");const s=new kq,a=new Jm,n=wk(r.body);for await(const i of Sq(n))for(const o of a.decode(i)){const c=s.decode(o);c&&(yield c)}for(const i of a.flush()){const o=s.decode(i);o&&(yield o)}}async function*Sq(r){let t=new Uint8Array;for await(const s of r){if(s==null)continue;const a=s instanceof ArrayBuffer?new Uint8Array(s):typeof s=="string"?Dy(s):s;let n=new Uint8Array(t.length+a.length);n.set(t),n.set(a,t.length),t=n;let i;for(;(i=_q(t))!==-1;)yield t.slice(0,i),t=t.slice(i)}t.length>0&&(yield t)}class kq{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(t),t.startsWith(":"))return null;let[s,a,n]=Cq(t,":");return n.startsWith(" ")&&(n=n.substring(1)),s==="event"?this.event=n:s==="data"&&this.data.push(n),null}}function Cq(r,t){const s=r.indexOf(t);return s!==-1?[r.substring(0,s),t,r.substring(s+t.length)]:[r,"",""]}const am={off:0,error:200,warn:300,info:400,debug:500},Eb=(r,t,s)=>{if(r){if(aq(am,r))return r;dr(s).warn(`${t} was set to ${JSON.stringify(r)}, expected one of ${JSON.stringify(Object.keys(am))}`)}};function Vc(){}function ah(r,t,s){return!t||am[r]>am[s]?Vc:t[r].bind(t)}const Eq={error:Vc,warn:Vc,info:Vc,debug:Vc};let Ab=new WeakMap;function dr(r){const t=r.logger,s=r.logLevel??"off";if(!t)return Eq;const a=Ab.get(t);if(a&&a[0]===s)return a[1];const n={error:ah("error",t,s),warn:ah("warn",t,s),info:ah("info",t,s),debug:ah("debug",t,s)};return Ab.set(t,[s,n]),n}const to=r=>(r.options&&(r.options={...r.options},delete r.options.headers),r.headers&&(r.headers=Object.fromEntries((r.headers instanceof Headers?[...r.headers]:Object.entries(r.headers)).map(([t,s])=>[t,t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in r&&(r.retryOfRequestLogID&&(r.retryOf=r.retryOfRequestLogID),delete r.retryOfRequestLogID),r);async function kk(r,t){const{response:s,requestLogID:a,retryOfRequestLogID:n,startTime:i}=t,o=await(async()=>{var f;if(t.options.stream)return dr(r).debug("response",s.status,s.url,s.headers,s.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(s,t.controller):nn.fromSSEResponse(s,t.controller);if(s.status===204)return null;if(t.options.__binaryResponse)return s;const c=s.headers.get("content-type"),d=(f=c==null?void 0:c.split(";")[0])==null?void 0:f.trim();if((d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))){const g=await s.json();return Ck(g,s)}return await s.text()})();return dr(r).debug(`[${a}] response parsed`,to({retryOfRequestLogID:n,url:s.url,status:s.status,body:o,durationMs:Date.now()-i})),o}function Ck(r,t){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}var Wc;class Zm extends Promise{constructor(t,s,a=kk){super(n=>{n(null)}),this.responsePromise=s,this.parseResponse=a,Wc.set(this,void 0),ut(this,Wc,t)}_thenUnwrap(t){return new Zm(re(this,Wc,"f"),this.responsePromise,async(s,a)=>Ck(t(await this.parseResponse(s,a),a),a.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:s,request_id:s.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(re(this,Wc,"f"),t))),this.parsedPromise}then(t,s){return this.parse().then(t,s)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}Wc=new WeakMap;var nh;class Ek{constructor(t,s,a,n){nh.set(this,void 0),ut(this,nh,t),this.options=n,this.response=s,this.body=a}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new lt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await re(this,nh,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(nh=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const s of t.getPaginatedItems())yield s}}class Aq extends Zm{constructor(t,s,a){super(t,s,async(n,i)=>new a(n,i.response,await kk(n,i),i.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const s of t)yield s}}class Xm extends Ek{constructor(t,s,a,n){super(t,s,a,n),this.data=a.data||[],this.object=a.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Fs extends Ek{constructor(t,s,a,n){super(t,s,a,n),this.data=a.data||[],this.has_more=a.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var a;const t=this.getPaginatedItems(),s=(a=t[t.length-1])==null?void 0:a.id;return s?{...this.options,query:{...sq(this.options.query),after:s}}:null}}const Ak=()=>{var r;if(typeof File>"u"){const{process:t}=globalThis,s=typeof((r=t==null?void 0:t.versions)==null?void 0:r.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ud(r,t,s){return Ak(),new File(r,t??"unknown_file",s)}function _h(r){return(typeof r=="object"&&r!==null&&("name"in r&&r.name&&String(r.name)||"url"in r&&r.url&&String(r.url)||"filename"in r&&r.filename&&String(r.filename)||"path"in r&&r.path&&String(r.path))||"").split(/[\\/]/).pop()||void 0}const Tk=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",To=async(r,t)=>({...r,body:await Rq(r.body,t)}),Tb=new WeakMap;function Tq(r){const t=typeof r=="function"?r:r.fetch,s=Tb.get(t);if(s)return s;const a=(async()=>{try{const n="Response"in t?t.Response:(await t("data:,")).constructor,i=new FormData;return i.toString()!==await new n(i).text()}catch{return!0}})();return Tb.set(t,a),a}const Rq=async(r,t)=>{if(!await Tq(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const s=new FormData;return await Promise.all(Object.entries(r||{}).map(([a,n])=>Ng(s,a,n))),s},Pq=r=>r instanceof Blob&&"name"in r,Ng=async(r,t,s)=>{if(s!==void 0){if(s==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")r.append(t,String(s));else if(s instanceof Response)r.append(t,ud([await s.blob()],_h(s)));else if(Tk(s))r.append(t,ud([await new Response(vk(s)).blob()],_h(s)));else if(Pq(s))r.append(t,s,_h(s));else if(Array.isArray(s))await Promise.all(s.map(a=>Ng(r,t+"[]",a)));else if(typeof s=="object")await Promise.all(Object.entries(s).map(([a,n])=>Ng(r,`${t}[${a}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}},Rk=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",Iq=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&Rk(r),Dq=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function";async function Fq(r,t,s){if(Ak(),r=await r,Iq(r))return r instanceof File?r:ud([await r.arrayBuffer()],r.name);if(Dq(r)){const n=await r.blob();return t||(t=new URL(r.url).pathname.split(/[\\/]/).pop()),ud(await Sg(n),t,s)}const a=await Sg(r);if(t||(t=_h(r)),!(s!=null&&s.type)){const n=a.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof n=="string"&&(s={...s,type:n})}return ud(a,t,s)}async function Sg(r){var s;let t=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)t.push(r);else if(Rk(r))t.push(r instanceof Blob?r:await r.arrayBuffer());else if(Tk(r))for await(const a of r)t.push(...await Sg(a));else{const a=(s=r==null?void 0:r.constructor)==null?void 0:s.name;throw new Error(`Unexpected data type: ${typeof r}${a?`; constructor: ${a}`:""}${Oq(r)}`)}return t}function Oq(r){return typeof r!="object"||r===null?"":`; props: [${Object.getOwnPropertyNames(r).map(s=>`"${s}"`).join(", ")}]`}class ht{constructor(t){this._client=t}}function Pk(r){return r.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Mq=(r=Pk)=>function(s,...a){if(s.length===1)return s[0];let n=!1;const i=s.reduce((m,f,g)=>(/[?#]/.test(f)&&(n=!0),m+f+(g===a.length?"":(n?encodeURIComponent:r)(String(a[g])))),""),o=i.split(/[?#]/,1)[0],c=[],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=d.exec(o))!==null;)c.push({start:h.index,length:h[0].length});if(c.length>0){let m=0;const f=c.reduce((g,y)=>{const b=" ".repeat(y.start-m),w="^".repeat(y.length);return m=y.start+y.length,g+b+w},"");throw new lt(`Path parameters result in path with invalid segments:
${i}
${f}`)}return i},Ee=Mq(Pk);let Ik=class extends ht{list(t,s={},a){return this._client.getAPIList(Ee`/chat/completions/${t}/messages`,Fs,{query:s,...a})}};function Lq(r){return typeof r.parse=="function"}const nm=r=>(r==null?void 0:r.role)==="assistant",Dk=r=>(r==null?void 0:r.role)==="tool";var kg,Nh,Sh,Hc,Gc,kh,Kc,An,Qc,im,om,fl,Fk;class Fy{constructor(){kg.add(this),this.controller=new AbortController,Nh.set(this,void 0),Sh.set(this,()=>{}),Hc.set(this,()=>{}),Gc.set(this,void 0),kh.set(this,()=>{}),Kc.set(this,()=>{}),An.set(this,{}),Qc.set(this,!1),im.set(this,!1),om.set(this,!1),fl.set(this,!1),ut(this,Nh,new Promise((t,s)=>{ut(this,Sh,t,"f"),ut(this,Hc,s,"f")})),ut(this,Gc,new Promise((t,s)=>{ut(this,kh,t,"f"),ut(this,Kc,s,"f")})),re(this,Nh,"f").catch(()=>{}),re(this,Gc,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},re(this,kg,"m",Fk).bind(this))},0)}_connected(){this.ended||(re(this,Sh,"f").call(this),this._emit("connect"))}get ended(){return re(this,Qc,"f")}get errored(){return re(this,im,"f")}get aborted(){return re(this,om,"f")}abort(){this.controller.abort()}on(t,s){return(re(this,An,"f")[t]||(re(this,An,"f")[t]=[])).push({listener:s}),this}off(t,s){const a=re(this,An,"f")[t];if(!a)return this;const n=a.findIndex(i=>i.listener===s);return n>=0&&a.splice(n,1),this}once(t,s){return(re(this,An,"f")[t]||(re(this,An,"f")[t]=[])).push({listener:s,once:!0}),this}emitted(t){return new Promise((s,a)=>{ut(this,fl,!0),t!=="error"&&this.once("error",a),this.once(t,s)})}async done(){ut(this,fl,!0),await re(this,Gc,"f")}_emit(t,...s){if(re(this,Qc,"f"))return;t==="end"&&(ut(this,Qc,!0),re(this,kh,"f").call(this));const a=re(this,An,"f")[t];if(a&&(re(this,An,"f")[t]=a.filter(n=>!n.once),a.forEach(({listener:n})=>n(...s))),t==="abort"){const n=s[0];!re(this,fl,"f")&&!(a!=null&&a.length)&&Promise.reject(n),re(this,Hc,"f").call(this,n),re(this,Kc,"f").call(this,n),this._emit("end");return}if(t==="error"){const n=s[0];!re(this,fl,"f")&&!(a!=null&&a.length)&&Promise.reject(n),re(this,Hc,"f").call(this,n),re(this,Kc,"f").call(this,n),this._emit("end")}}_emitFinal(){}}Nh=new WeakMap,Sh=new WeakMap,Hc=new WeakMap,Gc=new WeakMap,kh=new WeakMap,Kc=new WeakMap,An=new WeakMap,Qc=new WeakMap,im=new WeakMap,om=new WeakMap,fl=new WeakMap,kg=new WeakSet,Fk=function(t){if(ut(this,im,!0),t instanceof Error&&t.name==="AbortError"&&(t=new ka),t instanceof ka)return ut(this,om,!0),this._emit("abort",t);if(t instanceof lt)return this._emit("error",t);if(t instanceof Error){const s=new lt(t.message);return s.cause=t,this._emit("error",s)}return this._emit("error",new lt(String(t)))};function Oy(r){return(r==null?void 0:r.$brand)==="auto-parseable-response-format"}function Hd(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function Uq(r,t){return!t||!Ok(t)?{...r,choices:r.choices.map(s=>({...s,message:{...s.message,parsed:null,...s.message.tool_calls?{tool_calls:s.message.tool_calls}:void 0}}))}:My(r,t)}function My(r,t){const s=r.choices.map(a=>{var n;if(a.finish_reason==="length")throw new xk;if(a.finish_reason==="content_filter")throw new gk;return{...a,message:{...a.message,...a.message.tool_calls?{tool_calls:((n=a.message.tool_calls)==null?void 0:n.map(i=>zq(t,i)))??void 0}:void 0,parsed:a.message.content&&!a.message.refusal?$q(t,a.message.content):null}}});return{...r,choices:s}}function $q(r,t){var s,a;return((s=r.response_format)==null?void 0:s.type)!=="json_schema"?null:((a=r.response_format)==null?void 0:a.type)==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(t):JSON.parse(t):null}function zq(r,t){var a;const s=(a=r.tools)==null?void 0:a.find(n=>{var i;return((i=n.function)==null?void 0:i.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:Hd(s)?s.$parseRaw(t.function.arguments):s!=null&&s.function.strict?JSON.parse(t.function.arguments):null}}}function Bq(r,t){var a;if(!r)return!1;const s=(a=r.tools)==null?void 0:a.find(n=>{var i;return((i=n.function)==null?void 0:i.name)===t.function.name});return Hd(s)||(s==null?void 0:s.function.strict)||!1}function Ok(r){var t;return Oy(r.response_format)?!0:((t=r.tools)==null?void 0:t.some(s=>Hd(s)||s.type==="function"&&s.function.strict===!0))??!1}function qq(r){for(const t of r??[]){if(t.type!=="function")throw new lt(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new lt(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var vr,Cg,lm,Eg,Ag,Tg,Mk,Lk;const Vq=10;class Uk extends Fy{constructor(){super(...arguments),vr.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var a;this._chatCompletions.push(t),this._emit("chatCompletion",t);const s=(a=t.choices[0])==null?void 0:a.message;return s&&this._addMessage(s),t}_addMessage(t,s=!0){if("content"in t||(t.content=null),this.messages.push(t),s){if(this._emit("message",t),Dk(t)&&t.content)this._emit("functionToolCallResult",t.content);else if(nm(t)&&t.tool_calls)for(const a of t.tool_calls)a.type==="function"&&this._emit("functionToolCall",a.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new lt("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),re(this,vr,"m",Cg).call(this)}async finalMessage(){return await this.done(),re(this,vr,"m",lm).call(this)}async finalFunctionToolCall(){return await this.done(),re(this,vr,"m",Eg).call(this)}async finalFunctionToolCallResult(){return await this.done(),re(this,vr,"m",Ag).call(this)}async totalUsage(){return await this.done(),re(this,vr,"m",Tg).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const s=re(this,vr,"m",lm).call(this);s&&this._emit("finalMessage",s);const a=re(this,vr,"m",Cg).call(this);a&&this._emit("finalContent",a);const n=re(this,vr,"m",Eg).call(this);n&&this._emit("finalFunctionToolCall",n);const i=re(this,vr,"m",Ag).call(this);i!=null&&this._emit("finalFunctionToolCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",re(this,vr,"m",Tg).call(this))}async _createChatCompletion(t,s,a){const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),re(this,vr,"m",Mk).call(this,s);const i=await t.chat.completions.create({...s,stream:!1},{...a,signal:this.controller.signal});return this._connected(),this._addChatCompletion(My(i,s))}async _runChatCompletion(t,s,a){for(const n of s.messages)this._addMessage(n,!1);return await this._createChatCompletion(t,s,a)}async _runTools(t,s,a){var y,b,w;const n="tool",{tool_choice:i="auto",stream:o,...c}=s,d=typeof i!="string"&&((y=i==null?void 0:i.function)==null?void 0:y.name),{maxChatCompletions:h=Vq}=a||{},m=s.tools.map(S=>{if(Hd(S)){if(!S.$callback)throw new lt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:S.$callback,name:S.function.name,description:S.function.description||"",parameters:S.function.parameters,parse:S.$parseRaw,strict:!0}}}return S}),f={};for(const S of m)S.type==="function"&&(f[S.function.name||S.function.function.name]=S.function);const g="tools"in s?m.map(S=>S.type==="function"?{type:"function",function:{name:S.function.name||S.function.function.name,parameters:S.function.parameters,description:S.function.description,strict:S.function.strict}}:S):void 0;for(const S of s.messages)this._addMessage(S,!1);for(let S=0;S<h;++S){const v=(b=(await this._createChatCompletion(t,{...c,tool_choice:i,tools:g,messages:[...this.messages]},a)).choices[0])==null?void 0:b.message;if(!v)throw new lt("missing message in ChatCompletion response");if(!((w=v.tool_calls)!=null&&w.length))return;for(const j of v.tool_calls){if(j.type!=="function")continue;const C=j.id,{name:k,arguments:I}=j.function,T=f[k];if(T){if(d&&d!==k){const L=`Invalid tool_call: ${JSON.stringify(k)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:n,tool_call_id:C,content:L});continue}}else{const L=`Invalid tool_call: ${JSON.stringify(k)}. Available options are: ${Object.keys(f).map(M=>JSON.stringify(M)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:C,content:L});continue}let O;try{O=Lq(T)?await T.parse(I):I}catch(L){const M=L instanceof Error?L.message:String(L);this._addMessage({role:n,tool_call_id:C,content:M});continue}const U=await T.function(O,this),A=re(this,vr,"m",Lk).call(this,U);if(this._addMessage({role:n,tool_call_id:C,content:A}),d)return}}}}vr=new WeakSet,Cg=function(){return re(this,vr,"m",lm).call(this).content??null},lm=function(){let t=this.messages.length;for(;t-- >0;){const s=this.messages[t];if(nm(s))return{...s,content:s.content??null,refusal:s.refusal??null}}throw new lt("stream ended without producing a ChatCompletionMessage with role=assistant")},Eg=function(){var t,s;for(let a=this.messages.length-1;a>=0;a--){const n=this.messages[a];if(nm(n)&&((t=n==null?void 0:n.tool_calls)!=null&&t.length))return(s=n.tool_calls.at(-1))==null?void 0:s.function}},Ag=function(){for(let t=this.messages.length-1;t>=0;t--){const s=this.messages[t];if(Dk(s)&&s.content!=null&&typeof s.content=="string"&&this.messages.some(a=>{var n;return a.role==="assistant"&&((n=a.tool_calls)==null?void 0:n.some(i=>i.type==="function"&&i.id===s.tool_call_id))}))return s.content}},Tg=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:s}of this._chatCompletions)s&&(t.completion_tokens+=s.completion_tokens,t.prompt_tokens+=s.prompt_tokens,t.total_tokens+=s.total_tokens);return t},Mk=function(t){if(t.n!=null&&t.n>1)throw new lt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Lk=function(t){return typeof t=="string"?t:t===void 0?"undefined":JSON.stringify(t)};class Ly extends Uk{static runTools(t,s,a){const n=new Ly,i={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(t,s,i)),n}_addMessage(t,s=!0){super._addMessage(t,s),nm(t)&&t.content&&this._emit("content",t.content)}}const $k=1,zk=2,Bk=4,qk=8,Vk=16,Wk=32,Hk=64,Gk=128,Kk=256,Qk=Gk|Kk,Yk=Vk|Wk|Qk|Hk,Jk=$k|zk|Yk,Zk=Bk|qk,Wq=Jk|Zk,Gs={STR:$k,NUM:zk,ARR:Bk,OBJ:qk,NULL:Vk,BOOL:Wk,NAN:Hk,INFINITY:Gk,MINUS_INFINITY:Kk,INF:Qk,SPECIAL:Yk,ATOM:Jk,COLLECTION:Zk,ALL:Wq};class Hq extends Error{}class Gq extends Error{}function Kq(r,t=Gs.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return Qq(r.trim(),t)}const Qq=(r,t)=>{const s=r.length;let a=0;const n=g=>{throw new Hq(`${g} at position ${a}`)},i=g=>{throw new Gq(`${g} at position ${a}`)},o=()=>(f(),a>=s&&n("Unexpected end of input"),r[a]==='"'?c():r[a]==="{"?d():r[a]==="["?h():r.substring(a,a+4)==="null"||Gs.NULL&t&&s-a<4&&"null".startsWith(r.substring(a))?(a+=4,null):r.substring(a,a+4)==="true"||Gs.BOOL&t&&s-a<4&&"true".startsWith(r.substring(a))?(a+=4,!0):r.substring(a,a+5)==="false"||Gs.BOOL&t&&s-a<5&&"false".startsWith(r.substring(a))?(a+=5,!1):r.substring(a,a+8)==="Infinity"||Gs.INFINITY&t&&s-a<8&&"Infinity".startsWith(r.substring(a))?(a+=8,1/0):r.substring(a,a+9)==="-Infinity"||Gs.MINUS_INFINITY&t&&1<s-a&&s-a<9&&"-Infinity".startsWith(r.substring(a))?(a+=9,-1/0):r.substring(a,a+3)==="NaN"||Gs.NAN&t&&s-a<3&&"NaN".startsWith(r.substring(a))?(a+=3,NaN):m()),c=()=>{const g=a;let y=!1;for(a++;a<s&&(r[a]!=='"'||y&&r[a-1]==="\\");)y=r[a]==="\\"?!y:!1,a++;if(r.charAt(a)=='"')try{return JSON.parse(r.substring(g,++a-Number(y)))}catch(b){i(String(b))}else if(Gs.STR&t)try{return JSON.parse(r.substring(g,a-Number(y))+'"')}catch{return JSON.parse(r.substring(g,r.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},d=()=>{a++,f();const g={};try{for(;r[a]!=="}";){if(f(),a>=s&&Gs.OBJ&t)return g;const y=c();f(),a++;try{const b=o();Object.defineProperty(g,y,{value:b,writable:!0,enumerable:!0,configurable:!0})}catch(b){if(Gs.OBJ&t)return g;throw b}f(),r[a]===","&&a++}}catch{if(Gs.OBJ&t)return g;n("Expected '}' at end of object")}return a++,g},h=()=>{a++;const g=[];try{for(;r[a]!=="]";)g.push(o()),f(),r[a]===","&&a++}catch{if(Gs.ARR&t)return g;n("Expected ']' at end of array")}return a++,g},m=()=>{if(a===0){r==="-"&&Gs.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(r)}catch(y){if(Gs.NUM&t)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}i(String(y))}}const g=a;for(r[a]==="-"&&a++;r[a]&&!",]}".includes(r[a]);)a++;a==s&&!(Gs.NUM&t)&&n("Unterminated number literal");try{return JSON.parse(r.substring(g,a))}catch{r.substring(g,a)==="-"&&Gs.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(r.substring(g,r.lastIndexOf("e")))}catch(b){i(String(b))}}},f=()=>{for(;a<s&&` 
\r	`.includes(r[a]);)a++};return o()},Rb=r=>Kq(r,Gs.ALL^Gs.NUM);var $s,kn,cl,ti,Jp,ih,Zp,Xp,ex,oh,tx,Pb;class bd extends Uk{constructor(t){super(),$s.add(this),kn.set(this,void 0),cl.set(this,void 0),ti.set(this,void 0),ut(this,kn,t),ut(this,cl,[])}get currentChatCompletionSnapshot(){return re(this,ti,"f")}static fromReadableStream(t){const s=new bd(null);return s._run(()=>s._fromReadableStream(t)),s}static createChatCompletion(t,s,a){const n=new bd(s);return n._run(()=>n._runChatCompletion(t,{...s,stream:!0},{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(t,s,a){var o;super._createChatCompletion;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),re(this,$s,"m",Jp).call(this);const i=await t.chat.completions.create({...s,stream:!0},{...a,signal:this.controller.signal});this._connected();for await(const c of i)re(this,$s,"m",Zp).call(this,c);if((o=i.controller.signal)!=null&&o.aborted)throw new ka;return this._addChatCompletion(re(this,$s,"m",oh).call(this))}async _fromReadableStream(t,s){var o;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),re(this,$s,"m",Jp).call(this),this._connected();const n=nn.fromReadableStream(t,this.controller);let i;for await(const c of n)i&&i!==c.id&&this._addChatCompletion(re(this,$s,"m",oh).call(this)),re(this,$s,"m",Zp).call(this,c),i=c.id;if((o=n.controller.signal)!=null&&o.aborted)throw new ka;return this._addChatCompletion(re(this,$s,"m",oh).call(this))}[(kn=new WeakMap,cl=new WeakMap,ti=new WeakMap,$s=new WeakSet,Jp=function(){this.ended||ut(this,ti,void 0)},ih=function(s){let a=re(this,cl,"f")[s.index];return a||(a={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},re(this,cl,"f")[s.index]=a,a)},Zp=function(s){var n,i,o,c,d,h,m,f,g,y,b,w,S,N,v;if(this.ended)return;const a=re(this,$s,"m",Pb).call(this,s);this._emit("chunk",s,a);for(const j of s.choices){const C=a.choices[j.index];j.delta.content!=null&&((n=C.message)==null?void 0:n.role)==="assistant"&&((i=C.message)!=null&&i.content)&&(this._emit("content",j.delta.content,C.message.content),this._emit("content.delta",{delta:j.delta.content,snapshot:C.message.content,parsed:C.message.parsed})),j.delta.refusal!=null&&((o=C.message)==null?void 0:o.role)==="assistant"&&((c=C.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:j.delta.refusal,snapshot:C.message.refusal}),((d=j.logprobs)==null?void 0:d.content)!=null&&((h=C.message)==null?void 0:h.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(m=j.logprobs)==null?void 0:m.content,snapshot:((f=C.logprobs)==null?void 0:f.content)??[]}),((g=j.logprobs)==null?void 0:g.refusal)!=null&&((y=C.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(b=j.logprobs)==null?void 0:b.refusal,snapshot:((w=C.logprobs)==null?void 0:w.refusal)??[]});const k=re(this,$s,"m",ih).call(this,C);C.finish_reason&&(re(this,$s,"m",ex).call(this,C),k.current_tool_call_index!=null&&re(this,$s,"m",Xp).call(this,C,k.current_tool_call_index));for(const I of j.delta.tool_calls??[])k.current_tool_call_index!==I.index&&(re(this,$s,"m",ex).call(this,C),k.current_tool_call_index!=null&&re(this,$s,"m",Xp).call(this,C,k.current_tool_call_index)),k.current_tool_call_index=I.index;for(const I of j.delta.tool_calls??[]){const T=(S=C.message.tool_calls)==null?void 0:S[I.index];T!=null&&T.type&&((T==null?void 0:T.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(N=T.function)==null?void 0:N.name,index:I.index,arguments:T.function.arguments,parsed_arguments:T.function.parsed_arguments,arguments_delta:((v=I.function)==null?void 0:v.arguments)??""}):(T==null||T.type,void 0))}}},Xp=function(s,a){var o,c,d;if(re(this,$s,"m",ih).call(this,s).done_tool_calls.has(a))return;const i=(o=s.message.tool_calls)==null?void 0:o[a];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const h=(d=(c=re(this,kn,"f"))==null?void 0:c.tools)==null?void 0:d.find(m=>m.type==="function"&&m.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:a,arguments:i.function.arguments,parsed_arguments:Hd(h)?h.$parseRaw(i.function.arguments):h!=null&&h.function.strict?JSON.parse(i.function.arguments):null})}else i.type},ex=function(s){var n,i;const a=re(this,$s,"m",ih).call(this,s);if(s.message.content&&!a.content_done){a.content_done=!0;const o=re(this,$s,"m",tx).call(this);this._emit("content.done",{content:s.message.content,parsed:o?o.$parseRaw(s.message.content):null})}s.message.refusal&&!a.refusal_done&&(a.refusal_done=!0,this._emit("refusal.done",{refusal:s.message.refusal})),(n=s.logprobs)!=null&&n.content&&!a.logprobs_content_done&&(a.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:s.logprobs.content})),(i=s.logprobs)!=null&&i.refusal&&!a.logprobs_refusal_done&&(a.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:s.logprobs.refusal}))},oh=function(){if(this.ended)throw new lt("stream has ended, this shouldn't happen");const s=re(this,ti,"f");if(!s)throw new lt("request ended without sending any chunks");return ut(this,ti,void 0),ut(this,cl,[]),Yq(s,re(this,kn,"f"))},tx=function(){var a;const s=(a=re(this,kn,"f"))==null?void 0:a.response_format;return Oy(s)?s:null},Pb=function(s){var a,n,i,o;let c=re(this,ti,"f");const{choices:d,...h}=s;c?Object.assign(c,h):c=ut(this,ti,{...h,choices:[]});for(const{delta:m,finish_reason:f,index:g,logprobs:y=null,...b}of s.choices){let w=c.choices[g];if(w||(w=c.choices[g]={finish_reason:f,index:g,message:{},logprobs:y,...b}),y)if(!w.logprobs)w.logprobs=Object.assign({},y);else{const{content:I,refusal:T,...O}=y;Object.assign(w.logprobs,O),I&&((a=w.logprobs).content??(a.content=[]),w.logprobs.content.push(...I)),T&&((n=w.logprobs).refusal??(n.refusal=[]),w.logprobs.refusal.push(...T))}if(f&&(w.finish_reason=f,re(this,kn,"f")&&Ok(re(this,kn,"f")))){if(f==="length")throw new xk;if(f==="content_filter")throw new gk}if(Object.assign(w,b),!m)continue;const{content:S,refusal:N,function_call:v,role:j,tool_calls:C,...k}=m;if(Object.assign(w.message,k),N&&(w.message.refusal=(w.message.refusal||"")+N),j&&(w.message.role=j),v&&(w.message.function_call?(v.name&&(w.message.function_call.name=v.name),v.arguments&&((i=w.message.function_call).arguments??(i.arguments=""),w.message.function_call.arguments+=v.arguments)):w.message.function_call=v),S&&(w.message.content=(w.message.content||"")+S,!w.message.refusal&&re(this,$s,"m",tx).call(this)&&(w.message.parsed=Rb(w.message.content))),C){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:I,id:T,type:O,function:U,...A}of C){const L=(o=w.message.tool_calls)[I]??(o[I]={});Object.assign(L,A),T&&(L.id=T),O&&(L.type=O),U&&(L.function??(L.function={name:U.name??"",arguments:""})),U!=null&&U.name&&(L.function.name=U.name),U!=null&&U.arguments&&(L.function.arguments+=U.arguments,Bq(re(this,kn,"f"),L)&&(L.function.parsed_arguments=Rb(L.function.arguments)))}}}return c},Symbol.asyncIterator)](){const t=[],s=[];let a=!1;return this.on("chunk",n=>{const i=s.shift();i?i.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of s)n.resolve(void 0);s.length=0}),this.on("abort",n=>{a=!0;for(const i of s)i.reject(n);s.length=0}),this.on("error",n=>{a=!0;for(const i of s)i.reject(n);s.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((i,o)=>s.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new nn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Yq(r,t){const{id:s,choices:a,created:n,model:i,system_fingerprint:o,...c}=r,d={...c,id:s,choices:a.map(({message:h,finish_reason:m,index:f,logprobs:g,...y})=>{if(!m)throw new lt(`missing finish_reason for choice ${f}`);const{content:b=null,function_call:w,tool_calls:S,...N}=h,v=h.role;if(!v)throw new lt(`missing role for choice ${f}`);if(w){const{arguments:j,name:C}=w;if(j==null)throw new lt(`missing function_call.arguments for choice ${f}`);if(!C)throw new lt(`missing function_call.name for choice ${f}`);return{...y,message:{content:b,function_call:{arguments:j,name:C},role:v,refusal:h.refusal??null},finish_reason:m,index:f,logprobs:g}}return S?{...y,index:f,finish_reason:m,logprobs:g,message:{...N,role:v,content:b,refusal:h.refusal??null,tool_calls:S.map((j,C)=>{const{function:k,type:I,id:T,...O}=j,{arguments:U,name:A,...L}=k||{};if(T==null)throw new lt(`missing choices[${f}].tool_calls[${C}].id
${lh(r)}`);if(I==null)throw new lt(`missing choices[${f}].tool_calls[${C}].type
${lh(r)}`);if(A==null)throw new lt(`missing choices[${f}].tool_calls[${C}].function.name
${lh(r)}`);if(U==null)throw new lt(`missing choices[${f}].tool_calls[${C}].function.arguments
${lh(r)}`);return{...O,id:T,type:I,function:{...L,name:A,arguments:U}}})}}:{...y,message:{...N,content:b,role:v,refusal:h.refusal??null},finish_reason:m,index:f,logprobs:g}}),created:n,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return Uq(d,t)}function lh(r){return JSON.stringify(r)}class cm extends bd{static fromReadableStream(t){const s=new cm(null);return s._run(()=>s._fromReadableStream(t)),s}static runTools(t,s,a){const n=new cm(s),i={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(t,s,i)),n}}let Uy=class extends ht{constructor(){super(...arguments),this.messages=new Ik(this._client)}create(t,s){return this._client.post("/chat/completions",{body:t,...s,stream:t.stream??!1})}retrieve(t,s){return this._client.get(Ee`/chat/completions/${t}`,s)}update(t,s,a){return this._client.post(Ee`/chat/completions/${t}`,{body:s,...a})}list(t={},s){return this._client.getAPIList("/chat/completions",Fs,{query:t,...s})}delete(t,s){return this._client.delete(Ee`/chat/completions/${t}`,s)}parse(t,s){return qq(t.tools),this._client.chat.completions.create(t,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(a=>My(a,t))}runTools(t,s){return t.stream?cm.runTools(this._client,t,s):Ly.runTools(this._client,t,s)}stream(t,s){return bd.createChatCompletion(this._client,t,s)}};Uy.Messages=Ik;class $y extends ht{constructor(){super(...arguments),this.completions=new Uy(this._client)}}$y.Completions=Uy;const Xk=Symbol("brand.privateNullableHeaders");function*Jq(r){if(!r)return;if(Xk in r){const{values:a,nulls:n}=r;yield*a.entries();for(const i of n)yield[i,null];return}let t=!1,s;r instanceof Headers?s=r.entries():yb(r)?s=r:(t=!0,s=Object.entries(r??{}));for(let a of s){const n=a[0];if(typeof n!="string")throw new TypeError("expected header name to be a string");const i=yb(a[1])?a[1]:[a[1]];let o=!1;for(const c of i)c!==void 0&&(t&&!o&&(o=!0,yield[n,null]),yield[n,c])}}const Je=r=>{const t=new Headers,s=new Set;for(const a of r){const n=new Set;for(const[i,o]of Jq(a)){const c=i.toLowerCase();n.has(c)||(t.delete(i),n.add(c)),o===null?(t.delete(i),s.add(c)):(t.append(i,o),s.delete(c))}}return{[Xk]:!0,values:t,nulls:s}};class eC extends ht{create(t,s){return this._client.post("/audio/speech",{body:t,...s,headers:Je([{Accept:"application/octet-stream"},s==null?void 0:s.headers]),__binaryResponse:!0})}}class tC extends ht{create(t,s){return this._client.post("/audio/transcriptions",To({body:t,...s,stream:t.stream??!1,__metadata:{model:t.model}},this._client))}}class sC extends ht{create(t,s){return this._client.post("/audio/translations",To({body:t,...s,__metadata:{model:t.model}},this._client))}}class Gd extends ht{constructor(){super(...arguments),this.transcriptions=new tC(this._client),this.translations=new sC(this._client),this.speech=new eC(this._client)}}Gd.Transcriptions=tC;Gd.Translations=sC;Gd.Speech=eC;class rC extends ht{create(t,s){return this._client.post("/batches",{body:t,...s})}retrieve(t,s){return this._client.get(Ee`/batches/${t}`,s)}list(t={},s){return this._client.getAPIList("/batches",Fs,{query:t,...s})}cancel(t,s){return this._client.post(Ee`/batches/${t}/cancel`,s)}}class aC extends ht{create(t,s){return this._client.post("/assistants",{body:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,s){return this._client.get(Ee`/assistants/${t}`,{...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(t,s,a){return this._client.post(Ee`/assistants/${t}`,{body:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}list(t={},s){return this._client.getAPIList("/assistants",Fs,{query:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,s){return this._client.delete(Ee`/assistants/${t}`,{...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class nC extends ht{create(t,s){return this._client.post("/realtime/sessions",{body:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class iC extends ht{create(t,s){return this._client.post("/realtime/transcription_sessions",{body:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class ef extends ht{constructor(){super(...arguments),this.sessions=new nC(this._client),this.transcriptionSessions=new iC(this._client)}}ef.Sessions=nC;ef.TranscriptionSessions=iC;class oC extends ht{create(t,s,a){return this._client.post(Ee`/threads/${t}/messages`,{body:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}retrieve(t,s,a){const{thread_id:n}=s;return this._client.get(Ee`/threads/${n}/messages/${t}`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}update(t,s,a){const{thread_id:n,...i}=s;return this._client.post(Ee`/threads/${n}/messages/${t}`,{body:i,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}list(t,s={},a){return this._client.getAPIList(Ee`/threads/${t}/messages`,Fs,{query:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}delete(t,s,a){const{thread_id:n}=s;return this._client.delete(Ee`/threads/${n}/messages/${t}`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}}class lC extends ht{retrieve(t,s,a){const{thread_id:n,run_id:i,...o}=s;return this._client.get(Ee`/threads/${n}/runs/${i}/steps/${t}`,{query:o,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}list(t,s,a){const{thread_id:n,...i}=s;return this._client.getAPIList(Ee`/threads/${n}/runs/${t}/steps`,Fs,{query:i,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}}const Zq=r=>{if(typeof Buffer<"u"){const t=Buffer.from(r,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}else{const t=atob(r),s=t.length,a=new Uint8Array(s);for(let n=0;n<s;n++)a[n]=t.charCodeAt(n);return Array.from(new Float32Array(a.buffer))}};var sx={};const Oc=r=>{var t,s,a,n;if(typeof globalThis.process<"u")return((t=sx==null?void 0:sx[r])==null?void 0:t.trim())??void 0;if(typeof globalThis.Deno<"u")return(n=(a=(s=globalThis.Deno.env)==null?void 0:s.get)==null?void 0:a.call(s,r))==null?void 0:n.trim()};var er,uo,Rg,Ja,Ch,Ma,ho,xl,oo,dm,ta,Eh,Ah,hd,Yc,Jc,Ib,Db,Fb,Ob,Mb,Lb,Ub;class md extends Fy{constructor(){super(...arguments),er.add(this),Rg.set(this,[]),Ja.set(this,{}),Ch.set(this,{}),Ma.set(this,void 0),ho.set(this,void 0),xl.set(this,void 0),oo.set(this,void 0),dm.set(this,void 0),ta.set(this,void 0),Eh.set(this,void 0),Ah.set(this,void 0),hd.set(this,void 0)}[(Rg=new WeakMap,Ja=new WeakMap,Ch=new WeakMap,Ma=new WeakMap,ho=new WeakMap,xl=new WeakMap,oo=new WeakMap,dm=new WeakMap,ta=new WeakMap,Eh=new WeakMap,Ah=new WeakMap,hd=new WeakMap,er=new WeakSet,Symbol.asyncIterator)](){const t=[],s=[];let a=!1;return this.on("event",n=>{const i=s.shift();i?i.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of s)n.resolve(void 0);s.length=0}),this.on("abort",n=>{a=!0;for(const i of s)i.reject(n);s.length=0}),this.on("error",n=>{a=!0;for(const i of s)i.reject(n);s.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((i,o)=>s.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const s=new uo;return s._run(()=>s._fromReadableStream(t)),s}async _fromReadableStream(t,s){var i;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=nn.fromReadableStream(t,this.controller);for await(const o of n)re(this,er,"m",Yc).call(this,o);if((i=n.controller.signal)!=null&&i.aborted)throw new ka;return this._addRun(re(this,er,"m",Jc).call(this))}toReadableStream(){return new nn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,s,a,n){const i=new uo;return i._run(()=>i._runToolAssistantStream(t,s,a,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,s,a,n){var d;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...a,stream:!0},c=await t.submitToolOutputs(s,o,{...n,signal:this.controller.signal});this._connected();for await(const h of c)re(this,er,"m",Yc).call(this,h);if((d=c.controller.signal)!=null&&d.aborted)throw new ka;return this._addRun(re(this,er,"m",Jc).call(this))}static createThreadAssistantStream(t,s,a){const n=new uo;return n._run(()=>n._threadAssistantStream(t,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(t,s,a,n){const i=new uo;return i._run(()=>i._runAssistantStream(t,s,a,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return re(this,Eh,"f")}currentRun(){return re(this,Ah,"f")}currentMessageSnapshot(){return re(this,Ma,"f")}currentRunStepSnapshot(){return re(this,hd,"f")}async finalRunSteps(){return await this.done(),Object.values(re(this,Ja,"f"))}async finalMessages(){return await this.done(),Object.values(re(this,Ch,"f"))}async finalRun(){if(await this.done(),!re(this,ho,"f"))throw Error("Final run was not received.");return re(this,ho,"f")}async _createThreadAssistantStream(t,s,a){var c;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const i={...s,stream:!0},o=await t.createAndRun(i,{...a,signal:this.controller.signal});this._connected();for await(const d of o)re(this,er,"m",Yc).call(this,d);if((c=o.controller.signal)!=null&&c.aborted)throw new ka;return this._addRun(re(this,er,"m",Jc).call(this))}async _createAssistantStream(t,s,a,n){var d;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...a,stream:!0},c=await t.create(s,o,{...n,signal:this.controller.signal});this._connected();for await(const h of c)re(this,er,"m",Yc).call(this,h);if((d=c.controller.signal)!=null&&d.aborted)throw new ka;return this._addRun(re(this,er,"m",Jc).call(this))}static accumulateDelta(t,s){for(const[a,n]of Object.entries(s)){if(!t.hasOwnProperty(a)){t[a]=n;continue}let i=t[a];if(i==null){t[a]=n;continue}if(a==="index"||a==="type"){t[a]=n;continue}if(typeof i=="string"&&typeof n=="string")i+=n;else if(typeof i=="number"&&typeof n=="number")i+=n;else if(Kp(i)&&Kp(n))i=this.accumulateDelta(i,n);else if(Array.isArray(i)&&Array.isArray(n)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...n);continue}for(const o of n){if(!Kp(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const c=o.index;if(c==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const d=i[c];d==null?i.push(o):i[c]=this.accumulateDelta(d,o)}continue}else throw Error(`Unhandled record type: ${a}, deltaValue: ${n}, accValue: ${i}`);t[a]=i}return t}_addRun(t){return t}async _threadAssistantStream(t,s,a){return await this._createThreadAssistantStream(s,t,a)}async _runAssistantStream(t,s,a,n){return await this._createAssistantStream(s,t,a,n)}async _runToolAssistantStream(t,s,a,n){return await this._createToolAssistantStream(s,t,a,n)}}uo=md,Yc=function(t){if(!this.ended)switch(ut(this,Eh,t),re(this,er,"m",Fb).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":re(this,er,"m",Ub).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":re(this,er,"m",Db).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":re(this,er,"m",Ib).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Jc=function(){if(this.ended)throw new lt("stream has ended, this shouldn't happen");if(!re(this,ho,"f"))throw Error("Final run has not been received");return re(this,ho,"f")},Ib=function(t){const[s,a]=re(this,er,"m",Mb).call(this,t,re(this,Ma,"f"));ut(this,Ma,s),re(this,Ch,"f")[s.id]=s;for(const n of a){const i=s.content[n.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,s),t.data.delta.content)for(const n of t.data.delta.content){if(n.type=="text"&&n.text){let i=n.text,o=s.content[n.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=re(this,xl,"f")){if(re(this,oo,"f"))switch(re(this,oo,"f").type){case"text":this._emit("textDone",re(this,oo,"f").text,re(this,Ma,"f"));break;case"image_file":this._emit("imageFileDone",re(this,oo,"f").image_file,re(this,Ma,"f"));break}ut(this,xl,n.index)}ut(this,oo,s.content[n.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(re(this,xl,"f")!==void 0){const n=t.data.content[re(this,xl,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,re(this,Ma,"f"));break;case"text":this._emit("textDone",n.text,re(this,Ma,"f"));break}}re(this,Ma,"f")&&this._emit("messageDone",t.data),ut(this,Ma,void 0)}},Db=function(t){const s=re(this,er,"m",Ob).call(this,t);switch(ut(this,hd,s),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const a=t.data.delta;if(a.step_details&&a.step_details.type=="tool_calls"&&a.step_details.tool_calls&&s.step_details.type=="tool_calls")for(const i of a.step_details.tool_calls)i.index==re(this,dm,"f")?this._emit("toolCallDelta",i,s.step_details.tool_calls[i.index]):(re(this,ta,"f")&&this._emit("toolCallDone",re(this,ta,"f")),ut(this,dm,i.index),ut(this,ta,s.step_details.tool_calls[i.index]),re(this,ta,"f")&&this._emit("toolCallCreated",re(this,ta,"f")));this._emit("runStepDelta",t.data.delta,s);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ut(this,hd,void 0),t.data.step_details.type=="tool_calls"&&re(this,ta,"f")&&(this._emit("toolCallDone",re(this,ta,"f")),ut(this,ta,void 0)),this._emit("runStepDone",t.data,s);break}},Fb=function(t){re(this,Rg,"f").push(t),this._emit("event",t)},Ob=function(t){switch(t.event){case"thread.run.step.created":return re(this,Ja,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let s=re(this,Ja,"f")[t.data.id];if(!s)throw Error("Received a RunStepDelta before creation of a snapshot");let a=t.data;if(a.delta){const n=uo.accumulateDelta(s,a.delta);re(this,Ja,"f")[t.data.id]=n}return re(this,Ja,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":re(this,Ja,"f")[t.data.id]=t.data;break}if(re(this,Ja,"f")[t.data.id])return re(this,Ja,"f")[t.data.id];throw new Error("No snapshot available")},Mb=function(t,s){let a=[];switch(t.event){case"thread.message.created":return[t.data,a];case"thread.message.delta":if(!s)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=t.data;if(n.delta.content)for(const i of n.delta.content)if(i.index in s.content){let o=s.content[i.index];s.content[i.index]=re(this,er,"m",Lb).call(this,i,o)}else s.content[i.index]=i,a.push(i);return[s,a];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(s)return[s,a];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Lb=function(t,s){return uo.accumulateDelta(s,t)},Ub=function(t){switch(ut(this,Ah,t.data),t.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":ut(this,ho,t.data),re(this,ta,"f")&&(this._emit("toolCallDone",re(this,ta,"f")),ut(this,ta,void 0));break}};let zy=class extends ht{constructor(){super(...arguments),this.steps=new lC(this._client)}create(t,s,a){const{include:n,...i}=s;return this._client.post(Ee`/threads/${t}/runs`,{query:{include:n},body:i,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers]),stream:s.stream??!1})}retrieve(t,s,a){const{thread_id:n}=s;return this._client.get(Ee`/threads/${n}/runs/${t}`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}update(t,s,a){const{thread_id:n,...i}=s;return this._client.post(Ee`/threads/${n}/runs/${t}`,{body:i,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}list(t,s={},a){return this._client.getAPIList(Ee`/threads/${t}/runs`,Fs,{query:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}cancel(t,s,a){const{thread_id:n}=s;return this._client.post(Ee`/threads/${n}/runs/${t}/cancel`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}async createAndPoll(t,s,a){const n=await this.create(t,s,a);return await this.poll(n.id,{thread_id:t},a)}createAndStream(t,s,a){return md.createAssistantStream(t,this._client.beta.threads.runs,s,a)}async poll(t,s,a){var i;const n=Je([a==null?void 0:a.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=a==null?void 0:a.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(t,s,{...a,headers:{...a==null?void 0:a.headers,...n}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(a!=null&&a.pollIntervalMs)d=a.pollIntervalMs;else{const h=c.headers.get("openai-poll-after-ms");if(h){const m=parseInt(h);isNaN(m)||(d=m)}}await Wd(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,s,a){return md.createAssistantStream(t,this._client.beta.threads.runs,s,a)}submitToolOutputs(t,s,a){const{thread_id:n,...i}=s;return this._client.post(Ee`/threads/${n}/runs/${t}/submit_tool_outputs`,{body:i,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers]),stream:s.stream??!1})}async submitToolOutputsAndPoll(t,s,a){const n=await this.submitToolOutputs(t,s,a);return await this.poll(n.id,s,a)}submitToolOutputsStream(t,s,a){return md.createToolAssistantStream(t,this._client.beta.threads.runs,s,a)}};zy.Steps=lC;class tf extends ht{constructor(){super(...arguments),this.runs=new zy(this._client),this.messages=new oC(this._client)}create(t={},s){return this._client.post("/threads",{body:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,s){return this._client.get(Ee`/threads/${t}`,{...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(t,s,a){return this._client.post(Ee`/threads/${t}`,{body:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}delete(t,s){return this._client.delete(Ee`/threads/${t}`,{...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}createAndRun(t,s){return this._client.post("/threads/runs",{body:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers]),stream:t.stream??!1})}async createAndRunPoll(t,s){const a=await this.createAndRun(t,s);return await this.runs.poll(a.id,{thread_id:a.thread_id},s)}createAndRunStream(t,s){return md.createThreadAssistantStream(t,this._client.beta.threads,s)}}tf.Runs=zy;tf.Messages=oC;class Kd extends ht{constructor(){super(...arguments),this.realtime=new ef(this._client),this.assistants=new aC(this._client),this.threads=new tf(this._client)}}Kd.Realtime=ef;Kd.Assistants=aC;Kd.Threads=tf;class cC extends ht{create(t,s){return this._client.post("/completions",{body:t,...s,stream:t.stream??!1})}}class dC extends ht{retrieve(t,s,a){const{container_id:n}=s;return this._client.get(Ee`/containers/${n}/files/${t}/content`,{...a,headers:Je([{Accept:"application/binary"},a==null?void 0:a.headers]),__binaryResponse:!0})}}let By=class extends ht{constructor(){super(...arguments),this.content=new dC(this._client)}create(t,s,a){return this._client.post(Ee`/containers/${t}/files`,To({body:s,...a},this._client))}retrieve(t,s,a){const{container_id:n}=s;return this._client.get(Ee`/containers/${n}/files/${t}`,a)}list(t,s={},a){return this._client.getAPIList(Ee`/containers/${t}/files`,Fs,{query:s,...a})}delete(t,s,a){const{container_id:n}=s;return this._client.delete(Ee`/containers/${n}/files/${t}`,{...a,headers:Je([{Accept:"*/*"},a==null?void 0:a.headers])})}};By.Content=dC;class qy extends ht{constructor(){super(...arguments),this.files=new By(this._client)}create(t,s){return this._client.post("/containers",{body:t,...s})}retrieve(t,s){return this._client.get(Ee`/containers/${t}`,s)}list(t={},s){return this._client.getAPIList("/containers",Fs,{query:t,...s})}delete(t,s){return this._client.delete(Ee`/containers/${t}`,{...s,headers:Je([{Accept:"*/*"},s==null?void 0:s.headers])})}}qy.Files=By;class uC extends ht{create(t,s){const a=!!t.encoding_format;let n=a?t.encoding_format:"base64";a&&dr(this._client).debug("embeddings/user defined encoding_format:",t.encoding_format);const i=this._client.post("/embeddings",{body:{...t,encoding_format:n},...s});return a?i:(dr(this._client).debug("embeddings/decoding base64 embeddings from base64"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(c=>{const d=c.embedding;c.embedding=Zq(d)}),o)))}}class hC extends ht{retrieve(t,s,a){const{eval_id:n,run_id:i}=s;return this._client.get(Ee`/evals/${n}/runs/${i}/output_items/${t}`,a)}list(t,s,a){const{eval_id:n,...i}=s;return this._client.getAPIList(Ee`/evals/${n}/runs/${t}/output_items`,Fs,{query:i,...a})}}class Vy extends ht{constructor(){super(...arguments),this.outputItems=new hC(this._client)}create(t,s,a){return this._client.post(Ee`/evals/${t}/runs`,{body:s,...a})}retrieve(t,s,a){const{eval_id:n}=s;return this._client.get(Ee`/evals/${n}/runs/${t}`,a)}list(t,s={},a){return this._client.getAPIList(Ee`/evals/${t}/runs`,Fs,{query:s,...a})}delete(t,s,a){const{eval_id:n}=s;return this._client.delete(Ee`/evals/${n}/runs/${t}`,a)}cancel(t,s,a){const{eval_id:n}=s;return this._client.post(Ee`/evals/${n}/runs/${t}`,a)}}Vy.OutputItems=hC;class Wy extends ht{constructor(){super(...arguments),this.runs=new Vy(this._client)}create(t,s){return this._client.post("/evals",{body:t,...s})}retrieve(t,s){return this._client.get(Ee`/evals/${t}`,s)}update(t,s,a){return this._client.post(Ee`/evals/${t}`,{body:s,...a})}list(t={},s){return this._client.getAPIList("/evals",Fs,{query:t,...s})}delete(t,s){return this._client.delete(Ee`/evals/${t}`,s)}}Wy.Runs=Vy;let mC=class extends ht{create(t,s){return this._client.post("/files",To({body:t,...s},this._client))}retrieve(t,s){return this._client.get(Ee`/files/${t}`,s)}list(t={},s){return this._client.getAPIList("/files",Fs,{query:t,...s})}delete(t,s){return this._client.delete(Ee`/files/${t}`,s)}content(t,s){return this._client.get(Ee`/files/${t}/content`,{...s,headers:Je([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}async waitForProcessing(t,{pollInterval:s=5e3,maxWait:a=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(t);for(;!o.status||!n.has(o.status);)if(await Wd(s),o=await this.retrieve(t),Date.now()-i>a)throw new Iy({message:`Giving up on waiting for file ${t} to finish processing after ${a} milliseconds.`});return o}};class fC extends ht{}let pC=class extends ht{run(t,s){return this._client.post("/fine_tuning/alpha/graders/run",{body:t,...s})}validate(t,s){return this._client.post("/fine_tuning/alpha/graders/validate",{body:t,...s})}};class Hy extends ht{constructor(){super(...arguments),this.graders=new pC(this._client)}}Hy.Graders=pC;class xC extends ht{create(t,s,a){return this._client.getAPIList(Ee`/fine_tuning/checkpoints/${t}/permissions`,Xm,{body:s,method:"post",...a})}retrieve(t,s={},a){return this._client.getAPIList(Ee`/fine_tuning/checkpoints/${t}/permissions`,Fs,{query:s,...a})}delete(t,s,a){const{fine_tuned_model_checkpoint:n}=s;return this._client.delete(Ee`/fine_tuning/checkpoints/${n}/permissions/${t}`,a)}}let Gy=class extends ht{constructor(){super(...arguments),this.permissions=new xC(this._client)}};Gy.Permissions=xC;class gC extends ht{list(t,s={},a){return this._client.getAPIList(Ee`/fine_tuning/jobs/${t}/checkpoints`,Fs,{query:s,...a})}}class Ky extends ht{constructor(){super(...arguments),this.checkpoints=new gC(this._client)}create(t,s){return this._client.post("/fine_tuning/jobs",{body:t,...s})}retrieve(t,s){return this._client.get(Ee`/fine_tuning/jobs/${t}`,s)}list(t={},s){return this._client.getAPIList("/fine_tuning/jobs",Fs,{query:t,...s})}cancel(t,s){return this._client.post(Ee`/fine_tuning/jobs/${t}/cancel`,s)}listEvents(t,s={},a){return this._client.getAPIList(Ee`/fine_tuning/jobs/${t}/events`,Fs,{query:s,...a})}pause(t,s){return this._client.post(Ee`/fine_tuning/jobs/${t}/pause`,s)}resume(t,s){return this._client.post(Ee`/fine_tuning/jobs/${t}/resume`,s)}}Ky.Checkpoints=gC;class dc extends ht{constructor(){super(...arguments),this.methods=new fC(this._client),this.jobs=new Ky(this._client),this.checkpoints=new Gy(this._client),this.alpha=new Hy(this._client)}}dc.Methods=fC;dc.Jobs=Ky;dc.Checkpoints=Gy;dc.Alpha=Hy;class yC extends ht{}class Qy extends ht{constructor(){super(...arguments),this.graderModels=new yC(this._client)}}Qy.GraderModels=yC;class vC extends ht{createVariation(t,s){return this._client.post("/images/variations",To({body:t,...s},this._client))}edit(t,s){return this._client.post("/images/edits",To({body:t,...s},this._client))}generate(t,s){return this._client.post("/images/generations",{body:t,...s})}}class wC extends ht{retrieve(t,s){return this._client.get(Ee`/models/${t}`,s)}list(t){return this._client.getAPIList("/models",Xm,t)}delete(t,s){return this._client.delete(Ee`/models/${t}`,s)}}class jC extends ht{create(t,s){return this._client.post("/moderations",{body:t,...s})}}function Xq(r,t){return!t||!t9(t)?{...r,output_parsed:null,output:r.output.map(s=>s.type==="function_call"?{...s,parsed_arguments:null}:s.type==="message"?{...s,content:s.content.map(a=>({...a,parsed:null}))}:s)}:bC(r,t)}function bC(r,t){const s=r.output.map(n=>{if(n.type==="function_call")return{...n,parsed_arguments:a9(t,n)};if(n.type==="message"){const i=n.content.map(o=>o.type==="output_text"?{...o,parsed:e9(t,o.text)}:o);return{...n,content:i}}return n}),a=Object.assign({},r,{output:s});return Object.getOwnPropertyDescriptor(r,"output_text")||_C(a),Object.defineProperty(a,"output_parsed",{enumerable:!0,get(){for(const n of a.output)if(n.type==="message"){for(const i of n.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),a}function e9(r,t){var s,a,n,i;return((a=(s=r.text)==null?void 0:s.format)==null?void 0:a.type)!=="json_schema"?null:"$parseRaw"in((n=r.text)==null?void 0:n.format)?((i=r.text)==null?void 0:i.format).$parseRaw(t):JSON.parse(t)}function t9(r){var t;return!!Oy((t=r.text)==null?void 0:t.format)}function s9(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function r9(r,t){return r.find(s=>s.type==="function"&&s.name===t)}function a9(r,t){const s=r9(r.tools??[],t.name);return{...t,...t,parsed_arguments:s9(s)?s.$parseRaw(t.arguments):s!=null&&s.strict?JSON.parse(t.arguments):null}}function _C(r){const t=[];for(const s of r.output)if(s.type==="message")for(const a of s.content)a.type==="output_text"&&t.push(a.text);r.output_text=t.join("")}var dl,ch,si,dh,$b,zb,Bb,qb;class Yy extends Fy{constructor(t){super(),dl.add(this),ch.set(this,void 0),si.set(this,void 0),dh.set(this,void 0),ut(this,ch,t)}static createResponse(t,s,a){const n=new Yy(s);return n._run(()=>n._createOrRetrieveResponse(t,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createOrRetrieveResponse(t,s,a){var c;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),re(this,dl,"m",$b).call(this);let i,o=null;"response_id"in s?(i=await t.responses.retrieve(s.response_id,{stream:!0},{...a,signal:this.controller.signal,stream:!0}),o=s.starting_after??null):i=await t.responses.create({...s,stream:!0},{...a,signal:this.controller.signal}),this._connected();for await(const d of i)re(this,dl,"m",zb).call(this,d,o);if((c=i.controller.signal)!=null&&c.aborted)throw new ka;return re(this,dl,"m",Bb).call(this)}[(ch=new WeakMap,si=new WeakMap,dh=new WeakMap,dl=new WeakSet,$b=function(){this.ended||ut(this,si,void 0)},zb=function(s,a){if(this.ended)return;const n=(o,c)=>{(a==null||c.sequence_number>a)&&this._emit(o,c)},i=re(this,dl,"m",qb).call(this,s);switch(n("event",s),s.type){case"response.output_text.delta":{const o=i.output[s.output_index];if(!o)throw new lt(`missing output at index ${s.output_index}`);if(o.type==="message"){const c=o.content[s.content_index];if(!c)throw new lt(`missing content at index ${s.content_index}`);if(c.type!=="output_text")throw new lt(`expected content to be 'output_text', got ${c.type}`);n("response.output_text.delta",{...s,snapshot:c.text})}break}case"response.function_call_arguments.delta":{const o=i.output[s.output_index];if(!o)throw new lt(`missing output at index ${s.output_index}`);o.type==="function_call"&&n("response.function_call_arguments.delta",{...s,snapshot:o.arguments});break}default:n(s.type,s);break}},Bb=function(){if(this.ended)throw new lt("stream has ended, this shouldn't happen");const s=re(this,si,"f");if(!s)throw new lt("request ended without sending any events");ut(this,si,void 0);const a=n9(s,re(this,ch,"f"));return ut(this,dh,a),a},qb=function(s){let a=re(this,si,"f");if(!a){if(s.type!=="response.created")throw new lt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${s.type}`);return a=ut(this,si,s.response),a}switch(s.type){case"response.output_item.added":{a.output.push(s.item);break}case"response.content_part.added":{const n=a.output[s.output_index];if(!n)throw new lt(`missing output at index ${s.output_index}`);n.type==="message"&&n.content.push(s.part);break}case"response.output_text.delta":{const n=a.output[s.output_index];if(!n)throw new lt(`missing output at index ${s.output_index}`);if(n.type==="message"){const i=n.content[s.content_index];if(!i)throw new lt(`missing content at index ${s.content_index}`);if(i.type!=="output_text")throw new lt(`expected content to be 'output_text', got ${i.type}`);i.text+=s.delta}break}case"response.function_call_arguments.delta":{const n=a.output[s.output_index];if(!n)throw new lt(`missing output at index ${s.output_index}`);n.type==="function_call"&&(n.arguments+=s.delta);break}case"response.completed":{ut(this,si,s.response);break}}return a},Symbol.asyncIterator)](){const t=[],s=[];let a=!1;return this.on("event",n=>{const i=s.shift();i?i.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of s)n.resolve(void 0);s.length=0}),this.on("abort",n=>{a=!0;for(const i of s)i.reject(n);s.length=0}),this.on("error",n=>{a=!0;for(const i of s)i.reject(n);s.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((i,o)=>s.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=re(this,dh,"f");if(!t)throw new lt("stream ended without producing a ChatCompletion");return t}}function n9(r,t){return Xq(r,t)}class NC extends ht{list(t,s={},a){return this._client.getAPIList(Ee`/responses/${t}/input_items`,Fs,{query:s,...a})}}class Jy extends ht{constructor(){super(...arguments),this.inputItems=new NC(this._client)}create(t,s){return this._client.post("/responses",{body:t,...s,stream:t.stream??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&_C(a),a))}retrieve(t,s={},a){return this._client.get(Ee`/responses/${t}`,{query:s,...a,stream:(s==null?void 0:s.stream)??!1})}delete(t,s){return this._client.delete(Ee`/responses/${t}`,{...s,headers:Je([{Accept:"*/*"},s==null?void 0:s.headers])})}parse(t,s){return this._client.responses.create(t,s)._thenUnwrap(a=>bC(a,t))}stream(t,s){return Yy.createResponse(this._client,t,s)}cancel(t,s){return this._client.post(Ee`/responses/${t}/cancel`,s)}}Jy.InputItems=NC;class SC extends ht{create(t,s,a){return this._client.post(Ee`/uploads/${t}/parts`,To({body:s,...a},this._client))}}class Zy extends ht{constructor(){super(...arguments),this.parts=new SC(this._client)}create(t,s){return this._client.post("/uploads",{body:t,...s})}cancel(t,s){return this._client.post(Ee`/uploads/${t}/cancel`,s)}complete(t,s,a){return this._client.post(Ee`/uploads/${t}/complete`,{body:s,...a})}}Zy.Parts=SC;const i9=async r=>{const t=await Promise.allSettled(r),s=t.filter(n=>n.status==="rejected");if(s.length){for(const n of s)console.error(n.reason);throw new Error(`${s.length} promise(s) failed - see the above errors`)}const a=[];for(const n of t)n.status==="fulfilled"&&a.push(n.value);return a};class kC extends ht{create(t,s,a){return this._client.post(Ee`/vector_stores/${t}/file_batches`,{body:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}retrieve(t,s,a){const{vector_store_id:n}=s;return this._client.get(Ee`/vector_stores/${n}/file_batches/${t}`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}cancel(t,s,a){const{vector_store_id:n}=s;return this._client.post(Ee`/vector_stores/${n}/file_batches/${t}/cancel`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}async createAndPoll(t,s,a){const n=await this.create(t,s);return await this.poll(t,n.id,a)}listFiles(t,s,a){const{vector_store_id:n,...i}=s;return this._client.getAPIList(Ee`/vector_stores/${n}/file_batches/${t}/files`,Fs,{query:i,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}async poll(t,s,a){var i;const n=Je([a==null?void 0:a.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=a==null?void 0:a.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(s,{vector_store_id:t},{...a,headers:n}).withResponse();switch(o.status){case"in_progress":let d=5e3;if(a!=null&&a.pollIntervalMs)d=a.pollIntervalMs;else{const h=c.headers.get("openai-poll-after-ms");if(h){const m=parseInt(h);isNaN(m)||(d=m)}}await Wd(d);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:s,fileIds:a=[]},n){if(s==null||s.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(n==null?void 0:n.maxConcurrency)??5,o=Math.min(i,s.length),c=this._client,d=s.values(),h=[...a];async function m(g){for(let y of g){const b=await c.files.create({file:y,purpose:"assistants"},n);h.push(b.id)}}const f=Array(o).fill(d).map(m);return await i9(f),await this.createAndPoll(t,{file_ids:h})}}class CC extends ht{create(t,s,a){return this._client.post(Ee`/vector_stores/${t}/files`,{body:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}retrieve(t,s,a){const{vector_store_id:n}=s;return this._client.get(Ee`/vector_stores/${n}/files/${t}`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}update(t,s,a){const{vector_store_id:n,...i}=s;return this._client.post(Ee`/vector_stores/${n}/files/${t}`,{body:i,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}list(t,s={},a){return this._client.getAPIList(Ee`/vector_stores/${t}/files`,Fs,{query:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}delete(t,s,a){const{vector_store_id:n}=s;return this._client.delete(Ee`/vector_stores/${n}/files/${t}`,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}async createAndPoll(t,s,a){const n=await this.create(t,s,a);return await this.poll(t,n.id,a)}async poll(t,s,a){var i;const n=Je([a==null?void 0:a.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=a==null?void 0:a.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const o=await this.retrieve(s,{vector_store_id:t},{...a,headers:n}).withResponse(),c=o.data;switch(c.status){case"in_progress":let d=5e3;if(a!=null&&a.pollIntervalMs)d=a.pollIntervalMs;else{const h=o.response.headers.get("openai-poll-after-ms");if(h){const m=parseInt(h);isNaN(m)||(d=m)}}await Wd(d);break;case"failed":case"completed":return c}}}async upload(t,s,a){const n=await this._client.files.create({file:s,purpose:"assistants"},a);return this.create(t,{file_id:n.id},a)}async uploadAndPoll(t,s,a){const n=await this.upload(t,s,a);return await this.poll(t,n.id,a)}content(t,s,a){const{vector_store_id:n}=s;return this._client.getAPIList(Ee`/vector_stores/${n}/files/${t}/content`,Xm,{...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}}class sf extends ht{constructor(){super(...arguments),this.files=new CC(this._client),this.fileBatches=new kC(this._client)}create(t,s){return this._client.post("/vector_stores",{body:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,s){return this._client.get(Ee`/vector_stores/${t}`,{...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(t,s,a){return this._client.post(Ee`/vector_stores/${t}`,{body:s,...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}list(t={},s){return this._client.getAPIList("/vector_stores",Fs,{query:t,...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,s){return this._client.delete(Ee`/vector_stores/${t}`,{...s,headers:Je([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}search(t,s,a){return this._client.getAPIList(Ee`/vector_stores/${t}/search`,Xm,{body:s,method:"post",...a,headers:Je([{"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers])})}}sf.Files=CC;sf.FileBatches=kC;var Pg,Xy,Th,EC;class Ut{constructor({baseURL:t=Oc("OPENAI_BASE_URL"),apiKey:s=Oc("OPENAI_API_KEY"),organization:a=Oc("OPENAI_ORG_ID")??null,project:n=Oc("OPENAI_PROJECT_ID")??null,...i}={}){if(Pg.add(this),Th.set(this,void 0),this.completions=new cC(this),this.chat=new $y(this),this.embeddings=new uC(this),this.files=new mC(this),this.images=new vC(this),this.audio=new Gd(this),this.moderations=new jC(this),this.models=new wC(this),this.fineTuning=new dc(this),this.graders=new Qy(this),this.vectorStores=new sf(this),this.beta=new Kd(this),this.batches=new rC(this),this.uploads=new Zy(this),this.responses=new Jy(this),this.evals=new Wy(this),this.containers=new qy(this),s===void 0)throw new lt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:s,organization:a,project:n,...i,baseURL:t||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&oq())throw new lt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=o.baseURL,this.timeout=o.timeout??Xy.DEFAULT_TIMEOUT,this.logger=o.logger??console;const c="warn";this.logLevel=c,this.logLevel=Eb(o.logLevel,"ClientOptions.logLevel",this)??Eb(Oc("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??c,this.fetchOptions=o.fetchOptions,this.maxRetries=o.maxRetries??2,this.fetch=o.fetch??hq(),ut(this,Th,fq),this._options=o,this.apiKey=s,this.organization=a,this.project=n}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:s}){}authHeaders(t){return Je([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(t){return wq(t,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${ml}`}defaultIdempotencyKey(){return`stainless-node-retry-${ok()}`}makeStatusError(t,s,a,n){return ar.generate(t,s,a,n)}buildURL(t,s,a){const n=!re(this,Pg,"m",EC).call(this)&&a||this.baseURL,i=tq(t)?new URL(t):new URL(n+(n.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),o=this.defaultQuery();return rq(o)||(s={...o,...s}),typeof s=="object"&&s&&!Array.isArray(s)&&(i.search=this.stringifyQuery(s)),i.toString()}async prepareOptions(t){}async prepareRequest(t,{url:s,options:a}){}get(t,s){return this.methodRequest("get",t,s)}post(t,s){return this.methodRequest("post",t,s)}patch(t,s){return this.methodRequest("patch",t,s)}put(t,s){return this.methodRequest("put",t,s)}delete(t,s){return this.methodRequest("delete",t,s)}methodRequest(t,s,a){return this.request(Promise.resolve(a).then(n=>({method:t,path:s,...n})))}request(t,s=null){return new Zm(this,this.makeRequest(t,s,void 0))}async makeRequest(t,s,a){var N,v;const n=await t,i=n.maxRetries??this.maxRetries;s==null&&(s=i),await this.prepareOptions(n);const{req:o,url:c,timeout:d}=this.buildRequest(n,{retryCount:i-s});await this.prepareRequest(o,{url:c,options:n});const h="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=a===void 0?"":`, retryOf: ${a}`,f=Date.now();if(dr(this).debug(`[${h}] sending request`,to({retryOfRequestLogID:a,method:n.method,url:c,options:n,headers:o.headers})),(N=n.signal)!=null&&N.aborted)throw new ka;const g=new AbortController,y=await this.fetchWithTimeout(c,o,d,g).catch(bg),b=Date.now();if(y instanceof Error){const j=`retrying, ${s} attempts remaining`;if((v=n.signal)!=null&&v.aborted)throw new ka;const C=jg(y)||/timed? ?out/i.test(String(y)+("cause"in y?String(y.cause):""));if(s)return dr(this).info(`[${h}] connection ${C?"timed out":"failed"} - ${j}`),dr(this).debug(`[${h}] connection ${C?"timed out":"failed"} (${j})`,to({retryOfRequestLogID:a,url:c,durationMs:b-f,message:y.message})),this.retryRequest(n,s,a??h);throw dr(this).info(`[${h}] connection ${C?"timed out":"failed"} - error; no more retries left`),dr(this).debug(`[${h}] connection ${C?"timed out":"failed"} (error; no more retries left)`,to({retryOfRequestLogID:a,url:c,durationMs:b-f,message:y.message})),C?new Iy:new Ym({cause:y})}const w=[...y.headers.entries()].filter(([j])=>j==="x-request-id").map(([j,C])=>", "+j+": "+JSON.stringify(C)).join(""),S=`[${h}${m}${w}] ${o.method} ${c} ${y.ok?"succeeded":"failed"} with status ${y.status} in ${b-f}ms`;if(!y.ok){const j=this.shouldRetry(y);if(s&&j){const U=`retrying, ${s} attempts remaining`;return await mq(y.body),dr(this).info(`${S} - ${U}`),dr(this).debug(`[${h}] response error (${U})`,to({retryOfRequestLogID:a,url:y.url,status:y.status,headers:y.headers,durationMs:b-f})),this.retryRequest(n,s,a??h,y.headers)}const C=j?"error; no more retries left":"error; not retryable";dr(this).info(`${S} - ${C}`);const k=await y.text().catch(U=>bg(U).message),I=iq(k),T=I?void 0:k;throw dr(this).debug(`[${h}] response error (${C})`,to({retryOfRequestLogID:a,url:y.url,status:y.status,headers:y.headers,message:T,durationMs:Date.now()-f})),this.makeStatusError(y.status,I,T,y.headers)}return dr(this).info(S),dr(this).debug(`[${h}] response start`,to({retryOfRequestLogID:a,url:y.url,status:y.status,headers:y.headers,durationMs:b-f})),{response:y,options:n,controller:g,requestLogID:h,retryOfRequestLogID:a,startTime:f}}getAPIList(t,s,a){return this.requestAPIList(s,{method:"get",path:t,...a})}requestAPIList(t,s){const a=this.makeRequest(s,null,void 0);return new Aq(this,a,t)}async fetchWithTimeout(t,s,a,n){const{signal:i,method:o,...c}=s||{};i&&i.addEventListener("abort",()=>n.abort());const d=setTimeout(()=>n.abort(),a),h=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,m={signal:n.signal,...h?{duplex:"half"}:{},method:"GET",...c};o&&(m.method=o.toUpperCase());try{return await this.fetch.call(void 0,t,m)}finally{clearTimeout(d)}}shouldRetry(t){const s=t.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,s,a,n){let i;const o=n==null?void 0:n.get("retry-after-ms");if(o){const d=parseFloat(o);Number.isNaN(d)||(i=d)}const c=n==null?void 0:n.get("retry-after");if(c&&!i){const d=parseFloat(c);Number.isNaN(d)?i=Date.parse(c)-Date.now():i=d*1e3}if(!(i&&0<=i&&i<60*1e3)){const d=t.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(s,d)}return await Wd(i),this.makeRequest(t,s-1,a)}calculateDefaultRetryTimeoutMillis(t,s){const i=s-t,o=Math.min(.5*Math.pow(2,i),8),c=1-Math.random()*.25;return o*c*1e3}buildRequest(t,{retryCount:s=0}={}){const a={...t},{method:n,path:i,query:o,defaultBaseURL:c}=a,d=this.buildURL(i,o,c);"timeout"in a&&nq("timeout",a.timeout),a.timeout=a.timeout??this.timeout;const{bodyHeaders:h,body:m}=this.buildBody({options:a}),f=this.buildHeaders({options:t,method:n,bodyHeaders:h,retryCount:s});return{req:{method:n,headers:f,...a.signal&&{signal:a.signal},...globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"},...m&&{body:m},...this.fetchOptions??{},...a.fetchOptions??{}},url:d,timeout:a.timeout}}buildHeaders({options:t,method:s,bodyHeaders:a,retryCount:n}){let i={};this.idempotencyHeader&&s!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=t.idempotencyKey);const o=Je([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(n),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...uq(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},this.authHeaders(t),this._options.defaultHeaders,a,t.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:t,headers:s}}){if(!t)return{bodyHeaders:void 0,body:void 0};const a=Je([s]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&a.values.has("content-type")||t instanceof Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:vk(t)}:re(this,Th,"f").call(this,{body:t,headers:a})}}Xy=Ut,Th=new WeakMap,Pg=new WeakSet,EC=function(){return this.baseURL!=="https://api.openai.com/v1"};Ut.OpenAI=Xy;Ut.DEFAULT_TIMEOUT=6e5;Ut.OpenAIError=lt;Ut.APIError=ar;Ut.APIConnectionError=Ym;Ut.APIConnectionTimeoutError=Iy;Ut.APIUserAbortError=ka;Ut.NotFoundError=uk;Ut.ConflictError=hk;Ut.RateLimitError=fk;Ut.BadRequestError=lk;Ut.AuthenticationError=ck;Ut.InternalServerError=pk;Ut.PermissionDeniedError=dk;Ut.UnprocessableEntityError=mk;Ut.toFile=Fq;Ut.Completions=cC;Ut.Chat=$y;Ut.Embeddings=uC;Ut.Files=mC;Ut.Images=vC;Ut.Audio=Gd;Ut.Moderations=jC;Ut.Models=wC;Ut.FineTuning=dc;Ut.Graders=Qy;Ut.VectorStores=sf;Ut.Beta=Kd;Ut.Batches=rC;Ut.Uploads=Zy;Ut.Responses=Jy;Ut.Evals=Wy;Ut.Containers=qy;const Qd=new Ut({apiKey:sr.openai.apiKey,dangerouslyAllowBrowser:!0});async function ev(r){var s,a;if(!sr.openai.apiKey)throw new Error("OpenAI API key not configured");const t=`
    Analyze this legal document and provide a structured analysis in JSON format:
    
    1. Executive summary (2-3 sentences)
    2. Key entities (people, organizations, dates, amounts)
    3. Document classification (contract, agreement, legal notice, etc.)
    4. Legal implications (potential risks, obligations, rights)
    5. Recommended actions (what the reader should do)
    6. Confidence score (0-1, how confident you are in this analysis)
    
    Document text:
    ${r.substring(0,8e3)} ${r.length>8e3?"...":""}
    
    Respond with valid JSON only, no additional text.
  `;try{const i=(a=(s=(await Qd.chat.completions.create({model:sr.openai.model,messages:[{role:"system",content:"You are a legal AI assistant specializing in Singapore law. Provide accurate, helpful analysis of legal documents."},{role:"user",content:t}],max_tokens:sr.openai.maxTokens,temperature:sr.openai.temperature})).choices[0])==null?void 0:s.message)==null?void 0:a.content;if(!i)throw new Error("No response from OpenAI");const o=JSON.parse(i);return{summary:o.summary||"",keyEntities:o.keyEntities||[],documentType:o.documentType||"Unknown",legalImplications:o.legalImplications||[],recommendedActions:o.recommendedActions||[],confidence:o.confidence||.5}}catch(n){throw console.error("Error analyzing document:",n),new Error("Failed to analyze document")}}async function tv(r){if(!sr.openai.apiKey)throw new Error("OpenAI API key not configured");try{const t=await Qd.embeddings.create({model:"text-embedding-3-small",input:r.substring(0,8e3)});return{embedding:t.data[0].embedding,usage:t.usage}}catch(t){throw console.error("Error generating embedding:",t),new Error("Failed to generate embedding")}}async function AC(r,t=[],s=[]){var o,c;if(!sr.openai.apiKey)throw new Error("OpenAI API key not configured");const a=t.length>0?`

Relevant context from your documents:
${t.join(`

`)}`:"",i=[{role:"system",content:`You are a legal AI assistant specializing in Singapore law. 
    Provide helpful, accurate legal information while being clear that this is not legal advice.
    Always recommend consulting with a qualified lawyer for specific legal matters.
    If you reference information from the user's documents, mention that clearly.`},...s,{role:"user",content:`${r}${a}`}];try{const h=(c=(o=(await Qd.chat.completions.create({model:sr.openai.model,messages:i,max_tokens:sr.openai.maxTokens,temperature:.2})).choices[0])==null?void 0:o.message)==null?void 0:c.content;if(!h)throw new Error("No response from OpenAI");return{message:h,sources:t.length>0?["Your uploaded documents"]:[],confidence:.8}}catch(d){throw console.error("Error in AI chat:",d),new Error("Failed to get AI response")}}async function o9(r,t=500){var a,n;if(!sr.openai.apiKey)throw new Error("OpenAI API key not configured");const s=`
    Provide a concise summary of this legal document in approximately ${t} characters.
    Focus on the key points, parties involved, main obligations, and important dates.
    
    Document text:
    ${r.substring(0,8e3)} ${r.length>8e3?"...":""}
  `;try{return((n=(a=(await Qd.chat.completions.create({model:sr.openai.model,messages:[{role:"system",content:"You are a legal AI assistant. Provide clear, concise summaries of legal documents."},{role:"user",content:s}],max_tokens:Math.min(sr.openai.maxTokens,1e3),temperature:sr.openai.temperature})).choices[0])==null?void 0:a.message)==null?void 0:n.content)||"Unable to generate summary"}catch(i){throw console.error("Error summarizing document:",i),new Error("Failed to summarize document")}}async function l9(r){var s,a;if(!sr.openai.apiKey)throw new Error("OpenAI API key not configured");const t=`
    Extract key entities from this legal document and return them in JSON format:
    
    {
      "people": ["names of people"],
      "organizations": ["company names, law firms, etc."],
      "dates": ["important dates"],
      "amounts": ["monetary amounts, percentages"],
      "locations": ["addresses, jurisdictions"]
    }
    
    Document text:
    ${r.substring(0,8e3)} ${r.length>8e3?"...":""}
    
    Respond with valid JSON only.
  `;try{const i=(a=(s=(await Qd.chat.completions.create({model:sr.openai.model,messages:[{role:"system",content:"You are a legal AI assistant. Extract entities accurately from legal documents."},{role:"user",content:t}],max_tokens:1e3,temperature:.1})).choices[0])==null?void 0:s.message)==null?void 0:a.content;if(!i)throw new Error("No response from OpenAI");const o=JSON.parse(i);return{people:o.people||[],organizations:o.organizations||[],dates:o.dates||[],amounts:o.amounts||[],locations:o.locations||[]}}catch(n){return console.error("Error extracting entities:",n),{people:[],organizations:[],dates:[],amounts:[],locations:[]}}}async function c9(r,t,s){try{const{usageTrackingService:a}=await Ns(async()=>{const{usageTrackingService:b}=await Promise.resolve().then(()=>an);return{usageTrackingService:b}},void 0),n=await a.checkUsageLimit("ai_query");if(!n.allowed)throw new Error(`AI processing limit exceeded. You have used ${n.current}/${n.limit} AI queries this month. Please upgrade your plan to continue.`);s==null||s({stage:"ocr",progress:0,message:"Starting text extraction..."});const i=await ak(r,b=>{s==null||s({stage:"ocr",progress:b.progress*.4,message:b.message||"Extracting text..."})}),o=nk(i),c=ik(i.text),{error:d}=await D.from("uploaded_documents").update({ocr_text:c,ocr_quality_score:o.qualityScore,processing_status:"processing",updated_at:new Date().toISOString()}).eq("id",t);if(d)throw new Error(`Failed to update OCR results: ${d.message}`);s==null||s({stage:"analysis",progress:40,message:"Analyzing document content..."});const h=await ev(c);await a.incrementUsage("ai_query",t,{operation:"document_analysis",text_length:c.length,document_type:r.type});const{error:m}=await D.from("uploaded_documents").update({document_structure:{analysis:h,ocrQuality:o,metadata:i.metadata},updated_at:new Date().toISOString()}).eq("id",t);if(m)throw new Error(`Failed to update analysis results: ${m.message}`);s==null||s({stage:"embedding",progress:70,message:"Generating embeddings for search..."});let f;if(c.length>50)try{const b=d9(c,1e3);for(let w=0;w<b.length;w++){const S=b[w],N=await tv(S),{data:v,error:j}=await D.from("document_embeddings").insert({document_id:t,chunk_text:S,chunk_index:w,embedding:N.embedding,metadata:{usage:N.usage,chunkLength:S.length,totalChunks:b.length}}).select("id").single();j?console.error("Failed to store embedding:",j):w===0&&(f=v.id);const C=70+(w+1)/b.length*20;s==null||s({stage:"embedding",progress:C,message:`Processing chunk ${w+1} of ${b.length}...`})}}catch(b){console.error("Embedding generation failed:",b)}s==null||s({stage:"completed",progress:95,message:"Finalizing document processing..."});const{data:g,error:y}=await D.from("uploaded_documents").update({processing_status:"completed",updated_at:new Date().toISOString()}).eq("id",t).select().single();if(y)throw new Error(`Failed to finalize document: ${y.message}`);return s==null||s({stage:"completed",progress:100,message:"Document processing completed successfully!"}),{document:g,ocrResult:i,analysis:h,embeddingId:f}}catch(a){throw console.error("Document processing failed:",a),await D.from("uploaded_documents").update({processing_status:"failed",updated_at:new Date().toISOString()}).eq("id",t),s==null||s({stage:"error",progress:0,message:"Document processing failed",error:a instanceof Error?a.message:"Unknown error"}),a}}function d9(r,t=1e3){const s=[],a=r.split(/[.!?]+/).filter(i=>i.trim().length>0);let n="";for(const i of a){const o=i.trim();n.length+o.length+1<=t?n+=(n?". ":"")+o:(n&&s.push(n+"."),n=o)}if(n&&s.push(n+"."),s.length===0){const i=r.split(/\s+/);let o="";for(const c of i)o.length+c.length+1<=t?o+=(o?" ":"")+c:(o&&s.push(o),o=c);o&&s.push(o)}return s.filter(i=>i.trim().length>0)}class u9{constructor(){rs(this,"ws",null);rs(this,"reconnectAttempts",0);rs(this,"maxReconnectAttempts",5);rs(this,"reconnectDelay",1e3);rs(this,"handlers",new Map);rs(this,"isConnecting",!1);rs(this,"userId",null);console.log("WebSocket service initialized but connections disabled in production")}setupAuthListener(){D.auth.onAuthStateChange((t,s)=>{t==="SIGNED_IN"&&(s!=null&&s.user)?(this.userId=s.user.id,this.connect()):t==="SIGNED_OUT"&&(this.userId=null,this.disconnect())})}async connect(){console.log("WebSocket connection skipped - disabled in production")}getWebSocketUrl(){return"https://kvlaydeyqidlfpfutbmp.supabase.co".replace("https://","wss://")+"/realtime/v1/websocket"}scheduleReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached");return}const t=this.reconnectDelay*Math.pow(2,this.reconnectAttempts);this.reconnectAttempts++,console.log(`Scheduling reconnect attempt ${this.reconnectAttempts} in ${t}ms`),setTimeout(()=>{this.connect()},t)}disconnect(){this.ws&&(this.ws.close(1e3,"User disconnected"),this.ws=null),this.isConnecting=!1,this.reconnectAttempts=0}send(t){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(t)):console.warn("WebSocket not connected, cannot send message:",t)}handleMessage(t){(this.handlers.get(t.type)||[]).forEach(n=>{try{n(t)}catch(i){console.error("Error in WebSocket message handler:",i)}}),(this.handlers.get("all")||[]).forEach(n=>{try{n(t)}catch(i){console.error("Error in WebSocket all-events handler:",i)}})}subscribe(t,s){return this.handlers.has(t)||this.handlers.set(t,[]),this.handlers.get(t).push(s),()=>{const a=this.handlers.get(t);if(a){const n=a.indexOf(s);n>-1&&a.splice(n,1)}}}sendDocumentProcessingUpdate(t){this.send({type:"document_processing",payload:t,timestamp:new Date().toISOString(),userId:this.userId||void 0,documentId:t.documentId})}sendAIQueryUpdate(t){this.send({type:"ai_query",payload:t,timestamp:new Date().toISOString(),userId:this.userId||void 0})}sendSystemNotification(t){this.send({type:"system_notification",payload:t,timestamp:new Date().toISOString(),userId:this.userId||void 0})}get isConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}get connectionState(){if(!this.ws)return"disconnected";switch(this.ws.readyState){case WebSocket.CONNECTING:return"connecting";case WebSocket.OPEN:return"connected";case WebSocket.CLOSING:return"closing";case WebSocket.CLOSED:return"closed";default:return"unknown"}}}const h9=new u9,Zc=h9;function m9(){const r=p.useCallback(a=>{},[]),t=p.useCallback(a=>{},[]),s=p.useCallback(a=>{Zc.sendSystemNotification({id:`notification_${Date.now()}`,...a})},[]);return{simulateDocumentProcessing:r,simulateAIQuery:t,simulateSystemNotification:s}}const f9=({onUploadComplete:r,maxFiles:t=5})=>{const[s,a]=p.useState([]),[n,i]=p.useState(!1),[o,c]=p.useState(!1),{profile:d,loading:h}=ft(),{simulateDocumentProcessing:m}=m9(),f=p.useCallback(C=>{!d&&!h&&te.warning("Profile not fully loaded. Upload will proceed with default settings."),c(!0),(async()=>{try{if(d){const{usageTrackingService:I}=await Ns(async()=>{const{usageTrackingService:A}=await Promise.resolve().then(()=>an);return{usageTrackingService:A}},void 0),T=I.checkUsageLimit("document_upload"),O=new Promise((A,L)=>setTimeout(()=>L(new Error("Usage check timeout")),5e3)),U=await Promise.race([T,O]);if(!U.allowed){te.error(`Upload limit reached. You have used ${U.current}/${U.limit} document uploads this month. Please upgrade your plan to continue.`),c(!1);return}U.percentage>=80&&te.warning(`You have used ${U.current}/${U.limit} document uploads this month (${Math.round(U.percentage)}%).`)}else te.warning("Profile not loaded. Upload will proceed with default free tier limits.")}catch(I){console.error("Error checking usage limits:",I),te.warning("Unable to verify upload limits. Upload will proceed but may be subject to restrictions.")}c(!1),g(C)})()},[d]),g=p.useCallback(C=>{const k=d!=null&&d.subscription_tier?bi.maxSize[d.subscription_tier]:bi.maxSize.free,T=C.filter(O=>O.size>k?(te.error(`File ${O.name} is too large. Maximum size is ${Math.round(k/1024/1024)}MB`),!1):!0).map(O=>({file:O,id:crypto.randomUUID(),progress:0,status:"pending"}));a(O=>[...O,...T].slice(0,t))},[d,t]),{getRootProps:y,getInputProps:b,isDragActive:w}=Qm({onDrop:f,accept:{"application/pdf":[".pdf"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"text/plain":[".txt"]},maxFiles:t,disabled:n||o||h}),S=C=>{a(k=>k.filter(I=>I.id!==C))},N=(C,k)=>{a(I=>I.map(T=>T.id===C?{...T,documentType:k}:T))},v=async()=>{if(s.length!==0){i(!0);for(const C of s)if(!(C.status!=="pending"||!C.documentType))try{a(T=>T.map(O=>O.id===C.id?{...O,status:"uploading",progress:0,processingMessage:"Uploading file..."}:O));const k=await Ds.uploadDocument(C.file,C.documentType),{usageTrackingService:I}=await Ns(async()=>{const{usageTrackingService:T}=await Promise.resolve().then(()=>an);return{usageTrackingService:T}},void 0);await I.incrementUsage("document_upload",k.id,{filename:C.file.name,file_size:C.file.size,document_type:C.documentType}),a(T=>T.map(O=>O.id===C.id?{...O,status:"processing",progress:20,documentId:k.id,processingMessage:"Starting AI processing..."}:O)),Zc.sendDocumentProcessingUpdate({documentId:k.id,status:"processing",progress:20,message:"Starting AI processing..."}),await c9(C.file,k.id,T=>{a(O=>O.map(U=>U.id===C.id?{...U,progress:20+T.progress*.8,processingStage:T.stage,processingMessage:T.message}:U)),Zc.sendDocumentProcessingUpdate({documentId:k.id,status:"processing",progress:20+T.progress*.8,message:T.message,stage:T.stage})}),a(T=>T.map(O=>O.id===C.id?{...O,status:"completed",progress:100,processingMessage:"Processing completed!"}:O)),Zc.sendDocumentProcessingUpdate({documentId:k.id,status:"completed",progress:100,message:"Document processing completed successfully!"}),te.success(`${C.file.name} uploaded and processed successfully`),r&&r(k.id)}catch(k){console.error("Upload/processing error:",k),a(T=>T.map(O=>O.id===C.id?{...O,status:"error",error:k.message??"Upload or processing failed",processingMessage:"Failed"}:O));const I=s.find(T=>T.id===C.id);I!=null&&I.documentId&&Zc.sendDocumentProcessingUpdate({documentId:I.documentId,status:"failed",progress:0,message:"Document processing failed",error:k.message??"Upload or processing failed"}),te.error(`Failed to process ${C.file.name}: ${k.message}`)}i(!1)}},j=s.some(C=>C.status==="pending"&&C.documentType);return e.jsxs($,{className:"w-full",children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Upload Documents"}),e.jsx(ye,{children:"Upload your legal documents for AI-powered analysis and processing"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{...y(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${w?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${n||o||h||!d?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{...b()}),e.jsx(_r,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),h?e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Loading user profile..."}),e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})]}):o?e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Checking upload limits..."}),e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})]}):w?e.jsx("p",{className:"text-blue-600",children:"Drop the files here..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Drag & drop files here, or click to select files"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Supports PDF, DOC, DOCX, TXT files up to"," ",Math.round((d!=null&&d.subscription_tier?bi.maxSize[d.subscription_tier]:bi.maxSize.free)/1024/1024),"MB"]})]})]}),s.length>0&&e.jsx("div",{className:"space-y-3",children:s.map(C=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium",children:C.file.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",Math.round(C.file.size/1024)," KB)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[C.status==="completed"&&e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),C.status==="error"&&e.jsx(is,{className:"h-4 w-4 text-red-500"}),C.status==="pending"&&e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>S(C.id),children:e.jsx(Vs,{className:"h-4 w-4"})})]})]}),C.status==="pending"&&e.jsx("div",{className:"mb-2",children:e.jsxs(it,{value:C.documentType||"",onValueChange:k=>N(C.id,k),children:[e.jsx(rt,{className:"w-full",children:e.jsx(ot,{placeholder:"Select document type"})}),e.jsx(at,{children:Object.entries(dn).map(([k,I])=>e.jsx(ne,{value:k,children:I},k))})]})}),(C.status==="uploading"||C.status==="processing")&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:C.processingMessage||"Processing..."}),e.jsxs("span",{children:[Math.round(C.progress),"%"]})]}),e.jsx(na,{value:C.progress,className:"w-full"}),C.processingStage&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[C.processingStage==="ocr"&&e.jsx(Gt,{className:"h-3 w-3"}),C.processingStage==="analysis"&&e.jsx(ki,{className:"h-3 w-3"}),C.processingStage==="embedding"&&e.jsx(Nr,{className:"h-3 w-3"}),e.jsxs("span",{className:"capitalize",children:[C.processingStage," processing"]})]})]}),C.status==="error"&&C.error&&e.jsx(vt,{variant:"destructive",children:e.jsx(wt,{children:C.error})})]},C.id))}),s.length>0&&e.jsx(R,{onClick:v,disabled:!j||n,className:"w-full",children:n?"Uploading...":`Upload ${s.filter(C=>C.status==="pending").length} Files`})]})]})},Vb=({onUploadComplete:r,maxFiles:t=5})=>{const[s,a]=p.useState([]),[n,i]=p.useState(!1),o=h=>{const f=Array.from(h.target.files||[]).filter(g=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"].includes(g.type)?g.size>10485760?(te.error(`${g.name} is too large (max 10MB)`),!1):!0:(te.error(`${g.name} is not a supported file type`),!1));a(g=>[...g,...f].slice(0,t))},c=h=>{a(m=>m.filter((f,g)=>g!==h))},d=async()=>{if(s.length===0){te.error("Please select files to upload");return}i(!0);try{for(const h of s)await new Promise(m=>setTimeout(m,1e3)),console.log("Uploading file:",h.name),r&&r(`mock-id-${Date.now()}`);te.success(`Successfully uploaded ${s.length} file(s)`),a([])}catch(h){console.error("Upload error:",h),te.error("Upload failed. Please try again.")}finally{i(!1)}};return e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(_r,{className:"h-5 w-5 mr-2"}),"Document Upload (Fallback Mode)"]}),e.jsx(ye,{children:"Basic file upload functionality"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs(vt,{children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx(wt,{children:"Advanced upload features are temporarily unavailable. Using basic upload mode."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"file-input",className:"block text-sm font-medium",children:"Select Files"}),e.jsx("input",{id:"file-input",type:"file",multiple:!0,accept:".pdf,.doc,.docx,.txt",onChange:o,disabled:n,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports PDF, DOC, DOCX, TXT files up to 10MB each"})]}),s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Selected Files:"}),s.map((h,m)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:h.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",Math.round(h.size/1024)," KB)"]})]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>c(m),disabled:n,children:"Remove"})]},m))]}),e.jsx(R,{onClick:d,disabled:s.length===0||n,className:"w-full",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_r,{className:"h-4 w-4 mr-2"}),"Upload ",s.length," File(s)"]})})]})]})},p9=()=>e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(_r,{className:"h-5 w-5 mr-2"}),"Document Upload"]}),e.jsx(ye,{children:"Loading upload interface..."})]}),e.jsx(z,{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Initializing upload component..."})]})})]}),x9=({error:r,resetErrorBoundary:t})=>e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center text-red-600",children:[e.jsx(is,{className:"h-5 w-5 mr-2"}),"Upload Error"]}),e.jsx(ye,{children:"The upload component encountered an error"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs(vt,{variant:"destructive",children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx(wt,{children:r.message||"An unexpected error occurred while loading the upload component."})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Try Again"})}),e.jsxs("details",{className:"text-xs text-gray-500",children:[e.jsx("summary",{className:"cursor-pointer",children:"Technical Details"}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-100 rounded overflow-auto",children:r.stack})]})]})]}),Wb=r=>e.jsx(U2,{FallbackComponent:x9,onError:(t,s)=>{console.error("DocumentUpload Error:",t,s),typeof window<"u"&&window.gtag&&window.gtag("event","exception",{description:t.message,fatal:!1})},onReset:()=>{console.log("Resetting DocumentUpload component")},children:e.jsx(p.Suspense,{fallback:e.jsx(p9,{}),children:e.jsx(g9,{...r})})}),g9=r=>{const[t,s]=xe.useState(!0),[a,n]=xe.useState(!1);return xe.useEffect(()=>{n(!1)},[r]),a||!t?e.jsx(Vb,{...r}):e.jsx(U2,{FallbackComponent:()=>(n(!0),e.jsx(Vb,{...r})),onError:i=>{console.error("Main DocumentUpload failed, switching to fallback:",i),s(!1),n(!0)},children:e.jsx(f9,{...r})})},_d=GD,Nd=KD,y9=p.forwardRef(({className:r,inset:t,children:s,...a},n)=>e.jsxs(__,{ref:n,className:Ie("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",r),...a,children:[s,e.jsx(aN,{className:"ml-auto h-4 w-4"})]}));y9.displayName=__.displayName;const v9=p.forwardRef(({className:r,...t},s)=>e.jsx(N_,{ref:s,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t}));v9.displayName=N_.displayName;const Yl=p.forwardRef(({className:r,sideOffset:t=4,...s},a)=>e.jsx(HD,{children:e.jsx(S_,{ref:a,sideOffset:t,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...s})}));Yl.displayName=S_.displayName;const ur=p.forwardRef(({className:r,inset:t,...s},a)=>e.jsx(k_,{ref:a,className:Ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",r),...s}));ur.displayName=k_.displayName;const w9=p.forwardRef(({className:r,children:t,checked:s,...a},n)=>e.jsxs(C_,{ref:n,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:s,...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(E_,{children:e.jsx(sc,{className:"h-4 w-4"})})}),t]}));w9.displayName=C_.displayName;const j9=p.forwardRef(({className:r,children:t,...s},a)=>e.jsxs(A_,{ref:a,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(E_,{children:e.jsx(gh,{className:"h-2 w-2 fill-current"})})}),t]}));j9.displayName=A_.displayName;const sv=p.forwardRef(({className:r,inset:t,...s},a)=>e.jsx(T_,{ref:a,className:Ie("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",r),...s}));sv.displayName=T_.displayName;const Ro=p.forwardRef(({className:r,...t},s)=>e.jsx(R_,{ref:s,className:Ie("-mx-1 my-1 h-px bg-muted",r),...t}));Ro.displayName=R_.displayName;const rx=({onDocumentSelect:r,refreshTrigger:t})=>{const[s,a]=p.useState([]),[n,i]=p.useState(!0),[o,c]=p.useState(""),[d,h]=p.useState("all"),[m,f]=p.useState("all");p.useEffect(()=>{g()},[t]);const g=async()=>{try{i(!0);const v=await Ds.getDocuments();a(v)}catch(v){console.error("Error loading documents:",v),te.error("Failed to load documents")}finally{i(!1)}},y=async()=>{if(!o.trim()){g();return}try{i(!0);const v=await Ds.searchDocuments(o);a(v)}catch(v){console.error("Error searching documents:",v),te.error("Failed to search documents")}finally{i(!1)}},b=async v=>{if(confirm("Are you sure you want to delete this document?"))try{await Ds.deleteDocument(v),a(j=>j.filter(C=>C.id!==v)),te.success("Document deleted successfully")}catch(j){console.error("Error deleting document:",j),te.error("Failed to delete document")}},w=v=>{switch(v){case"pending":return e.jsx(us,{className:"h-4 w-4 text-yellow-500"});case"processing":return e.jsx(ds,{className:"h-4 w-4 text-blue-500 animate-spin"});case"completed":return e.jsx(Ue,{className:"h-4 w-4 text-green-500"});case"failed":return e.jsx(is,{className:"h-4 w-4 text-red-500"});default:return e.jsx(Fe,{className:"h-4 w-4 text-gray-500"})}},S=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},N=s.filter(v=>{const j=d==="all"||v.processing_status===d,C=m==="all"||v.document_type===m;return j&&C});return n&&s.length===0?e.jsx($,{children:e.jsx(z,{className:"flex items-center justify-center py-8",children:e.jsx(ds,{className:"h-8 w-8 animate-spin"})})}):e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Documents"}),e.jsx(ye,{children:"Manage and view your uploaded documents"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(Pe,{placeholder:"Search documents...",value:o,onChange:v=>c(v.target.value),onKeyPress:v=>v.key==="Enter"&&y()}),e.jsx(R,{onClick:y,variant:"outline",children:e.jsx(Yt,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(it,{value:d,onValueChange:h,children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All Status"}),Object.entries(Un).map(([v,j])=>e.jsx(ne,{value:v,children:j},v))]})]}),e.jsxs(it,{value:m,onValueChange:f,children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All Types"}),Object.entries(dn).map(([v,j])=>e.jsx(ne,{value:v,children:j},v))]})]})]})]}),N.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents found"}),e.jsx("p",{className:"text-gray-500",children:s.length===0?"Upload your first document to get started":"Try adjusting your search or filters"})]}):e.jsx("div",{className:"space-y-3",children:N.map(v=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(Fe,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:v.filename}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:dn[v.document_type]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[Math.round(v.file_size/1024)," KB"]}),e.jsx("span",{className:"text-xs text-gray-500",children:Vt(new Date(v.created_at),{addSuffix:!0})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[w(v.processing_status),e.jsx(ae,{className:S(v.processing_status),children:Un[v.processing_status]})]}),e.jsxs(_d,{children:[e.jsx(Nd,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"sm",children:e.jsx(U5,{className:"h-4 w-4"})})}),e.jsxs(Yl,{align:"end",children:[e.jsxs(ur,{onClick:()=>r==null?void 0:r(v),children:[e.jsx(Gt,{className:"mr-2 h-4 w-4"}),"View"]}),e.jsxs(ur,{onClick:()=>window.open(v.file_url,"_blank"),children:[e.jsx(fs,{className:"mr-2 h-4 w-4"}),"Download"]}),e.jsxs(ur,{onClick:()=>b(v.id),className:"text-red-600",children:[e.jsx(Ln,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]})},v.id))})]})]})};function Hb(r,t){if(typeof r=="function")return r(t);r!=null&&(r.current=t)}function TC(...r){return t=>{let s=!1;const a=r.map(n=>{const i=Hb(n,t);return!s&&typeof i=="function"&&(s=!0),i});if(s)return()=>{for(let n=0;n<a.length;n++){const i=a[n];typeof i=="function"?i():Hb(r[n],null)}}}}function zo(...r){return p.useCallback(TC(...r),r)}function b9(r){const t=_9(r),s=p.forwardRef((a,n)=>{const{children:i,...o}=a,c=p.Children.toArray(i),d=c.find(S9);if(d){const h=d.props.children,m=c.map(f=>f===d?p.Children.count(h)>1?p.Children.only(null):p.isValidElement(h)?h.props.children:null:f);return e.jsx(t,{...o,ref:n,children:p.isValidElement(h)?p.cloneElement(h,void 0,m):null})}return e.jsx(t,{...o,ref:n,children:i})});return s.displayName=`${r}.Slot`,s}function _9(r){const t=p.forwardRef((s,a)=>{const{children:n,...i}=s;if(p.isValidElement(n)){const o=C9(n),c=k9(i,n.props);return n.type!==p.Fragment&&(c.ref=a?TC(a,o):o),p.cloneElement(n,c)}return p.Children.count(n)>1?p.Children.only(null):null});return t.displayName=`${r}.SlotClone`,t}var N9=Symbol("radix.slottable");function S9(r){return p.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===N9}function k9(r,t){const s={...t};for(const a in t){const n=r[a],i=t[a];/^on[A-Z]/.test(a)?n&&i?s[a]=(...c)=>{const d=i(...c);return n(...c),d}:n&&(s[a]=n):a==="style"?s[a]={...n,...i}:a==="className"&&(s[a]=[n,i].filter(Boolean).join(" "))}return{...r,...s}}function C9(r){var a,n;let t=(a=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:a.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?r.ref:(t=(n=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:n.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}var E9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Yd=E9.reduce((r,t)=>{const s=b9(`Primitive.${t}`),a=p.forwardRef((n,i)=>{const{asChild:o,...c}=n,d=o?s:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:i})});return a.displayName=`Primitive.${t}`,{...r,[t]:a}},{}),Ig=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{};function A9(r,t){return p.useReducer((s,a)=>t[s][a]??s,r)}var Jd=r=>{const{present:t,children:s}=r,a=T9(t),n=typeof s=="function"?s({present:a.isPresent}):p.Children.only(s),i=zo(a.ref,R9(n));return typeof s=="function"||a.isPresent?p.cloneElement(n,{ref:i}):null};Jd.displayName="Presence";function T9(r){const[t,s]=p.useState(),a=p.useRef(null),n=p.useRef(r),i=p.useRef("none"),o=r?"mounted":"unmounted",[c,d]=A9(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const h=uh(a.current);i.current=c==="mounted"?h:"none"},[c]),Ig(()=>{const h=a.current,m=n.current;if(m!==r){const g=i.current,y=uh(h);r?d("MOUNT"):y==="none"||(h==null?void 0:h.display)==="none"?d("UNMOUNT"):d(m&&g!==y?"ANIMATION_OUT":"UNMOUNT"),n.current=r}},[r,d]),Ig(()=>{if(t){let h;const m=t.ownerDocument.defaultView??window,f=y=>{const w=uh(a.current).includes(y.animationName);if(y.target===t&&w&&(d("ANIMATION_END"),!n.current)){const S=t.style.animationFillMode;t.style.animationFillMode="forwards",h=m.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=S)})}},g=y=>{y.target===t&&(i.current=uh(a.current))};return t.addEventListener("animationstart",g),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{m.clearTimeout(h),t.removeEventListener("animationstart",g),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:p.useCallback(h=>{a.current=h?getComputedStyle(h):null,s(h)},[])}}function uh(r){return(r==null?void 0:r.animationName)||"none"}function R9(r){var a,n;let t=(a=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:a.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?r.ref:(t=(n=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:n.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?r.props.ref:r.props.ref||r.ref)}function P9(r,t=[]){let s=[];function a(i,o){const c=p.createContext(o),d=s.length;s=[...s,o];const h=f=>{var N;const{scope:g,children:y,...b}=f,w=((N=g==null?void 0:g[r])==null?void 0:N[d])||c,S=p.useMemo(()=>b,Object.values(b));return e.jsx(w.Provider,{value:S,children:y})};h.displayName=i+"Provider";function m(f,g){var w;const y=((w=g==null?void 0:g[r])==null?void 0:w[d])||c,b=p.useContext(y);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[h,m]}const n=()=>{const i=s.map(o=>p.createContext(o));return function(c){const d=(c==null?void 0:c[r])||i;return p.useMemo(()=>({[`__scope${r}`]:{...c,[r]:d}}),[c,d])}};return n.scopeName=r,[a,I9(n,...t)]}function I9(...r){const t=r[0];if(r.length===1)return t;const s=()=>{const a=r.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(i){const o=a.reduce((c,{useScope:d,scopeName:h})=>{const f=d(i)[`__scope${h}`];return{...c,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return s.scopeName=t.scopeName,s}function lo(r){const t=p.useRef(r);return p.useEffect(()=>{t.current=r}),p.useMemo(()=>(...s)=>{var a;return(a=t.current)==null?void 0:a.call(t,...s)},[])}var D9=p.createContext(void 0);function F9(r){const t=p.useContext(D9);return r||t||"ltr"}function O9(r,[t,s]){return Math.min(s,Math.max(t,r))}function bo(r,t,{checkForDefaultPrevented:s=!0}={}){return function(n){if(r==null||r(n),s===!1||!n.defaultPrevented)return t==null?void 0:t(n)}}function M9(r,t){return p.useReducer((s,a)=>t[s][a]??s,r)}var rv="ScrollArea",[RC,QW]=P9(rv),[L9,Ta]=RC(rv),PC=p.forwardRef((r,t)=>{const{__scopeScrollArea:s,type:a="hover",dir:n,scrollHideDelay:i=600,...o}=r,[c,d]=p.useState(null),[h,m]=p.useState(null),[f,g]=p.useState(null),[y,b]=p.useState(null),[w,S]=p.useState(null),[N,v]=p.useState(0),[j,C]=p.useState(0),[k,I]=p.useState(!1),[T,O]=p.useState(!1),U=zo(t,L=>d(L)),A=F9(n);return e.jsx(L9,{scope:s,type:a,dir:A,scrollHideDelay:i,scrollArea:c,viewport:h,onViewportChange:m,content:f,onContentChange:g,scrollbarX:y,onScrollbarXChange:b,scrollbarXEnabled:k,onScrollbarXEnabledChange:I,scrollbarY:w,onScrollbarYChange:S,scrollbarYEnabled:T,onScrollbarYEnabledChange:O,onCornerWidthChange:v,onCornerHeightChange:C,children:e.jsx(Yd.div,{dir:A,...o,ref:U,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":j+"px",...r.style}})})});PC.displayName=rv;var IC="ScrollAreaViewport",DC=p.forwardRef((r,t)=>{const{__scopeScrollArea:s,children:a,nonce:n,...i}=r,o=Ta(IC,s),c=p.useRef(null),d=zo(t,c,o.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(Yd.div,{"data-radix-scroll-area-viewport":"",...i,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...r.style},children:e.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});DC.displayName=IC;var hn="ScrollAreaScrollbar",av=p.forwardRef((r,t)=>{const{forceMount:s,...a}=r,n=Ta(hn,r.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=n,c=r.orientation==="horizontal";return p.useEffect(()=>(c?i(!0):o(!0),()=>{c?i(!1):o(!1)}),[c,i,o]),n.type==="hover"?e.jsx(U9,{...a,ref:t,forceMount:s}):n.type==="scroll"?e.jsx($9,{...a,ref:t,forceMount:s}):n.type==="auto"?e.jsx(FC,{...a,ref:t,forceMount:s}):n.type==="always"?e.jsx(nv,{...a,ref:t}):null});av.displayName=hn;var U9=p.forwardRef((r,t)=>{const{forceMount:s,...a}=r,n=Ta(hn,r.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const c=n.scrollArea;let d=0;if(c){const h=()=>{window.clearTimeout(d),o(!0)},m=()=>{d=window.setTimeout(()=>o(!1),n.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",m),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",m)}}},[n.scrollArea,n.scrollHideDelay]),e.jsx(Jd,{present:s||i,children:e.jsx(FC,{"data-state":i?"visible":"hidden",...a,ref:t})})}),$9=p.forwardRef((r,t)=>{const{forceMount:s,...a}=r,n=Ta(hn,r.__scopeScrollArea),i=r.orientation==="horizontal",o=af(()=>d("SCROLL_END"),100),[c,d]=M9("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>d("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,n.scrollHideDelay,d]),p.useEffect(()=>{const h=n.viewport,m=i?"scrollLeft":"scrollTop";if(h){let f=h[m];const g=()=>{const y=h[m];f!==y&&(d("SCROLL"),o()),f=y};return h.addEventListener("scroll",g),()=>h.removeEventListener("scroll",g)}},[n.viewport,i,d,o]),e.jsx(Jd,{present:s||c!=="hidden",children:e.jsx(nv,{"data-state":c==="hidden"?"hidden":"visible",...a,ref:t,onPointerEnter:bo(r.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:bo(r.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),FC=p.forwardRef((r,t)=>{const s=Ta(hn,r.__scopeScrollArea),{forceMount:a,...n}=r,[i,o]=p.useState(!1),c=r.orientation==="horizontal",d=af(()=>{if(s.viewport){const h=s.viewport.offsetWidth<s.viewport.scrollWidth,m=s.viewport.offsetHeight<s.viewport.scrollHeight;o(c?h:m)}},10);return Jl(s.viewport,d),Jl(s.content,d),e.jsx(Jd,{present:a||i,children:e.jsx(nv,{"data-state":i?"visible":"hidden",...n,ref:t})})}),nv=p.forwardRef((r,t)=>{const{orientation:s="vertical",...a}=r,n=Ta(hn,r.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[c,d]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=$C(c.viewport,c.content),m={...a,sizes:c,onSizesChange:d,hasThumb:h>0&&h<1,onThumbChange:g=>i.current=g,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:g=>o.current=g};function f(g,y){return H9(g,o.current,c,y)}return s==="horizontal"?e.jsx(z9,{...m,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){const g=n.viewport.scrollLeft,y=Gb(g,c,n.dir);i.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:g=>{n.viewport&&(n.viewport.scrollLeft=g)},onDragScroll:g=>{n.viewport&&(n.viewport.scrollLeft=f(g,n.dir))}}):s==="vertical"?e.jsx(B9,{...m,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){const g=n.viewport.scrollTop,y=Gb(g,c);i.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:g=>{n.viewport&&(n.viewport.scrollTop=g)},onDragScroll:g=>{n.viewport&&(n.viewport.scrollTop=f(g))}}):null}),z9=p.forwardRef((r,t)=>{const{sizes:s,onSizesChange:a,...n}=r,i=Ta(hn,r.__scopeScrollArea),[o,c]=p.useState(),d=p.useRef(null),h=zo(t,d,i.onScrollbarXChange);return p.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(MC,{"data-orientation":"horizontal",...n,ref:h,sizes:s,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":rf(s)+"px",...r.style},onThumbPointerDown:m=>r.onThumbPointerDown(m.x),onDragScroll:m=>r.onDragScroll(m.x),onWheelScroll:(m,f)=>{if(i.viewport){const g=i.viewport.scrollLeft+m.deltaX;r.onWheelScroll(g),BC(g,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&a({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:hm(o.paddingLeft),paddingEnd:hm(o.paddingRight)}})}})}),B9=p.forwardRef((r,t)=>{const{sizes:s,onSizesChange:a,...n}=r,i=Ta(hn,r.__scopeScrollArea),[o,c]=p.useState(),d=p.useRef(null),h=zo(t,d,i.onScrollbarYChange);return p.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(MC,{"data-orientation":"vertical",...n,ref:h,sizes:s,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":rf(s)+"px",...r.style},onThumbPointerDown:m=>r.onThumbPointerDown(m.y),onDragScroll:m=>r.onDragScroll(m.y),onWheelScroll:(m,f)=>{if(i.viewport){const g=i.viewport.scrollTop+m.deltaY;r.onWheelScroll(g),BC(g,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&a({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:hm(o.paddingTop),paddingEnd:hm(o.paddingBottom)}})}})}),[q9,OC]=RC(hn),MC=p.forwardRef((r,t)=>{const{__scopeScrollArea:s,sizes:a,hasThumb:n,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:h,onWheelScroll:m,onResize:f,...g}=r,y=Ta(hn,s),[b,w]=p.useState(null),S=zo(t,U=>w(U)),N=p.useRef(null),v=p.useRef(""),j=y.viewport,C=a.content-a.viewport,k=lo(m),I=lo(d),T=af(f,10);function O(U){if(N.current){const A=U.clientX-N.current.left,L=U.clientY-N.current.top;h({x:A,y:L})}}return p.useEffect(()=>{const U=A=>{const L=A.target;(b==null?void 0:b.contains(L))&&k(A,C)};return document.addEventListener("wheel",U,{passive:!1}),()=>document.removeEventListener("wheel",U,{passive:!1})},[j,b,C,k]),p.useEffect(I,[a,I]),Jl(b,T),Jl(y.content,T),e.jsx(q9,{scope:s,scrollbar:b,hasThumb:n,onThumbChange:lo(i),onThumbPointerUp:lo(o),onThumbPositionChange:I,onThumbPointerDown:lo(c),children:e.jsx(Yd.div,{...g,ref:S,style:{position:"absolute",...g.style},onPointerDown:bo(r.onPointerDown,U=>{U.button===0&&(U.target.setPointerCapture(U.pointerId),N.current=b.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),O(U))}),onPointerMove:bo(r.onPointerMove,O),onPointerUp:bo(r.onPointerUp,U=>{const A=U.target;A.hasPointerCapture(U.pointerId)&&A.releasePointerCapture(U.pointerId),document.body.style.webkitUserSelect=v.current,y.viewport&&(y.viewport.style.scrollBehavior=""),N.current=null})})})}),um="ScrollAreaThumb",LC=p.forwardRef((r,t)=>{const{forceMount:s,...a}=r,n=OC(um,r.__scopeScrollArea);return e.jsx(Jd,{present:s||n.hasThumb,children:e.jsx(V9,{ref:t,...a})})}),V9=p.forwardRef((r,t)=>{const{__scopeScrollArea:s,style:a,...n}=r,i=Ta(um,s),o=OC(um,s),{onThumbPositionChange:c}=o,d=zo(t,f=>o.onThumbChange(f)),h=p.useRef(void 0),m=af(()=>{h.current&&(h.current(),h.current=void 0)},100);return p.useEffect(()=>{const f=i.viewport;if(f){const g=()=>{if(m(),!h.current){const y=G9(f,c);h.current=y,c()}};return c(),f.addEventListener("scroll",g),()=>f.removeEventListener("scroll",g)}},[i.viewport,m,c]),e.jsx(Yd.div,{"data-state":o.hasThumb?"visible":"hidden",...n,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:bo(r.onPointerDownCapture,f=>{const y=f.target.getBoundingClientRect(),b=f.clientX-y.left,w=f.clientY-y.top;o.onThumbPointerDown({x:b,y:w})}),onPointerUp:bo(r.onPointerUp,o.onThumbPointerUp)})});LC.displayName=um;var iv="ScrollAreaCorner",UC=p.forwardRef((r,t)=>{const s=Ta(iv,r.__scopeScrollArea),a=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&a?e.jsx(W9,{...r,ref:t}):null});UC.displayName=iv;var W9=p.forwardRef((r,t)=>{const{__scopeScrollArea:s,...a}=r,n=Ta(iv,s),[i,o]=p.useState(0),[c,d]=p.useState(0),h=!!(i&&c);return Jl(n.scrollbarX,()=>{var f;const m=((f=n.scrollbarX)==null?void 0:f.offsetHeight)||0;n.onCornerHeightChange(m),d(m)}),Jl(n.scrollbarY,()=>{var f;const m=((f=n.scrollbarY)==null?void 0:f.offsetWidth)||0;n.onCornerWidthChange(m),o(m)}),h?e.jsx(Yd.div,{...a,ref:t,style:{width:i,height:c,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function hm(r){return r?parseInt(r,10):0}function $C(r,t){const s=r/t;return isNaN(s)?0:s}function rf(r){const t=$C(r.viewport,r.content),s=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,a=(r.scrollbar.size-s)*t;return Math.max(a,18)}function H9(r,t,s,a="ltr"){const n=rf(s),i=n/2,o=t||i,c=n-o,d=s.scrollbar.paddingStart+o,h=s.scrollbar.size-s.scrollbar.paddingEnd-c,m=s.content-s.viewport,f=a==="ltr"?[0,m]:[m*-1,0];return zC([d,h],f)(r)}function Gb(r,t,s="ltr"){const a=rf(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-n,o=t.content-t.viewport,c=i-a,d=s==="ltr"?[0,o]:[o*-1,0],h=O9(r,d);return zC([0,o],[0,c])(h)}function zC(r,t){return s=>{if(r[0]===r[1]||t[0]===t[1])return t[0];const a=(t[1]-t[0])/(r[1]-r[0]);return t[0]+a*(s-r[0])}}function BC(r,t){return r>0&&r<t}var G9=(r,t=()=>{})=>{let s={left:r.scrollLeft,top:r.scrollTop},a=0;return function n(){const i={left:r.scrollLeft,top:r.scrollTop},o=s.left!==i.left,c=s.top!==i.top;(o||c)&&t(),s=i,a=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(a)};function af(r,t){const s=lo(r),a=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(a.current),[]),p.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(s,t)},[s,t])}function Jl(r,t){const s=lo(t);Ig(()=>{let a=0;if(r){const n=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(s)});return n.observe(r),()=>{window.cancelAnimationFrame(a),n.unobserve(r)}}},[r,s])}var qC=PC,K9=DC,Q9=UC;const Po=p.forwardRef(({className:r,children:t,...s},a)=>e.jsxs(qC,{ref:a,className:Ie("relative overflow-hidden",r),...s,children:[e.jsx(K9,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(VC,{}),e.jsx(Q9,{})]}));Po.displayName=qC.displayName;const VC=p.forwardRef(({className:r,orientation:t="vertical",...s},a)=>e.jsx(av,{ref:a,orientation:t,className:Ie("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...s,children:e.jsx(LC,{className:"relative flex-1 rounded-full bg-border"})}));VC.displayName=av.displayName;const Y9=({document:r,className:t=""})=>{const[s,a]=p.useState(null),[n,i]=p.useState(""),[o,c]=p.useState(null),[d,h]=p.useState(!1),[m,f]=p.useState(0),[g,y]=p.useState("overview");p.useEffect(()=>{if(r.document_structure&&typeof r.document_structure=="object"){const v=r.document_structure.analysis;v&&a(v)}},[r]);const b=async()=>{if(!r.ocr_text){te.error("No text content available for analysis");return}h(!0),f(0);try{f(20);const v=await ev(r.ocr_text);a(v),f(50);const j=await o9(r.ocr_text,800);i(j),f(80);const C=await l9(r.ocr_text);c(C),f(100),te.success("Document analysis completed successfully")}catch(v){console.error("Analysis error:",v),te.error("Failed to analyze document: "+v.message)}finally{h(!1)}},w=()=>{const v={document:{filename:r.filename,type:r.document_type,uploadDate:r.created_at},analysis:s,summary:n,entities:o,generatedAt:new Date().toISOString()},j=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),C=URL.createObjectURL(j),k=r.createElement("a");k.href=C,k.download=`${r.filename}_analysis.json`,r.body.appendChild(k),k.click(),r.body.removeChild(k),URL.revokeObjectURL(C)},S=v=>v>=.8?"text-green-600":v>=.6?"text-yellow-600":"text-red-600",N=v=>v>=.8?"High":v>=.6?"Medium":"Low";return e.jsxs($,{className:t,children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(ki,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{children:"AI Document Analysis"})]}),e.jsxs(ye,{children:["AI-powered analysis of ",r.filename]})]}),e.jsxs("div",{className:"flex space-x-2",children:[(s||n||o)&&e.jsxs(R,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsx(R,{onClick:b,disabled:d||!r.ocr_text,size:"sm",children:d?e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(mr,{className:"h-4 w-4 mr-2"}),s?"Re-analyze":"Analyze"]})})]})]})}),e.jsxs(z,{className:"space-y-4",children:[!r.ocr_text&&e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:"No text content available. Please ensure the document has been processed with OCR."})]}),d&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Analyzing document..."}),e.jsxs("span",{children:[m,"%"]})]}),e.jsx(na,{value:m,className:"w-full"})]}),(s||n||o)&&e.jsxs(fr,{value:g,onValueChange:y,children:[e.jsxs(nr,{className:"grid w-full grid-cols-4",children:[e.jsx(Ge,{value:"overview",children:"Overview"}),e.jsx(Ge,{value:"summary",children:"Summary"}),e.jsx(Ge,{value:"entities",children:"Entities"}),e.jsx(Ge,{value:"insights",children:"Insights"})]}),e.jsxs(He,{value:"overview",className:"space-y-4",children:[s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsx(X,{className:"text-sm",children:"Document Classification"})}),e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{variant:"secondary",children:s.documentType}),e.jsxs("div",{className:`text-sm ${S(s.confidence)}`,children:[N(s.confidence)," confidence"]})]})})]}),e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsx(X,{className:"text-sm",children:"Key Entities"})}),e.jsx(z,{children:e.jsx("div",{className:"text-sm text-gray-600",children:s.keyEntities.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.keyEntities.slice(0,3).map((v,j)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:v},j)),s.keyEntities.length>3&&e.jsxs(ae,{variant:"outline",className:"text-xs",children:["+",s.keyEntities.length-3," more"]})]}):"No key entities identified"})})]})]}),s&&e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsx(X,{className:"text-sm",children:"Executive Summary"})}),e.jsx(z,{children:e.jsx("p",{className:"text-sm text-gray-700",children:s.summary})})]})]}),e.jsx(He,{value:"summary",className:"space-y-4",children:n?e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsx(X,{className:"text-sm",children:"Document Summary"})}),e.jsx(z,{children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:n})})})]}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(Fe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:'No summary available. Click "Analyze" to generate one.'})]})}),e.jsx(He,{value:"entities",className:"space-y-4",children:o?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsx("span",{children:"People"})]})}),e.jsx(z,{children:o.people.length>0?e.jsx("div",{className:"space-y-1",children:o.people.map((v,j)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:v},j))}):e.jsx("p",{className:"text-sm text-gray-500",children:"None identified"})})]}),e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:"Organizations"})]})}),e.jsx(z,{children:o.organizations.length>0?e.jsx("div",{className:"space-y-1",children:o.organizations.map((v,j)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:v},j))}):e.jsx("p",{className:"text-sm text-gray-500",children:"None identified"})})]}),e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(ln,{className:"h-4 w-4"}),e.jsx("span",{children:"Dates"})]})}),e.jsx(z,{children:o.dates.length>0?e.jsx("div",{className:"space-y-1",children:o.dates.map((v,j)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:v},j))}):e.jsx("p",{className:"text-sm text-gray-500",children:"None identified"})})]}),e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(Ph,{className:"h-4 w-4"}),e.jsx("span",{children:"Amounts"})]})}),e.jsx(z,{children:o.amounts.length>0?e.jsx("div",{className:"space-y-1",children:o.amounts.map((v,j)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:v},j))}):e.jsx("p",{className:"text-sm text-gray-500",children:"None identified"})})]}),e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(ia,{className:"h-4 w-4"}),e.jsx("span",{children:"Locations"})]})}),e.jsx(z,{children:o.locations.length>0?e.jsx("div",{className:"space-y-1",children:o.locations.map((v,j)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:v},j))}):e.jsx("p",{className:"text-sm text-gray-500",children:"None identified"})})]})]}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(es,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:'No entities extracted. Click "Analyze" to extract entities.'})]})}),e.jsx(He,{value:"insights",className:"space-y-4",children:s&&e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsx(X,{className:"text-sm",children:"Legal Implications"})}),e.jsx(z,{children:s.legalImplications.length>0?e.jsx("ul",{className:"space-y-2",children:s.legalImplications.map((v,j)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(It,{className:"h-4 w-4 text-yellow-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:v})]},j))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No legal implications identified"})})]}),e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsx(X,{className:"text-sm",children:"Recommended Actions"})}),e.jsx(z,{children:s.recommendedActions.length>0?e.jsx("ul",{className:"space-y-2",children:s.recommendedActions.map((v,j)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:v})]},j))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No specific actions recommended"})})]})]})})]}),!s&&!n&&!o&&!d&&r.ocr_text&&e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(ki,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"mb-4",children:"Ready to analyze this document with AI"}),e.jsxs(R,{onClick:b,children:[e.jsx(ki,{className:"h-4 w-4 mr-2"}),"Start Analysis"]})]})]})]})};var ov="Popover",[WC,YW]=Io(ov,[ec]),Zd=ec(),[J9,qi]=WC(ov),HC=r=>{const{__scopePopover:t,children:s,open:a,defaultOpen:n,onOpenChange:i,modal:o=!1}=r,c=Zd(t),d=p.useRef(null),[h,m]=p.useState(!1),[f=!1,g]=_o({prop:a,defaultProp:n,onChange:i});return e.jsx(Lg,{...c,children:e.jsx(J9,{scope:t,contentId:Id(),triggerRef:d,open:f,onOpenChange:g,onOpenToggle:p.useCallback(()=>g(y=>!y),[g]),hasCustomAnchor:h,onCustomAnchorAdd:p.useCallback(()=>m(!0),[]),onCustomAnchorRemove:p.useCallback(()=>m(!1),[]),modal:o,children:s})})};HC.displayName=ov;var GC="PopoverAnchor",Z9=p.forwardRef((r,t)=>{const{__scopePopover:s,...a}=r,n=qi(GC,s),i=Zd(s),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=n;return p.useEffect(()=>(o(),()=>c()),[o,c]),e.jsx(fm,{...i,...a,ref:t})});Z9.displayName=GC;var KC="PopoverTrigger",QC=p.forwardRef((r,t)=>{const{__scopePopover:s,...a}=r,n=qi(KC,s),i=Zd(s),o=Ys(t,n.triggerRef),c=e.jsx(zt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":eE(n.open),...a,ref:o,onClick:Nt(r.onClick,n.onOpenToggle)});return n.hasCustomAnchor?c:e.jsx(fm,{asChild:!0,...i,children:c})});QC.displayName=KC;var lv="PopoverPortal",[X9,eV]=WC(lv,{forceMount:void 0}),YC=r=>{const{__scopePopover:t,forceMount:s,children:a,container:n}=r,i=qi(lv,t);return e.jsx(X9,{scope:t,forceMount:s,children:e.jsx(Pd,{present:s||i.open,children:e.jsx(Dg,{asChild:!0,container:n,children:a})})})};YC.displayName=lv;var Zl="PopoverContent",JC=p.forwardRef((r,t)=>{const s=eV(Zl,r.__scopePopover),{forceMount:a=s.forceMount,...n}=r,i=qi(Zl,r.__scopePopover);return e.jsx(Pd,{present:a||i.open,children:i.modal?e.jsx(tV,{...n,ref:t}):e.jsx(sV,{...n,ref:t})})});JC.displayName=Zl;var tV=p.forwardRef((r,t)=>{const s=qi(Zl,r.__scopePopover),a=p.useRef(null),n=Ys(t,a),i=p.useRef(!1);return p.useEffect(()=>{const o=a.current;if(o)return v_(o)},[]),e.jsx(j_,{as:pm,allowPinchZoom:!0,children:e.jsx(ZC,{...r,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Nt(r.onCloseAutoFocus,o=>{var c;o.preventDefault(),i.current||(c=s.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Nt(r.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,h=c.button===2||d;i.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:Nt(r.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),sV=p.forwardRef((r,t)=>{const s=qi(Zl,r.__scopePopover),a=p.useRef(!1),n=p.useRef(!1);return e.jsx(ZC,{...r,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=r.onCloseAutoFocus)==null||o.call(r,i),i.defaultPrevented||(a.current||(c=s.triggerRef.current)==null||c.focus(),i.preventDefault()),a.current=!1,n.current=!1},onInteractOutside:i=>{var d,h;(d=r.onInteractOutside)==null||d.call(r,i),i.defaultPrevented||(a.current=!0,i.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const o=i.target;((h=s.triggerRef.current)==null?void 0:h.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&n.current&&i.preventDefault()}})}),ZC=p.forwardRef((r,t)=>{const{__scopePopover:s,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:m,...f}=r,g=qi(Zl,s),y=Zd(s);return w_(),e.jsx(b_,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:n,onUnmountAutoFocus:i,children:e.jsx(Fg,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:m,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h,onDismiss:()=>g.onOpenChange(!1),children:e.jsx(Og,{"data-state":eE(g.open),role:"dialog",id:g.contentId,...y,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),XC="PopoverClose",rV=p.forwardRef((r,t)=>{const{__scopePopover:s,...a}=r,n=qi(XC,s);return e.jsx(zt.button,{type:"button",...a,ref:t,onClick:Nt(r.onClick,()=>n.onOpenChange(!1))})});rV.displayName=XC;var aV="PopoverArrow",nV=p.forwardRef((r,t)=>{const{__scopePopover:s,...a}=r,n=Zd(s);return e.jsx(Mg,{...n,...a,ref:t})});nV.displayName=aV;function eE(r){return r?"open":"closed"}var iV=HC,oV=QC,lV=YC,tE=JC;const Sd=iV,kd=oV,Xl=p.forwardRef(({className:r,align:t="center",sideOffset:s=4,...a},n)=>e.jsx(lV,{children:e.jsx(tE,{ref:n,align:t,sideOffset:s,className:Ie("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...a})}));Xl.displayName=tE.displayName;class cV{async getDocumentAnnotations(t){const{data:s,error:a}=await D.from("document_annotations").select("*").eq("document_id",t).order("created_at",{ascending:!0});if(a)throw new Error(`Failed to fetch annotations: ${a.message}`);return s||[]}async createAnnotation(t){const{data:s}=await D.auth.getUser();if(!s.user)throw new Error("User not authenticated");const{data:a,error:n}=await D.from("document_annotations").insert({...t,user_id:s.user.id,is_resolved:!1}).select().single();if(n)throw new Error(`Failed to create annotation: ${n.message}`);return a}async updateAnnotation(t,s){const{data:a,error:n}=await D.from("document_annotations").update(s).eq("id",t).select().single();if(n)throw new Error(`Failed to update annotation: ${n.message}`);return a}async deleteAnnotation(t){const{error:s}=await D.from("document_annotations").delete().eq("id",t);if(s)throw new Error(`Failed to delete annotation: ${s.message}`)}subscribeToAnnotations(t,s){return D.channel(`annotations:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"document_annotations",filter:`document_id=eq.${t}`},s).subscribe()}async getDocumentCollaborators(t){const{data:s,error:a}=await D.from("annotation_collaborators").select(`
        *,
        user:profiles!annotation_collaborators_user_id_fkey(id, email, first_name, last_name),
        invited_by_user:profiles!annotation_collaborators_invited_by_fkey(id, email, first_name, last_name)
      `).eq("document_id",t);if(a)throw new Error(`Failed to fetch collaborators: ${a.message}`);return s||[]}async inviteCollaborator(t){var o;const{data:s,error:a}=await D.from("profiles").select("id").eq("email",t.email).single();if(a||!s)throw new Error("User not found with this email address");const{data:n,error:i}=await D.from("annotation_collaborators").insert({document_id:t.document_id,user_id:s.id,permission_level:t.permission_level,invited_by:(o=(await D.auth.getUser()).data.user)==null?void 0:o.id}).select().single();if(i)throw new Error(`Failed to invite collaborator: ${i.message}`);return n}async removeCollaborator(t){const{error:s}=await D.from("annotation_collaborators").delete().eq("id",t);if(s)throw new Error(`Failed to remove collaborator: ${s.message}`)}async updateCollaboratorPermission(t,s){const{data:a,error:n}=await D.from("annotation_collaborators").update({permission_level:s}).eq("id",t).select().single();if(n)throw new Error(`Failed to update permission: ${n.message}`);return a}async createReply(t){const{data:s}=await D.auth.getUser();if(!s.user)throw new Error("User not authenticated");const{data:a,error:n}=await D.from("annotation_replies").insert({...t,user_id:s.user.id}).select(`
        *,
        user:profiles!annotation_replies_user_id_fkey(id, email, first_name, last_name)
      `).single();if(n)throw new Error(`Failed to create reply: ${n.message}`);return a}}const Dn=new cV;function dV(r,t){const s=qn(),{data:a=[],isLoading:n,error:i,refetch:o}=Fo({queryKey:["annotations",r,t],queryFn:()=>Dn.getDocumentAnnotations(r,t),enabled:!!r,staleTime:3e4}),c=oa({mutationFn:Dn.createAnnotation,onSuccess:y=>{s.setQueryData(["annotations",r,t],(b=[])=>[...b,y]),te.success("Annotation created successfully")},onError:y=>{te.error(`Failed to create annotation: ${y.message}`)}}),d=oa({mutationFn:({id:y,data:b})=>Dn.updateAnnotation(y,b),onSuccess:y=>{s.setQueryData(["annotations",r,t],(b=[])=>b.map(w=>w.id===y.id?y:w)),te.success("Annotation updated successfully")},onError:y=>{te.error(`Failed to update annotation: ${y.message}`)}}),h=oa({mutationFn:Dn.deleteAnnotation,onSuccess:(y,b)=>{s.setQueryData(["annotations",r,t],(w=[])=>w.filter(S=>S.id!==b)),te.success("Annotation deleted successfully")},onError:y=>{te.error(`Failed to delete annotation: ${y.message}`)}}),m=p.useCallback(y=>c.mutateAsync(y),[c]),f=p.useCallback((y,b)=>d.mutateAsync({id:y,data:b}),[d]),g=p.useCallback(y=>h.mutateAsync(y),[h]);return{annotations:a,isLoading:n,error:i,refetch:o,createAnnotation:m,updateAnnotation:f,deleteAnnotation:g,isCreating:c.isPending,isUpdating:d.isPending,isDeleting:h.isPending}}function JW(r){const t=qn(),s=oa({mutationFn:Dn.addComment,onSuccess:d=>{t.setQueriesData({queryKey:["annotations"]},(h=[])=>h.map(m=>m.id===r?{...m,comments:[...m.comments||[],d]}:m)),te.success("Comment added successfully")},onError:d=>{te.error(`Failed to add comment: ${d.message}`)}}),a=oa({mutationFn:({id:d,content:h})=>Dn.updateComment(d,h),onSuccess:d=>{t.setQueriesData({queryKey:["annotations"]},(h=[])=>h.map(m=>{var f;return m.id===r?{...m,comments:((f=m.comments)==null?void 0:f.map(g=>g.id===d.id?d:g))||[]}:m})),te.success("Comment updated successfully")},onError:d=>{te.error(`Failed to update comment: ${d.message}`)}}),n=oa({mutationFn:Dn.deleteComment,onSuccess:(d,h)=>{t.setQueriesData({queryKey:["annotations"]},(m=[])=>m.map(f=>{var g;return f.id===r?{...f,comments:((g=f.comments)==null?void 0:g.filter(y=>y.id!==h))||[]}:f})),te.success("Comment deleted successfully")},onError:d=>{te.error(`Failed to delete comment: ${d.message}`)}}),i=p.useCallback(d=>s.mutateAsync(d),[s]),o=p.useCallback((d,h)=>a.mutateAsync({id:d,content:h}),[a]),c=p.useCallback(d=>n.mutateAsync(d),[n]);return{addComment:i,updateComment:o,deleteComment:c,isAddingComment:s.isPending,isUpdatingComment:a.isPending,isDeletingComment:n.isPending}}function ZW(){const r=qn(),t=oa({mutationFn:Dn.shareAnnotation,onSuccess:i=>{r.setQueriesData({queryKey:["annotations"]},(o=[])=>o.map(c=>c.id===i.annotationId?{...c,shares:[...c.shares||[],i]}:c)),te.success("Annotation shared successfully")},onError:i=>{te.error(`Failed to share annotation: ${i.message}`)}}),s=oa({mutationFn:Dn.removeShare,onSuccess:(i,o)=>{r.setQueriesData({queryKey:["annotations"]},(c=[])=>c.map(d=>{var h;return{...d,shares:((h=d.shares)==null?void 0:h.filter(m=>m.id!==o))||[]}})),te.success("Share removed successfully")},onError:i=>{te.error(`Failed to remove share: ${i.message}`)}}),a=p.useCallback(i=>t.mutateAsync(i),[t]),n=p.useCallback(i=>s.mutateAsync(i),[s]);return{shareAnnotation:a,removeShare:n,isSharing:t.isPending,isRemoving:s.isPending}}function XW(){const[r,t]=p.useState({annotation:null,isEditing:!1}),[s,a]=p.useState({type:"highlight",color:"yellow",isActive:!1}),[n,i]=p.useState({isDrawing:!1,currentPath:"",strokeWidth:2,color:"red"}),o=p.useCallback((g,y=!1)=>{t({annotation:g,isEditing:y})},[]),c=p.useCallback((g,y="yellow")=>{a({type:g,color:y,isActive:!0})},[]),d=p.useCallback(()=>{a(g=>({...g,isActive:!1}))},[]),h=p.useCallback((g="red",y=2)=>{i({isDrawing:!0,currentPath:"",strokeWidth:y,color:g})},[]),m=p.useCallback(g=>{i(y=>({...y,currentPath:g}))},[]),f=p.useCallback(()=>{i(g=>({...g,isDrawing:!1}))},[]);return{selectedAnnotation:r,activeTool:s,drawingState:n,selectAnnotation:o,activateTool:c,deactivateTool:d,startDrawing:h,updateDrawingPath:m,stopDrawing:f}}class uV{constructor(){rs(this,"channels",new Map);rs(this,"eventListeners",new Map);rs(this,"presenceData",new Map)}subscribeToDocumentProcessing(t,s){const a=`document_processing:${t}`;if(!this.channels.has(a)){const n=D.channel(a).on("postgres_changes",{event:"UPDATE",schema:"public",table:"uploaded_documents",filter:`id=eq.${t}`},i=>{const o={document_id:t,status:i.new.processing_status,progress:i.new.processing_progress||0,stage:i.new.processing_stage||"upload",error_message:i.new.error_message};s(o)}).subscribe();this.channels.set(a,n)}return()=>this.unsubscribe(a)}subscribeToDocumentAnnotations(t,s){const a=`annotations:${t}`;if(!this.channels.has(a)){const n=D.channel(a).on("postgres_changes",{event:"*",schema:"public",table:"document_annotations",filter:`document_id=eq.${t}`},i=>{var c,d;const o={type:"annotation_change",payload:{event_type:i.eventType,annotation:i.new||i.old,document_id:t},timestamp:new Date().toISOString(),user_id:((c=i.new)==null?void 0:c.user_id)||((d=i.old)==null?void 0:d.user_id)};s(o)}).on("postgres_changes",{event:"*",schema:"public",table:"annotation_replies"},i=>{var o,c,d,h;if((o=i.new)!=null&&o.annotation_id||(c=i.old)!=null&&c.annotation_id){const m={type:"annotation_change",payload:{event_type:`reply_${i.eventType}`,reply:i.new||i.old,document_id:t},timestamp:new Date().toISOString(),user_id:((d=i.new)==null?void 0:d.user_id)||((h=i.old)==null?void 0:h.user_id)};s(m)}}).subscribe();this.channels.set(a,n)}return()=>this.unsubscribe(a)}subscribeToUserPresence(t,s,a){const n=`presence:${t}`;if(!this.channels.has(n)){const i=D.channel(n).on("presence",{event:"sync"},()=>{const o=i.presenceState(),c=[];Object.keys(o).forEach(d=>{const h=o[d][0];c.push(h)}),a(c)}).on("presence",{event:"join"},({key:o,newPresences:c})=>{console.log("User joined:",o,c)}).on("presence",{event:"leave"},({key:o,leftPresences:c})=>{console.log("User left:",o,c)}).subscribe(async o=>{o==="SUBSCRIBED"&&await i.track({user_id:s,document_id:t,status:"online",last_seen:new Date().toISOString(),current_page:1})});this.channels.set(n,i)}return()=>this.unsubscribe(n)}async updatePresence(t,s){const a=`presence:${t}`,n=this.channels.get(a);n&&await n.track(s)}subscribeToSystemNotifications(t,s){const a=`notifications:${t}`;if(!this.channels.has(a)){const n=D.channel(a).on("postgres_changes",{event:"INSERT",schema:"public",table:"user_notifications",filter:`user_id=eq.${t}`},i=>{s(i.new)}).subscribe();this.channels.set(a,n)}return()=>this.unsubscribe(a)}subscribeToCollaborationUpdates(t,s){const a=`collaboration:${t}`;if(!this.channels.has(a)){const n=D.channel(a).on("postgres_changes",{event:"*",schema:"public",table:"annotation_collaborators",filter:`user_id=eq.${t}`},i=>{var c,d;const o={document_id:((c=i.new)==null?void 0:c.document_id)||((d=i.old)==null?void 0:d.document_id),user_id:t,action:i.eventType==="INSERT"?"joined":i.eventType==="DELETE"?"left":"editing",metadata:i.new||i.old};s(o)}).subscribe();this.channels.set(a,n)}return()=>this.unsubscribe(a)}async broadcastEvent(t,s){const a=this.channels.get(t);a&&await a.send({type:"broadcast",event:s.type,payload:s})}unsubscribe(t){const s=this.channels.get(t);s&&(D.removeChannel(s),this.channels.delete(t))}unsubscribeAll(){this.channels.forEach((t,s)=>{D.removeChannel(t)}),this.channels.clear(),this.eventListeners.clear(),this.presenceData.clear()}getPresenceData(t){const s=`presence:${t}`,a=this.channels.get(s);if(a){const n=a.presenceState();return Object.keys(n).map(i=>n[i][0])}return[]}isConnected(){return D.realtime.isConnected()}getConnectionStatus(){var t;return((t=D.realtime.channels[0])==null?void 0:t.state)||"disconnected"}}const Cd=new uV,hV=r=>{const[t,s]=p.useState([]),[a,n]=p.useState(!1),{user:i}=ft(),o=p.useRef(null);p.useEffect(()=>{if(!r||!i)return;n(!0);const m=Cd.subscribeToUserPresence(r,i.id,f=>{s(f)});return o.current=m,()=>{m(),n(!1)}},[r,i]);const c=p.useCallback(async m=>{r&&i&&await Cd.updatePresence(r,{user_id:i.id,document_id:r,...m})},[r,i]),d=p.useCallback(m=>{c({current_page:m})},[c]),h=p.useCallback(m=>{c({status:m,last_seen:new Date().toISOString()})},[c]);return{presenceData:t,isConnected:a,updateCurrentPage:d,setStatus:h,updatePresence:c}},mV=()=>{const[r,t]=p.useState([]),[s,a]=p.useState(!1),{user:n}=ft();p.useEffect(()=>{if(!n)return;a(!0);const c=Cd.subscribeToSystemNotifications(n.id,d=>{t(h=>[...h.slice(-9),d]),te.info(d.message||"New notification received")});return()=>{c(),a(!1)}},[n]);const i=p.useCallback(c=>{t(d=>d.map(h=>h.id===c?{...h,read:!0}:h))},[]),o=p.useCallback(()=>{t([])},[]);return{notifications:r,isConnected:s,markAsRead:i,clearAll:o}},fV=()=>{const[r,t]=p.useState(!1),[s,a]=p.useState("disconnected");return p.useEffect(()=>{const n=()=>{const o=Cd.isConnected(),c=Cd.getConnectionStatus();t(o),a(c)};n();const i=setInterval(n,5e3);return()=>clearInterval(i)},[]),{isConnected:r,connectionStatus:s}},sE=({documentId:r,showUserPresence:t=!1,className:s=""})=>{const{isConnected:a,connectionStatus:n}=fV(),{presenceData:i}=hV(r||""),o=f=>{switch(f){case"SUBSCRIBED":case"connected":return"bg-green-500";case"CHANNEL_ERROR":case"TIMED_OUT":return"bg-red-500";case"CONNECTING":return"bg-yellow-500";default:return"bg-gray-500"}},c=f=>{switch(f){case"SUBSCRIBED":return"Connected";case"CHANNEL_ERROR":return"Error";case"TIMED_OUT":return"Timeout";case"CONNECTING":return"Connecting";default:return"Disconnected"}},d=f=>f.user_id.slice(0,2).toUpperCase(),h=i.filter(f=>f.status==="online"),m=i.filter(f=>f.status==="away");return e.jsxs("div",{className:`flex items-center space-x-2 ${s}`,children:[e.jsxs(Sd,{children:[e.jsx(kd,{asChild:!0,children:e.jsxs(R,{variant:"ghost",size:"sm",className:"h-8 px-2",children:[a?e.jsx(Qw,{className:"h-4 w-4 text-green-500"}):e.jsx(Kw,{className:"h-4 w-4 text-red-500"}),e.jsx(gh,{className:`h-2 w-2 ml-1 ${o(n)}`})]})}),e.jsx(Xl,{className:"w-64",align:"end",children:e.jsxs($,{className:"border-0 shadow-none",children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[a?e.jsx(Qw,{className:"h-4 w-4 text-green-500"}):e.jsx(Kw,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{children:"Real-time Connection"})]})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx(ae,{variant:a?"default":"destructive",className:"text-xs",children:c(n)})]}),!a&&e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-yellow-50 rounded-md",children:[e.jsx(It,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsx("div",{className:"text-xs text-yellow-800",children:"Real-time features may not work properly. Check your internet connection."})]}),e.jsxs(R,{variant:"outline",size:"sm",className:"w-full",onClick:()=>window.location.reload(),children:[e.jsx(mr,{className:"h-3 w-3 mr-2"}),"Reconnect"]})]})]})})]}),t&&r&&i.length>0&&e.jsxs(Sd,{children:[e.jsx(kd,{asChild:!0,children:e.jsxs(R,{variant:"ghost",size:"sm",className:"h-8 px-2",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1 text-xs",children:h.length})]})}),e.jsx(Xl,{className:"w-80",align:"end",children:e.jsxs($,{className:"border-0 shadow-none",children:[e.jsxs(Z,{className:"pb-3",children:[e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsx("span",{children:"Active Collaborators"})]}),e.jsx(ye,{className:"text-xs",children:"Users currently viewing this document"})]}),e.jsxs(z,{className:"space-y-3",children:[h.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-medium text-gray-900 mb-2",children:["Online (",h.length,")"]}),e.jsx("div",{className:"space-y-2",children:h.map(f=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(zr,{className:"h-6 w-6",children:e.jsx(Br,{className:"text-xs",children:d(f)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gh,{className:"h-2 w-2 text-green-500 fill-current"}),e.jsxs("span",{className:"text-xs font-medium truncate",children:["User ",f.user_id.slice(-4)]})]}),f.current_page&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Page ",f.current_page]})]})]},f.user_id))})]}),m.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-medium text-gray-900 mb-2",children:["Away (",m.length,")"]}),e.jsx("div",{className:"space-y-2",children:m.map(f=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(zr,{className:"h-6 w-6",children:e.jsx(Br,{className:"text-xs",children:d(f)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(gh,{className:"h-2 w-2 text-yellow-500 fill-current"}),e.jsxs("span",{className:"text-xs font-medium truncate",children:["User ",f.user_id.slice(-4)]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last seen ",Vt(new Date(f.last_seen),{addSuffix:!0})]})]})]},f.user_id))})]}),i.length===0&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx(es,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500",children:"No other users online"})]})]})]})})]})]})},ax=[{name:"Yellow",value:"#FFEB3B",bg:"rgba(255, 235, 59, 0.3)"},{name:"Green",value:"#4CAF50",bg:"rgba(76, 175, 80, 0.3)"},{name:"Blue",value:"#2196F3",bg:"rgba(33, 150, 243, 0.3)"},{name:"Red",value:"#F44336",bg:"rgba(244, 67, 54, 0.3)"},{name:"Purple",value:"#9C27B0",bg:"rgba(156, 39, 176, 0.3)"},{name:"Orange",value:"#FF9800",bg:"rgba(255, 152, 0, 0.3)"}],pV=({documentUrl:r,documentId:t,className:s="",onAnnotationChange:a})=>{const[n,i]=p.useState(100),[o,c]=p.useState(0),[d,h]=p.useState(!1),[m,f]=p.useState("select"),[g,y]=p.useState(ax[0]),[b,w]=p.useState(!0),[S,N]=p.useState(!1),[v,j]=p.useState(null),[C,k]=p.useState(null),[I,T]=p.useState(null),[O,U]=p.useState(""),A=p.useRef(null),L=p.useRef(null),{annotations:M,isLoading:se,createAnnotation:W,updateAnnotation:q,deleteAnnotation:K}=dV(t),{user:Y}=ft();p.useEffect(()=>{a==null||a(M)},[M,a]);const le=()=>{i(fe=>Math.min(fe+25,300))},Ne=()=>{i(fe=>Math.max(fe-25,25))},Ke=()=>{c(fe=>(fe+90)%360)},ke=()=>{h(fe=>!fe)},$e=p.useCallback(fe=>{var Tt;if(m==="select")return;const Me=(Tt=A.current)==null?void 0:Tt.getBoundingClientRect();if(!Me)return;const ze=fe.clientX-Me.left,ts=fe.clientY-Me.top;m==="highlight"?(N(!0),j({x:ze,y:ts}),k({x:ze,y:ts,width:0,height:0})):(m==="note"||m==="sticky")&&Qe(ze,ts)},[m]),ce=p.useCallback(fe=>{var Tt;if(!S||!v||m!=="highlight")return;const Me=(Tt=A.current)==null?void 0:Tt.getBoundingClientRect();if(!Me)return;const ze=fe.clientX-Me.left,ts=fe.clientY-Me.top;k({x:Math.min(v.x,ze),y:Math.min(v.y,ts),width:Math.abs(ze-v.x),height:Math.abs(ts-v.y)})},[S,v,m]),Re=p.useCallback(()=>{S&&C&&m==="highlight"&&C.width>10&&C.height>10&&nt(C),N(!1),j(null),k(null)},[S,C,m]),Qe=async(fe,Me)=>{if(!Y){te.error("Please log in to create annotations");return}const ze=await W({type:m,page_number:1,position:{x:fe,y:Me},content:"",color:g.value});ze&&(T(ze.id),U(""))},nt=async fe=>{if(!Y){te.error("Please log in to create highlights");return}await W({type:"highlight",page_number:1,position:fe,content:"Highlighted text",color:g.value})},We=async(fe,Me)=>{await q(fe,{content:Me})&&(T(null),U(""))},ct=async fe=>{await K(fe)},he=d?"fixed inset-0 z-50 bg-white":s;return e.jsxs($,{className:he,children:[e.jsx("div",{className:"border-b p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1 border rounded-md",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:Ne,children:e.jsx(i6,{className:"h-4 w-4"})}),e.jsxs("span",{className:"px-2 text-sm font-medium",children:[n,"%"]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:le,children:e.jsx(n6,{className:"h-4 w-4"})})]}),e.jsx(Ts,{orientation:"vertical",className:"h-6"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(R,{variant:m==="select"?"default":"ghost",size:"sm",onClick:()=>f("select"),children:"Select"}),e.jsx(R,{variant:m==="highlight"?"default":"ghost",size:"sm",onClick:()=>f("highlight"),children:e.jsx(q5,{className:"h-4 w-4"})}),e.jsx(R,{variant:m==="note"?"default":"ghost",size:"sm",onClick:()=>f("note"),children:e.jsx(Ft,{className:"h-4 w-4"})}),e.jsx(R,{variant:m==="sticky"?"default":"ghost",size:"sm",onClick:()=>f("sticky"),children:e.jsx(Gw,{className:"h-4 w-4"})})]}),e.jsx(Ts,{orientation:"vertical",className:"h-6"}),e.jsxs(Sd,{children:[e.jsx(kd,{asChild:!0,children:e.jsxs(R,{variant:"ghost",size:"sm",children:[e.jsx(yx,{className:"h-4 w-4 mr-2"}),e.jsx("div",{className:"w-4 h-4 rounded border",style:{backgroundColor:g.value}})]})}),e.jsx(Xl,{className:"w-48",children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ax.map(fe=>e.jsx(R,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",style:{backgroundColor:fe.value},onClick:()=>y(fe)},fe.value))})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>w(!b),children:b?e.jsx(Gt,{className:"h-4 w-4"}):e.jsx(Pi,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:Ke,children:e.jsx(Q5,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:ke,children:d?e.jsx(gx,{className:"h-4 w-4"}):e.jsx(Fh,{className:"h-4 w-4"})}),e.jsx(sE,{documentId:t,showUserPresence:!0,className:"ml-auto"})]})]})}),e.jsx(z,{className:"p-0 relative",children:e.jsx("div",{ref:A,className:"relative overflow-auto",style:{height:d?"calc(100vh - 120px)":"600px"},onMouseDown:$e,onMouseMove:ce,onMouseUp:Re,children:e.jsxs("div",{className:"relative",style:{transform:`scale(${n/100}) rotate(${o}deg)`,transformOrigin:"top left",cursor:m==="select"?"default":"crosshair"},children:[e.jsx("iframe",{ref:L,src:`${r}#toolbar=0&navpanes=0&scrollbar=0`,className:"w-full h-[800px] border-0",title:"PDF Document"}),b&&e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[M.map(fe=>{var Me,ze,ts,Tt,Os,Ms,os,V;return e.jsx("div",{className:"absolute pointer-events-auto",style:{left:fe.position.x,top:fe.position.y,width:fe.position.width,height:fe.position.height,backgroundColor:fe.type==="highlight"?(Me=ax.find(ee=>ee.value===fe.color))==null?void 0:Me.bg:"transparent"},children:fe.type!=="highlight"&&e.jsxs(Sd,{children:[e.jsx(kd,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full",style:{backgroundColor:fe.color},children:fe.type==="note"?e.jsx(Ft,{className:"h-3 w-3"}):e.jsx(Gw,{className:"h-3 w-3"})})}),e.jsx(Xl,{className:"w-80",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(zr,{className:"h-6 w-6",children:[e.jsx($n,{src:(ze=fe.user)==null?void 0:ze.avatar_url}),e.jsxs(Br,{className:"text-xs",children:[(Tt=(ts=fe.user)==null?void 0:ts.first_name)==null?void 0:Tt[0],(Ms=(Os=fe.user)==null?void 0:Os.last_name)==null?void 0:Ms[0]]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-sm font-medium",children:[(os=fe.user)==null?void 0:os.first_name," ",(V=fe.user)==null?void 0:V.last_name]}),e.jsx("span",{className:"text-xs text-gray-500",children:Vt(new Date(fe.created_at),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ae,{variant:"outline",className:"text-xs",children:fe.type}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>ct(fe.id),children:e.jsx(Ln,{className:"h-4 w-4"})})]})]}),I===fe.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx(Sr,{value:O,onChange:ee=>U(ee.target.value),placeholder:"Enter annotation content...",className:"min-h-[80px]"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{size:"sm",onClick:()=>We(fe.id,O),children:[e.jsx(Ci,{className:"h-4 w-4 mr-1"}),"Save"]}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>T(null),children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:fe.content||"No content"}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>{T(fe.id),U(fe.content)},children:"Edit"})]})]})})]})},fe.id)}),C&&S&&e.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-200 bg-opacity-30 pointer-events-none",style:{left:C.x,top:C.y,width:C.width,height:C.height}})]})]})})})]})},xV=({documentId:r,onClose:t,className:s=""})=>{const[a,n]=p.useState(null),[i,o]=p.useState(!0),[c,d]=p.useState(null),[h,m]=p.useState(!1),[f,g]=p.useState("viewer");p.useEffect(()=>{y()},[r]);const y=async()=>{try{o(!0),d(null);const T=await Ds.getDocument(r);n(T)}catch(T){console.error("Error loading document:",T),d(T.message||"Failed to load document"),te.error("Failed to load document")}finally{o(!1)}},b=()=>{a&&window.open(a.file_url,"_blank")},w=async()=>{if(a)try{await navigator.share({title:a.filename,url:a.file_url})}catch{await navigator.clipboard.writeText(a.file_url),te.success("Document URL copied to clipboard")}},S=()=>{setZoom(T=>Math.min(T+25,200))},N=()=>{setZoom(T=>Math.max(T-25,50))},v=()=>{setRotation(T=>(T+90)%360)},j=()=>{m(!h)},C=T=>{switch(T){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=T=>{switch(T){case"processing":return e.jsx(ds,{className:"h-4 w-4 animate-spin"});case"failed":return e.jsx(is,{className:"h-4 w-4"});default:return e.jsx(Fe,{className:"h-4 w-4"})}};if(i)return e.jsx($,{className:s,children:e.jsx(z,{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(ds,{className:"h-8 w-8 animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading document..."})]})})});if(c||!a)return e.jsx($,{className:s,children:e.jsx(z,{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(is,{className:"h-8 w-8 text-red-500"}),e.jsx("p",{className:"text-sm text-red-600",children:c||"Document not found"}),e.jsx(R,{onClick:y,variant:"outline",size:"sm",children:"Try Again"})]})})});const I=h?"fixed inset-0 z-50 bg-white":`${s}`;return e.jsxs($,{className:I,children:[e.jsx(Z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(X,{className:"text-lg font-semibold truncate",children:a.filename}),e.jsxs(ye,{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{children:dn[a.document_type]}),e.jsxs("span",{children:[Math.round(a.file_size/1024)," KB"]}),e.jsx("span",{children:Vt(new Date(a.created_at),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[k(a.processing_status),e.jsx(ae,{className:C(a.processing_status),children:Un[a.processing_status]})]}),t&&e.jsx(R,{onClick:t,variant:"ghost",size:"sm",children:e.jsx(Vs,{className:"h-4 w-4"})})]})]})}),e.jsx(Ts,{}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{onClick:N,variant:"outline",size:"sm",children:e.jsx(ZoomOut,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm font-medium min-w-[60px] text-center",children:[zoom,"%"]}),e.jsx(R,{onClick:S,variant:"outline",size:"sm",children:e.jsx(ZoomIn,{className:"h-4 w-4"})}),e.jsx(R,{onClick:v,variant:"outline",size:"sm",children:e.jsx(RotateCw,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{onClick:b,variant:"outline",size:"sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsxs(R,{onClick:w,variant:"outline",size:"sm",children:[e.jsx(Od,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsx(R,{onClick:j,variant:"outline",size:"sm",children:e.jsx(Fh,{className:"h-4 w-4"})})]})]}),e.jsx(z,{className:"p-0 flex-1",children:e.jsxs(fr,{value:f,onValueChange:g,children:[e.jsx("div",{className:"border-b px-4",children:e.jsxs(nr,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ge,{value:"viewer",className:"flex items-center space-x-2",children:[e.jsx(Gt,{className:"h-4 w-4"}),e.jsx("span",{children:"Document"})]}),e.jsxs(Ge,{value:"text",className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:"Text"})]}),e.jsxs(Ge,{value:"analysis",className:"flex items-center space-x-2",children:[e.jsx(ki,{className:"h-4 w-4"}),e.jsx("span",{children:"AI Analysis"})]})]})}),e.jsx(He,{value:"viewer",className:"mt-0",children:e.jsx("div",{className:"p-4",children:a.file_url.toLowerCase().endsWith(".pdf")?e.jsx(pV,{documentUrl:a.file_url,documentId:a.id,className:"w-full",onAnnotationChange:T=>{console.log("Annotations updated:",T)}}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Preview not available"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"This file type cannot be previewed in the browser."}),e.jsxs(R,{onClick:b,children:[e.jsx(fs,{className:"mr-2 h-4 w-4"}),"Download to view"]})]})})}),e.jsx(He,{value:"text",className:"mt-0",children:e.jsx(Po,{className:h?"h-[calc(100vh-250px)]":"h-[550px]",children:e.jsx("div",{className:"p-4",children:a.ocr_text?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Extracted Text"}),a.ocr_quality_score&&e.jsxs(ae,{variant:"outline",children:["Quality: ",Math.round(a.ocr_quality_score*100),"%"]})]}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:a.ocr_text})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No text extracted"}),e.jsx("p",{className:"text-gray-500",children:"Text extraction may still be in progress or the document may not contain readable text."})]})})})}),e.jsx(He,{value:"analysis",className:"mt-0",children:e.jsx(Po,{className:h?"h-[calc(100vh-250px)]":"h-[550px]",children:e.jsx("div",{className:"p-4",children:e.jsx(Y9,{document:a})})})})]})})]})};async function cv(r){const{query:t,userId:s,similarityThreshold:a=.7,maxResults:n=10,documentIds:i}=r;try{const{embedding:o}=await tv(t),{data:c,error:d}=await D.rpc("search_similar_chunks",{query_embedding:o,similarity_threshold:a,match_count:n,user_filter:s||null});if(d)throw console.error("Semantic search error:",d),new Error("Failed to perform semantic search");let h=c||[];return i&&i.length>0&&(h=h.filter(f=>i.includes(f.document_id))),await Promise.all(h.map(async f=>{const{data:g}=await D.from("uploaded_documents").select("*").eq("id",f.document_id).single();return{id:f.id,document_id:f.document_id,chunk_text:f.chunk_text,similarity:f.similarity,document:g||void 0}}))}catch(o){throw console.error("Semantic search failed:",o),o}}async function rE(r){const{query:t,userId:s,documentType:a,dateRange:n}=r;try{let i=D.from("uploaded_documents").select("*").eq("user_id",s).textSearch("ocr_text",t,{type:"websearch",config:"english"});a&&(i=i.eq("document_type",a)),n&&(i=i.gte("created_at",n.start.toISOString()).lte("created_at",n.end.toISOString())),i=i.order("created_at",{ascending:!1});const{data:o,error:c}=await i;if(c)throw console.error("Text search error:",c),new Error("Failed to perform text search");return o||[]}catch(i){throw console.error("Text search failed:",i),i}}async function gV(r,t,s={}){const{semanticWeight:a=.7,textWeight:n=.3,maxResults:i=20,documentType:o,dateRange:c}=s;try{const[d,h]=await Promise.all([cv({query:r,userId:t,maxResults:Math.ceil(i*a)}),rE({query:r,userId:t,documentType:o,dateRange:c})]),m=new Set,f=[];return d.forEach(g=>{g.document&&!m.has(g.document.id)&&(m.add(g.document.id),f.push(g.document))}),h.forEach(g=>{m.has(g.id)||(m.add(g.id),f.push(g))}),{semanticResults:d,textResults:f.slice(0,i),totalResults:f.length}}catch(d){throw console.error("Combined search failed:",d),d}}var mm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */mm.exports;(function(r,t){(function(){var s,a="4.17.21",n=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",c="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",h=500,m="__lodash_placeholder__",f=1,g=2,y=4,b=1,w=2,S=1,N=2,v=4,j=8,C=16,k=32,I=64,T=128,O=256,U=512,A=30,L="...",M=800,se=16,W=1,q=2,K=3,Y=1/0,le=9007199254740991,Ne=17976931348623157e292,Ke=NaN,ke=4294967295,$e=ke-1,ce=ke>>>1,Re=[["ary",T],["bind",S],["bindKey",N],["curry",j],["curryRight",C],["flip",U],["partial",k],["partialRight",I],["rearg",O]],Qe="[object Arguments]",nt="[object Array]",We="[object AsyncFunction]",ct="[object Boolean]",he="[object Date]",fe="[object DOMException]",Me="[object Error]",ze="[object Function]",ts="[object GeneratorFunction]",Tt="[object Map]",Os="[object Number]",Ms="[object Null]",os="[object Object]",V="[object Promise]",ee="[object Proxy]",oe="[object RegExp]",Se="[object Set]",_e="[object String]",we="[object Symbol]",de="[object Undefined]",je="[object WeakMap]",mt="[object WeakSet]",et="[object ArrayBuffer]",Wt="[object DataView]",Ws="[object Float32Array]",Js="[object Float64Array]",qr="[object Int8Array]",ma="[object Int16Array]",Vr="[object Int32Array]",fa="[object Uint8Array]",kr="[object Uint8ClampedArray]",ir="[object Uint16Array]",mn="[object Uint32Array]",dt=/\b__p \+= '';/g,Zt=/\b(__p \+=) '' \+/g,ss=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Wr=/&(?:amp|lt|gt|quot|#39);/g,Hr=/[&<>"']/g,Bo=RegExp(Wr.source),nf=RegExp(Hr.source),uE=/<%-([\s\S]+?)%>/g,hE=/<%([\s\S]+?)%>/g,dv=/<%=([\s\S]+?)%>/g,mE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fE=/^\w*$/,pE=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,of=/[\\^$.*+?()[\]{}|]/g,xE=RegExp(of.source),lf=/^\s+/,gE=/\s/,yE=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,vE=/\{\n\/\* \[wrapped with (.+)\] \*/,wE=/,? & /,jE=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,bE=/[()=,{}\[\]\/\s]/,_E=/\\(\\)?/g,NE=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,uv=/\w*$/,SE=/^[-+]0x[0-9a-f]+$/i,kE=/^0b[01]+$/i,CE=/^\[object .+?Constructor\]$/,EE=/^0o[0-7]+$/i,AE=/^(?:0|[1-9]\d*)$/,TE=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,eu=/($^)/,RE=/['\n\r\u2028\u2029\\]/g,tu="\\ud800-\\udfff",PE="\\u0300-\\u036f",IE="\\ufe20-\\ufe2f",DE="\\u20d0-\\u20ff",hv=PE+IE+DE,mv="\\u2700-\\u27bf",fv="a-z\\xdf-\\xf6\\xf8-\\xff",FE="\\xac\\xb1\\xd7\\xf7",OE="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ME="\\u2000-\\u206f",LE=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pv="A-Z\\xc0-\\xd6\\xd8-\\xde",xv="\\ufe0e\\ufe0f",gv=FE+OE+ME+LE,cf="['’]",UE="["+tu+"]",yv="["+gv+"]",su="["+hv+"]",vv="\\d+",$E="["+mv+"]",wv="["+fv+"]",jv="[^"+tu+gv+vv+mv+fv+pv+"]",df="\\ud83c[\\udffb-\\udfff]",zE="(?:"+su+"|"+df+")",bv="[^"+tu+"]",uf="(?:\\ud83c[\\udde6-\\uddff]){2}",hf="[\\ud800-\\udbff][\\udc00-\\udfff]",qo="["+pv+"]",_v="\\u200d",Nv="(?:"+wv+"|"+jv+")",BE="(?:"+qo+"|"+jv+")",Sv="(?:"+cf+"(?:d|ll|m|re|s|t|ve))?",kv="(?:"+cf+"(?:D|LL|M|RE|S|T|VE))?",Cv=zE+"?",Ev="["+xv+"]?",qE="(?:"+_v+"(?:"+[bv,uf,hf].join("|")+")"+Ev+Cv+")*",VE="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",WE="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Av=Ev+Cv+qE,HE="(?:"+[$E,uf,hf].join("|")+")"+Av,GE="(?:"+[bv+su+"?",su,uf,hf,UE].join("|")+")",KE=RegExp(cf,"g"),QE=RegExp(su,"g"),mf=RegExp(df+"(?="+df+")|"+GE+Av,"g"),YE=RegExp([qo+"?"+wv+"+"+Sv+"(?="+[yv,qo,"$"].join("|")+")",BE+"+"+kv+"(?="+[yv,qo+Nv,"$"].join("|")+")",qo+"?"+Nv+"+"+Sv,qo+"+"+kv,WE,VE,vv,HE].join("|"),"g"),JE=RegExp("["+_v+tu+hv+xv+"]"),ZE=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,XE=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],e4=-1,hs={};hs[Ws]=hs[Js]=hs[qr]=hs[ma]=hs[Vr]=hs[fa]=hs[kr]=hs[ir]=hs[mn]=!0,hs[Qe]=hs[nt]=hs[et]=hs[ct]=hs[Wt]=hs[he]=hs[Me]=hs[ze]=hs[Tt]=hs[Os]=hs[os]=hs[oe]=hs[Se]=hs[_e]=hs[je]=!1;var ls={};ls[Qe]=ls[nt]=ls[et]=ls[Wt]=ls[ct]=ls[he]=ls[Ws]=ls[Js]=ls[qr]=ls[ma]=ls[Vr]=ls[Tt]=ls[Os]=ls[os]=ls[oe]=ls[Se]=ls[_e]=ls[we]=ls[fa]=ls[kr]=ls[ir]=ls[mn]=!0,ls[Me]=ls[ze]=ls[je]=!1;var t4={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},s4={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},r4={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},a4={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},n4=parseFloat,i4=parseInt,Tv=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,o4=typeof self=="object"&&self&&self.Object===Object&&self,Zs=Tv||o4||Function("return this")(),ff=t&&!t.nodeType&&t,Vi=ff&&!0&&r&&!r.nodeType&&r,Rv=Vi&&Vi.exports===ff,pf=Rv&&Tv.process,pa=function(){try{var Q=Vi&&Vi.require&&Vi.require("util").types;return Q||pf&&pf.binding&&pf.binding("util")}catch{}}(),Pv=pa&&pa.isArrayBuffer,Iv=pa&&pa.isDate,Dv=pa&&pa.isMap,Fv=pa&&pa.isRegExp,Ov=pa&&pa.isSet,Mv=pa&&pa.isTypedArray;function Gr(Q,ue,ie){switch(ie.length){case 0:return Q.call(ue);case 1:return Q.call(ue,ie[0]);case 2:return Q.call(ue,ie[0],ie[1]);case 3:return Q.call(ue,ie[0],ie[1],ie[2])}return Q.apply(ue,ie)}function l4(Q,ue,ie,Le){for(var pt=-1,Ht=Q==null?0:Q.length;++pt<Ht;){var Ls=Q[pt];ue(Le,Ls,ie(Ls),Q)}return Le}function xa(Q,ue){for(var ie=-1,Le=Q==null?0:Q.length;++ie<Le&&ue(Q[ie],ie,Q)!==!1;);return Q}function c4(Q,ue){for(var ie=Q==null?0:Q.length;ie--&&ue(Q[ie],ie,Q)!==!1;);return Q}function Lv(Q,ue){for(var ie=-1,Le=Q==null?0:Q.length;++ie<Le;)if(!ue(Q[ie],ie,Q))return!1;return!0}function Vn(Q,ue){for(var ie=-1,Le=Q==null?0:Q.length,pt=0,Ht=[];++ie<Le;){var Ls=Q[ie];ue(Ls,ie,Q)&&(Ht[pt++]=Ls)}return Ht}function ru(Q,ue){var ie=Q==null?0:Q.length;return!!ie&&Vo(Q,ue,0)>-1}function xf(Q,ue,ie){for(var Le=-1,pt=Q==null?0:Q.length;++Le<pt;)if(ie(ue,Q[Le]))return!0;return!1}function xs(Q,ue){for(var ie=-1,Le=Q==null?0:Q.length,pt=Array(Le);++ie<Le;)pt[ie]=ue(Q[ie],ie,Q);return pt}function Wn(Q,ue){for(var ie=-1,Le=ue.length,pt=Q.length;++ie<Le;)Q[pt+ie]=ue[ie];return Q}function gf(Q,ue,ie,Le){var pt=-1,Ht=Q==null?0:Q.length;for(Le&&Ht&&(ie=Q[++pt]);++pt<Ht;)ie=ue(ie,Q[pt],pt,Q);return ie}function d4(Q,ue,ie,Le){var pt=Q==null?0:Q.length;for(Le&&pt&&(ie=Q[--pt]);pt--;)ie=ue(ie,Q[pt],pt,Q);return ie}function yf(Q,ue){for(var ie=-1,Le=Q==null?0:Q.length;++ie<Le;)if(ue(Q[ie],ie,Q))return!0;return!1}var u4=vf("length");function h4(Q){return Q.split("")}function m4(Q){return Q.match(jE)||[]}function Uv(Q,ue,ie){var Le;return ie(Q,function(pt,Ht,Ls){if(ue(pt,Ht,Ls))return Le=Ht,!1}),Le}function au(Q,ue,ie,Le){for(var pt=Q.length,Ht=ie+(Le?1:-1);Le?Ht--:++Ht<pt;)if(ue(Q[Ht],Ht,Q))return Ht;return-1}function Vo(Q,ue,ie){return ue===ue?S4(Q,ue,ie):au(Q,$v,ie)}function f4(Q,ue,ie,Le){for(var pt=ie-1,Ht=Q.length;++pt<Ht;)if(Le(Q[pt],ue))return pt;return-1}function $v(Q){return Q!==Q}function zv(Q,ue){var ie=Q==null?0:Q.length;return ie?jf(Q,ue)/ie:Ke}function vf(Q){return function(ue){return ue==null?s:ue[Q]}}function wf(Q){return function(ue){return Q==null?s:Q[ue]}}function Bv(Q,ue,ie,Le,pt){return pt(Q,function(Ht,Ls,as){ie=Le?(Le=!1,Ht):ue(ie,Ht,Ls,as)}),ie}function p4(Q,ue){var ie=Q.length;for(Q.sort(ue);ie--;)Q[ie]=Q[ie].value;return Q}function jf(Q,ue){for(var ie,Le=-1,pt=Q.length;++Le<pt;){var Ht=ue(Q[Le]);Ht!==s&&(ie=ie===s?Ht:ie+Ht)}return ie}function bf(Q,ue){for(var ie=-1,Le=Array(Q);++ie<Q;)Le[ie]=ue(ie);return Le}function x4(Q,ue){return xs(ue,function(ie){return[ie,Q[ie]]})}function qv(Q){return Q&&Q.slice(0,Gv(Q)+1).replace(lf,"")}function Kr(Q){return function(ue){return Q(ue)}}function _f(Q,ue){return xs(ue,function(ie){return Q[ie]})}function uc(Q,ue){return Q.has(ue)}function Vv(Q,ue){for(var ie=-1,Le=Q.length;++ie<Le&&Vo(ue,Q[ie],0)>-1;);return ie}function Wv(Q,ue){for(var ie=Q.length;ie--&&Vo(ue,Q[ie],0)>-1;);return ie}function g4(Q,ue){for(var ie=Q.length,Le=0;ie--;)Q[ie]===ue&&++Le;return Le}var y4=wf(t4),v4=wf(s4);function w4(Q){return"\\"+a4[Q]}function j4(Q,ue){return Q==null?s:Q[ue]}function Wo(Q){return JE.test(Q)}function b4(Q){return ZE.test(Q)}function _4(Q){for(var ue,ie=[];!(ue=Q.next()).done;)ie.push(ue.value);return ie}function Nf(Q){var ue=-1,ie=Array(Q.size);return Q.forEach(function(Le,pt){ie[++ue]=[pt,Le]}),ie}function Hv(Q,ue){return function(ie){return Q(ue(ie))}}function Hn(Q,ue){for(var ie=-1,Le=Q.length,pt=0,Ht=[];++ie<Le;){var Ls=Q[ie];(Ls===ue||Ls===m)&&(Q[ie]=m,Ht[pt++]=ie)}return Ht}function nu(Q){var ue=-1,ie=Array(Q.size);return Q.forEach(function(Le){ie[++ue]=Le}),ie}function N4(Q){var ue=-1,ie=Array(Q.size);return Q.forEach(function(Le){ie[++ue]=[Le,Le]}),ie}function S4(Q,ue,ie){for(var Le=ie-1,pt=Q.length;++Le<pt;)if(Q[Le]===ue)return Le;return-1}function k4(Q,ue,ie){for(var Le=ie+1;Le--;)if(Q[Le]===ue)return Le;return Le}function Ho(Q){return Wo(Q)?E4(Q):u4(Q)}function Ra(Q){return Wo(Q)?A4(Q):h4(Q)}function Gv(Q){for(var ue=Q.length;ue--&&gE.test(Q.charAt(ue)););return ue}var C4=wf(r4);function E4(Q){for(var ue=mf.lastIndex=0;mf.test(Q);)++ue;return ue}function A4(Q){return Q.match(mf)||[]}function T4(Q){return Q.match(YE)||[]}var R4=function Q(ue){ue=ue==null?Zs:Go.defaults(Zs.Object(),ue,Go.pick(Zs,XE));var ie=ue.Array,Le=ue.Date,pt=ue.Error,Ht=ue.Function,Ls=ue.Math,as=ue.Object,Sf=ue.RegExp,P4=ue.String,ga=ue.TypeError,iu=ie.prototype,I4=Ht.prototype,Ko=as.prototype,ou=ue["__core-js_shared__"],lu=I4.toString,Xt=Ko.hasOwnProperty,D4=0,Kv=function(){var l=/[^.]+$/.exec(ou&&ou.keys&&ou.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),cu=Ko.toString,F4=lu.call(as),O4=Zs._,M4=Sf("^"+lu.call(Xt).replace(of,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),du=Rv?ue.Buffer:s,Gn=ue.Symbol,uu=ue.Uint8Array,Qv=du?du.allocUnsafe:s,hu=Hv(as.getPrototypeOf,as),Yv=as.create,Jv=Ko.propertyIsEnumerable,mu=iu.splice,Zv=Gn?Gn.isConcatSpreadable:s,hc=Gn?Gn.iterator:s,Wi=Gn?Gn.toStringTag:s,fu=function(){try{var l=Yi(as,"defineProperty");return l({},"",{}),l}catch{}}(),L4=ue.clearTimeout!==Zs.clearTimeout&&ue.clearTimeout,U4=Le&&Le.now!==Zs.Date.now&&Le.now,$4=ue.setTimeout!==Zs.setTimeout&&ue.setTimeout,pu=Ls.ceil,xu=Ls.floor,kf=as.getOwnPropertySymbols,z4=du?du.isBuffer:s,Xv=ue.isFinite,B4=iu.join,q4=Hv(as.keys,as),Us=Ls.max,or=Ls.min,V4=Le.now,W4=ue.parseInt,e0=Ls.random,H4=iu.reverse,Cf=Yi(ue,"DataView"),mc=Yi(ue,"Map"),Ef=Yi(ue,"Promise"),Qo=Yi(ue,"Set"),fc=Yi(ue,"WeakMap"),pc=Yi(as,"create"),gu=fc&&new fc,Yo={},G4=Ji(Cf),K4=Ji(mc),Q4=Ji(Ef),Y4=Ji(Qo),J4=Ji(fc),yu=Gn?Gn.prototype:s,xc=yu?yu.valueOf:s,t0=yu?yu.toString:s;function P(l){if(Ss(l)&&!yt(l)&&!(l instanceof Dt)){if(l instanceof ya)return l;if(Xt.call(l,"__wrapped__"))return sw(l)}return new ya(l)}var Jo=function(){function l(){}return function(u){if(!ws(u))return{};if(Yv)return Yv(u);l.prototype=u;var x=new l;return l.prototype=s,x}}();function vu(){}function ya(l,u){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=s}P.templateSettings={escape:uE,evaluate:hE,interpolate:dv,variable:"",imports:{_:P}},P.prototype=vu.prototype,P.prototype.constructor=P,ya.prototype=Jo(vu.prototype),ya.prototype.constructor=ya;function Dt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ke,this.__views__=[]}function Z4(){var l=new Dt(this.__wrapped__);return l.__actions__=Cr(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=Cr(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=Cr(this.__views__),l}function X4(){if(this.__filtered__){var l=new Dt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function eA(){var l=this.__wrapped__.value(),u=this.__dir__,x=yt(l),_=u<0,E=x?l.length:0,F=hT(0,E,this.__views__),B=F.start,H=F.end,J=H-B,pe=_?H:B-1,ge=this.__iteratees__,ve=ge.length,Ae=0,qe=or(J,this.__takeCount__);if(!x||!_&&E==J&&qe==J)return S0(l,this.__actions__);var tt=[];e:for(;J--&&Ae<qe;){pe+=u;for(var St=-1,st=l[pe];++St<ve;){var Rt=ge[St],Mt=Rt.iteratee,Jr=Rt.type,gr=Mt(st);if(Jr==q)st=gr;else if(!gr){if(Jr==W)continue e;break e}}tt[Ae++]=st}return tt}Dt.prototype=Jo(vu.prototype),Dt.prototype.constructor=Dt;function Hi(l){var u=-1,x=l==null?0:l.length;for(this.clear();++u<x;){var _=l[u];this.set(_[0],_[1])}}function tA(){this.__data__=pc?pc(null):{},this.size=0}function sA(l){var u=this.has(l)&&delete this.__data__[l];return this.size-=u?1:0,u}function rA(l){var u=this.__data__;if(pc){var x=u[l];return x===d?s:x}return Xt.call(u,l)?u[l]:s}function aA(l){var u=this.__data__;return pc?u[l]!==s:Xt.call(u,l)}function nA(l,u){var x=this.__data__;return this.size+=this.has(l)?0:1,x[l]=pc&&u===s?d:u,this}Hi.prototype.clear=tA,Hi.prototype.delete=sA,Hi.prototype.get=rA,Hi.prototype.has=aA,Hi.prototype.set=nA;function fn(l){var u=-1,x=l==null?0:l.length;for(this.clear();++u<x;){var _=l[u];this.set(_[0],_[1])}}function iA(){this.__data__=[],this.size=0}function oA(l){var u=this.__data__,x=wu(u,l);if(x<0)return!1;var _=u.length-1;return x==_?u.pop():mu.call(u,x,1),--this.size,!0}function lA(l){var u=this.__data__,x=wu(u,l);return x<0?s:u[x][1]}function cA(l){return wu(this.__data__,l)>-1}function dA(l,u){var x=this.__data__,_=wu(x,l);return _<0?(++this.size,x.push([l,u])):x[_][1]=u,this}fn.prototype.clear=iA,fn.prototype.delete=oA,fn.prototype.get=lA,fn.prototype.has=cA,fn.prototype.set=dA;function pn(l){var u=-1,x=l==null?0:l.length;for(this.clear();++u<x;){var _=l[u];this.set(_[0],_[1])}}function uA(){this.size=0,this.__data__={hash:new Hi,map:new(mc||fn),string:new Hi}}function hA(l){var u=Pu(this,l).delete(l);return this.size-=u?1:0,u}function mA(l){return Pu(this,l).get(l)}function fA(l){return Pu(this,l).has(l)}function pA(l,u){var x=Pu(this,l),_=x.size;return x.set(l,u),this.size+=x.size==_?0:1,this}pn.prototype.clear=uA,pn.prototype.delete=hA,pn.prototype.get=mA,pn.prototype.has=fA,pn.prototype.set=pA;function Gi(l){var u=-1,x=l==null?0:l.length;for(this.__data__=new pn;++u<x;)this.add(l[u])}function xA(l){return this.__data__.set(l,d),this}function gA(l){return this.__data__.has(l)}Gi.prototype.add=Gi.prototype.push=xA,Gi.prototype.has=gA;function Pa(l){var u=this.__data__=new fn(l);this.size=u.size}function yA(){this.__data__=new fn,this.size=0}function vA(l){var u=this.__data__,x=u.delete(l);return this.size=u.size,x}function wA(l){return this.__data__.get(l)}function jA(l){return this.__data__.has(l)}function bA(l,u){var x=this.__data__;if(x instanceof fn){var _=x.__data__;if(!mc||_.length<n-1)return _.push([l,u]),this.size=++x.size,this;x=this.__data__=new pn(_)}return x.set(l,u),this.size=x.size,this}Pa.prototype.clear=yA,Pa.prototype.delete=vA,Pa.prototype.get=wA,Pa.prototype.has=jA,Pa.prototype.set=bA;function s0(l,u){var x=yt(l),_=!x&&Zi(l),E=!x&&!_&&Zn(l),F=!x&&!_&&!E&&tl(l),B=x||_||E||F,H=B?bf(l.length,P4):[],J=H.length;for(var pe in l)(u||Xt.call(l,pe))&&!(B&&(pe=="length"||E&&(pe=="offset"||pe=="parent")||F&&(pe=="buffer"||pe=="byteLength"||pe=="byteOffset")||vn(pe,J)))&&H.push(pe);return H}function r0(l){var u=l.length;return u?l[Uf(0,u-1)]:s}function _A(l,u){return Iu(Cr(l),Ki(u,0,l.length))}function NA(l){return Iu(Cr(l))}function Af(l,u,x){(x!==s&&!Ia(l[u],x)||x===s&&!(u in l))&&xn(l,u,x)}function gc(l,u,x){var _=l[u];(!(Xt.call(l,u)&&Ia(_,x))||x===s&&!(u in l))&&xn(l,u,x)}function wu(l,u){for(var x=l.length;x--;)if(Ia(l[x][0],u))return x;return-1}function SA(l,u,x,_){return Kn(l,function(E,F,B){u(_,E,x(E),B)}),_}function a0(l,u){return l&&Ga(u,Hs(u),l)}function kA(l,u){return l&&Ga(u,Ar(u),l)}function xn(l,u,x){u=="__proto__"&&fu?fu(l,u,{configurable:!0,enumerable:!0,value:x,writable:!0}):l[u]=x}function Tf(l,u){for(var x=-1,_=u.length,E=ie(_),F=l==null;++x<_;)E[x]=F?s:dp(l,u[x]);return E}function Ki(l,u,x){return l===l&&(x!==s&&(l=l<=x?l:x),u!==s&&(l=l>=u?l:u)),l}function va(l,u,x,_,E,F){var B,H=u&f,J=u&g,pe=u&y;if(x&&(B=E?x(l,_,E,F):x(l)),B!==s)return B;if(!ws(l))return l;var ge=yt(l);if(ge){if(B=fT(l),!H)return Cr(l,B)}else{var ve=lr(l),Ae=ve==ze||ve==ts;if(Zn(l))return E0(l,H);if(ve==os||ve==Qe||Ae&&!E){if(B=J||Ae?{}:G0(l),!H)return J?rT(l,kA(B,l)):sT(l,a0(B,l))}else{if(!ls[ve])return E?l:{};B=pT(l,ve,H)}}F||(F=new Pa);var qe=F.get(l);if(qe)return qe;F.set(l,B),bw(l)?l.forEach(function(st){B.add(va(st,u,x,st,l,F))}):ww(l)&&l.forEach(function(st,Rt){B.set(Rt,va(st,u,x,Rt,l,F))});var tt=pe?J?Yf:Qf:J?Ar:Hs,St=ge?s:tt(l);return xa(St||l,function(st,Rt){St&&(Rt=st,st=l[Rt]),gc(B,Rt,va(st,u,x,Rt,l,F))}),B}function CA(l){var u=Hs(l);return function(x){return n0(x,l,u)}}function n0(l,u,x){var _=x.length;if(l==null)return!_;for(l=as(l);_--;){var E=x[_],F=u[E],B=l[E];if(B===s&&!(E in l)||!F(B))return!1}return!0}function i0(l,u,x){if(typeof l!="function")throw new ga(o);return Nc(function(){l.apply(s,x)},u)}function yc(l,u,x,_){var E=-1,F=ru,B=!0,H=l.length,J=[],pe=u.length;if(!H)return J;x&&(u=xs(u,Kr(x))),_?(F=xf,B=!1):u.length>=n&&(F=uc,B=!1,u=new Gi(u));e:for(;++E<H;){var ge=l[E],ve=x==null?ge:x(ge);if(ge=_||ge!==0?ge:0,B&&ve===ve){for(var Ae=pe;Ae--;)if(u[Ae]===ve)continue e;J.push(ge)}else F(u,ve,_)||J.push(ge)}return J}var Kn=I0(Ha),o0=I0(Pf,!0);function EA(l,u){var x=!0;return Kn(l,function(_,E,F){return x=!!u(_,E,F),x}),x}function ju(l,u,x){for(var _=-1,E=l.length;++_<E;){var F=l[_],B=u(F);if(B!=null&&(H===s?B===B&&!Yr(B):x(B,H)))var H=B,J=F}return J}function AA(l,u,x,_){var E=l.length;for(x=bt(x),x<0&&(x=-x>E?0:E+x),_=_===s||_>E?E:bt(_),_<0&&(_+=E),_=x>_?0:Nw(_);x<_;)l[x++]=u;return l}function l0(l,u){var x=[];return Kn(l,function(_,E,F){u(_,E,F)&&x.push(_)}),x}function Xs(l,u,x,_,E){var F=-1,B=l.length;for(x||(x=gT),E||(E=[]);++F<B;){var H=l[F];u>0&&x(H)?u>1?Xs(H,u-1,x,_,E):Wn(E,H):_||(E[E.length]=H)}return E}var Rf=D0(),c0=D0(!0);function Ha(l,u){return l&&Rf(l,u,Hs)}function Pf(l,u){return l&&c0(l,u,Hs)}function bu(l,u){return Vn(u,function(x){return wn(l[x])})}function Qi(l,u){u=Yn(u,l);for(var x=0,_=u.length;l!=null&&x<_;)l=l[Ka(u[x++])];return x&&x==_?l:s}function d0(l,u,x){var _=u(l);return yt(l)?_:Wn(_,x(l))}function pr(l){return l==null?l===s?de:Ms:Wi&&Wi in as(l)?uT(l):NT(l)}function If(l,u){return l>u}function TA(l,u){return l!=null&&Xt.call(l,u)}function RA(l,u){return l!=null&&u in as(l)}function PA(l,u,x){return l>=or(u,x)&&l<Us(u,x)}function Df(l,u,x){for(var _=x?xf:ru,E=l[0].length,F=l.length,B=F,H=ie(F),J=1/0,pe=[];B--;){var ge=l[B];B&&u&&(ge=xs(ge,Kr(u))),J=or(ge.length,J),H[B]=!x&&(u||E>=120&&ge.length>=120)?new Gi(B&&ge):s}ge=l[0];var ve=-1,Ae=H[0];e:for(;++ve<E&&pe.length<J;){var qe=ge[ve],tt=u?u(qe):qe;if(qe=x||qe!==0?qe:0,!(Ae?uc(Ae,tt):_(pe,tt,x))){for(B=F;--B;){var St=H[B];if(!(St?uc(St,tt):_(l[B],tt,x)))continue e}Ae&&Ae.push(tt),pe.push(qe)}}return pe}function IA(l,u,x,_){return Ha(l,function(E,F,B){u(_,x(E),F,B)}),_}function vc(l,u,x){u=Yn(u,l),l=J0(l,u);var _=l==null?l:l[Ka(ja(u))];return _==null?s:Gr(_,l,x)}function u0(l){return Ss(l)&&pr(l)==Qe}function DA(l){return Ss(l)&&pr(l)==et}function FA(l){return Ss(l)&&pr(l)==he}function wc(l,u,x,_,E){return l===u?!0:l==null||u==null||!Ss(l)&&!Ss(u)?l!==l&&u!==u:OA(l,u,x,_,wc,E)}function OA(l,u,x,_,E,F){var B=yt(l),H=yt(u),J=B?nt:lr(l),pe=H?nt:lr(u);J=J==Qe?os:J,pe=pe==Qe?os:pe;var ge=J==os,ve=pe==os,Ae=J==pe;if(Ae&&Zn(l)){if(!Zn(u))return!1;B=!0,ge=!1}if(Ae&&!ge)return F||(F=new Pa),B||tl(l)?V0(l,u,x,_,E,F):cT(l,u,J,x,_,E,F);if(!(x&b)){var qe=ge&&Xt.call(l,"__wrapped__"),tt=ve&&Xt.call(u,"__wrapped__");if(qe||tt){var St=qe?l.value():l,st=tt?u.value():u;return F||(F=new Pa),E(St,st,x,_,F)}}return Ae?(F||(F=new Pa),dT(l,u,x,_,E,F)):!1}function MA(l){return Ss(l)&&lr(l)==Tt}function Ff(l,u,x,_){var E=x.length,F=E,B=!_;if(l==null)return!F;for(l=as(l);E--;){var H=x[E];if(B&&H[2]?H[1]!==l[H[0]]:!(H[0]in l))return!1}for(;++E<F;){H=x[E];var J=H[0],pe=l[J],ge=H[1];if(B&&H[2]){if(pe===s&&!(J in l))return!1}else{var ve=new Pa;if(_)var Ae=_(pe,ge,J,l,u,ve);if(!(Ae===s?wc(ge,pe,b|w,_,ve):Ae))return!1}}return!0}function h0(l){if(!ws(l)||vT(l))return!1;var u=wn(l)?M4:CE;return u.test(Ji(l))}function LA(l){return Ss(l)&&pr(l)==oe}function UA(l){return Ss(l)&&lr(l)==Se}function $A(l){return Ss(l)&&Uu(l.length)&&!!hs[pr(l)]}function m0(l){return typeof l=="function"?l:l==null?Tr:typeof l=="object"?yt(l)?x0(l[0],l[1]):p0(l):Fw(l)}function Of(l){if(!_c(l))return q4(l);var u=[];for(var x in as(l))Xt.call(l,x)&&x!="constructor"&&u.push(x);return u}function zA(l){if(!ws(l))return _T(l);var u=_c(l),x=[];for(var _ in l)_=="constructor"&&(u||!Xt.call(l,_))||x.push(_);return x}function Mf(l,u){return l<u}function f0(l,u){var x=-1,_=Er(l)?ie(l.length):[];return Kn(l,function(E,F,B){_[++x]=u(E,F,B)}),_}function p0(l){var u=Zf(l);return u.length==1&&u[0][2]?Q0(u[0][0],u[0][1]):function(x){return x===l||Ff(x,l,u)}}function x0(l,u){return ep(l)&&K0(u)?Q0(Ka(l),u):function(x){var _=dp(x,l);return _===s&&_===u?up(x,l):wc(u,_,b|w)}}function _u(l,u,x,_,E){l!==u&&Rf(u,function(F,B){if(E||(E=new Pa),ws(F))BA(l,u,B,x,_u,_,E);else{var H=_?_(sp(l,B),F,B+"",l,u,E):s;H===s&&(H=F),Af(l,B,H)}},Ar)}function BA(l,u,x,_,E,F,B){var H=sp(l,x),J=sp(u,x),pe=B.get(J);if(pe){Af(l,x,pe);return}var ge=F?F(H,J,x+"",l,u,B):s,ve=ge===s;if(ve){var Ae=yt(J),qe=!Ae&&Zn(J),tt=!Ae&&!qe&&tl(J);ge=J,Ae||qe||tt?yt(H)?ge=H:Rs(H)?ge=Cr(H):qe?(ve=!1,ge=E0(J,!0)):tt?(ve=!1,ge=A0(J,!0)):ge=[]:Sc(J)||Zi(J)?(ge=H,Zi(H)?ge=Sw(H):(!ws(H)||wn(H))&&(ge=G0(J))):ve=!1}ve&&(B.set(J,ge),E(ge,J,_,F,B),B.delete(J)),Af(l,x,ge)}function g0(l,u){var x=l.length;if(x)return u+=u<0?x:0,vn(u,x)?l[u]:s}function y0(l,u,x){u.length?u=xs(u,function(F){return yt(F)?function(B){return Qi(B,F.length===1?F[0]:F)}:F}):u=[Tr];var _=-1;u=xs(u,Kr(Ze()));var E=f0(l,function(F,B,H){var J=xs(u,function(pe){return pe(F)});return{criteria:J,index:++_,value:F}});return p4(E,function(F,B){return tT(F,B,x)})}function qA(l,u){return v0(l,u,function(x,_){return up(l,_)})}function v0(l,u,x){for(var _=-1,E=u.length,F={};++_<E;){var B=u[_],H=Qi(l,B);x(H,B)&&jc(F,Yn(B,l),H)}return F}function VA(l){return function(u){return Qi(u,l)}}function Lf(l,u,x,_){var E=_?f4:Vo,F=-1,B=u.length,H=l;for(l===u&&(u=Cr(u)),x&&(H=xs(l,Kr(x)));++F<B;)for(var J=0,pe=u[F],ge=x?x(pe):pe;(J=E(H,ge,J,_))>-1;)H!==l&&mu.call(H,J,1),mu.call(l,J,1);return l}function w0(l,u){for(var x=l?u.length:0,_=x-1;x--;){var E=u[x];if(x==_||E!==F){var F=E;vn(E)?mu.call(l,E,1):Bf(l,E)}}return l}function Uf(l,u){return l+xu(e0()*(u-l+1))}function WA(l,u,x,_){for(var E=-1,F=Us(pu((u-l)/(x||1)),0),B=ie(F);F--;)B[_?F:++E]=l,l+=x;return B}function $f(l,u){var x="";if(!l||u<1||u>le)return x;do u%2&&(x+=l),u=xu(u/2),u&&(l+=l);while(u);return x}function Ct(l,u){return rp(Y0(l,u,Tr),l+"")}function HA(l){return r0(sl(l))}function GA(l,u){var x=sl(l);return Iu(x,Ki(u,0,x.length))}function jc(l,u,x,_){if(!ws(l))return l;u=Yn(u,l);for(var E=-1,F=u.length,B=F-1,H=l;H!=null&&++E<F;){var J=Ka(u[E]),pe=x;if(J==="__proto__"||J==="constructor"||J==="prototype")return l;if(E!=B){var ge=H[J];pe=_?_(ge,J,H):s,pe===s&&(pe=ws(ge)?ge:vn(u[E+1])?[]:{})}gc(H,J,pe),H=H[J]}return l}var j0=gu?function(l,u){return gu.set(l,u),l}:Tr,KA=fu?function(l,u){return fu(l,"toString",{configurable:!0,enumerable:!1,value:mp(u),writable:!0})}:Tr;function QA(l){return Iu(sl(l))}function wa(l,u,x){var _=-1,E=l.length;u<0&&(u=-u>E?0:E+u),x=x>E?E:x,x<0&&(x+=E),E=u>x?0:x-u>>>0,u>>>=0;for(var F=ie(E);++_<E;)F[_]=l[_+u];return F}function YA(l,u){var x;return Kn(l,function(_,E,F){return x=u(_,E,F),!x}),!!x}function Nu(l,u,x){var _=0,E=l==null?_:l.length;if(typeof u=="number"&&u===u&&E<=ce){for(;_<E;){var F=_+E>>>1,B=l[F];B!==null&&!Yr(B)&&(x?B<=u:B<u)?_=F+1:E=F}return E}return zf(l,u,Tr,x)}function zf(l,u,x,_){var E=0,F=l==null?0:l.length;if(F===0)return 0;u=x(u);for(var B=u!==u,H=u===null,J=Yr(u),pe=u===s;E<F;){var ge=xu((E+F)/2),ve=x(l[ge]),Ae=ve!==s,qe=ve===null,tt=ve===ve,St=Yr(ve);if(B)var st=_||tt;else pe?st=tt&&(_||Ae):H?st=tt&&Ae&&(_||!qe):J?st=tt&&Ae&&!qe&&(_||!St):qe||St?st=!1:st=_?ve<=u:ve<u;st?E=ge+1:F=ge}return or(F,$e)}function b0(l,u){for(var x=-1,_=l.length,E=0,F=[];++x<_;){var B=l[x],H=u?u(B):B;if(!x||!Ia(H,J)){var J=H;F[E++]=B===0?0:B}}return F}function _0(l){return typeof l=="number"?l:Yr(l)?Ke:+l}function Qr(l){if(typeof l=="string")return l;if(yt(l))return xs(l,Qr)+"";if(Yr(l))return t0?t0.call(l):"";var u=l+"";return u=="0"&&1/l==-Y?"-0":u}function Qn(l,u,x){var _=-1,E=ru,F=l.length,B=!0,H=[],J=H;if(x)B=!1,E=xf;else if(F>=n){var pe=u?null:oT(l);if(pe)return nu(pe);B=!1,E=uc,J=new Gi}else J=u?[]:H;e:for(;++_<F;){var ge=l[_],ve=u?u(ge):ge;if(ge=x||ge!==0?ge:0,B&&ve===ve){for(var Ae=J.length;Ae--;)if(J[Ae]===ve)continue e;u&&J.push(ve),H.push(ge)}else E(J,ve,x)||(J!==H&&J.push(ve),H.push(ge))}return H}function Bf(l,u){return u=Yn(u,l),l=J0(l,u),l==null||delete l[Ka(ja(u))]}function N0(l,u,x,_){return jc(l,u,x(Qi(l,u)),_)}function Su(l,u,x,_){for(var E=l.length,F=_?E:-1;(_?F--:++F<E)&&u(l[F],F,l););return x?wa(l,_?0:F,_?F+1:E):wa(l,_?F+1:0,_?E:F)}function S0(l,u){var x=l;return x instanceof Dt&&(x=x.value()),gf(u,function(_,E){return E.func.apply(E.thisArg,Wn([_],E.args))},x)}function qf(l,u,x){var _=l.length;if(_<2)return _?Qn(l[0]):[];for(var E=-1,F=ie(_);++E<_;)for(var B=l[E],H=-1;++H<_;)H!=E&&(F[E]=yc(F[E]||B,l[H],u,x));return Qn(Xs(F,1),u,x)}function k0(l,u,x){for(var _=-1,E=l.length,F=u.length,B={};++_<E;){var H=_<F?u[_]:s;x(B,l[_],H)}return B}function Vf(l){return Rs(l)?l:[]}function Wf(l){return typeof l=="function"?l:Tr}function Yn(l,u){return yt(l)?l:ep(l,u)?[l]:tw(Kt(l))}var JA=Ct;function Jn(l,u,x){var _=l.length;return x=x===s?_:x,!u&&x>=_?l:wa(l,u,x)}var C0=L4||function(l){return Zs.clearTimeout(l)};function E0(l,u){if(u)return l.slice();var x=l.length,_=Qv?Qv(x):new l.constructor(x);return l.copy(_),_}function Hf(l){var u=new l.constructor(l.byteLength);return new uu(u).set(new uu(l)),u}function ZA(l,u){var x=u?Hf(l.buffer):l.buffer;return new l.constructor(x,l.byteOffset,l.byteLength)}function XA(l){var u=new l.constructor(l.source,uv.exec(l));return u.lastIndex=l.lastIndex,u}function eT(l){return xc?as(xc.call(l)):{}}function A0(l,u){var x=u?Hf(l.buffer):l.buffer;return new l.constructor(x,l.byteOffset,l.length)}function T0(l,u){if(l!==u){var x=l!==s,_=l===null,E=l===l,F=Yr(l),B=u!==s,H=u===null,J=u===u,pe=Yr(u);if(!H&&!pe&&!F&&l>u||F&&B&&J&&!H&&!pe||_&&B&&J||!x&&J||!E)return 1;if(!_&&!F&&!pe&&l<u||pe&&x&&E&&!_&&!F||H&&x&&E||!B&&E||!J)return-1}return 0}function tT(l,u,x){for(var _=-1,E=l.criteria,F=u.criteria,B=E.length,H=x.length;++_<B;){var J=T0(E[_],F[_]);if(J){if(_>=H)return J;var pe=x[_];return J*(pe=="desc"?-1:1)}}return l.index-u.index}function R0(l,u,x,_){for(var E=-1,F=l.length,B=x.length,H=-1,J=u.length,pe=Us(F-B,0),ge=ie(J+pe),ve=!_;++H<J;)ge[H]=u[H];for(;++E<B;)(ve||E<F)&&(ge[x[E]]=l[E]);for(;pe--;)ge[H++]=l[E++];return ge}function P0(l,u,x,_){for(var E=-1,F=l.length,B=-1,H=x.length,J=-1,pe=u.length,ge=Us(F-H,0),ve=ie(ge+pe),Ae=!_;++E<ge;)ve[E]=l[E];for(var qe=E;++J<pe;)ve[qe+J]=u[J];for(;++B<H;)(Ae||E<F)&&(ve[qe+x[B]]=l[E++]);return ve}function Cr(l,u){var x=-1,_=l.length;for(u||(u=ie(_));++x<_;)u[x]=l[x];return u}function Ga(l,u,x,_){var E=!x;x||(x={});for(var F=-1,B=u.length;++F<B;){var H=u[F],J=_?_(x[H],l[H],H,x,l):s;J===s&&(J=l[H]),E?xn(x,H,J):gc(x,H,J)}return x}function sT(l,u){return Ga(l,Xf(l),u)}function rT(l,u){return Ga(l,W0(l),u)}function ku(l,u){return function(x,_){var E=yt(x)?l4:SA,F=u?u():{};return E(x,l,Ze(_,2),F)}}function Zo(l){return Ct(function(u,x){var _=-1,E=x.length,F=E>1?x[E-1]:s,B=E>2?x[2]:s;for(F=l.length>3&&typeof F=="function"?(E--,F):s,B&&xr(x[0],x[1],B)&&(F=E<3?s:F,E=1),u=as(u);++_<E;){var H=x[_];H&&l(u,H,_,F)}return u})}function I0(l,u){return function(x,_){if(x==null)return x;if(!Er(x))return l(x,_);for(var E=x.length,F=u?E:-1,B=as(x);(u?F--:++F<E)&&_(B[F],F,B)!==!1;);return x}}function D0(l){return function(u,x,_){for(var E=-1,F=as(u),B=_(u),H=B.length;H--;){var J=B[l?H:++E];if(x(F[J],J,F)===!1)break}return u}}function aT(l,u,x){var _=u&S,E=bc(l);function F(){var B=this&&this!==Zs&&this instanceof F?E:l;return B.apply(_?x:this,arguments)}return F}function F0(l){return function(u){u=Kt(u);var x=Wo(u)?Ra(u):s,_=x?x[0]:u.charAt(0),E=x?Jn(x,1).join(""):u.slice(1);return _[l]()+E}}function Xo(l){return function(u){return gf(Iw(Pw(u).replace(KE,"")),l,"")}}function bc(l){return function(){var u=arguments;switch(u.length){case 0:return new l;case 1:return new l(u[0]);case 2:return new l(u[0],u[1]);case 3:return new l(u[0],u[1],u[2]);case 4:return new l(u[0],u[1],u[2],u[3]);case 5:return new l(u[0],u[1],u[2],u[3],u[4]);case 6:return new l(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new l(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var x=Jo(l.prototype),_=l.apply(x,u);return ws(_)?_:x}}function nT(l,u,x){var _=bc(l);function E(){for(var F=arguments.length,B=ie(F),H=F,J=el(E);H--;)B[H]=arguments[H];var pe=F<3&&B[0]!==J&&B[F-1]!==J?[]:Hn(B,J);if(F-=pe.length,F<x)return $0(l,u,Cu,E.placeholder,s,B,pe,s,s,x-F);var ge=this&&this!==Zs&&this instanceof E?_:l;return Gr(ge,this,B)}return E}function O0(l){return function(u,x,_){var E=as(u);if(!Er(u)){var F=Ze(x,3);u=Hs(u),x=function(H){return F(E[H],H,E)}}var B=l(u,x,_);return B>-1?E[F?u[B]:B]:s}}function M0(l){return yn(function(u){var x=u.length,_=x,E=ya.prototype.thru;for(l&&u.reverse();_--;){var F=u[_];if(typeof F!="function")throw new ga(o);if(E&&!B&&Ru(F)=="wrapper")var B=new ya([],!0)}for(_=B?_:x;++_<x;){F=u[_];var H=Ru(F),J=H=="wrapper"?Jf(F):s;J&&tp(J[0])&&J[1]==(T|j|k|O)&&!J[4].length&&J[9]==1?B=B[Ru(J[0])].apply(B,J[3]):B=F.length==1&&tp(F)?B[H]():B.thru(F)}return function(){var pe=arguments,ge=pe[0];if(B&&pe.length==1&&yt(ge))return B.plant(ge).value();for(var ve=0,Ae=x?u[ve].apply(this,pe):ge;++ve<x;)Ae=u[ve].call(this,Ae);return Ae}})}function Cu(l,u,x,_,E,F,B,H,J,pe){var ge=u&T,ve=u&S,Ae=u&N,qe=u&(j|C),tt=u&U,St=Ae?s:bc(l);function st(){for(var Rt=arguments.length,Mt=ie(Rt),Jr=Rt;Jr--;)Mt[Jr]=arguments[Jr];if(qe)var gr=el(st),Zr=g4(Mt,gr);if(_&&(Mt=R0(Mt,_,E,qe)),F&&(Mt=P0(Mt,F,B,qe)),Rt-=Zr,qe&&Rt<pe){var Ps=Hn(Mt,gr);return $0(l,u,Cu,st.placeholder,x,Mt,Ps,H,J,pe-Rt)}var Da=ve?x:this,bn=Ae?Da[l]:l;return Rt=Mt.length,H?Mt=ST(Mt,H):tt&&Rt>1&&Mt.reverse(),ge&&J<Rt&&(Mt.length=J),this&&this!==Zs&&this instanceof st&&(bn=St||bc(bn)),bn.apply(Da,Mt)}return st}function L0(l,u){return function(x,_){return IA(x,l,u(_),{})}}function Eu(l,u){return function(x,_){var E;if(x===s&&_===s)return u;if(x!==s&&(E=x),_!==s){if(E===s)return _;typeof x=="string"||typeof _=="string"?(x=Qr(x),_=Qr(_)):(x=_0(x),_=_0(_)),E=l(x,_)}return E}}function Gf(l){return yn(function(u){return u=xs(u,Kr(Ze())),Ct(function(x){var _=this;return l(u,function(E){return Gr(E,_,x)})})})}function Au(l,u){u=u===s?" ":Qr(u);var x=u.length;if(x<2)return x?$f(u,l):u;var _=$f(u,pu(l/Ho(u)));return Wo(u)?Jn(Ra(_),0,l).join(""):_.slice(0,l)}function iT(l,u,x,_){var E=u&S,F=bc(l);function B(){for(var H=-1,J=arguments.length,pe=-1,ge=_.length,ve=ie(ge+J),Ae=this&&this!==Zs&&this instanceof B?F:l;++pe<ge;)ve[pe]=_[pe];for(;J--;)ve[pe++]=arguments[++H];return Gr(Ae,E?x:this,ve)}return B}function U0(l){return function(u,x,_){return _&&typeof _!="number"&&xr(u,x,_)&&(x=_=s),u=jn(u),x===s?(x=u,u=0):x=jn(x),_=_===s?u<x?1:-1:jn(_),WA(u,x,_,l)}}function Tu(l){return function(u,x){return typeof u=="string"&&typeof x=="string"||(u=ba(u),x=ba(x)),l(u,x)}}function $0(l,u,x,_,E,F,B,H,J,pe){var ge=u&j,ve=ge?B:s,Ae=ge?s:B,qe=ge?F:s,tt=ge?s:F;u|=ge?k:I,u&=~(ge?I:k),u&v||(u&=~(S|N));var St=[l,u,E,qe,ve,tt,Ae,H,J,pe],st=x.apply(s,St);return tp(l)&&Z0(st,St),st.placeholder=_,X0(st,l,u)}function Kf(l){var u=Ls[l];return function(x,_){if(x=ba(x),_=_==null?0:or(bt(_),292),_&&Xv(x)){var E=(Kt(x)+"e").split("e"),F=u(E[0]+"e"+(+E[1]+_));return E=(Kt(F)+"e").split("e"),+(E[0]+"e"+(+E[1]-_))}return u(x)}}var oT=Qo&&1/nu(new Qo([,-0]))[1]==Y?function(l){return new Qo(l)}:xp;function z0(l){return function(u){var x=lr(u);return x==Tt?Nf(u):x==Se?N4(u):x4(u,l(u))}}function gn(l,u,x,_,E,F,B,H){var J=u&N;if(!J&&typeof l!="function")throw new ga(o);var pe=_?_.length:0;if(pe||(u&=~(k|I),_=E=s),B=B===s?B:Us(bt(B),0),H=H===s?H:bt(H),pe-=E?E.length:0,u&I){var ge=_,ve=E;_=E=s}var Ae=J?s:Jf(l),qe=[l,u,x,_,E,ge,ve,F,B,H];if(Ae&&bT(qe,Ae),l=qe[0],u=qe[1],x=qe[2],_=qe[3],E=qe[4],H=qe[9]=qe[9]===s?J?0:l.length:Us(qe[9]-pe,0),!H&&u&(j|C)&&(u&=~(j|C)),!u||u==S)var tt=aT(l,u,x);else u==j||u==C?tt=nT(l,u,H):(u==k||u==(S|k))&&!E.length?tt=iT(l,u,x,_):tt=Cu.apply(s,qe);var St=Ae?j0:Z0;return X0(St(tt,qe),l,u)}function B0(l,u,x,_){return l===s||Ia(l,Ko[x])&&!Xt.call(_,x)?u:l}function q0(l,u,x,_,E,F){return ws(l)&&ws(u)&&(F.set(u,l),_u(l,u,s,q0,F),F.delete(u)),l}function lT(l){return Sc(l)?s:l}function V0(l,u,x,_,E,F){var B=x&b,H=l.length,J=u.length;if(H!=J&&!(B&&J>H))return!1;var pe=F.get(l),ge=F.get(u);if(pe&&ge)return pe==u&&ge==l;var ve=-1,Ae=!0,qe=x&w?new Gi:s;for(F.set(l,u),F.set(u,l);++ve<H;){var tt=l[ve],St=u[ve];if(_)var st=B?_(St,tt,ve,u,l,F):_(tt,St,ve,l,u,F);if(st!==s){if(st)continue;Ae=!1;break}if(qe){if(!yf(u,function(Rt,Mt){if(!uc(qe,Mt)&&(tt===Rt||E(tt,Rt,x,_,F)))return qe.push(Mt)})){Ae=!1;break}}else if(!(tt===St||E(tt,St,x,_,F))){Ae=!1;break}}return F.delete(l),F.delete(u),Ae}function cT(l,u,x,_,E,F,B){switch(x){case Wt:if(l.byteLength!=u.byteLength||l.byteOffset!=u.byteOffset)return!1;l=l.buffer,u=u.buffer;case et:return!(l.byteLength!=u.byteLength||!F(new uu(l),new uu(u)));case ct:case he:case Os:return Ia(+l,+u);case Me:return l.name==u.name&&l.message==u.message;case oe:case _e:return l==u+"";case Tt:var H=Nf;case Se:var J=_&b;if(H||(H=nu),l.size!=u.size&&!J)return!1;var pe=B.get(l);if(pe)return pe==u;_|=w,B.set(l,u);var ge=V0(H(l),H(u),_,E,F,B);return B.delete(l),ge;case we:if(xc)return xc.call(l)==xc.call(u)}return!1}function dT(l,u,x,_,E,F){var B=x&b,H=Qf(l),J=H.length,pe=Qf(u),ge=pe.length;if(J!=ge&&!B)return!1;for(var ve=J;ve--;){var Ae=H[ve];if(!(B?Ae in u:Xt.call(u,Ae)))return!1}var qe=F.get(l),tt=F.get(u);if(qe&&tt)return qe==u&&tt==l;var St=!0;F.set(l,u),F.set(u,l);for(var st=B;++ve<J;){Ae=H[ve];var Rt=l[Ae],Mt=u[Ae];if(_)var Jr=B?_(Mt,Rt,Ae,u,l,F):_(Rt,Mt,Ae,l,u,F);if(!(Jr===s?Rt===Mt||E(Rt,Mt,x,_,F):Jr)){St=!1;break}st||(st=Ae=="constructor")}if(St&&!st){var gr=l.constructor,Zr=u.constructor;gr!=Zr&&"constructor"in l&&"constructor"in u&&!(typeof gr=="function"&&gr instanceof gr&&typeof Zr=="function"&&Zr instanceof Zr)&&(St=!1)}return F.delete(l),F.delete(u),St}function yn(l){return rp(Y0(l,s,nw),l+"")}function Qf(l){return d0(l,Hs,Xf)}function Yf(l){return d0(l,Ar,W0)}var Jf=gu?function(l){return gu.get(l)}:xp;function Ru(l){for(var u=l.name+"",x=Yo[u],_=Xt.call(Yo,u)?x.length:0;_--;){var E=x[_],F=E.func;if(F==null||F==l)return E.name}return u}function el(l){var u=Xt.call(P,"placeholder")?P:l;return u.placeholder}function Ze(){var l=P.iteratee||fp;return l=l===fp?m0:l,arguments.length?l(arguments[0],arguments[1]):l}function Pu(l,u){var x=l.__data__;return yT(u)?x[typeof u=="string"?"string":"hash"]:x.map}function Zf(l){for(var u=Hs(l),x=u.length;x--;){var _=u[x],E=l[_];u[x]=[_,E,K0(E)]}return u}function Yi(l,u){var x=j4(l,u);return h0(x)?x:s}function uT(l){var u=Xt.call(l,Wi),x=l[Wi];try{l[Wi]=s;var _=!0}catch{}var E=cu.call(l);return _&&(u?l[Wi]=x:delete l[Wi]),E}var Xf=kf?function(l){return l==null?[]:(l=as(l),Vn(kf(l),function(u){return Jv.call(l,u)}))}:gp,W0=kf?function(l){for(var u=[];l;)Wn(u,Xf(l)),l=hu(l);return u}:gp,lr=pr;(Cf&&lr(new Cf(new ArrayBuffer(1)))!=Wt||mc&&lr(new mc)!=Tt||Ef&&lr(Ef.resolve())!=V||Qo&&lr(new Qo)!=Se||fc&&lr(new fc)!=je)&&(lr=function(l){var u=pr(l),x=u==os?l.constructor:s,_=x?Ji(x):"";if(_)switch(_){case G4:return Wt;case K4:return Tt;case Q4:return V;case Y4:return Se;case J4:return je}return u});function hT(l,u,x){for(var _=-1,E=x.length;++_<E;){var F=x[_],B=F.size;switch(F.type){case"drop":l+=B;break;case"dropRight":u-=B;break;case"take":u=or(u,l+B);break;case"takeRight":l=Us(l,u-B);break}}return{start:l,end:u}}function mT(l){var u=l.match(vE);return u?u[1].split(wE):[]}function H0(l,u,x){u=Yn(u,l);for(var _=-1,E=u.length,F=!1;++_<E;){var B=Ka(u[_]);if(!(F=l!=null&&x(l,B)))break;l=l[B]}return F||++_!=E?F:(E=l==null?0:l.length,!!E&&Uu(E)&&vn(B,E)&&(yt(l)||Zi(l)))}function fT(l){var u=l.length,x=new l.constructor(u);return u&&typeof l[0]=="string"&&Xt.call(l,"index")&&(x.index=l.index,x.input=l.input),x}function G0(l){return typeof l.constructor=="function"&&!_c(l)?Jo(hu(l)):{}}function pT(l,u,x){var _=l.constructor;switch(u){case et:return Hf(l);case ct:case he:return new _(+l);case Wt:return ZA(l,x);case Ws:case Js:case qr:case ma:case Vr:case fa:case kr:case ir:case mn:return A0(l,x);case Tt:return new _;case Os:case _e:return new _(l);case oe:return XA(l);case Se:return new _;case we:return eT(l)}}function xT(l,u){var x=u.length;if(!x)return l;var _=x-1;return u[_]=(x>1?"& ":"")+u[_],u=u.join(x>2?", ":" "),l.replace(yE,`{
/* [wrapped with `+u+`] */
`)}function gT(l){return yt(l)||Zi(l)||!!(Zv&&l&&l[Zv])}function vn(l,u){var x=typeof l;return u=u??le,!!u&&(x=="number"||x!="symbol"&&AE.test(l))&&l>-1&&l%1==0&&l<u}function xr(l,u,x){if(!ws(x))return!1;var _=typeof u;return(_=="number"?Er(x)&&vn(u,x.length):_=="string"&&u in x)?Ia(x[u],l):!1}function ep(l,u){if(yt(l))return!1;var x=typeof l;return x=="number"||x=="symbol"||x=="boolean"||l==null||Yr(l)?!0:fE.test(l)||!mE.test(l)||u!=null&&l in as(u)}function yT(l){var u=typeof l;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?l!=="__proto__":l===null}function tp(l){var u=Ru(l),x=P[u];if(typeof x!="function"||!(u in Dt.prototype))return!1;if(l===x)return!0;var _=Jf(x);return!!_&&l===_[0]}function vT(l){return!!Kv&&Kv in l}var wT=ou?wn:yp;function _c(l){var u=l&&l.constructor,x=typeof u=="function"&&u.prototype||Ko;return l===x}function K0(l){return l===l&&!ws(l)}function Q0(l,u){return function(x){return x==null?!1:x[l]===u&&(u!==s||l in as(x))}}function jT(l){var u=Mu(l,function(_){return x.size===h&&x.clear(),_}),x=u.cache;return u}function bT(l,u){var x=l[1],_=u[1],E=x|_,F=E<(S|N|T),B=_==T&&x==j||_==T&&x==O&&l[7].length<=u[8]||_==(T|O)&&u[7].length<=u[8]&&x==j;if(!(F||B))return l;_&S&&(l[2]=u[2],E|=x&S?0:v);var H=u[3];if(H){var J=l[3];l[3]=J?R0(J,H,u[4]):H,l[4]=J?Hn(l[3],m):u[4]}return H=u[5],H&&(J=l[5],l[5]=J?P0(J,H,u[6]):H,l[6]=J?Hn(l[5],m):u[6]),H=u[7],H&&(l[7]=H),_&T&&(l[8]=l[8]==null?u[8]:or(l[8],u[8])),l[9]==null&&(l[9]=u[9]),l[0]=u[0],l[1]=E,l}function _T(l){var u=[];if(l!=null)for(var x in as(l))u.push(x);return u}function NT(l){return cu.call(l)}function Y0(l,u,x){return u=Us(u===s?l.length-1:u,0),function(){for(var _=arguments,E=-1,F=Us(_.length-u,0),B=ie(F);++E<F;)B[E]=_[u+E];E=-1;for(var H=ie(u+1);++E<u;)H[E]=_[E];return H[u]=x(B),Gr(l,this,H)}}function J0(l,u){return u.length<2?l:Qi(l,wa(u,0,-1))}function ST(l,u){for(var x=l.length,_=or(u.length,x),E=Cr(l);_--;){var F=u[_];l[_]=vn(F,x)?E[F]:s}return l}function sp(l,u){if(!(u==="constructor"&&typeof l[u]=="function")&&u!="__proto__")return l[u]}var Z0=ew(j0),Nc=$4||function(l,u){return Zs.setTimeout(l,u)},rp=ew(KA);function X0(l,u,x){var _=u+"";return rp(l,xT(_,kT(mT(_),x)))}function ew(l){var u=0,x=0;return function(){var _=V4(),E=se-(_-x);if(x=_,E>0){if(++u>=M)return arguments[0]}else u=0;return l.apply(s,arguments)}}function Iu(l,u){var x=-1,_=l.length,E=_-1;for(u=u===s?_:u;++x<u;){var F=Uf(x,E),B=l[F];l[F]=l[x],l[x]=B}return l.length=u,l}var tw=jT(function(l){var u=[];return l.charCodeAt(0)===46&&u.push(""),l.replace(pE,function(x,_,E,F){u.push(E?F.replace(_E,"$1"):_||x)}),u});function Ka(l){if(typeof l=="string"||Yr(l))return l;var u=l+"";return u=="0"&&1/l==-Y?"-0":u}function Ji(l){if(l!=null){try{return lu.call(l)}catch{}try{return l+""}catch{}}return""}function kT(l,u){return xa(Re,function(x){var _="_."+x[0];u&x[1]&&!ru(l,_)&&l.push(_)}),l.sort()}function sw(l){if(l instanceof Dt)return l.clone();var u=new ya(l.__wrapped__,l.__chain__);return u.__actions__=Cr(l.__actions__),u.__index__=l.__index__,u.__values__=l.__values__,u}function CT(l,u,x){(x?xr(l,u,x):u===s)?u=1:u=Us(bt(u),0);var _=l==null?0:l.length;if(!_||u<1)return[];for(var E=0,F=0,B=ie(pu(_/u));E<_;)B[F++]=wa(l,E,E+=u);return B}function ET(l){for(var u=-1,x=l==null?0:l.length,_=0,E=[];++u<x;){var F=l[u];F&&(E[_++]=F)}return E}function AT(){var l=arguments.length;if(!l)return[];for(var u=ie(l-1),x=arguments[0],_=l;_--;)u[_-1]=arguments[_];return Wn(yt(x)?Cr(x):[x],Xs(u,1))}var TT=Ct(function(l,u){return Rs(l)?yc(l,Xs(u,1,Rs,!0)):[]}),RT=Ct(function(l,u){var x=ja(u);return Rs(x)&&(x=s),Rs(l)?yc(l,Xs(u,1,Rs,!0),Ze(x,2)):[]}),PT=Ct(function(l,u){var x=ja(u);return Rs(x)&&(x=s),Rs(l)?yc(l,Xs(u,1,Rs,!0),s,x):[]});function IT(l,u,x){var _=l==null?0:l.length;return _?(u=x||u===s?1:bt(u),wa(l,u<0?0:u,_)):[]}function DT(l,u,x){var _=l==null?0:l.length;return _?(u=x||u===s?1:bt(u),u=_-u,wa(l,0,u<0?0:u)):[]}function FT(l,u){return l&&l.length?Su(l,Ze(u,3),!0,!0):[]}function OT(l,u){return l&&l.length?Su(l,Ze(u,3),!0):[]}function MT(l,u,x,_){var E=l==null?0:l.length;return E?(x&&typeof x!="number"&&xr(l,u,x)&&(x=0,_=E),AA(l,u,x,_)):[]}function rw(l,u,x){var _=l==null?0:l.length;if(!_)return-1;var E=x==null?0:bt(x);return E<0&&(E=Us(_+E,0)),au(l,Ze(u,3),E)}function aw(l,u,x){var _=l==null?0:l.length;if(!_)return-1;var E=_-1;return x!==s&&(E=bt(x),E=x<0?Us(_+E,0):or(E,_-1)),au(l,Ze(u,3),E,!0)}function nw(l){var u=l==null?0:l.length;return u?Xs(l,1):[]}function LT(l){var u=l==null?0:l.length;return u?Xs(l,Y):[]}function UT(l,u){var x=l==null?0:l.length;return x?(u=u===s?1:bt(u),Xs(l,u)):[]}function $T(l){for(var u=-1,x=l==null?0:l.length,_={};++u<x;){var E=l[u];_[E[0]]=E[1]}return _}function iw(l){return l&&l.length?l[0]:s}function zT(l,u,x){var _=l==null?0:l.length;if(!_)return-1;var E=x==null?0:bt(x);return E<0&&(E=Us(_+E,0)),Vo(l,u,E)}function BT(l){var u=l==null?0:l.length;return u?wa(l,0,-1):[]}var qT=Ct(function(l){var u=xs(l,Vf);return u.length&&u[0]===l[0]?Df(u):[]}),VT=Ct(function(l){var u=ja(l),x=xs(l,Vf);return u===ja(x)?u=s:x.pop(),x.length&&x[0]===l[0]?Df(x,Ze(u,2)):[]}),WT=Ct(function(l){var u=ja(l),x=xs(l,Vf);return u=typeof u=="function"?u:s,u&&x.pop(),x.length&&x[0]===l[0]?Df(x,s,u):[]});function HT(l,u){return l==null?"":B4.call(l,u)}function ja(l){var u=l==null?0:l.length;return u?l[u-1]:s}function GT(l,u,x){var _=l==null?0:l.length;if(!_)return-1;var E=_;return x!==s&&(E=bt(x),E=E<0?Us(_+E,0):or(E,_-1)),u===u?k4(l,u,E):au(l,$v,E,!0)}function KT(l,u){return l&&l.length?g0(l,bt(u)):s}var QT=Ct(ow);function ow(l,u){return l&&l.length&&u&&u.length?Lf(l,u):l}function YT(l,u,x){return l&&l.length&&u&&u.length?Lf(l,u,Ze(x,2)):l}function JT(l,u,x){return l&&l.length&&u&&u.length?Lf(l,u,s,x):l}var ZT=yn(function(l,u){var x=l==null?0:l.length,_=Tf(l,u);return w0(l,xs(u,function(E){return vn(E,x)?+E:E}).sort(T0)),_});function XT(l,u){var x=[];if(!(l&&l.length))return x;var _=-1,E=[],F=l.length;for(u=Ze(u,3);++_<F;){var B=l[_];u(B,_,l)&&(x.push(B),E.push(_))}return w0(l,E),x}function ap(l){return l==null?l:H4.call(l)}function eR(l,u,x){var _=l==null?0:l.length;return _?(x&&typeof x!="number"&&xr(l,u,x)?(u=0,x=_):(u=u==null?0:bt(u),x=x===s?_:bt(x)),wa(l,u,x)):[]}function tR(l,u){return Nu(l,u)}function sR(l,u,x){return zf(l,u,Ze(x,2))}function rR(l,u){var x=l==null?0:l.length;if(x){var _=Nu(l,u);if(_<x&&Ia(l[_],u))return _}return-1}function aR(l,u){return Nu(l,u,!0)}function nR(l,u,x){return zf(l,u,Ze(x,2),!0)}function iR(l,u){var x=l==null?0:l.length;if(x){var _=Nu(l,u,!0)-1;if(Ia(l[_],u))return _}return-1}function oR(l){return l&&l.length?b0(l):[]}function lR(l,u){return l&&l.length?b0(l,Ze(u,2)):[]}function cR(l){var u=l==null?0:l.length;return u?wa(l,1,u):[]}function dR(l,u,x){return l&&l.length?(u=x||u===s?1:bt(u),wa(l,0,u<0?0:u)):[]}function uR(l,u,x){var _=l==null?0:l.length;return _?(u=x||u===s?1:bt(u),u=_-u,wa(l,u<0?0:u,_)):[]}function hR(l,u){return l&&l.length?Su(l,Ze(u,3),!1,!0):[]}function mR(l,u){return l&&l.length?Su(l,Ze(u,3)):[]}var fR=Ct(function(l){return Qn(Xs(l,1,Rs,!0))}),pR=Ct(function(l){var u=ja(l);return Rs(u)&&(u=s),Qn(Xs(l,1,Rs,!0),Ze(u,2))}),xR=Ct(function(l){var u=ja(l);return u=typeof u=="function"?u:s,Qn(Xs(l,1,Rs,!0),s,u)});function gR(l){return l&&l.length?Qn(l):[]}function yR(l,u){return l&&l.length?Qn(l,Ze(u,2)):[]}function vR(l,u){return u=typeof u=="function"?u:s,l&&l.length?Qn(l,s,u):[]}function np(l){if(!(l&&l.length))return[];var u=0;return l=Vn(l,function(x){if(Rs(x))return u=Us(x.length,u),!0}),bf(u,function(x){return xs(l,vf(x))})}function lw(l,u){if(!(l&&l.length))return[];var x=np(l);return u==null?x:xs(x,function(_){return Gr(u,s,_)})}var wR=Ct(function(l,u){return Rs(l)?yc(l,u):[]}),jR=Ct(function(l){return qf(Vn(l,Rs))}),bR=Ct(function(l){var u=ja(l);return Rs(u)&&(u=s),qf(Vn(l,Rs),Ze(u,2))}),_R=Ct(function(l){var u=ja(l);return u=typeof u=="function"?u:s,qf(Vn(l,Rs),s,u)}),NR=Ct(np);function SR(l,u){return k0(l||[],u||[],gc)}function kR(l,u){return k0(l||[],u||[],jc)}var CR=Ct(function(l){var u=l.length,x=u>1?l[u-1]:s;return x=typeof x=="function"?(l.pop(),x):s,lw(l,x)});function cw(l){var u=P(l);return u.__chain__=!0,u}function ER(l,u){return u(l),l}function Du(l,u){return u(l)}var AR=yn(function(l){var u=l.length,x=u?l[0]:0,_=this.__wrapped__,E=function(F){return Tf(F,l)};return u>1||this.__actions__.length||!(_ instanceof Dt)||!vn(x)?this.thru(E):(_=_.slice(x,+x+(u?1:0)),_.__actions__.push({func:Du,args:[E],thisArg:s}),new ya(_,this.__chain__).thru(function(F){return u&&!F.length&&F.push(s),F}))});function TR(){return cw(this)}function RR(){return new ya(this.value(),this.__chain__)}function PR(){this.__values__===s&&(this.__values__=_w(this.value()));var l=this.__index__>=this.__values__.length,u=l?s:this.__values__[this.__index__++];return{done:l,value:u}}function IR(){return this}function DR(l){for(var u,x=this;x instanceof vu;){var _=sw(x);_.__index__=0,_.__values__=s,u?E.__wrapped__=_:u=_;var E=_;x=x.__wrapped__}return E.__wrapped__=l,u}function FR(){var l=this.__wrapped__;if(l instanceof Dt){var u=l;return this.__actions__.length&&(u=new Dt(this)),u=u.reverse(),u.__actions__.push({func:Du,args:[ap],thisArg:s}),new ya(u,this.__chain__)}return this.thru(ap)}function OR(){return S0(this.__wrapped__,this.__actions__)}var MR=ku(function(l,u,x){Xt.call(l,x)?++l[x]:xn(l,x,1)});function LR(l,u,x){var _=yt(l)?Lv:EA;return x&&xr(l,u,x)&&(u=s),_(l,Ze(u,3))}function UR(l,u){var x=yt(l)?Vn:l0;return x(l,Ze(u,3))}var $R=O0(rw),zR=O0(aw);function BR(l,u){return Xs(Fu(l,u),1)}function qR(l,u){return Xs(Fu(l,u),Y)}function VR(l,u,x){return x=x===s?1:bt(x),Xs(Fu(l,u),x)}function dw(l,u){var x=yt(l)?xa:Kn;return x(l,Ze(u,3))}function uw(l,u){var x=yt(l)?c4:o0;return x(l,Ze(u,3))}var WR=ku(function(l,u,x){Xt.call(l,x)?l[x].push(u):xn(l,x,[u])});function HR(l,u,x,_){l=Er(l)?l:sl(l),x=x&&!_?bt(x):0;var E=l.length;return x<0&&(x=Us(E+x,0)),$u(l)?x<=E&&l.indexOf(u,x)>-1:!!E&&Vo(l,u,x)>-1}var GR=Ct(function(l,u,x){var _=-1,E=typeof u=="function",F=Er(l)?ie(l.length):[];return Kn(l,function(B){F[++_]=E?Gr(u,B,x):vc(B,u,x)}),F}),KR=ku(function(l,u,x){xn(l,x,u)});function Fu(l,u){var x=yt(l)?xs:f0;return x(l,Ze(u,3))}function QR(l,u,x,_){return l==null?[]:(yt(u)||(u=u==null?[]:[u]),x=_?s:x,yt(x)||(x=x==null?[]:[x]),y0(l,u,x))}var YR=ku(function(l,u,x){l[x?0:1].push(u)},function(){return[[],[]]});function JR(l,u,x){var _=yt(l)?gf:Bv,E=arguments.length<3;return _(l,Ze(u,4),x,E,Kn)}function ZR(l,u,x){var _=yt(l)?d4:Bv,E=arguments.length<3;return _(l,Ze(u,4),x,E,o0)}function XR(l,u){var x=yt(l)?Vn:l0;return x(l,Lu(Ze(u,3)))}function eP(l){var u=yt(l)?r0:HA;return u(l)}function tP(l,u,x){(x?xr(l,u,x):u===s)?u=1:u=bt(u);var _=yt(l)?_A:GA;return _(l,u)}function sP(l){var u=yt(l)?NA:QA;return u(l)}function rP(l){if(l==null)return 0;if(Er(l))return $u(l)?Ho(l):l.length;var u=lr(l);return u==Tt||u==Se?l.size:Of(l).length}function aP(l,u,x){var _=yt(l)?yf:YA;return x&&xr(l,u,x)&&(u=s),_(l,Ze(u,3))}var nP=Ct(function(l,u){if(l==null)return[];var x=u.length;return x>1&&xr(l,u[0],u[1])?u=[]:x>2&&xr(u[0],u[1],u[2])&&(u=[u[0]]),y0(l,Xs(u,1),[])}),Ou=U4||function(){return Zs.Date.now()};function iP(l,u){if(typeof u!="function")throw new ga(o);return l=bt(l),function(){if(--l<1)return u.apply(this,arguments)}}function hw(l,u,x){return u=x?s:u,u=l&&u==null?l.length:u,gn(l,T,s,s,s,s,u)}function mw(l,u){var x;if(typeof u!="function")throw new ga(o);return l=bt(l),function(){return--l>0&&(x=u.apply(this,arguments)),l<=1&&(u=s),x}}var ip=Ct(function(l,u,x){var _=S;if(x.length){var E=Hn(x,el(ip));_|=k}return gn(l,_,u,x,E)}),fw=Ct(function(l,u,x){var _=S|N;if(x.length){var E=Hn(x,el(fw));_|=k}return gn(u,_,l,x,E)});function pw(l,u,x){u=x?s:u;var _=gn(l,j,s,s,s,s,s,u);return _.placeholder=pw.placeholder,_}function xw(l,u,x){u=x?s:u;var _=gn(l,C,s,s,s,s,s,u);return _.placeholder=xw.placeholder,_}function gw(l,u,x){var _,E,F,B,H,J,pe=0,ge=!1,ve=!1,Ae=!0;if(typeof l!="function")throw new ga(o);u=ba(u)||0,ws(x)&&(ge=!!x.leading,ve="maxWait"in x,F=ve?Us(ba(x.maxWait)||0,u):F,Ae="trailing"in x?!!x.trailing:Ae);function qe(Ps){var Da=_,bn=E;return _=E=s,pe=Ps,B=l.apply(bn,Da),B}function tt(Ps){return pe=Ps,H=Nc(Rt,u),ge?qe(Ps):B}function St(Ps){var Da=Ps-J,bn=Ps-pe,Ow=u-Da;return ve?or(Ow,F-bn):Ow}function st(Ps){var Da=Ps-J,bn=Ps-pe;return J===s||Da>=u||Da<0||ve&&bn>=F}function Rt(){var Ps=Ou();if(st(Ps))return Mt(Ps);H=Nc(Rt,St(Ps))}function Mt(Ps){return H=s,Ae&&_?qe(Ps):(_=E=s,B)}function Jr(){H!==s&&C0(H),pe=0,_=J=E=H=s}function gr(){return H===s?B:Mt(Ou())}function Zr(){var Ps=Ou(),Da=st(Ps);if(_=arguments,E=this,J=Ps,Da){if(H===s)return tt(J);if(ve)return C0(H),H=Nc(Rt,u),qe(J)}return H===s&&(H=Nc(Rt,u)),B}return Zr.cancel=Jr,Zr.flush=gr,Zr}var oP=Ct(function(l,u){return i0(l,1,u)}),lP=Ct(function(l,u,x){return i0(l,ba(u)||0,x)});function cP(l){return gn(l,U)}function Mu(l,u){if(typeof l!="function"||u!=null&&typeof u!="function")throw new ga(o);var x=function(){var _=arguments,E=u?u.apply(this,_):_[0],F=x.cache;if(F.has(E))return F.get(E);var B=l.apply(this,_);return x.cache=F.set(E,B)||F,B};return x.cache=new(Mu.Cache||pn),x}Mu.Cache=pn;function Lu(l){if(typeof l!="function")throw new ga(o);return function(){var u=arguments;switch(u.length){case 0:return!l.call(this);case 1:return!l.call(this,u[0]);case 2:return!l.call(this,u[0],u[1]);case 3:return!l.call(this,u[0],u[1],u[2])}return!l.apply(this,u)}}function dP(l){return mw(2,l)}var uP=JA(function(l,u){u=u.length==1&&yt(u[0])?xs(u[0],Kr(Ze())):xs(Xs(u,1),Kr(Ze()));var x=u.length;return Ct(function(_){for(var E=-1,F=or(_.length,x);++E<F;)_[E]=u[E].call(this,_[E]);return Gr(l,this,_)})}),op=Ct(function(l,u){var x=Hn(u,el(op));return gn(l,k,s,u,x)}),yw=Ct(function(l,u){var x=Hn(u,el(yw));return gn(l,I,s,u,x)}),hP=yn(function(l,u){return gn(l,O,s,s,s,u)});function mP(l,u){if(typeof l!="function")throw new ga(o);return u=u===s?u:bt(u),Ct(l,u)}function fP(l,u){if(typeof l!="function")throw new ga(o);return u=u==null?0:Us(bt(u),0),Ct(function(x){var _=x[u],E=Jn(x,0,u);return _&&Wn(E,_),Gr(l,this,E)})}function pP(l,u,x){var _=!0,E=!0;if(typeof l!="function")throw new ga(o);return ws(x)&&(_="leading"in x?!!x.leading:_,E="trailing"in x?!!x.trailing:E),gw(l,u,{leading:_,maxWait:u,trailing:E})}function xP(l){return hw(l,1)}function gP(l,u){return op(Wf(u),l)}function yP(){if(!arguments.length)return[];var l=arguments[0];return yt(l)?l:[l]}function vP(l){return va(l,y)}function wP(l,u){return u=typeof u=="function"?u:s,va(l,y,u)}function jP(l){return va(l,f|y)}function bP(l,u){return u=typeof u=="function"?u:s,va(l,f|y,u)}function _P(l,u){return u==null||n0(l,u,Hs(u))}function Ia(l,u){return l===u||l!==l&&u!==u}var NP=Tu(If),SP=Tu(function(l,u){return l>=u}),Zi=u0(function(){return arguments}())?u0:function(l){return Ss(l)&&Xt.call(l,"callee")&&!Jv.call(l,"callee")},yt=ie.isArray,kP=Pv?Kr(Pv):DA;function Er(l){return l!=null&&Uu(l.length)&&!wn(l)}function Rs(l){return Ss(l)&&Er(l)}function CP(l){return l===!0||l===!1||Ss(l)&&pr(l)==ct}var Zn=z4||yp,EP=Iv?Kr(Iv):FA;function AP(l){return Ss(l)&&l.nodeType===1&&!Sc(l)}function TP(l){if(l==null)return!0;if(Er(l)&&(yt(l)||typeof l=="string"||typeof l.splice=="function"||Zn(l)||tl(l)||Zi(l)))return!l.length;var u=lr(l);if(u==Tt||u==Se)return!l.size;if(_c(l))return!Of(l).length;for(var x in l)if(Xt.call(l,x))return!1;return!0}function RP(l,u){return wc(l,u)}function PP(l,u,x){x=typeof x=="function"?x:s;var _=x?x(l,u):s;return _===s?wc(l,u,s,x):!!_}function lp(l){if(!Ss(l))return!1;var u=pr(l);return u==Me||u==fe||typeof l.message=="string"&&typeof l.name=="string"&&!Sc(l)}function IP(l){return typeof l=="number"&&Xv(l)}function wn(l){if(!ws(l))return!1;var u=pr(l);return u==ze||u==ts||u==We||u==ee}function vw(l){return typeof l=="number"&&l==bt(l)}function Uu(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=le}function ws(l){var u=typeof l;return l!=null&&(u=="object"||u=="function")}function Ss(l){return l!=null&&typeof l=="object"}var ww=Dv?Kr(Dv):MA;function DP(l,u){return l===u||Ff(l,u,Zf(u))}function FP(l,u,x){return x=typeof x=="function"?x:s,Ff(l,u,Zf(u),x)}function OP(l){return jw(l)&&l!=+l}function MP(l){if(wT(l))throw new pt(i);return h0(l)}function LP(l){return l===null}function UP(l){return l==null}function jw(l){return typeof l=="number"||Ss(l)&&pr(l)==Os}function Sc(l){if(!Ss(l)||pr(l)!=os)return!1;var u=hu(l);if(u===null)return!0;var x=Xt.call(u,"constructor")&&u.constructor;return typeof x=="function"&&x instanceof x&&lu.call(x)==F4}var cp=Fv?Kr(Fv):LA;function $P(l){return vw(l)&&l>=-le&&l<=le}var bw=Ov?Kr(Ov):UA;function $u(l){return typeof l=="string"||!yt(l)&&Ss(l)&&pr(l)==_e}function Yr(l){return typeof l=="symbol"||Ss(l)&&pr(l)==we}var tl=Mv?Kr(Mv):$A;function zP(l){return l===s}function BP(l){return Ss(l)&&lr(l)==je}function qP(l){return Ss(l)&&pr(l)==mt}var VP=Tu(Mf),WP=Tu(function(l,u){return l<=u});function _w(l){if(!l)return[];if(Er(l))return $u(l)?Ra(l):Cr(l);if(hc&&l[hc])return _4(l[hc]());var u=lr(l),x=u==Tt?Nf:u==Se?nu:sl;return x(l)}function jn(l){if(!l)return l===0?l:0;if(l=ba(l),l===Y||l===-Y){var u=l<0?-1:1;return u*Ne}return l===l?l:0}function bt(l){var u=jn(l),x=u%1;return u===u?x?u-x:u:0}function Nw(l){return l?Ki(bt(l),0,ke):0}function ba(l){if(typeof l=="number")return l;if(Yr(l))return Ke;if(ws(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=ws(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=qv(l);var x=kE.test(l);return x||EE.test(l)?i4(l.slice(2),x?2:8):SE.test(l)?Ke:+l}function Sw(l){return Ga(l,Ar(l))}function HP(l){return l?Ki(bt(l),-le,le):l===0?l:0}function Kt(l){return l==null?"":Qr(l)}var GP=Zo(function(l,u){if(_c(u)||Er(u)){Ga(u,Hs(u),l);return}for(var x in u)Xt.call(u,x)&&gc(l,x,u[x])}),kw=Zo(function(l,u){Ga(u,Ar(u),l)}),zu=Zo(function(l,u,x,_){Ga(u,Ar(u),l,_)}),KP=Zo(function(l,u,x,_){Ga(u,Hs(u),l,_)}),QP=yn(Tf);function YP(l,u){var x=Jo(l);return u==null?x:a0(x,u)}var JP=Ct(function(l,u){l=as(l);var x=-1,_=u.length,E=_>2?u[2]:s;for(E&&xr(u[0],u[1],E)&&(_=1);++x<_;)for(var F=u[x],B=Ar(F),H=-1,J=B.length;++H<J;){var pe=B[H],ge=l[pe];(ge===s||Ia(ge,Ko[pe])&&!Xt.call(l,pe))&&(l[pe]=F[pe])}return l}),ZP=Ct(function(l){return l.push(s,q0),Gr(Cw,s,l)});function XP(l,u){return Uv(l,Ze(u,3),Ha)}function eI(l,u){return Uv(l,Ze(u,3),Pf)}function tI(l,u){return l==null?l:Rf(l,Ze(u,3),Ar)}function sI(l,u){return l==null?l:c0(l,Ze(u,3),Ar)}function rI(l,u){return l&&Ha(l,Ze(u,3))}function aI(l,u){return l&&Pf(l,Ze(u,3))}function nI(l){return l==null?[]:bu(l,Hs(l))}function iI(l){return l==null?[]:bu(l,Ar(l))}function dp(l,u,x){var _=l==null?s:Qi(l,u);return _===s?x:_}function oI(l,u){return l!=null&&H0(l,u,TA)}function up(l,u){return l!=null&&H0(l,u,RA)}var lI=L0(function(l,u,x){u!=null&&typeof u.toString!="function"&&(u=cu.call(u)),l[u]=x},mp(Tr)),cI=L0(function(l,u,x){u!=null&&typeof u.toString!="function"&&(u=cu.call(u)),Xt.call(l,u)?l[u].push(x):l[u]=[x]},Ze),dI=Ct(vc);function Hs(l){return Er(l)?s0(l):Of(l)}function Ar(l){return Er(l)?s0(l,!0):zA(l)}function uI(l,u){var x={};return u=Ze(u,3),Ha(l,function(_,E,F){xn(x,u(_,E,F),_)}),x}function hI(l,u){var x={};return u=Ze(u,3),Ha(l,function(_,E,F){xn(x,E,u(_,E,F))}),x}var mI=Zo(function(l,u,x){_u(l,u,x)}),Cw=Zo(function(l,u,x,_){_u(l,u,x,_)}),fI=yn(function(l,u){var x={};if(l==null)return x;var _=!1;u=xs(u,function(F){return F=Yn(F,l),_||(_=F.length>1),F}),Ga(l,Yf(l),x),_&&(x=va(x,f|g|y,lT));for(var E=u.length;E--;)Bf(x,u[E]);return x});function pI(l,u){return Ew(l,Lu(Ze(u)))}var xI=yn(function(l,u){return l==null?{}:qA(l,u)});function Ew(l,u){if(l==null)return{};var x=xs(Yf(l),function(_){return[_]});return u=Ze(u),v0(l,x,function(_,E){return u(_,E[0])})}function gI(l,u,x){u=Yn(u,l);var _=-1,E=u.length;for(E||(E=1,l=s);++_<E;){var F=l==null?s:l[Ka(u[_])];F===s&&(_=E,F=x),l=wn(F)?F.call(l):F}return l}function yI(l,u,x){return l==null?l:jc(l,u,x)}function vI(l,u,x,_){return _=typeof _=="function"?_:s,l==null?l:jc(l,u,x,_)}var Aw=z0(Hs),Tw=z0(Ar);function wI(l,u,x){var _=yt(l),E=_||Zn(l)||tl(l);if(u=Ze(u,4),x==null){var F=l&&l.constructor;E?x=_?new F:[]:ws(l)?x=wn(F)?Jo(hu(l)):{}:x={}}return(E?xa:Ha)(l,function(B,H,J){return u(x,B,H,J)}),x}function jI(l,u){return l==null?!0:Bf(l,u)}function bI(l,u,x){return l==null?l:N0(l,u,Wf(x))}function _I(l,u,x,_){return _=typeof _=="function"?_:s,l==null?l:N0(l,u,Wf(x),_)}function sl(l){return l==null?[]:_f(l,Hs(l))}function NI(l){return l==null?[]:_f(l,Ar(l))}function SI(l,u,x){return x===s&&(x=u,u=s),x!==s&&(x=ba(x),x=x===x?x:0),u!==s&&(u=ba(u),u=u===u?u:0),Ki(ba(l),u,x)}function kI(l,u,x){return u=jn(u),x===s?(x=u,u=0):x=jn(x),l=ba(l),PA(l,u,x)}function CI(l,u,x){if(x&&typeof x!="boolean"&&xr(l,u,x)&&(u=x=s),x===s&&(typeof u=="boolean"?(x=u,u=s):typeof l=="boolean"&&(x=l,l=s)),l===s&&u===s?(l=0,u=1):(l=jn(l),u===s?(u=l,l=0):u=jn(u)),l>u){var _=l;l=u,u=_}if(x||l%1||u%1){var E=e0();return or(l+E*(u-l+n4("1e-"+((E+"").length-1))),u)}return Uf(l,u)}var EI=Xo(function(l,u,x){return u=u.toLowerCase(),l+(x?Rw(u):u)});function Rw(l){return hp(Kt(l).toLowerCase())}function Pw(l){return l=Kt(l),l&&l.replace(TE,y4).replace(QE,"")}function AI(l,u,x){l=Kt(l),u=Qr(u);var _=l.length;x=x===s?_:Ki(bt(x),0,_);var E=x;return x-=u.length,x>=0&&l.slice(x,E)==u}function TI(l){return l=Kt(l),l&&nf.test(l)?l.replace(Hr,v4):l}function RI(l){return l=Kt(l),l&&xE.test(l)?l.replace(of,"\\$&"):l}var PI=Xo(function(l,u,x){return l+(x?"-":"")+u.toLowerCase()}),II=Xo(function(l,u,x){return l+(x?" ":"")+u.toLowerCase()}),DI=F0("toLowerCase");function FI(l,u,x){l=Kt(l),u=bt(u);var _=u?Ho(l):0;if(!u||_>=u)return l;var E=(u-_)/2;return Au(xu(E),x)+l+Au(pu(E),x)}function OI(l,u,x){l=Kt(l),u=bt(u);var _=u?Ho(l):0;return u&&_<u?l+Au(u-_,x):l}function MI(l,u,x){l=Kt(l),u=bt(u);var _=u?Ho(l):0;return u&&_<u?Au(u-_,x)+l:l}function LI(l,u,x){return x||u==null?u=0:u&&(u=+u),W4(Kt(l).replace(lf,""),u||0)}function UI(l,u,x){return(x?xr(l,u,x):u===s)?u=1:u=bt(u),$f(Kt(l),u)}function $I(){var l=arguments,u=Kt(l[0]);return l.length<3?u:u.replace(l[1],l[2])}var zI=Xo(function(l,u,x){return l+(x?"_":"")+u.toLowerCase()});function BI(l,u,x){return x&&typeof x!="number"&&xr(l,u,x)&&(u=x=s),x=x===s?ke:x>>>0,x?(l=Kt(l),l&&(typeof u=="string"||u!=null&&!cp(u))&&(u=Qr(u),!u&&Wo(l))?Jn(Ra(l),0,x):l.split(u,x)):[]}var qI=Xo(function(l,u,x){return l+(x?" ":"")+hp(u)});function VI(l,u,x){return l=Kt(l),x=x==null?0:Ki(bt(x),0,l.length),u=Qr(u),l.slice(x,x+u.length)==u}function WI(l,u,x){var _=P.templateSettings;x&&xr(l,u,x)&&(u=s),l=Kt(l),u=zu({},u,_,B0);var E=zu({},u.imports,_.imports,B0),F=Hs(E),B=_f(E,F),H,J,pe=0,ge=u.interpolate||eu,ve="__p += '",Ae=Sf((u.escape||eu).source+"|"+ge.source+"|"+(ge===dv?NE:eu).source+"|"+(u.evaluate||eu).source+"|$","g"),qe="//# sourceURL="+(Xt.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++e4+"]")+`
`;l.replace(Ae,function(st,Rt,Mt,Jr,gr,Zr){return Mt||(Mt=Jr),ve+=l.slice(pe,Zr).replace(RE,w4),Rt&&(H=!0,ve+=`' +
__e(`+Rt+`) +
'`),gr&&(J=!0,ve+=`';
`+gr+`;
__p += '`),Mt&&(ve+=`' +
((__t = (`+Mt+`)) == null ? '' : __t) +
'`),pe=Zr+st.length,st}),ve+=`';
`;var tt=Xt.call(u,"variable")&&u.variable;if(!tt)ve=`with (obj) {
`+ve+`
}
`;else if(bE.test(tt))throw new pt(c);ve=(J?ve.replace(dt,""):ve).replace(Zt,"$1").replace(ss,"$1;"),ve="function("+(tt||"obj")+`) {
`+(tt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(H?", __e = _.escape":"")+(J?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ve+`return __p
}`;var St=Dw(function(){return Ht(F,qe+"return "+ve).apply(s,B)});if(St.source=ve,lp(St))throw St;return St}function HI(l){return Kt(l).toLowerCase()}function GI(l){return Kt(l).toUpperCase()}function KI(l,u,x){if(l=Kt(l),l&&(x||u===s))return qv(l);if(!l||!(u=Qr(u)))return l;var _=Ra(l),E=Ra(u),F=Vv(_,E),B=Wv(_,E)+1;return Jn(_,F,B).join("")}function QI(l,u,x){if(l=Kt(l),l&&(x||u===s))return l.slice(0,Gv(l)+1);if(!l||!(u=Qr(u)))return l;var _=Ra(l),E=Wv(_,Ra(u))+1;return Jn(_,0,E).join("")}function YI(l,u,x){if(l=Kt(l),l&&(x||u===s))return l.replace(lf,"");if(!l||!(u=Qr(u)))return l;var _=Ra(l),E=Vv(_,Ra(u));return Jn(_,E).join("")}function JI(l,u){var x=A,_=L;if(ws(u)){var E="separator"in u?u.separator:E;x="length"in u?bt(u.length):x,_="omission"in u?Qr(u.omission):_}l=Kt(l);var F=l.length;if(Wo(l)){var B=Ra(l);F=B.length}if(x>=F)return l;var H=x-Ho(_);if(H<1)return _;var J=B?Jn(B,0,H).join(""):l.slice(0,H);if(E===s)return J+_;if(B&&(H+=J.length-H),cp(E)){if(l.slice(H).search(E)){var pe,ge=J;for(E.global||(E=Sf(E.source,Kt(uv.exec(E))+"g")),E.lastIndex=0;pe=E.exec(ge);)var ve=pe.index;J=J.slice(0,ve===s?H:ve)}}else if(l.indexOf(Qr(E),H)!=H){var Ae=J.lastIndexOf(E);Ae>-1&&(J=J.slice(0,Ae))}return J+_}function ZI(l){return l=Kt(l),l&&Bo.test(l)?l.replace(Wr,C4):l}var XI=Xo(function(l,u,x){return l+(x?" ":"")+u.toUpperCase()}),hp=F0("toUpperCase");function Iw(l,u,x){return l=Kt(l),u=x?s:u,u===s?b4(l)?T4(l):m4(l):l.match(u)||[]}var Dw=Ct(function(l,u){try{return Gr(l,s,u)}catch(x){return lp(x)?x:new pt(x)}}),eD=yn(function(l,u){return xa(u,function(x){x=Ka(x),xn(l,x,ip(l[x],l))}),l});function tD(l){var u=l==null?0:l.length,x=Ze();return l=u?xs(l,function(_){if(typeof _[1]!="function")throw new ga(o);return[x(_[0]),_[1]]}):[],Ct(function(_){for(var E=-1;++E<u;){var F=l[E];if(Gr(F[0],this,_))return Gr(F[1],this,_)}})}function sD(l){return CA(va(l,f))}function mp(l){return function(){return l}}function rD(l,u){return l==null||l!==l?u:l}var aD=M0(),nD=M0(!0);function Tr(l){return l}function fp(l){return m0(typeof l=="function"?l:va(l,f))}function iD(l){return p0(va(l,f))}function oD(l,u){return x0(l,va(u,f))}var lD=Ct(function(l,u){return function(x){return vc(x,l,u)}}),cD=Ct(function(l,u){return function(x){return vc(l,x,u)}});function pp(l,u,x){var _=Hs(u),E=bu(u,_);x==null&&!(ws(u)&&(E.length||!_.length))&&(x=u,u=l,l=this,E=bu(u,Hs(u)));var F=!(ws(x)&&"chain"in x)||!!x.chain,B=wn(l);return xa(E,function(H){var J=u[H];l[H]=J,B&&(l.prototype[H]=function(){var pe=this.__chain__;if(F||pe){var ge=l(this.__wrapped__),ve=ge.__actions__=Cr(this.__actions__);return ve.push({func:J,args:arguments,thisArg:l}),ge.__chain__=pe,ge}return J.apply(l,Wn([this.value()],arguments))})}),l}function dD(){return Zs._===this&&(Zs._=O4),this}function xp(){}function uD(l){return l=bt(l),Ct(function(u){return g0(u,l)})}var hD=Gf(xs),mD=Gf(Lv),fD=Gf(yf);function Fw(l){return ep(l)?vf(Ka(l)):VA(l)}function pD(l){return function(u){return l==null?s:Qi(l,u)}}var xD=U0(),gD=U0(!0);function gp(){return[]}function yp(){return!1}function yD(){return{}}function vD(){return""}function wD(){return!0}function jD(l,u){if(l=bt(l),l<1||l>le)return[];var x=ke,_=or(l,ke);u=Ze(u),l-=ke;for(var E=bf(_,u);++x<l;)u(x);return E}function bD(l){return yt(l)?xs(l,Ka):Yr(l)?[l]:Cr(tw(Kt(l)))}function _D(l){var u=++D4;return Kt(l)+u}var ND=Eu(function(l,u){return l+u},0),SD=Kf("ceil"),kD=Eu(function(l,u){return l/u},1),CD=Kf("floor");function ED(l){return l&&l.length?ju(l,Tr,If):s}function AD(l,u){return l&&l.length?ju(l,Ze(u,2),If):s}function TD(l){return zv(l,Tr)}function RD(l,u){return zv(l,Ze(u,2))}function PD(l){return l&&l.length?ju(l,Tr,Mf):s}function ID(l,u){return l&&l.length?ju(l,Ze(u,2),Mf):s}var DD=Eu(function(l,u){return l*u},1),FD=Kf("round"),OD=Eu(function(l,u){return l-u},0);function MD(l){return l&&l.length?jf(l,Tr):0}function LD(l,u){return l&&l.length?jf(l,Ze(u,2)):0}return P.after=iP,P.ary=hw,P.assign=GP,P.assignIn=kw,P.assignInWith=zu,P.assignWith=KP,P.at=QP,P.before=mw,P.bind=ip,P.bindAll=eD,P.bindKey=fw,P.castArray=yP,P.chain=cw,P.chunk=CT,P.compact=ET,P.concat=AT,P.cond=tD,P.conforms=sD,P.constant=mp,P.countBy=MR,P.create=YP,P.curry=pw,P.curryRight=xw,P.debounce=gw,P.defaults=JP,P.defaultsDeep=ZP,P.defer=oP,P.delay=lP,P.difference=TT,P.differenceBy=RT,P.differenceWith=PT,P.drop=IT,P.dropRight=DT,P.dropRightWhile=FT,P.dropWhile=OT,P.fill=MT,P.filter=UR,P.flatMap=BR,P.flatMapDeep=qR,P.flatMapDepth=VR,P.flatten=nw,P.flattenDeep=LT,P.flattenDepth=UT,P.flip=cP,P.flow=aD,P.flowRight=nD,P.fromPairs=$T,P.functions=nI,P.functionsIn=iI,P.groupBy=WR,P.initial=BT,P.intersection=qT,P.intersectionBy=VT,P.intersectionWith=WT,P.invert=lI,P.invertBy=cI,P.invokeMap=GR,P.iteratee=fp,P.keyBy=KR,P.keys=Hs,P.keysIn=Ar,P.map=Fu,P.mapKeys=uI,P.mapValues=hI,P.matches=iD,P.matchesProperty=oD,P.memoize=Mu,P.merge=mI,P.mergeWith=Cw,P.method=lD,P.methodOf=cD,P.mixin=pp,P.negate=Lu,P.nthArg=uD,P.omit=fI,P.omitBy=pI,P.once=dP,P.orderBy=QR,P.over=hD,P.overArgs=uP,P.overEvery=mD,P.overSome=fD,P.partial=op,P.partialRight=yw,P.partition=YR,P.pick=xI,P.pickBy=Ew,P.property=Fw,P.propertyOf=pD,P.pull=QT,P.pullAll=ow,P.pullAllBy=YT,P.pullAllWith=JT,P.pullAt=ZT,P.range=xD,P.rangeRight=gD,P.rearg=hP,P.reject=XR,P.remove=XT,P.rest=mP,P.reverse=ap,P.sampleSize=tP,P.set=yI,P.setWith=vI,P.shuffle=sP,P.slice=eR,P.sortBy=nP,P.sortedUniq=oR,P.sortedUniqBy=lR,P.split=BI,P.spread=fP,P.tail=cR,P.take=dR,P.takeRight=uR,P.takeRightWhile=hR,P.takeWhile=mR,P.tap=ER,P.throttle=pP,P.thru=Du,P.toArray=_w,P.toPairs=Aw,P.toPairsIn=Tw,P.toPath=bD,P.toPlainObject=Sw,P.transform=wI,P.unary=xP,P.union=fR,P.unionBy=pR,P.unionWith=xR,P.uniq=gR,P.uniqBy=yR,P.uniqWith=vR,P.unset=jI,P.unzip=np,P.unzipWith=lw,P.update=bI,P.updateWith=_I,P.values=sl,P.valuesIn=NI,P.without=wR,P.words=Iw,P.wrap=gP,P.xor=jR,P.xorBy=bR,P.xorWith=_R,P.zip=NR,P.zipObject=SR,P.zipObjectDeep=kR,P.zipWith=CR,P.entries=Aw,P.entriesIn=Tw,P.extend=kw,P.extendWith=zu,pp(P,P),P.add=ND,P.attempt=Dw,P.camelCase=EI,P.capitalize=Rw,P.ceil=SD,P.clamp=SI,P.clone=vP,P.cloneDeep=jP,P.cloneDeepWith=bP,P.cloneWith=wP,P.conformsTo=_P,P.deburr=Pw,P.defaultTo=rD,P.divide=kD,P.endsWith=AI,P.eq=Ia,P.escape=TI,P.escapeRegExp=RI,P.every=LR,P.find=$R,P.findIndex=rw,P.findKey=XP,P.findLast=zR,P.findLastIndex=aw,P.findLastKey=eI,P.floor=CD,P.forEach=dw,P.forEachRight=uw,P.forIn=tI,P.forInRight=sI,P.forOwn=rI,P.forOwnRight=aI,P.get=dp,P.gt=NP,P.gte=SP,P.has=oI,P.hasIn=up,P.head=iw,P.identity=Tr,P.includes=HR,P.indexOf=zT,P.inRange=kI,P.invoke=dI,P.isArguments=Zi,P.isArray=yt,P.isArrayBuffer=kP,P.isArrayLike=Er,P.isArrayLikeObject=Rs,P.isBoolean=CP,P.isBuffer=Zn,P.isDate=EP,P.isElement=AP,P.isEmpty=TP,P.isEqual=RP,P.isEqualWith=PP,P.isError=lp,P.isFinite=IP,P.isFunction=wn,P.isInteger=vw,P.isLength=Uu,P.isMap=ww,P.isMatch=DP,P.isMatchWith=FP,P.isNaN=OP,P.isNative=MP,P.isNil=UP,P.isNull=LP,P.isNumber=jw,P.isObject=ws,P.isObjectLike=Ss,P.isPlainObject=Sc,P.isRegExp=cp,P.isSafeInteger=$P,P.isSet=bw,P.isString=$u,P.isSymbol=Yr,P.isTypedArray=tl,P.isUndefined=zP,P.isWeakMap=BP,P.isWeakSet=qP,P.join=HT,P.kebabCase=PI,P.last=ja,P.lastIndexOf=GT,P.lowerCase=II,P.lowerFirst=DI,P.lt=VP,P.lte=WP,P.max=ED,P.maxBy=AD,P.mean=TD,P.meanBy=RD,P.min=PD,P.minBy=ID,P.stubArray=gp,P.stubFalse=yp,P.stubObject=yD,P.stubString=vD,P.stubTrue=wD,P.multiply=DD,P.nth=KT,P.noConflict=dD,P.noop=xp,P.now=Ou,P.pad=FI,P.padEnd=OI,P.padStart=MI,P.parseInt=LI,P.random=CI,P.reduce=JR,P.reduceRight=ZR,P.repeat=UI,P.replace=$I,P.result=gI,P.round=FD,P.runInContext=Q,P.sample=eP,P.size=rP,P.snakeCase=zI,P.some=aP,P.sortedIndex=tR,P.sortedIndexBy=sR,P.sortedIndexOf=rR,P.sortedLastIndex=aR,P.sortedLastIndexBy=nR,P.sortedLastIndexOf=iR,P.startCase=qI,P.startsWith=VI,P.subtract=OD,P.sum=MD,P.sumBy=LD,P.template=WI,P.times=jD,P.toFinite=jn,P.toInteger=bt,P.toLength=Nw,P.toLower=HI,P.toNumber=ba,P.toSafeInteger=HP,P.toString=Kt,P.toUpper=GI,P.trim=KI,P.trimEnd=QI,P.trimStart=YI,P.truncate=JI,P.unescape=ZI,P.uniqueId=_D,P.upperCase=XI,P.upperFirst=hp,P.each=dw,P.eachRight=uw,P.first=iw,pp(P,function(){var l={};return Ha(P,function(u,x){Xt.call(P.prototype,x)||(l[x]=u)}),l}(),{chain:!1}),P.VERSION=a,xa(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){P[l].placeholder=P}),xa(["drop","take"],function(l,u){Dt.prototype[l]=function(x){x=x===s?1:Us(bt(x),0);var _=this.__filtered__&&!u?new Dt(this):this.clone();return _.__filtered__?_.__takeCount__=or(x,_.__takeCount__):_.__views__.push({size:or(x,ke),type:l+(_.__dir__<0?"Right":"")}),_},Dt.prototype[l+"Right"]=function(x){return this.reverse()[l](x).reverse()}}),xa(["filter","map","takeWhile"],function(l,u){var x=u+1,_=x==W||x==K;Dt.prototype[l]=function(E){var F=this.clone();return F.__iteratees__.push({iteratee:Ze(E,3),type:x}),F.__filtered__=F.__filtered__||_,F}}),xa(["head","last"],function(l,u){var x="take"+(u?"Right":"");Dt.prototype[l]=function(){return this[x](1).value()[0]}}),xa(["initial","tail"],function(l,u){var x="drop"+(u?"":"Right");Dt.prototype[l]=function(){return this.__filtered__?new Dt(this):this[x](1)}}),Dt.prototype.compact=function(){return this.filter(Tr)},Dt.prototype.find=function(l){return this.filter(l).head()},Dt.prototype.findLast=function(l){return this.reverse().find(l)},Dt.prototype.invokeMap=Ct(function(l,u){return typeof l=="function"?new Dt(this):this.map(function(x){return vc(x,l,u)})}),Dt.prototype.reject=function(l){return this.filter(Lu(Ze(l)))},Dt.prototype.slice=function(l,u){l=bt(l);var x=this;return x.__filtered__&&(l>0||u<0)?new Dt(x):(l<0?x=x.takeRight(-l):l&&(x=x.drop(l)),u!==s&&(u=bt(u),x=u<0?x.dropRight(-u):x.take(u-l)),x)},Dt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Dt.prototype.toArray=function(){return this.take(ke)},Ha(Dt.prototype,function(l,u){var x=/^(?:filter|find|map|reject)|While$/.test(u),_=/^(?:head|last)$/.test(u),E=P[_?"take"+(u=="last"?"Right":""):u],F=_||/^find/.test(u);E&&(P.prototype[u]=function(){var B=this.__wrapped__,H=_?[1]:arguments,J=B instanceof Dt,pe=H[0],ge=J||yt(B),ve=function(Rt){var Mt=E.apply(P,Wn([Rt],H));return _&&Ae?Mt[0]:Mt};ge&&x&&typeof pe=="function"&&pe.length!=1&&(J=ge=!1);var Ae=this.__chain__,qe=!!this.__actions__.length,tt=F&&!Ae,St=J&&!qe;if(!F&&ge){B=St?B:new Dt(this);var st=l.apply(B,H);return st.__actions__.push({func:Du,args:[ve],thisArg:s}),new ya(st,Ae)}return tt&&St?l.apply(this,H):(st=this.thru(ve),tt?_?st.value()[0]:st.value():st)})}),xa(["pop","push","shift","sort","splice","unshift"],function(l){var u=iu[l],x=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",_=/^(?:pop|shift)$/.test(l);P.prototype[l]=function(){var E=arguments;if(_&&!this.__chain__){var F=this.value();return u.apply(yt(F)?F:[],E)}return this[x](function(B){return u.apply(yt(B)?B:[],E)})}}),Ha(Dt.prototype,function(l,u){var x=P[u];if(x){var _=x.name+"";Xt.call(Yo,_)||(Yo[_]=[]),Yo[_].push({name:u,func:x})}}),Yo[Cu(s,N).name]=[{name:"wrapper",func:s}],Dt.prototype.clone=Z4,Dt.prototype.reverse=X4,Dt.prototype.value=eA,P.prototype.at=AR,P.prototype.chain=TR,P.prototype.commit=RR,P.prototype.next=PR,P.prototype.plant=DR,P.prototype.reverse=FR,P.prototype.toJSON=P.prototype.valueOf=P.prototype.value=OR,P.prototype.first=P.prototype.head,hc&&(P.prototype[hc]=IR),P},Go=R4();Vi?((Vi.exports=Go)._=Go,ff._=Go):Zs._=Go}).call(ca)})(mm,mm.exports);var yV=mm.exports;const vV=zi({query:ys().optional(),searchType:og(["combined","semantic","text"]).default("combined"),documentType:ys().optional(),status:ys().optional(),dateFrom:ys().optional(),dateTo:ys().optional(),minSize:ig().optional(),maxSize:ig().optional(),hasOcr:f2().optional()}),wV=({onResults:r,onLoading:t,className:s=""})=>{const[a,n]=p.useState(!1),[i,o]=p.useState(!1),[c,d]=p.useState([]),[h,m]=p.useState([]),{user:f}=ft(),{register:g,handleSubmit:y,watch:b,setValue:w,reset:S,formState:{errors:N}}=Ui({resolver:$i(vV),defaultValues:{hasOcr:!1}}),v=b("query"),j=p.useCallback(yV.debounce(async A=>{var L;if(!((L=A.query)!=null&&L.trim())&&!C(A)){try{o(!0),t==null||t(!0);const M=await Ds.getDocuments();r(M)}catch(M){console.error("Error loading documents:",M),te.error("Failed to load documents")}finally{o(!1),t==null||t(!1)}return}await k(A)},500),[r,t]);p.useEffect(()=>{const A=b(L=>{j(L)});return()=>A.unsubscribe()},[b,j]);const C=A=>!!(A.documentType||A.status||A.dateFrom||A.dateTo||A.minSize||A.maxSize||A.hasOcr),k=async A=>{var L;if(!f){te.error("Please log in to search documents");return}try{o(!0),t==null||t(!0);let M=[];if((L=A.query)!=null&&L.trim()){const se=[A.query,...h.filter(q=>q!==A.query)].slice(0,5);switch(m(se),localStorage.setItem("documentSearchHistory",JSON.stringify(se)),A.searchType||"combined"){case"semantic":M=(await cv({query:A.query,userId:f.id,maxResults:20})).map(Y=>Y.document).filter(Boolean);break;case"text":M=await rE({query:A.query,userId:f.id,documentType:A.documentType,dateRange:A.dateFrom&&A.dateTo?{start:new Date(A.dateFrom),end:new Date(A.dateTo)}:void 0});break;case"combined":default:M=(await gV(A.query,f.id,{documentType:A.documentType,dateRange:A.dateFrom&&A.dateTo?{start:new Date(A.dateFrom),end:new Date(A.dateTo)}:void 0,maxResults:20})).textResults;break}}else M=await Ds.getDocuments();M=I(M,A),r(M),T(A)}catch(M){console.error("Search error:",M),te.error("Search failed. Please try again.")}finally{o(!1),t==null||t(!1)}},I=(A,L)=>A.filter(M=>{if(L.documentType&&M.document_type!==L.documentType||L.status&&M.processing_status!==L.status)return!1;if(L.dateFrom){const W=new Date(M.created_at),q=new Date(L.dateFrom);if(W<q)return!1}if(L.dateTo){const W=new Date(M.created_at),q=new Date(L.dateTo);if(q.setHours(23,59,59,999),W>q)return!1}const se=M.file_size/1024;return!(L.minSize&&se<L.minSize||L.maxSize&&se>L.maxSize||L.hasOcr&&!M.ocr_text)}),T=A=>{const L=[];A.documentType&&L.push(`Type: ${dn[A.documentType]}`),A.status&&L.push(`Status: ${Un[A.status]}`),A.dateFrom&&L.push(`From: ${new Date(A.dateFrom).toLocaleDateString()}`),A.dateTo&&L.push(`To: ${new Date(A.dateTo).toLocaleDateString()}`),A.minSize&&L.push(`Min: ${A.minSize}KB`),A.maxSize&&L.push(`Max: ${A.maxSize}KB`),A.hasOcr&&L.push("Has OCR text"),d(L)},O=()=>{S(),d([]),n(!1)},U=A=>{O()};return p.useEffect(()=>{const A=localStorage.getItem("documentSearchHistory");if(A)try{m(JSON.parse(A))}catch(L){console.error("Error loading search history:",L)}},[]),e.jsxs($,{className:s,children:[e.jsx(Z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-lg",children:"Search Documents"}),e.jsx(ye,{children:"Find documents by name, content, or metadata"})]}),e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>n(!a),children:[e.jsx(dN,{className:"h-4 w-4 mr-2"}),"Filters"]})]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Pe,{...g("query"),placeholder:"Search by filename or content...",className:"pl-10 pr-10"}),i&&e.jsx(ds,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 animate-spin text-gray-400"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"text-xs text-gray-500",children:"Search type:"}),e.jsxs(it,{onValueChange:A=>w("searchType",A),children:[e.jsx(rt,{className:"w-32 h-8",children:e.jsx(ot,{placeholder:"Combined"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"combined",children:"Combined"}),e.jsx(ne,{value:"semantic",children:"AI Semantic"}),e.jsx(ne,{value:"text",children:"Text Only"})]})]})]})]}),h.length>0&&!v&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Recent:"}),h.map((A,L)=>e.jsx(R,{variant:"outline",size:"sm",className:"h-6 text-xs",onClick:()=>w("query",A),children:A},L))]}),c.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Active filters:"}),c.map((A,L)=>e.jsxs(ae,{variant:"secondary",className:"text-xs",children:[A,e.jsx(R,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 ml-1",onClick:()=>U(),children:e.jsx(Vs,{className:"h-3 w-3"})})]},L)),e.jsx(R,{variant:"ghost",size:"sm",className:"text-xs",onClick:O,children:"Clear all"})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx(Ts,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"documentType",children:"Document Type"}),e.jsxs(it,{onValueChange:A=>w("documentType",A),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Any type"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"Any type"}),Object.entries(dn).map(([A,L])=>e.jsx(ne,{value:A,children:L},A))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"status",children:"Processing Status"}),e.jsxs(it,{onValueChange:A=>w("status",A),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Any status"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"Any status"}),Object.entries(Un).map(([A,L])=>e.jsx(ne,{value:A,children:L},A))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"dateFrom",children:"Date From"}),e.jsx(Pe,{...g("dateFrom"),type:"date",className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"dateTo",children:"Date To"}),e.jsx(Pe,{...g("dateTo"),type:"date",className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{children:"File Size (KB)"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Pe,{...g("minSize",{valueAsNumber:!0}),type:"number",placeholder:"Min",className:"w-full"}),e.jsx(Pe,{...g("maxSize",{valueAsNumber:!0}),type:"number",placeholder:"Max",className:"w-full"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{children:"Content Options"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{...g("hasOcr"),onCheckedChange:A=>w("hasOcr",!!A)}),e.jsx(Te,{className:"text-sm",children:"Has extracted text"})]})]})]})]})]})]})},nx=({onDocumentSelect:r,refreshTrigger:t,className:s=""})=>{const[a,n]=p.useState([]),[i,o]=p.useState({total:0,pending:0,processing:0,completed:0,failed:0}),[c,d]=p.useState(!0),[h,m]=p.useState(!0);p.useEffect(()=>{f()},[t]),p.useEffect(()=>{let j;return h&&(j=setInterval(()=>{(i.processing>0||i.pending>0)&&f()},3e4)),()=>{j&&clearInterval(j)}},[h,i.processing,i.pending]);const f=async()=>{try{d(!0),console.log("DocumentStatusTracker: Starting to load documents...");const{data:{user:j},error:C}=await D.auth.getUser();if(C)throw console.error("DocumentStatusTracker: Auth error:",C),new Error("Authentication failed");if(!j)throw console.error("DocumentStatusTracker: No authenticated user"),new Error("User not authenticated");console.log("DocumentStatusTracker: User authenticated:",j.email);const k=await Ds.getDocuments();console.log("DocumentStatusTracker: Loaded documents:",k.length);const I=k.sort((T,O)=>new Date(O.created_at).getTime()-new Date(T.created_at).getTime());n(I),g(I)}catch(j){console.error("DocumentStatusTracker: Error loading documents:",j),te.error(`Failed to load document status: ${j.message}`)}finally{d(!1)}},g=j=>{const C=j.reduce((k,I)=>{switch(k.total++,I.processing_status){case"pending":k.pending++;break;case"processing":k.processing++;break;case"completed":k.completed++;break;case"failed":k.failed++;break}return k},{total:0,pending:0,processing:0,completed:0,failed:0});o(C)},y=j=>{switch(j){case"pending":return e.jsx(us,{className:"h-4 w-4 text-yellow-500"});case"processing":return e.jsx(ds,{className:"h-4 w-4 text-blue-500 animate-spin"});case"completed":return e.jsx(Ue,{className:"h-4 w-4 text-green-500"});case"failed":return e.jsx(is,{className:"h-4 w-4 text-red-500"});default:return e.jsx(Fe,{className:"h-4 w-4 text-gray-500"})}},b=j=>{switch(j){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},w=()=>i.total===0?0:Math.round(i.completed/i.total*100),S=()=>a.filter(j=>j.processing_status==="pending"||j.processing_status==="processing").slice(0,5),N=()=>a.filter(j=>j.processing_status==="completed").slice(0,3),v=()=>a.filter(j=>j.processing_status==="failed");return c&&a.length===0?e.jsx($,{className:s,children:e.jsx(z,{className:"flex items-center justify-center py-8",children:e.jsx(ds,{className:"h-8 w-8 animate-spin"})})}):e.jsxs($,{className:s,children:[e.jsx(Z,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-lg",children:"Processing Status"}),e.jsx(ye,{children:"Real-time document processing status and progress"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>m(!h),className:h?"bg-green-50":"",children:[e.jsx(mr,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),"Auto-refresh"]}),e.jsx(R,{onClick:f,variant:"outline",size:"sm",children:e.jsx(mr,{className:"h-4 w-4"})})]})]})}),e.jsxs(z,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.completed," of ",i.total," completed"]})]}),e.jsx(na,{value:w(),className:"w-full"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.pending}),e.jsx("div",{className:"text-xs text-gray-500",children:"Pending"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.processing}),e.jsx("div",{className:"text-xs text-gray-500",children:"Processing"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.completed}),e.jsx("div",{className:"text-xs text-gray-500",children:"Completed"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.failed}),e.jsx("div",{className:"text-xs text-gray-500",children:"Failed"})]})]})]}),S().length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[e.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Currently Processing"]}),e.jsx("div",{className:"space-y-2",children:S().map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[y(j.processing_status),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:j.filename}),e.jsx("p",{className:"text-xs text-gray-500",children:Vt(new Date(j.created_at),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:b(j.processing_status),children:Un[j.processing_status]}),r&&e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>r(j),children:e.jsx(Gt,{className:"h-4 w-4"})})]})]},j.id))})]}),N().length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2 text-green-500"}),"Recently Completed"]}),e.jsx("div",{className:"space-y-2",children:N().map(j=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg bg-green-50",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:j.filename}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Completed ",Vt(new Date(j.updated_at),{addSuffix:!0})]})]})]}),r&&e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>r(j),children:e.jsx(Gt,{className:"h-4 w-4"})})]},j.id))})]}),v().length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center text-red-600",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Failed Processing (",v().length,")"]}),e.jsx("div",{className:"space-y-2",children:v().slice(0,3).map(j=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg bg-red-50",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx(is,{className:"h-4 w-4 text-red-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:j.filename}),e.jsx("p",{className:"text-xs text-red-600",children:"Processing failed"})]})]}),r&&e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>r(j),children:e.jsx(Gt,{className:"h-4 w-4"})})]},j.id))})]}),i.total===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents yet"}),e.jsx("p",{className:"text-gray-500",children:"Upload your first document to start tracking processing status"})]})]})]})};class jV{constructor(){rs(this,"retryAttempts",3);rs(this,"retryDelay",1e3)}async processDocument(t,s,a={},n){const i=Date.now();try{n==null||n({stage:"initializing",progress:0,message:"Initializing document processing..."}),await this.checkUsageLimits(),await this.updateDocumentStatus(s,"processing");let o,c,d=[];a.skipOCR||(o=await this.performOCR(t,n)),!a.skipAnalysis&&o&&(c=await this.performAnalysis(o.text,s,a.customAnalysisPrompt,n)),!a.skipEmbedding&&o&&(d=await this.generateEmbeddings(o.text,s,a.chunkSize,n)),n==null||n({stage:"finalizing",progress:95,message:"Finalizing document processing..."});const h=await this.finalizeProcessing(s,o,c,d),m=Date.now()-i;return n==null||n({stage:"completed",progress:100,message:"Document processing completed successfully!",details:{processingTime:m,ocrQuality:(o==null?void 0:o.qualityScore)||0,textLength:(o==null?void 0:o.text.length)||0,embeddingChunks:d.length}}),{document:h,ocrResult:o,analysis:c,embeddingIds:d,processingTime:m,qualityMetrics:{ocrQuality:(o==null?void 0:o.qualityScore)||0,textLength:(o==null?void 0:o.text.length)||0,embeddingChunks:d.length}}}catch(o){const c=Date.now()-i;throw await this.updateDocumentStatus(s,"failed"),n==null||n({stage:"error",progress:0,message:"Document processing failed",error:o instanceof Error?o.message:"Unknown error",details:{processingTime:c}}),o}}async checkUsageLimits(){const t=await aa.checkUsageLimit("ai_query");if(!t.allowed)throw new Error(`AI processing limit exceeded. You have used ${t.current}/${t.limit} AI queries this month. Please upgrade your plan to continue.`)}async performOCR(t,s){return s==null||s({stage:"ocr",progress:10,message:"Extracting text from document..."}),await this.withRetry(async()=>{const a=await ak(t,o=>{s==null||s({stage:"ocr",progress:10+o.progress*.3,message:o.message||"Extracting text..."})}),n=nk(a),i=ik(a.text);return{...a,text:i,qualityScore:n.qualityScore}},"OCR processing")}async performAnalysis(t,s,a,n){return n==null||n({stage:"analysis",progress:40,message:"Analyzing document content with AI..."}),await this.withRetry(async()=>{const i=await ev(t);return await aa.incrementUsage("ai_query",s,{operation:"document_analysis",text_length:t.length,custom_prompt:!!a}),i},"AI analysis")}async generateEmbeddings(t,s,a=1e3,n){return n==null||n({stage:"embedding",progress:70,message:"Generating embeddings for search..."}),await this.withRetry(async()=>{const i=this.splitTextIntoChunks(t,a),o=[];for(let c=0;c<i.length;c++){const d=i[c],h=await tv(d),{data:m,error:f}=await D.from("document_embeddings").insert({document_id:s,chunk_text:d,chunk_index:c,embedding:h,metadata:{chunk_size:d.length,total_chunks:i.length}}).select("id").single();if(f)throw f;o.push(m.id);const g=70+(c+1)/i.length*20;n==null||n({stage:"embedding",progress:g,message:`Generated embedding ${c+1}/${i.length}...`})}return o},"Embedding generation")}async finalizeProcessing(t,s,a,n){const{data:i,error:o}=await D.from("uploaded_documents").update({processing_status:"completed",ocr_text:s==null?void 0:s.text,ocr_quality_score:s==null?void 0:s.qualityScore,document_structure:{analysis:a,ocrQuality:s==null?void 0:s.qualityScore,embeddingCount:(n==null?void 0:n.length)||0,processedAt:new Date().toISOString()},updated_at:new Date().toISOString()}).eq("id",t).select().single();if(o)throw o;return i}async updateDocumentStatus(t,s){const{error:a}=await D.from("uploaded_documents").update({processing_status:s,updated_at:new Date().toISOString()}).eq("id",t);if(a)throw a}async withRetry(t,s){let a;for(let n=1;n<=this.retryAttempts;n++)try{return await t()}catch(i){if(a=i instanceof Error?i:new Error("Unknown error"),n===this.retryAttempts)throw new Error(`${s} failed after ${this.retryAttempts} attempts: ${a.message}`);await new Promise(o=>setTimeout(o,this.retryDelay*n))}throw a}splitTextIntoChunks(t,s=1e3){const a=[],n=t.split(/[.!?]+/).filter(o=>o.trim().length>0);let i="";for(const o of n){const c=o.trim();i.length+c.length+1<=s?i+=(i?". ":"")+c:(i&&a.push(i+"."),i=c)}return i&&a.push(i+"."),a}}const bV=new jV;class _V{async callEdgeFunction(t,s){const{data:{session:a}}=await D.auth.getSession();if(!a)throw new Error("Authentication required");const n=await fetch(`https://kvlaydeyqidlfpfutbmp.supabase.co/functions/v1/${t}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`},body:JSON.stringify(s)});if(!n.ok){const i=await n.json().catch(()=>({}));throw new Error(i.error||`HTTP ${n.status}: ${n.statusText}`)}return n.json()}async sendChatMessage(t){var n,i;const{usageTrackingService:s}=await Ns(async()=>{const{usageTrackingService:o}=await Promise.resolve().then(()=>an);return{usageTrackingService:o}},void 0),a=await s.checkAndIncrementUsage("ai_query",void 0,{operation:"chat",message_length:t.message.length,document_ids:t.documentIds,use_rag:t.useRAG});if(!a.allowed)throw new Error(`Usage limit exceeded. You have used ${(n=a.limit)==null?void 0:n.current}/${(i=a.limit)==null?void 0:i.limit} AI queries this month. Please upgrade your plan to continue.`);return this.callEdgeFunction("ai-chat",t)}async processDocument(t){var n,i;const{usageTrackingService:s}=await Ns(async()=>{const{usageTrackingService:o}=await Promise.resolve().then(()=>an);return{usageTrackingService:o}},void 0),a=await s.checkAndIncrementUsage("document_upload",t.documentId,{operation:t.operation,options:t.options});if(!a.allowed)throw new Error(`Usage limit exceeded. You have used ${(n=a.limit)==null?void 0:n.current}/${(i=a.limit)==null?void 0:i.limit} document operations this month. Please upgrade your plan to continue.`);return this.callEdgeFunction("document-processor",t)}async generateTemplate(t){var n,i;const{usageTrackingService:s}=await Ns(async()=>{const{usageTrackingService:o}=await Promise.resolve().then(()=>an);return{usageTrackingService:o}},void 0),a=await s.checkAndIncrementUsage("ai_query",void 0,{operation:"template_generation",template_type:t.templateType,description_length:t.description.length});if(!a.allowed)throw new Error(`Usage limit exceeded. You have used ${(n=a.limit)==null?void 0:n.current}/${(i=a.limit)==null?void 0:i.limit} AI queries this month. Please upgrade your plan to continue.`);return this.callEdgeFunction("template-generator",t)}async extractText(t){return(await this.processDocument({documentId:t,operation:"extract-text"})).result}async generateEmbeddings(t){return(await this.processDocument({documentId:t,operation:"generate-embeddings"})).result}async classifyDocument(t){return(await this.processDocument({documentId:t,operation:"classify"})).result}async summarizeDocument(t){return(await this.processDocument({documentId:t,operation:"summarize"})).result}async askDocumentQuestion(t,s,a){return this.sendChatMessage({message:t,documentIds:s,useRAG:!0,conversationId:a})}async getChatHistory(t){const{data:s,error:a}=await D.from("chat_messages").select("role, content, created_at").eq("conversation_id",t).order("created_at",{ascending:!0});if(a)throw new Error(`Failed to fetch chat history: ${a.message}`);return s.map(n=>({role:n.role,content:n.content,timestamp:n.created_at}))}async getUsageStats(t=30){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("Authentication required");const{data:a,error:n}=await D.rpc("get_user_usage_stats",{user_id_param:s.id,period_days:t});if(n)throw new Error(`Failed to fetch usage stats: ${n.message}`);return a||[]}async checkUsageLimit(t){const{usageTrackingService:s}=await Ns(async()=>{const{usageTrackingService:i}=await Promise.resolve().then(()=>an);return{usageTrackingService:i}},void 0);let a;switch(t){case"ai_chat":case"chat":case"summarize":case"extract-entities":case"generate-template":a="ai_query";break;case"document_analysis":case"document_upload":a="document_upload";break;default:a="ai_query"}const n=await s.checkUsageLimit(a);return{allowed:n.allowed,limit:n.limit,used:n.current}}}const Xc=new _V;class NV{async analyzeDocument(t,s={}){const a=Date.now(),n=await aa.checkUsageLimit("ai_query");if(!n.allowed)throw new Error(`AI analysis limit exceeded. You have used ${n.current}/${n.limit} AI queries this month.`);const{data:i,error:o}=await D.from("uploaded_documents").select("*").eq("id",t).single();if(o||!i)throw new Error("Document not found");if(!i.ocr_text)throw new Error("Document text not available. Please ensure the document has been processed.");const{includeSummary:c=!0,includeEntities:d=!0,includeInsights:h=!0,customPrompt:m}=s,[f,g,y]=await Promise.all([c?this.generateSummary(i):Promise.resolve(null),d?this.extractEntities(i):Promise.resolve(null),h?this.generateLegalInsights(i,m):Promise.resolve(null)]);await aa.incrementUsage("ai_query",t,{operation:"document_analysis",analysis_types:[c&&"summary",d&&"entities",h&&"insights"].filter(Boolean),text_length:i.ocr_text.length});const b=Date.now()-a,w={documentId:t,summary:f||this.getDefaultSummary(),entities:g||this.getDefaultEntities(),insights:y||this.getDefaultInsights(),analysisDate:new Date().toISOString(),processingTime:b};return await this.saveAnalysisResults(t,w),w}async generateSummary(t){const s=`
      Analyze the following legal document and provide a comprehensive summary:

      Document Type: ${t.document_type}
      Text: ${t.ocr_text}

      Please provide:
      1. A concise summary (2-3 paragraphs)
      2. Key points (bullet points)
      3. Document type classification
      4. Confidence level (0-1)
      5. Word count
      6. Estimated reading time in minutes

      Format your response as JSON with the following structure:
      {
        "summary": "...",
        "keyPoints": ["...", "..."],
        "documentType": "...",
        "confidence": 0.95,
        "wordCount": 1234,
        "readingTime": 5
      }
    `,a=await Xc.sendChatMessage({message:s,useRAG:!1});try{return JSON.parse(a.response)}catch{return this.parseTextSummary(a.response,t)}}async extractEntities(t){const s=`
      Extract entities and relationships from the following legal document:

      Text: ${t.ocr_text}

      Please identify:
      1. Entities (persons, organizations, locations, dates, monetary amounts, legal terms, case references)
      2. Relationships between entities

      Format your response as JSON with the following structure:
      {
        "entities": [
          {
            "type": "person|organization|location|date|money|legal_term|case_reference",
            "text": "...",
            "confidence": 0.95,
            "startIndex": 0,
            "endIndex": 10
          }
        ],
        "relationships": [
          {
            "entity1": "...",
            "entity2": "...",
            "relationship": "...",
            "confidence": 0.9
          }
        ]
      }
    `,a=await Xc.sendChatMessage({message:s,useRAG:!1});try{return JSON.parse(a.response)}catch{return this.getDefaultEntities()}}async generateLegalInsights(t,s){const a=`
      Analyze the following legal document and provide legal insights:

      Document Type: ${t.document_type}
      Text: ${t.ocr_text}

      Please provide:
      1. Document category classification
      2. Key legal concepts identified
      3. Potential legal issues or concerns
      4. Recommendations for action
      5. Compliance checks (if applicable)
      6. Risk assessment

      ${s?`Additional instructions: ${s}`:""}

      Format your response as JSON with the following structure:
      {
        "documentCategory": "...",
        "legalConcepts": ["...", "..."],
        "potentialIssues": ["...", "..."],
        "recommendations": ["...", "..."],
        "complianceChecks": [
          {
            "requirement": "...",
            "status": "compliant|non_compliant|unclear",
            "details": "..."
          }
        ],
        "riskAssessment": {
          "level": "low|medium|high",
          "factors": ["...", "..."],
          "mitigation": ["...", "..."]
        }
      }
    `,n=await Xc.sendChatMessage({message:a,useRAG:!1});try{return JSON.parse(n.response)}catch{return this.getDefaultInsights()}}async saveAnalysisResults(t,s){const{error:a}=await D.from("document_analysis").upsert({document_id:t,analysis_data:s,created_at:new Date().toISOString()});a&&console.error("Failed to save analysis results:",a)}async getAnalysisResults(t){const{data:s,error:a}=await D.from("document_analysis").select("analysis_data").eq("document_id",t).order("created_at",{ascending:!1}).limit(1).single();return a||!s?null:s.analysis_data}async compareDocuments(t,s){if(!(await aa.checkUsageLimit("ai_query")).allowed)throw new Error("AI analysis limit exceeded.");const{data:n,error:i}=await D.from("uploaded_documents").select("*").in("id",[t,s]);if(i||!n||n.length!==2)throw new Error("Documents not found");const[o,c]=n,d=`
      Compare the following two legal documents and provide analysis:

      Document 1:
      Type: ${o.document_type}
      Text: ${o.ocr_text}

      Document 2:
      Type: ${c.document_type}
      Text: ${c.ocr_text}

      Please provide:
      1. Key similarities between the documents
      2. Important differences
      3. Recommendations based on the comparison

      Format as JSON:
      {
        "similarities": ["...", "..."],
        "differences": ["...", "..."],
        "recommendations": ["...", "..."]
      }
    `,h=await Xc.sendChatMessage({message:d,useRAG:!1});await aa.incrementUsage("ai_query",void 0,{operation:"document_comparison",document_ids:[t,s]});try{return JSON.parse(h.response)}catch{return{similarities:["Unable to parse comparison results"],differences:["Analysis failed"],recommendations:["Please try again"]}}}parseTextSummary(t,s){var n;const a=((n=s.ocr_text)==null?void 0:n.split(/\s+/).length)||0;return{summary:t.substring(0,500)+"...",keyPoints:["Analysis completed","Summary generated"],documentType:s.document_type,confidence:.7,wordCount:a,readingTime:Math.ceil(a/200)}}getDefaultSummary(){return{summary:"Summary not available",keyPoints:[],documentType:"unknown",confidence:0,wordCount:0,readingTime:0}}getDefaultEntities(){return{entities:[],relationships:[]}}getDefaultInsights(){return{documentCategory:"unknown",legalConcepts:[],potentialIssues:[],recommendations:[],complianceChecks:[],riskAssessment:{level:"low",factors:[],mitigation:[]}}}}const Kb=new NV;class SV{async downloadDocument(t,s={format:"pdf"}){var g,y;const a=await aa.checkAndIncrementUsage("document_download",t,{operation:"download",format:s.format,include_analysis:s.includeAnalysis});if(!a.allowed)throw new Error(`Download limit exceeded. You have used ${(g=a.limit)==null?void 0:g.current}/${(y=a.limit)==null?void 0:y.limit} document downloads this month.`);const{data:n,error:i}=await D.from("uploaded_documents").select("*").eq("id",t).single();if(i||!n)throw new Error("Document not found");const o=this.extractFileNameFromUrl(n.file_url),{data:c,error:d}=await D.storage.from("documents").download(o);if(d)throw new Error(`Failed to download document: ${d.message}`);let h=c,m=this.getContentType(s.format),f=this.generateFilename(n.filename,s.format);if(s.includeAnalysis){const b=await Kb.getAnalysisResults(t);b&&(h=await this.createEnhancedDocument(n,b,s),f=this.generateFilename(n.filename,s.format,"enhanced"))}return{blob:h,filename:f,contentType:m,size:h.size}}async generateCustomDocument(t,s={format:"pdf"}){var c,d;const a=await aa.checkAndIncrementUsage("custom_document",void 0,{operation:"generate",template_type:t.templateType,format:s.format});if(!a.allowed)throw new Error(`Custom document limit exceeded. You have used ${(c=a.limit)==null?void 0:c.current}/${(d=a.limit)==null?void 0:d.limit} custom documents this month.`);let n=t.content;t.templateType!=="custom"&&(n=await this.generateTemplateContent(t)),t.variables&&(n=this.applyVariables(n,t.variables));const i=await this.createDocumentBlob(n,t,s),o=this.generateCustomFilename(t.title,s.format);return{blob:i,filename:o,contentType:this.getContentType(s.format),size:i.size}}async exportAnalysis(t,s={format:"pdf"}){const a=await Kb.getAnalysisResults(t);if(!a)throw new Error("No analysis found for this document");const{data:n}=await D.from("uploaded_documents").select("filename").eq("id",t).single(),i=this.formatAnalysisForExport(a),o=await this.createAnalysisBlob(i,s),c=this.generateFilename((n==null?void 0:n.filename)||"document",s.format,"analysis");return{blob:o,filename:c,contentType:this.getContentType(s.format),size:o.size}}async bulkExport(t,s={format:"pdf"}){for(const o of t){const c=await aa.checkUsageLimit("document_download");if(!c.allowed)throw new Error(`Download limit would be exceeded. You have ${c.remaining} downloads remaining.`)}const a=(await Ns(async()=>{const{default:o}=await import("./jszip.min-DVQYy7dD.js").then(c=>c.j);return{default:o}},__vite__mapDeps([4,3]))).default,n=new a;for(const o of t)try{const c=await this.downloadDocument(o,s);n.file(c.filename,c.blob)}catch(c){console.error(`Failed to export document ${o}:`,c)}const i=await n.generateAsync({type:"blob"});return{blob:i,filename:`documents-export-${new Date().toISOString().split("T")[0]}.zip`,contentType:"application/zip",size:i.size}}async generateTemplateContent(t){const s=`
      Generate a professional ${t.templateType} document with the following specifications:
      
      Title: ${t.title}
      Content Requirements: ${t.content}
      
      Please create a well-structured, legally appropriate document that includes:
      1. Proper formatting and sections
      2. Professional language
      3. Placeholder variables where appropriate (use {{variable_name}} format)
      4. Standard clauses for this type of document
      
      Return only the document content without any explanations.
    `;return(await Xc.sendChatMessage({message:s,useRAG:!1})).response}applyVariables(t,s){let a=t;return Object.entries(s).forEach(([n,i])=>{const o=new RegExp(`{{${n}}}`,"g");a=a.replace(o,i)}),a}async createDocumentBlob(t,s,a){switch(a.format){case"txt":return new Blob([t],{type:"text/plain"});case"json":const n={title:s.title,content:t,templateType:s.templateType,variables:s.variables,formatting:s.formatting,generatedAt:new Date().toISOString()};return new Blob([JSON.stringify(n,null,2)],{type:"application/json"});case"pdf":case"docx":const i=this.contentToHtml(t,s);return new Blob([i],{type:"text/html"});default:return new Blob([t],{type:"text/plain"})}}async createEnhancedDocument(t,s,a){var i,o,c,d,h,m,f,g;const n=`
      Document: ${t.filename}
      
      ORIGINAL CONTENT:
      ${t.ocr_text||"Text not available"}
      
      ANALYSIS SUMMARY:
      ${((i=s.summary)==null?void 0:i.summary)||"No summary available"}
      
      KEY POINTS:
      ${((c=(o=s.summary)==null?void 0:o.keyPoints)==null?void 0:c.map(y=>`• ${y}`).join(`
`))||"No key points identified"}
      
      LEGAL INSIGHTS:
      Category: ${((d=s.insights)==null?void 0:d.documentCategory)||"Unknown"}
      Risk Level: ${((m=(h=s.insights)==null?void 0:h.riskAssessment)==null?void 0:m.level)||"Unknown"}
      
      RECOMMENDATIONS:
      ${((g=(f=s.insights)==null?void 0:f.recommendations)==null?void 0:g.map(y=>`• ${y}`).join(`
`))||"No recommendations available"}
    `;return new Blob([n],{type:"text/plain"})}async createAnalysisBlob(t,s){switch(s.format){case"json":return new Blob([t],{type:"application/json"});case"txt":return new Blob([t],{type:"text/plain"});default:const a=`
          <html>
            <head><title>Document Analysis Report</title></head>
            <body>
              <h1>Document Analysis Report</h1>
              <pre>${t}</pre>
            </body>
          </html>
        `;return new Blob([a],{type:"text/html"})}}formatAnalysisForExport(t){return JSON.stringify(t,null,2)}contentToHtml(t,s){var n,i,o,c;const{formatting:a={}}=s;return`
      <!DOCTYPE html>
      <html>
        <head>
          <title>${s.title}</title>
          <style>
            body {
              font-family: ${a.fontFamily||"Arial, sans-serif"};
              font-size: ${a.fontSize||12}pt;
              margin: ${((n=a.margins)==null?void 0:n.top)||1}in ${((i=a.margins)==null?void 0:i.right)||1}in ${((o=a.margins)==null?void 0:o.bottom)||1}in ${((c=a.margins)==null?void 0:c.left)||1}in;
              line-height: 1.5;
            }
            h1 { font-size: 18pt; margin-bottom: 20px; }
            p { margin-bottom: 12px; }
          </style>
        </head>
        <body>
          ${a.header?`<header>${a.header}</header>`:""}
          <h1>${s.title}</h1>
          <div>${t.replace(/\n/g,"<br>")}</div>
          ${a.footer?`<footer>${a.footer}</footer>`:""}
        </body>
      </html>
    `}extractFileNameFromUrl(t){const s=t.split("/");return s[s.length-1]}getContentType(t){return{pdf:"application/pdf",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",txt:"text/plain",json:"application/json",html:"text/html"}[t]||"application/octet-stream"}generateFilename(t,s,a){const n=t.replace(/\.[^/.]+$/,""),i=a?`-${a}`:"";return`${n}${i}.${s}`}generateCustomFilename(t,s){return`${t.replace(/[^a-zA-Z0-9\s-]/g,"").replace(/\s+/g,"-")}.${s}`}}const kV=new SV;function CV(){const[r,t]=p.useState({isUploading:!1,isProcessing:!1,progress:0,status:null,error:null}),s=qn(),{toast:a}=Bn(),n=p.useCallback(async(o,c,d={})=>{try{t({isUploading:!0,isProcessing:!1,progress:0,status:null,error:null});const h=await Ds.uploadDocument(o,c);t(f=>({...f,isUploading:!1,isProcessing:!0,progress:10}));const m=await bV.processDocument(o,h.id,d,f=>{t(g=>({...g,progress:f.progress,status:f,error:f.error||null}))});return t(f=>({...f,isProcessing:!1,progress:100,error:null})),s.invalidateQueries({queryKey:["documents"]}),s.invalidateQueries({queryKey:["document",h.id]}),a({title:"Document Processed",description:`${o.name} has been successfully uploaded and processed.`}),m}catch(h){const m=h instanceof Error?h.message:"Upload failed";throw t(f=>({...f,isUploading:!1,isProcessing:!1,error:m})),a({title:"Upload Failed",description:m,variant:"destructive"}),h}},[s,a]),i=p.useCallback(()=>{t({isUploading:!1,isProcessing:!1,progress:0,status:null,error:null})},[]);return{uploadAndProcessDocument:n,uploadState:r,resetUploadState:i,isActive:r.isUploading||r.isProcessing}}function EV(){return Fo({queryKey:["documents"],queryFn:()=>Ds.getDocuments(),staleTime:5*60*1e3})}function AV(){const[r,t]=p.useState(""),s=Fo({queryKey:["documents","search",r],queryFn:async()=>{if(!r||r.length<3)return[];try{return await Ds.searchDocuments(r)}catch(a){return console.error("Search error:",a),[]}},enabled:r.length>2,staleTime:2*60*1e3});return{searchQuery:r,setSearchQuery:t,searchResults:s.data||[],isSearching:s.isLoading,searchError:s.error}}function TV(){const r=qn(),{toast:t}=Bn();return oa({mutationFn:s=>Ds.deleteDocument(s),onSuccess:(s,a)=>{r.removeQueries({queryKey:["document",a]}),r.invalidateQueries({queryKey:["documents"]}),t({title:"Document Deleted",description:"The document has been successfully deleted."})},onError:s=>{t({title:"Deletion Failed",description:s instanceof Error?s.message:"Failed to delete document",variant:"destructive"})}})}function RV(){const{toast:r}=Bn();return oa({mutationFn:({documentId:t,trackUsage:s=!0})=>Ds.downloadDocument(t,s),onSuccess:t=>{const s=URL.createObjectURL(t.data),a=document.createElement("a");a.href=s,a.download=t.filename,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),r({title:"Download Started",description:`Downloading ${t.filename}...`})},onError:t=>{r({title:"Download Failed",description:t instanceof Error?t.message:"Failed to download document",variant:"destructive"})}})}function PV(){const r=qn(),{toast:t}=Bn(),s=oa({mutationFn:async a=>{const n=await Promise.allSettled(a.map(c=>Ds.deleteDocument(c))),i=n.filter(c=>c.status==="rejected").length;return{succeeded:n.filter(c=>c.status==="fulfilled").length,failed:i,total:a.length}},onSuccess:a=>{r.invalidateQueries({queryKey:["documents"]}),a.failed>0?t({title:"Bulk Delete Completed",description:`${a.succeeded} documents deleted, ${a.failed} failed.`,variant:"destructive"}):t({title:"Bulk Delete Completed",description:`Successfully deleted ${a.succeeded} documents.`})},onError:a=>{t({title:"Bulk Delete Failed",description:a instanceof Error?a.message:"Failed to delete documents",variant:"destructive"})}});return{bulkDelete:s,isBulkDeleting:s.isPending}}function IV(){return Fo({queryKey:["documents","stats"],queryFn:async()=>{try{const r=await Ds.getDocuments(),t=await Ds.getDocumentUsage();return{total:r.length,byStatus:r.reduce((a,n)=>(a[n.processing_status]=(a[n.processing_status]||0)+1,a),{}),byType:r.reduce((a,n)=>(a[n.document_type]=(a[n.document_type]||0)+1,a),{}),totalSize:r.reduce((a,n)=>a+n.file_size,0),usage:t}}catch(r){return console.error("Error fetching document stats:",r),{total:0,byStatus:{},byType:{},totalSize:0,usage:null}}},staleTime:10*60*1e3})}function ix(r){return Fo({queryKey:["usage-limit",r],queryFn:()=>aa.checkUsageLimit(r),staleTime:1*60*1e3,refetchOnWindowFocus:!1})}function DV(){const{data:r}=ix("ai_query"),{data:t}=ix("document_upload"),{data:s}=ix("custom_document");return{canUseAI:(r==null?void 0:r.allowed)??!1,canUploadDocuments:(t==null?void 0:t.allowed)??!1,canDownloadCustomDocuments:(s==null?void 0:s.allowed)??!1,aiUsage:r,documentUsage:t,customDocUsage:s,getUsagePercentage:a=>!a||a.limit===-1?0:a.limit>0?a.current/a.limit*100:0,isNearLimit:(a,n=80)=>!a||a.limit===-1?!1:(a.limit>0?a.current/a.limit*100:0)>=n}}const FV=({onUploadComplete:r,maxFiles:t=5,allowedTypes:s=["pdf","doc","docx","txt"]})=>{const{profile:a}=ft(),{uploadAndProcessDocument:n,uploadState:i,resetUploadState:o,isActive:c}=CV(),{canUploadDocuments:d,canUseAI:h,documentUsage:m}=DV(),[f,g]=p.useState([]),[y,b]=p.useState(!1),[w,S]=p.useState({skipOCR:!1,skipAnalysis:!1,skipEmbedding:!1,chunkSize:1e3,retryAttempts:3}),N=p.useCallback(async A=>{if(!d){toast.warning("Upload not available. Please check your subscription or try again later.");return}const L=a!=null&&a.subscription_tier?bi.maxSize[a.subscription_tier]:bi.maxSize.free,se=A.filter(W=>!(W.size>L)).map(W=>({file:W,id:crypto.randomUUID(),documentType:"other",options:{...w}}));g(W=>[...W,...se].slice(0,t))},[a,t,d,w]),{getRootProps:v,getInputProps:j,isDragActive:C}=Qm({onDrop:N,accept:{"application/pdf":[".pdf"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"text/plain":[".txt"]},maxFiles:t,disabled:c||!d}),k=A=>{g(L=>L.filter(M=>M.id!==A))},I=(A,L)=>{g(M=>M.map(se=>se.id===A?{...se,documentType:L}:se))},T=async()=>{for(const A of f)try{const L=await n(A.file,A.documentType,A.options);r&&r(L.document.id)}catch(L){console.error("Upload failed:",L)}g([]),o()},O=A=>{switch(A){case"ocr":return e.jsx(Gt,{className:"h-4 w-4"});case"analysis":return e.jsx(ki,{className:"h-4 w-4"});case"embedding":return e.jsx(Nr,{className:"h-4 w-4"});case"completed":return e.jsx(Ue,{className:"h-4 w-4"});case"error":return e.jsx(is,{className:"h-4 w-4"});default:return e.jsx(us,{className:"h-4 w-4"})}},U=A=>{switch(A){case"completed":return"text-green-600";case"error":return"text-red-600";case"analysis":return"text-blue-600";case"embedding":return"text-purple-600";default:return"text-gray-600"}};return e.jsxs($,{className:"w-full",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Enhanced Document Upload"}),e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>b(!y),children:[e.jsx(Ei,{className:"h-4 w-4 mr-2"}),"Advanced"]})]}),e.jsx(ye,{children:"Upload and process your legal documents with AI-powered analysis"}),m&&e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Usage: ",m.current,"/",m.limit===-1?"∞":m.limit," uploads"]}),m.limit>0&&e.jsx(na,{value:m.percentage,className:"w-24 h-2"})]})]}),e.jsxs(z,{className:"space-y-6",children:[y&&e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"Processing Options"})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(wl,{id:"skip-ocr",checked:!w.skipOCR,onCheckedChange:A=>S(L=>({...L,skipOCR:!A}))}),e.jsx(Te,{htmlFor:"skip-ocr",children:"Text Extraction"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(wl,{id:"skip-analysis",checked:!w.skipAnalysis,onCheckedChange:A=>S(L=>({...L,skipAnalysis:!A})),disabled:!h}),e.jsx(Te,{htmlFor:"skip-analysis",children:"AI Analysis"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(wl,{id:"skip-embedding",checked:!w.skipEmbedding,onCheckedChange:A=>S(L=>({...L,skipEmbedding:!A})),disabled:!h}),e.jsx(Te,{htmlFor:"skip-embedding",children:"Search Indexing"})]})]}),w.customAnalysisPrompt!==void 0&&e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"custom-prompt",children:"Custom Analysis Prompt"}),e.jsx(Sr,{id:"custom-prompt",placeholder:"Enter custom instructions for AI analysis...",value:w.customAnalysisPrompt||"",onChange:A=>S(L=>({...L,customAnalysisPrompt:A.target.value}))})]})]})]}),e.jsxs("div",{...v(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${C?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${c||!d?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{...j()}),e.jsx(_r,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),C?e.jsx("p",{className:"text-blue-600",children:"Drop the files here..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:d?"Drag & drop files here, or click to select":"Upload limit reached for your subscription tier"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Supports PDF, DOC, DOCX, TXT files up to"," ",Math.round((a!=null&&a.subscription_tier?bi.maxSize[a.subscription_tier]:bi.maxSize.free)/1024/1024),"MB"]})]})]}),f.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Files to Upload"}),f.map(A=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[e.jsx(Fe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:A.file.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(A.file.size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs(it,{value:A.documentType,onValueChange:L=>I(A.id,L),children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsx(at,{children:Object.entries(dn).map(([L,M])=>e.jsx(ne,{value:L,children:M},L))})]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>k(A.id),disabled:c,children:e.jsx(Vs,{className:"h-4 w-4"})})]},A.id))]}),c&&i.status&&e.jsx($,{children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:U(i.status.stage),children:O(i.status.stage)}),e.jsx("span",{className:"font-medium capitalize",children:i.status.stage.replace("_"," ")})]}),e.jsxs(ae,{variant:"outline",children:[Math.round(i.progress),"%"]})]}),e.jsx(na,{value:i.progress,className:"w-full"}),e.jsx("p",{className:"text-sm text-gray-600",children:i.status.message}),i.status.details&&e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[i.status.details.ocrQuality&&e.jsxs("p",{children:["OCR Quality: ",Math.round(i.status.details.ocrQuality*100),"%"]}),i.status.details.textLength&&e.jsxs("p",{children:["Text Length: ",i.status.details.textLength.toLocaleString()," characters"]}),i.status.details.embeddingChunks&&e.jsxs("p",{children:["Embedding Chunks: ",i.status.details.embeddingChunks]})]}),i.error&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:i.error})]})})}),f.length>0&&!c&&e.jsxs(R,{onClick:T,className:"w-full",disabled:!d,children:[e.jsx(_r,{className:"h-4 w-4 mr-2"}),"Upload and Process ",f.length," File",f.length>1?"s":""]})]})]})},OV=()=>{const[r,t]=p.useState("grid"),[s,a]=p.useState(new Set),[n,i]=p.useState("created_at"),[o,c]=p.useState("desc"),[d,h]=p.useState({status:"all",type:"all",dateRange:"all"}),[m,f]=p.useState(!1),{data:g=[],isLoading:y,error:b}=EV(),{searchQuery:w,setSearchQuery:S,searchResults:N,isSearching:v}=AV(),j=TV(),C=RV(),{bulkDelete:k,isBulkDeleting:I}=PV(),{data:T,error:O}=IV();xe.useEffect(()=>{b&&console.error("Documents loading error:",b),O&&console.error("Stats loading error:",O)},[b,O]);const U=p.useMemo(()=>{try{let Y=w.length>2?N:g;if(!Array.isArray(Y))return console.warn("Documents result is not an array:",Y),[];if(d.status!=="all"&&(Y=Y.filter(le=>(le==null?void 0:le.processing_status)===d.status)),d.type!=="all"&&(Y=Y.filter(le=>(le==null?void 0:le.document_type)===d.type)),d.dateRange!=="all"){const le=new Date,Ne=new Date;switch(d.dateRange){case"today":Ne.setHours(0,0,0,0);break;case"week":Ne.setDate(le.getDate()-7);break;case"month":Ne.setMonth(le.getMonth()-1);break}Y=Y.filter(Ke=>(Ke==null?void 0:Ke.created_at)&&new Date(Ke.created_at)>=Ne)}return Y.sort((le,Ne)=>{if(!le||!Ne)return 0;let Ke=le[n],ke=Ne[n];return n==="created_at"?(Ke=new Date(Ke).getTime(),ke=new Date(ke).getTime()):n==="file_size"?(Ke=Number(Ke)||0,ke=Number(ke)||0):(Ke=String(Ke||"").toLowerCase(),ke=String(ke||"").toLowerCase()),o==="asc"?Ke<ke?-1:Ke>ke?1:0:Ke>ke?-1:Ke<ke?1:0}),Y}catch(Y){return console.error("Error filtering documents:",Y),[]}},[g,N,w,d,n,o]),A=Y=>{const le=new Set(s);le.has(Y)?le.delete(Y):le.add(Y),a(le)},L=()=>{s.size===U.length?a(new Set):a(new Set(U.map(Y=>Y.id)))},M=async()=>{s.size!==0&&(await k.mutateAsync(Array.from(s)),a(new Set))},se=Y=>{C.mutate({documentId:Y})},W=Y=>{j.mutate(Y)},q=Y=>{switch(Y){case"completed":return e.jsx(Ue,{className:"h-4 w-4 text-green-500"});case"processing":return e.jsx(us,{className:"h-4 w-4 text-blue-500"});case"failed":return e.jsx(is,{className:"h-4 w-4 text-red-500"});default:return e.jsx(us,{className:"h-4 w-4 text-gray-500"})}},K=Y=>{switch(Y){case"completed":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return m?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Upload Documents"}),e.jsx(R,{variant:"outline",onClick:()=>f(!1),children:"Back to Dashboard"})]}),e.jsx(FV,{onUploadComplete:()=>f(!1)})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Document Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage and organize your legal documents"})]}),e.jsxs(R,{onClick:()=>f(!0),children:[e.jsx(_r,{className:"h-4 w-4 mr-2"}),"Upload Documents"]})]}),T&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Documents"}),e.jsx("p",{className:"text-2xl font-bold",children:T.total})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processed"}),e.jsx("p",{className:"text-2xl font-bold",children:T.byStatus.completed||0})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processing"}),e.jsx("p",{className:"text-2xl font-bold",children:T.byStatus.processing||0})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ba,{className:"h-5 w-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Size"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(T.totalSize/1024/1024).toFixed(1),"MB"]})]})]})})})]}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Pe,{placeholder:"Search documents...",value:w,onChange:Y=>S(Y.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(it,{value:d.status,onValueChange:Y=>h(le=>({...le,status:Y})),children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{placeholder:"Status"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All Status"}),Object.entries(Un).map(([Y,le])=>e.jsx(ne,{value:Y,children:le},Y))]})]}),e.jsxs(it,{value:d.type,onValueChange:Y=>h(le=>({...le,type:Y})),children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{placeholder:"Type"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All Types"}),Object.entries(dn).map(([Y,le])=>e.jsx(ne,{value:Y,children:le},Y))]})]}),e.jsxs(it,{value:n,onValueChange:Y=>i(Y),children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{placeholder:"Sort by"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"created_at",children:"Date"}),e.jsx(ne,{value:"filename",children:"Name"}),e.jsx(ne,{value:"file_size",children:"Size"}),e.jsx(ne,{value:"processing_status",children:"Status"})]})]}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>c(o==="asc"?"desc":"asc"),children:o==="asc"?"↑":"↓"})]}),e.jsxs("div",{className:"flex border rounded-md",children:[e.jsx(R,{variant:r==="grid"?"default":"ghost",size:"sm",onClick:()=>t("grid"),children:e.jsx(_m,{className:"h-4 w-4"})}),e.jsx(R,{variant:r==="list"?"default":"ghost",size:"sm",onClick:()=>t("list"),children:e.jsx(So,{className:"h-4 w-4"})})]})]})})}),s.size>0&&e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[s.size," document",s.size>1?"s":""," selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{variant:"destructive",size:"sm",onClick:M,disabled:I,children:[e.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Delete Selected"]}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>a(new Set),children:"Clear Selection"})]})]})})}),y?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"Loading documents..."})}):b?e.jsx("div",{className:"text-center py-8 text-red-600",children:e.jsxs("p",{children:["Error loading documents: ",b.message]})}):U.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:w?"No documents found matching your search.":"No documents uploaded yet."}),!w&&e.jsx(R,{className:"mt-4",onClick:()=>f(!0),children:"Upload Your First Document"})]}):e.jsxs("div",{className:r==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-2",children:[r==="list"&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 border-b",children:[e.jsx(hr,{checked:s.size===U.length,onCheckedChange:L}),e.jsx("span",{className:"text-sm font-medium",children:"Select All"})]}),U.map(Y=>!Y||!Y.id?(console.warn("Invalid document found:",Y),null):e.jsx(MV,{document:Y,viewMode:r,isSelected:s.has(Y.id),onToggleSelection:()=>A(Y.id),onDownload:()=>se(Y.id),onDelete:()=>W(Y.id),getStatusIcon:q,getStatusColor:K},Y.id)).filter(Boolean)]})]})},MV=({document:r,viewMode:t,isSelected:s,onToggleSelection:a,onDownload:n,onDelete:i,getStatusIcon:o,getStatusColor:c})=>{if(!r)return console.warn("DocumentCard received null/undefined document"),null;const d={id:r.id||"",filename:r.filename||"Unknown File",document_type:r.document_type||"other",file_size:r.file_size||0,created_at:r.created_at||new Date().toISOString(),processing_status:r.processing_status||"pending"};return t==="list"?e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(hr,{checked:s,onCheckedChange:a}),e.jsx(Fe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:d.filename}),e.jsxs("p",{className:"text-sm text-gray-500",children:[dn[d.document_type]||"Unknown"," •",(d.file_size/1024/1024).toFixed(2)," MB •",Vt(new Date(d.created_at),{addSuffix:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(ae,{className:c(d.processing_status),children:[o(d.processing_status),e.jsx("span",{className:"ml-1",children:Un[d.processing_status]||"Unknown"})]}),e.jsxs(_d,{children:[e.jsx(Nd,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"sm",children:e.jsx(fx,{className:"h-4 w-4"})})}),e.jsxs(Yl,{children:[e.jsxs(ur,{onClick:n,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsx(Ro,{}),e.jsxs(ur,{onClick:i,className:"text-red-600",children:[e.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]}):e.jsx($,{className:`cursor-pointer transition-colors ${s?"ring-2 ring-blue-500":""}`,children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx(hr,{checked:s,onCheckedChange:a}),e.jsxs(_d,{children:[e.jsx(Nd,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"sm",children:e.jsx(fx,{className:"h-4 w-4"})})}),e.jsxs(Yl,{children:[e.jsxs(ur,{onClick:n,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsx(Ro,{}),e.jsxs(ur,{onClick:i,className:"text-red-600",children:[e.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx(Fe,{className:"h-12 w-12 text-gray-400 mx-auto mb-2"}),e.jsx("h3",{className:"font-medium truncate",title:d.filename,children:d.filename})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Type:"}),e.jsx("span",{children:dn[d.document_type]||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Size:"}),e.jsxs("span",{children:[(d.file_size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Uploaded:"}),e.jsx("span",{children:Vt(new Date(d.created_at),{addSuffix:!0})})]})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(ae,{className:`w-full justify-center ${c(d.processing_status)}`,children:[o(d.processing_status),e.jsx("span",{className:"ml-1",children:Un[d.processing_status]||"Unknown"})]})})]})})};class Qb extends xe.Component{constructor(s){super(s);rs(this,"resetError",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,a){console.error("ErrorBoundary caught an error:",s,a),this.setState({error:s,errorInfo:a})}render(){if(this.state.hasError){if(this.props.fallback){const s=this.props.fallback;return e.jsx(s,{error:this.state.error,resetError:this.resetError})}return e.jsxs($,{className:"max-w-2xl mx-auto mt-8",children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center text-red-600",children:[e.jsx(It,{className:"h-5 w-5 mr-2"}),"Something went wrong"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"An error occurred while rendering this component. Please try refreshing the page or contact support if the problem persists."}),this.state.error&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md",children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Error Details:"}),e.jsx("pre",{className:"text-xs text-red-600 overflow-auto",children:this.state.error.message})]}),!1,e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{onClick:this.resetError,variant:"outline",children:[e.jsx(mr,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsx(R,{onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})]})}return this.props.children}}const LV=()=>{const[r,t]=p.useState([]),[s,a]=p.useState(!1),n=async()=>{a(!0);const o=[];try{const{data:h,error:m}=await D.from("profiles").select("count").limit(1);o.push({name:"Supabase Connection",status:m?"error":"success",message:m?m.message:"Connected successfully",details:{data:h,error:m}})}catch(h){o.push({name:"Supabase Connection",status:"error",message:h instanceof Error?h.message:"Unknown error",details:h})}try{const{data:h,error:m}=await D.from("uploaded_documents").select("id, filename, processing_status").limit(5);o.push({name:"uploaded_documents Table",status:m?"error":"success",message:m?m.message:`Found ${(h==null?void 0:h.length)||0} documents`,details:{data:h,error:m}})}catch(h){o.push({name:"uploaded_documents Table",status:"error",message:h instanceof Error?h.message:"Unknown error",details:h})}try{const{data:{user:h},error:m}=await D.auth.getUser();o.push({name:"Authentication",status:m?"error":"success",message:m?m.message:h?`Logged in as ${h.email}`:"Not logged in",details:{user:h,error:m}})}catch(h){o.push({name:"Authentication",status:"error",message:h instanceof Error?h.message:"Unknown error",details:h})}try{const{data:h,error:m}=await D.storage.listBuckets(),f=h==null?void 0:h.find(g=>g.name==="documents");o.push({name:"Storage Bucket",status:m?"error":f?"success":"error",message:m?m.message:f?"Documents bucket exists":"Documents bucket not found",details:{buckets:h,error:m}})}catch(h){o.push({name:"Storage Bucket",status:"error",message:h instanceof Error?h.message:"Unknown error",details:h})}const c={VITE_SUPABASE_URL:"https://kvlaydeyqidlfpfutbmp.supabase.co",VITE_SUPABASE_ANON_KEY:"***",VITE_APP_URL:"https://craftchatbot.com"},d=Object.entries(c).filter(([h,m])=>!m);o.push({name:"Environment Variables",status:d.length>0?"error":"success",message:d.length>0?`Missing: ${d.map(([h])=>h).join(", ")}`:"All required variables present",details:c}),t(o),a(!1)};p.useEffect(()=>{n()},[]);const i=o=>{switch(o){case"success":return e.jsx(Ue,{className:"h-5 w-5 text-green-500"});case"error":return e.jsx(Qs,{className:"h-5 w-5 text-red-500"});case"pending":return e.jsx(is,{className:"h-5 w-5 text-yellow-500"})}};return e.jsxs($,{className:"max-w-4xl mx-auto",children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center justify-between",children:["Database Connection Test",e.jsxs(R,{onClick:n,disabled:s,size:"sm",children:[e.jsx(mr,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),s?"Running...":"Run Tests"]})]})}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:r.map((o,c)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[i(o.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:o.name}),e.jsx("p",{className:"text-sm text-gray-600",children:o.message}),!1]})]},c))})})]})},UV=()=>{const{profile:r}=ft(),t=ps(),[s,a]=p.useState(null),[n,i]=p.useState([]),[o,c]=p.useState(!1),[d,h]=p.useState(0),[m,f]=p.useState("overview"),g=p.useCallback(N=>{a(N)},[]),y=p.useCallback(()=>{a(null)},[]),b=p.useCallback(N=>{h(v=>v+1)},[]),w=p.useCallback(N=>{i(N)},[]),S=p.useCallback(N=>{c(N)},[]);return e.jsx(Ey,{children:e.jsx(Qb,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>t("/"),className:"flex items-center space-x-1 px-2 sm:px-3",title:"Go to Homepage",children:[e.jsx(Nm,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Home"})]}),e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>t("/dashboard"),className:"flex items-center space-x-1 px-2 sm:px-3",title:"Back to Dashboard",children:[e.jsx($r,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Dashboard"})]})]}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Document Management"}),e.jsx("p",{className:"text-gray-600",children:"Upload, process, and manage your legal documents with AI"})]}),e.jsx("div",{className:"md:hidden",children:e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Documents"})})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Subscription"}),e.jsx("p",{className:"font-medium capitalize",children:(r==null?void 0:r.subscription_tier)||"Free"})]})})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"px-4 py-6 sm:px-0",children:s?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(R,{onClick:y,variant:"outline",size:"sm",children:[e.jsx(Vs,{className:"h-4 w-4 mr-2"}),"Close Viewer"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Document Viewer"}),e.jsxs("p",{className:"text-gray-600",children:["Viewing: ",s.filename]})]})]})}),e.jsx(xV,{documentId:s.id,onClose:y,className:"w-full"})]}):e.jsxs(fr,{value:m,onValueChange:f,className:"space-y-6",children:[e.jsxs(nr,{className:"grid w-full grid-cols-6",children:[e.jsxs(Ge,{value:"overview",className:"flex items-center space-x-2",children:[e.jsx(Ba,{className:"h-4 w-4"}),e.jsx("span",{children:"Overview"})]}),e.jsxs(Ge,{value:"upload",className:"flex items-center space-x-2",children:[e.jsx(_r,{className:"h-4 w-4"}),e.jsx("span",{children:"Upload"})]}),e.jsxs(Ge,{value:"search",className:"flex items-center space-x-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx("span",{children:"Search"})]}),e.jsxs(Ge,{value:"manage",className:"flex items-center space-x-2",children:[e.jsx(So,{className:"h-4 w-4"}),e.jsx("span",{children:"Manage"})]}),e.jsxs(Ge,{value:"enhanced",className:"flex items-center space-x-2",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsx("span",{children:"Enhanced"})]}),e.jsxs(Ge,{value:"debug",className:"flex items-center space-x-2",children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx("span",{children:"Debug"})]})]}),e.jsxs(He,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(nx,{onDocumentSelect:g,refreshTrigger:d})}),e.jsx("div",{children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"text-lg flex items-center",children:[e.jsx(_r,{className:"h-5 w-5 mr-2"}),"Quick Upload"]}),e.jsx(ye,{children:"Upload documents for AI processing"})]}),e.jsx(z,{children:e.jsx(Wb,{onUploadComplete:b,maxFiles:3})})]})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"text-lg flex items-center",children:[e.jsx(Fe,{className:"h-5 w-5 mr-2"}),"Recent Documents"]}),e.jsx(ye,{children:"Your most recently uploaded documents"})]}),e.jsx(z,{children:e.jsx(rx,{onDocumentSelect:g,refreshTrigger:d})})]})]}),e.jsx(He,{value:"upload",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Wb,{onUploadComplete:b,maxFiles:10})}),e.jsx("div",{children:e.jsx(nx,{onDocumentSelect:g,refreshTrigger:d})})]})}),e.jsx(He,{value:"search",className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(wV,{onResults:w,onLoading:S}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"text-lg flex items-center",children:[e.jsx(Yt,{className:"h-5 w-5 mr-2"}),"Search Results",o&&e.jsx("div",{className:"ml-2 h-4 w-4 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"})]}),e.jsx(ye,{children:n.length>0?`Found ${n.length} document${n.length===1?"":"s"}`:"Enter search criteria to find documents"})]}),e.jsx(z,{children:e.jsx(rx,{onDocumentSelect:g,refreshTrigger:d})})]})]})}),e.jsx(He,{value:"manage",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"text-lg flex items-center",children:[e.jsx(So,{className:"h-5 w-5 mr-2"}),"All Documents"]}),e.jsx(ye,{children:"Manage all your uploaded documents"})]}),e.jsx(z,{children:e.jsx(rx,{onDocumentSelect:g,refreshTrigger:d})})]})}),e.jsx("div",{children:e.jsx(nx,{onDocumentSelect:g,refreshTrigger:d})})]})}),e.jsx(He,{value:"enhanced",className:"space-y-6",children:e.jsx(Qb,{children:e.jsx(OV,{})})}),e.jsx(He,{value:"debug",className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(UploadDiagnostics,{}),e.jsx(O2,{}),e.jsx(by,{}),e.jsx(LV,{})]})})]})})})]})})})},$V=zi({message:ys().min(1,"Please enter a message")}),zV=({className:r="",documentContext:t=[]})=>{const[s,a]=p.useState([]),[n,i]=p.useState(!1),[o,c]=p.useState(t),d=p.useRef(null),{user:h}=ft(),{register:m,handleSubmit:f,reset:g,formState:{errors:y}}=Ui({resolver:$i($V)});p.useEffect(()=>{var N;(N=d.current)==null||N.scrollIntoView({behavior:"smooth"})},[s]),p.useEffect(()=>{s.length===0&&a([{id:"welcome",role:"assistant",content:`Hello! I'm your AI legal assistant. I can help you with:

• Understanding legal documents
• Answering questions about Singapore law
• Explaining legal concepts and procedures
• Providing guidance on legal matters

Please note that this is for informational purposes only and does not constitute legal advice. For specific legal matters, please consult with a qualified lawyer.

How can I help you today?`,timestamp:new Date,confidence:1}])},[s.length]);const b=async N=>{if(!h){te.error("Please log in to use the AI chat");return}const v={id:Date.now().toString(),role:"user",content:N.message,timestamp:new Date};a(j=>[...j,v]),i(!0),g();try{let j=[...o];if(N.message.length>10)try{const O=(await cv({query:N.message,userId:h.id,maxResults:3,similarityThreshold:.6})).map(U=>U.chunk_text);j=[...j,...O]}catch(T){console.warn("Failed to get document context:",T)}const C=s.slice(-6).map(T=>({role:T.role,content:T.content})),k=await AC(N.message,j,C),I={id:(Date.now()+1).toString(),role:"assistant",content:k.message,timestamp:new Date,sources:k.sources,confidence:k.confidence};a(T=>[...T,I])}catch(j){console.error("Chat error:",j);const C={id:(Date.now()+1).toString(),role:"assistant",content:"I apologize, but I encountered an error while processing your request. Please try again or rephrase your question.",timestamp:new Date,confidence:0};a(k=>[...k,C]),te.error("Failed to get AI response")}finally{i(!1)}},w=()=>{a([])},S=N=>N.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsxs($,{className:`flex flex-col h-[600px] ${r}`,children:[e.jsxs(Z,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-blue-600"}),e.jsx(X,{className:"text-lg",children:"AI Legal Assistant"})]}),s.length>1&&e.jsx(R,{variant:"outline",size:"sm",onClick:w,children:"Clear Chat"})]}),e.jsx(ye,{children:"Ask questions about your documents or Singapore law"})]}),e.jsxs(z,{className:"flex-1 flex flex-col space-y-4 p-4",children:[e.jsx(Po,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[s.map(N=>e.jsx("div",{className:`flex ${N.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${N.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[N.role==="assistant"&&e.jsx(fd,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),N.role==="user"&&e.jsx(cn,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"whitespace-pre-wrap text-sm",children:N.content}),N.sources&&N.sources.length>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("div",{className:"text-xs opacity-75",children:"Sources:"}),N.sources.map((v,j)=>e.jsxs(ae,{variant:"secondary",className:"text-xs",children:[e.jsx(Fe,{className:"h-3 w-3 mr-1"}),v]},j))]}),N.role==="assistant"&&N.confidence!==void 0&&e.jsxs("div",{className:"mt-2 flex items-center space-x-1",children:[N.confidence>=.8?e.jsx(Sm,{className:"h-3 w-3 text-green-500"}):N.confidence>=.5?e.jsx(It,{className:"h-3 w-3 text-yellow-500"}):e.jsx(It,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-xs opacity-75",children:N.confidence>=.8?"High confidence":N.confidence>=.5?"Medium confidence":"Low confidence"})]}),e.jsx("div",{className:"text-xs opacity-75 mt-1",children:S(N.timestamp)})]})]})})},N.id)),n&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fd,{className:"h-4 w-4"}),e.jsx(ds,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Thinking..."})]})})}),e.jsx("div",{ref:d})]})}),e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{className:"text-xs",children:"This AI assistant provides general information only and does not constitute legal advice. Consult a qualified lawyer for specific legal matters."})]}),e.jsxs("form",{onSubmit:f(b),className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(Pe,{...m("message"),placeholder:"Ask a legal question...",disabled:n,className:"w-full"}),y.message&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:y.message.message})]}),e.jsx(R,{type:"submit",disabled:n,size:"sm",children:e.jsx(Kg,{className:"h-4 w-4"})})]})]})]})},BV=({className:r=""})=>{const{notifications:t,markAsRead:s,clearAll:a}=mV(),n=t.filter(c=>!c.read).length,i=c=>{switch(c){case"success":return e.jsx(Ue,{className:"h-4 w-4 text-green-500"});case"warning":return e.jsx(It,{className:"h-4 w-4 text-yellow-500"});case"error":return e.jsx(Qs,{className:"h-4 w-4 text-red-500"});default:return e.jsx(Hg,{className:"h-4 w-4 text-blue-500"})}},o=c=>{switch(c){case"success":return"default";case"warning":return"secondary";case"error":return"destructive";default:return"outline"}};return e.jsx("div",{className:r,children:e.jsxs(Sd,{children:[e.jsx(kd,{asChild:!0,children:e.jsxs(R,{variant:"ghost",size:"sm",className:"relative h-8 w-8 p-0",children:[n>0?e.jsx(P5,{className:"h-4 w-4"}):e.jsx(td,{className:"h-4 w-4"}),n>0&&e.jsx(ae,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 text-xs flex items-center justify-center",children:n>9?"9+":n})]})}),e.jsx(Xl,{className:"w-96",align:"end",children:e.jsxs($,{className:"border-0 shadow-none",children:[e.jsx(Z,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(td,{className:"h-4 w-4"}),e.jsx("span",{children:"Notifications"})]}),n>0&&e.jsxs(ye,{className:"text-xs",children:[n," unread notification",n!==1?"s":""]})]}),t.length>0&&e.jsx(R,{variant:"ghost",size:"sm",onClick:a,className:"text-xs",children:"Clear all"})]})}),e.jsx(z,{className:"p-0",children:t.length>0?e.jsx(Po,{className:"h-80",children:e.jsx("div",{className:"space-y-1 p-3",children:t.map(c=>e.jsx("div",{className:`p-3 rounded-lg border transition-colors ${c.read?"bg-gray-50 border-gray-200":"bg-white border-blue-200 shadow-sm"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:i(c.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:c.title}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:c.message}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{variant:o(c.type),className:"text-xs",children:c.type}),e.jsx("span",{className:"text-xs text-gray-500",children:Vt(new Date(c.created_at),{addSuffix:!0})})]})]}),e.jsx("div",{className:"flex items-center space-x-1 ml-2",children:!c.read&&e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>s(c.id),className:"h-6 w-6 p-0",children:e.jsx(sc,{className:"h-3 w-3"})})})]}),c.action_url&&c.action_label&&e.jsx("div",{className:"mt-2",children:e.jsxs(R,{variant:"outline",size:"sm",className:"text-xs h-7",onClick:()=>{window.open(c.action_url,"_blank"),s(c.id)},children:[c.action_label,e.jsx(nN,{className:"h-3 w-3 ml-1"})]})})]})]})},c.id))})}):e.jsxs("div",{className:"text-center py-8 px-3",children:[e.jsx(td,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"No notifications"}),e.jsx("p",{className:"text-xs text-gray-500",children:"You're all caught up! New notifications will appear here."})]})})]})})]})})},Yb=[{name:"Dashboard",href:"/dashboard",icon:Nm},{name:"Documents",href:"/dashboard/documents",icon:Fe},{name:"AI Assistant",href:"/dashboard/ai-assistant",icon:Ft},{name:"Templates",href:"/dashboard/templates",icon:px},{name:"Law Firms",href:"/dashboard/law-firms",icon:No},{name:"Legal Q&A",href:"/legal-qa",icon:Ft},{name:"Document Analysis",href:"/analyze",icon:Ba},{name:"Search History",href:"/dashboard/search-history",icon:Yt}],la=({children:r})=>{var d,h,m;const{user:t,profile:s,signOut:a}=ft(),n=Ug(),i=ps(),o=async()=>{try{await a(),i("/")}catch(f){console.error("Error signing out:",f)}},c=(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="super_admin";return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(gs,{to:"/dashboard",className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"LM"})}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"LawMattersSG"})]})}),e.jsx("nav",{className:"hidden md:flex space-x-8",children:Yb.map(f=>{const g=f.icon,y=n.pathname===f.href;return e.jsxs(gs,{to:f.href,className:Ie("flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors",y?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{children:f.name})]},f.name)})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(BV,{}),e.jsx(sE,{}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(gs,{to:"/dashboard/subscription",children:e.jsx(R,{variant:"outline",size:"sm",children:(s==null?void 0:s.role)==="super_admin"?e.jsxs(e.Fragment,{children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Super Admin"]}):(s==null?void 0:s.role)==="admin"?e.jsxs(e.Fragment,{children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Admin"]}):e.jsxs(e.Fragment,{children:[e.jsx(wo,{className:"h-4 w-4 mr-2"}),(s==null?void 0:s.subscription_tier)||"Free"]})})})}),e.jsxs(_d,{children:[e.jsx(Nd,{asChild:!0,children:e.jsx(R,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:e.jsxs(zr,{className:"h-8 w-8",children:[e.jsx($n,{src:s==null?void 0:s.avatar_url,alt:(s==null?void 0:s.full_name)||(t==null?void 0:t.email)}),e.jsx(Br,{children:((d=s==null?void 0:s.first_name)==null?void 0:d[0])||((m=(h=t==null?void 0:t.email)==null?void 0:h[0])==null?void 0:m.toUpperCase())})]})})}),e.jsxs(Yl,{className:"w-56",align:"end",forceMount:!0,children:[e.jsx(sv,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:(s==null?void 0:s.full_name)||"User"}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:t==null?void 0:t.email})]})}),e.jsx(Ro,{}),e.jsx(ur,{asChild:!0,children:e.jsxs(gs,{to:"/dashboard/profile",className:"flex items-center",children:[e.jsx(cn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Profile"})]})}),e.jsx(ur,{asChild:!0,children:e.jsxs(gs,{to:"/dashboard/subscription",className:"flex items-center",children:[e.jsx(wo,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Subscription"})]})}),e.jsx(ur,{asChild:!0,children:e.jsxs(gs,{to:"/dashboard/settings",className:"flex items-center",children:[e.jsx(Ei,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Settings"})]})}),c&&e.jsx(ur,{asChild:!0,children:e.jsxs(gs,{to:"/dashboard/admin",className:"flex items-center",children:[e.jsx(vs,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Admin"})]})}),e.jsx(Ro,{}),e.jsxs(ur,{onClick:o,children:[e.jsx(lN,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Log out"})]})]})]})]})]})})}),e.jsx("div",{className:"md:hidden bg-white border-b",children:e.jsx("div",{className:"px-4 py-2",children:e.jsx("nav",{className:"flex space-x-4 overflow-x-auto",children:Yb.map(f=>{const g=f.icon,y=n.pathname===f.href;return e.jsxs(gs,{to:f.href,className:Ie("flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-colors",y?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{children:f.name})]},f.name)})})})}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"px-4 py-6 sm:px-0",children:r})})]})},qV=()=>{const[r,t]=p.useState([]),[s,a]=p.useState(!0),{user:n}=ft();p.useEffect(()=>{n&&(async()=>{try{const h=(await Ds.getDocuments()).filter(m=>m.ocr_text&&m.processing_status==="completed").sort((m,f)=>new Date(f.created_at).getTime()-new Date(m.created_at).getTime()).slice(0,5);t(h)}catch(d){console.error("Failed to load recent documents:",d)}finally{a(!1)}})()},[n]);const i=[{icon:Ft,title:"Legal Q&A",description:"Ask questions about Singapore law and get instant answers",color:"text-blue-600"},{icon:Fe,title:"Document Analysis",description:"Get AI-powered insights from your uploaded documents",color:"text-green-600"},{icon:ki,title:"Smart Search",description:"Find relevant information using semantic search",color:"text-purple-600"},{icon:Nr,title:"Quick Summaries",description:"Get concise summaries of complex legal documents",color:"text-yellow-600"}],o=["Ask specific questions about your documents for better results","Use natural language - no need for legal jargon","Reference document names or types for context","Ask for explanations of legal terms or concepts","Request summaries of long documents"];return e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"AI Legal Assistant"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Get instant help with legal questions and document analysis"})]}),e.jsxs(ae,{variant:"secondary",className:"flex items-center space-x-1",children:[e.jsx(ki,{className:"h-3 w-3"}),e.jsx("span",{children:"Powered by GPT-4"})]})]}),e.jsxs(fr,{defaultValue:"chat",className:"space-y-6",children:[e.jsxs(nr,{className:"grid w-full grid-cols-3",children:[e.jsx(Ge,{value:"chat",children:"AI Chat"}),e.jsx(Ge,{value:"features",children:"Features"}),e.jsx(Ge,{value:"tips",children:"Usage Tips"})]}),e.jsx(He,{value:"chat",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(zV,{className:"h-[700px]"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs($,{children:[e.jsxs(Z,{className:"pb-3",children:[e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:"Recent Documents"})]}),e.jsx(ye,{className:"text-xs",children:"Documents available for AI analysis"})]}),e.jsx(z,{className:"space-y-2",children:s?e.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):r.length>0?r.map(c=>e.jsxs("div",{className:"p-2 border rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:c.filename}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(c.created_at).toLocaleDateString()})]},c.id)):e.jsx("div",{className:"text-sm text-gray-500",children:"No processed documents yet. Upload some documents to get started!"})})]}),e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsx(X,{className:"text-sm",children:"Quick Actions"})}),e.jsxs(z,{className:"space-y-2",children:[e.jsxs(R,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(e6,{className:"h-4 w-4 mr-2"}),"Analyze Latest Document"]}),e.jsxs(R,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Legal Trend Analysis"]}),e.jsxs(R,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Recent Legal Updates"]})]})]})]})]})}),e.jsx(He,{value:"features",className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i.map((c,d)=>e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(c.icon,{className:`h-5 w-5 ${c.color}`}),e.jsx("span",{children:c.title})]}),e.jsx(ye,{children:c.description})]}),e.jsx(z,{children:e.jsxs("div",{className:"text-sm text-gray-600",children:[c.title==="Legal Q&A"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Ask about Singapore law and regulations"}),e.jsx("li",{children:"• Get explanations of legal concepts"}),e.jsx("li",{children:"• Understand legal procedures"})]}),c.title==="Document Analysis"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Extract key information from documents"}),e.jsx("li",{children:"• Identify important clauses and terms"}),e.jsx("li",{children:"• Get risk assessments"})]}),c.title==="Smart Search"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Find documents by meaning, not just keywords"}),e.jsx("li",{children:"• Discover related content"}),e.jsx("li",{children:"• Get contextual results"})]}),c.title==="Quick Summaries"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Get executive summaries"}),e.jsx("li",{children:"• Understand key points quickly"}),e.jsx("li",{children:"• Save time on document review"})]})]})})]},d))})}),e.jsxs(He,{value:"tips",className:"space-y-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"How to Get the Best Results"}),e.jsx(ye,{children:"Tips for effective AI interaction"})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:o.map((c,d)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 text-sm font-medium",children:d+1})}),e.jsx("p",{className:"text-sm text-gray-700",children:c})]},d))})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Example Questions"}),e.jsx(ye,{children:"Try asking these types of questions"})]}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Document Questions"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:'• "What are the key terms in my contract?"'}),e.jsx("li",{children:'• "Summarize the main points of this agreement"'}),e.jsx("li",{children:'• "What are the payment obligations?"'})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Legal Questions"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:'• "What is the process for company incorporation in Singapore?"'}),e.jsx("li",{children:'• "Explain employment law requirements"'}),e.jsx("li",{children:'• "What are the data protection obligations?"'})]})]})]})})]})]})]})]})})},aE={async getPublicTemplates(){const{data:r,error:t}=await D.from("templates").select("*").eq("is_public",!0).order("created_at",{ascending:!1});if(t)throw t;return r},async getUserTemplates(){const{data:r,error:t}=await D.from("templates").select("*").order("created_at",{ascending:!1});if(t)throw t;return r},async getTemplatesByCategory(r){const{data:t,error:s}=await D.from("templates").select("*").eq("category",r).eq("is_public",!0).order("created_at",{ascending:!1});if(s)throw s;return t},async getTemplate(r){const{data:t,error:s}=await D.from("templates").select("*").eq("id",r).single();if(s)throw s;return t},async createTemplate(r){const t=await D.auth.getUser();if(!t.data.user)throw new Error("User not authenticated");const{data:s,error:a}=await D.from("templates").insert({...r,created_by:t.data.user.id}).select().single();if(a)throw a;return s},async updateTemplate(r,t){const{data:s,error:a}=await D.from("templates").update(t).eq("id",r).select().single();if(a)throw a;return s},async deleteTemplate(r){const{error:t}=await D.from("templates").delete().eq("id",r);if(t)throw t},async searchTemplates(r){const{data:t,error:s}=await D.from("templates").select("*").or(`name.ilike.%${r}%,description.ilike.%${r}%,category.ilike.%${r}%`).eq("is_public",!0).order("created_at",{ascending:!1});if(s)throw s;return t},exportTemplate(r,t="txt"){let s,a;switch(t){case"json":s=JSON.stringify(r,null,2),a="application/json";break;case"docx":s=r.content,a="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"txt":default:s=r.content,a="text/plain";break}return new Blob([s],{type:a})},downloadTemplate(r,t="txt"){const s=this.exportTemplate(r,t),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=`${r.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.${t}`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},async createTemplateVersion(r,t,s){const a=await this.getTemplate(r),n={name:`${a.name} v${Date.now()}`,description:t.description||a.description,category:t.category||a.category,content:t.content||a.content,variables:t.variables||a.variables,is_public:t.is_public??a.is_public};return this.createTemplate(n)}},Jb=[{value:"",label:"All Categories"},{value:"contracts",label:"Contracts & Agreements"},{value:"employment",label:"Employment Law"},{value:"corporate",label:"Corporate Documents"},{value:"real-estate",label:"Real Estate"},{value:"intellectual-property",label:"Intellectual Property"},{value:"litigation",label:"Litigation & Court"},{value:"compliance",label:"Compliance & Regulatory"},{value:"personal",label:"Personal Legal"},{value:"other",label:"Other"}],VV=({onTemplateSelect:r,onTemplatePreview:t,className:s=""})=>{const[a,n]=p.useState([]),[i,o]=p.useState([]),[c,d]=p.useState(!0),[h,m]=p.useState(""),[f,g]=p.useState(""),[y,b]=p.useState("grid"),[w,S]=p.useState("newest");p.useEffect(()=>{N()},[]),p.useEffect(()=>{v()},[a,h,f,w]);const N=async()=>{try{d(!0);const T=await aE.getPublicTemplates();n(T)}catch(T){console.error("Error loading templates:",T),te.error("Failed to load templates")}finally{d(!1)}},v=()=>{let T=[...a];if(h.trim()){const O=h.toLowerCase();T=T.filter(U=>U.name.toLowerCase().includes(O)||U.description.toLowerCase().includes(O)||U.category.toLowerCase().includes(O))}f&&(T=T.filter(O=>O.category===f)),T.sort((O,U)=>{switch(w){case"newest":return new Date(U.created_at).getTime()-new Date(O.created_at).getTime();case"oldest":return new Date(O.created_at).getTime()-new Date(U.created_at).getTime();case"name":return O.name.localeCompare(U.name);default:return 0}}),o(T)},j=(T,O)=>{switch(O){case"select":r==null||r(T);break;case"preview":t==null||t(T);break;case"copy":navigator.clipboard.writeText(T.content),te.success("Template content copied to clipboard");break}},C=T=>{const O=Jb.find(U=>U.value===T);return(O==null?void 0:O.label)||T},k=({template:T})=>e.jsxs($,{className:"h-full hover:shadow-md transition-shadow",children:[e.jsx(Z,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(X,{className:"text-lg font-semibold truncate",children:T.name}),e.jsx(ye,{className:"mt-1 line-clamp-2",children:T.description})]}),e.jsx(ae,{variant:"secondary",className:"ml-2 flex-shrink-0",children:C(T.category)})]})}),e.jsx(z,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-700 line-clamp-3",children:[T.content.substring(0,150),"..."]})}),T.variables&&T.variables.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Variables:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[T.variables.slice(0,3).map((O,U)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:O},U)),T.variables.length>3&&e.jsxs(ae,{variant:"outline",className:"text-xs",children:["+",T.variables.length-3," more"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ln,{className:"h-3 w-3"}),e.jsx("span",{children:Vt(new Date(T.created_at),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(cn,{className:"h-3 w-3"}),e.jsx("span",{children:"Public"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>j(T,"preview"),children:[e.jsx(Gt,{className:"h-4 w-4 mr-1"}),"Preview"]}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>j(T,"copy"),children:e.jsx(sd,{className:"h-4 w-4"})}),e.jsxs(R,{size:"sm",onClick:()=>j(T,"select"),children:[e.jsx(fs,{className:"h-4 w-4 mr-1"}),"Use"]})]})]})})]}),I=({template:T})=>e.jsx($,{className:"hover:shadow-sm transition-shadow",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Fe,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium truncate",children:T.name}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:T.description})]})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ae,{variant:"secondary",className:"text-xs",children:C(T.category)}),e.jsx("span",{className:"text-xs text-gray-500",children:Vt(new Date(T.created_at),{addSuffix:!0})}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>j(T,"preview"),children:e.jsx(Gt,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>j(T,"copy"),children:e.jsx(sd,{className:"h-4 w-4"})}),e.jsx(R,{size:"sm",onClick:()=>j(T,"select"),children:"Use"})]})]})]})})});return e.jsxs("div",{className:`space-y-6 ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Legal Templates"}),e.jsx("p",{className:"text-gray-600",children:"Browse and customize professional legal document templates"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{variant:y==="grid"?"default":"outline",size:"sm",onClick:()=>b("grid"),children:e.jsx(_m,{className:"h-4 w-4"})}),e.jsx(R,{variant:y==="list"?"default":"outline",size:"sm",onClick:()=>b("list"),children:e.jsx(So,{className:"h-4 w-4"})})]})]}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Pe,{placeholder:"Search templates...",value:h,onChange:T=>m(T.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"w-full md:w-64",children:e.jsxs(it,{value:f,onValueChange:g,children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Category"})}),e.jsx(at,{children:Jb.map(T=>e.jsx(ne,{value:T.value,children:T.label},T.value))})]})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs(it,{value:w,onValueChange:T=>S(T),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Sort by"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"newest",children:"Newest First"}),e.jsx(ne,{value:"oldest",children:"Oldest First"}),e.jsx(ne,{value:"name",children:"Name A-Z"})]})]})})]})})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:c?"Loading...":`${i.length} template${i.length===1?"":"s"} found`})}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((T,O)=>e.jsxs($,{className:"animate-pulse",children:[e.jsxs(Z,{children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})})]},O))}):i.length>0?y==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(T=>e.jsx(k,{template:T},T.id))}):e.jsx("div",{className:"space-y-3",children:i.map(T=>e.jsx(I,{template:T},T.id))}):e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Fe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria or browse different categories."})]})})]})]})},WV=({template:r,onSave:t,onDownload:s,className:a=""})=>{const[n,i]=p.useState(r.content),[o,c]=p.useState({}),[d,h]=p.useState([]),[m,f]=p.useState(!1);p.useState(!1),p.useEffect(()=>{g()},[r]),p.useEffect(()=>{S()},[o,r.content]);const g=()=>{const U=/\{\{([^}]+)\}\}/g,A=r.content.match(U)||[],M=[...new Set(A.map(W=>W.replace(/[{}]/g,"")))].map(W=>{const q=W.trim();return{name:q,value:"",required:!0,type:y(q),placeholder:b(q),description:w(q)}});h(M);const se={};M.forEach(W=>{se[W.name]=""}),c(se)},y=U=>{const A=U.toLowerCase();return A.includes("date")||A.includes("time")?"date":A.includes("email")||A.includes("mail")?"email":A.includes("amount")||A.includes("price")||A.includes("cost")?"number":"text"},b=U=>{const A=U.toLowerCase();return A.includes("name")?"Enter full name":A.includes("company")?"Enter company name":A.includes("address")?"Enter address":A.includes("date")?"Select date":A.includes("email")?"Enter email address":A.includes("phone")?"Enter phone number":A.includes("amount")||A.includes("price")?"Enter amount":`Enter ${U.replace(/_/g," ").toLowerCase()}`},w=U=>{const A=U.toLowerCase();return A.includes("party1")||A.includes("first_party")?"First party to the agreement":A.includes("party2")||A.includes("second_party")?"Second party to the agreement":A.includes("effective_date")?"Date when the agreement becomes effective":A.includes("termination_date")?"Date when the agreement terminates":A.includes("governing_law")?"Jurisdiction governing this agreement":`Value for ${U.replace(/_/g," ").toLowerCase()}`},S=()=>{let U=r.content;d.forEach(A=>{const L=`{{${A.name}}}`,M=o[A.name]||`[${A.name.toUpperCase()}]`;U=U.replace(new RegExp(L.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),M)}),i(U)},N=(U,A)=>{c(L=>({...L,[U]:A}))},v=()=>{t==null||t(n,o),te.success("Template customization saved")},j=()=>{const U=`${r.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_customized.docx`;s==null||s(n,U),te.success("Template downloaded")},C=()=>{const U={};d.forEach(A=>{U[A.name]=""}),c(U),te.success("Variables reset")},k=()=>{const U=d.length,A=d.filter(L=>{var M;return(M=o[L.name])==null?void 0:M.trim()}).length;return{total:U,completed:A}},{total:I,completed:T}=k(),O=I>0?Math.round(T/I*100):100;return e.jsxs("div",{className:`space-y-6 ${a}`,children:[e.jsx($,{children:e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),e.jsx("span",{children:"Customize Template"})]}),e.jsxs(ye,{children:[r.name," - Fill in the variables to customize your document"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(ae,{variant:O===100?"default":"secondary",children:[T,"/",I," completed"]}),e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>f(!m),children:[m?e.jsx(Pi,{className:"h-4 w-4"}):e.jsx(Gt,{className:"h-4 w-4"}),m?"Hide":"Show"," Preview"]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-lg",children:"Template Variables"}),e.jsx(ye,{children:"Fill in the required information to customize your document"})]}),e.jsx(z,{className:"space-y-4",children:d.length>0?e.jsxs(e.Fragment,{children:[d.map(U=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Te,{htmlFor:U.name,className:"flex items-center space-x-2",children:[e.jsx("span",{children:U.name.replace(/_/g," ").replace(/\b\w/g,A=>A.toUpperCase())}),U.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),U.type==="date"?e.jsx(Pe,{id:U.name,type:"date",value:o[U.name]||"",onChange:A=>N(U.name,A.target.value),className:"w-full"}):U.type==="email"?e.jsx(Pe,{id:U.name,type:"email",placeholder:U.placeholder,value:o[U.name]||"",onChange:A=>N(U.name,A.target.value),className:"w-full"}):U.type==="number"?e.jsx(Pe,{id:U.name,type:"number",placeholder:U.placeholder,value:o[U.name]||"",onChange:A=>N(U.name,A.target.value),className:"w-full"}):e.jsx(Pe,{id:U.name,type:"text",placeholder:U.placeholder,value:o[U.name]||"",onChange:A=>N(U.name,A.target.value),className:"w-full"}),U.description&&e.jsx("p",{className:"text-xs text-gray-500",children:U.description})]},U.name)),e.jsx(Ts,{}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",onClick:C,className:"flex-1",children:[e.jsx(mr,{className:"h-4 w-4 mr-2"}),"Reset"]}),e.jsxs(R,{onClick:v,disabled:T===0,className:"flex-1",children:[e.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Save"]}),e.jsxs(R,{onClick:j,disabled:T===0,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Download"]})]})]}):e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:"No variables found in this template. You can download it as-is or modify the content directly."})]})})]}),m&&e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-lg",children:"Document Preview"}),e.jsx(ye,{children:"Live preview of your customized document"})]}),e.jsx(z,{children:e.jsx("div",{className:"max-h-96 overflow-y-auto p-4 bg-gray-50 rounded-lg",children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono",children:n})})})})]})]}),d.length>0&&e.jsx($,{children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[O===100?e.jsx(Ue,{className:"h-5 w-5 text-green-500"}):e.jsx(It,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium",children:O===100?"All variables completed - ready to download!":`${I-T} variable${I-T===1?"":"s"} remaining`})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[O,"% complete"]})]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${O}%`}})})]})})]})};async function HV(r){const t=GV(r);try{const s=await AC(t,[],[]);return{...KV(s.message,r),confidence:s.confidence}}catch(s){throw console.error("Template generation failed:",s),new Error("Failed to generate template")}}function GV(r){const{type:t,parties:s,terms:a,customRequirements:n,language:i="english",jurisdiction:o="singapore"}=r;let c=`Generate a professional legal ${t} template for ${o==="singapore"?"Singapore":"international"} use. `;return i==="simplified"?c+="Use clear, simple language that non-lawyers can understand. ":c+="Use standard legal terminology and formal language. ",c+=`

Template Requirements:
`,c+=`- Document Type: ${t}
`,(s.party1||s.party2)&&(c+=`- Parties:
`,s.party1&&(c+=`  - First Party: Use variable {{party1_name}} for ${s.party1}
`),s.party2&&(c+=`  - Second Party: Use variable {{party2_name}} for ${s.party2}
`)),Object.keys(a).length>0&&(c+=`- Key Terms:
`,Object.entries(a).forEach(([d,h])=>{h&&(c+=`  - ${d.replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase())}: Use variable {{${d}}} for ${h}
`)})),n&&(c+=`- Additional Requirements: ${n}
`),c+=`
Instructions:
`,c+=`1. Create a complete, legally sound template
`,c+=`2. Use variables in double curly braces {{variable_name}} for customizable fields
`,c+=`3. Include all necessary legal clauses and provisions
`,c+=`4. Ensure compliance with Singapore law (if applicable)
`,c+=`5. Add appropriate signature blocks and date fields
`,c+=`6. Include clear section headings and numbering

`,c+=`Format your response as JSON with the following structure:
`,c+=`{
`,c+=`  "name": "Template name",
`,c+=`  "description": "Brief description of the template",
`,c+=`  "category": "Template category (contracts, employment, corporate, etc.)",
`,c+=`  "content": "Full template content with variables",
`,c+=`  "variables": ["list", "of", "variable", "names"]
`,c+=`}

`,c+="Respond with valid JSON only, no additional text.",c}function KV(r,t){try{const s=JSON.parse(r);return{name:s.name||`${t.type} Template`,content:s.content||r,variables:s.variables||Zb(s.content||r),category:s.category||Xb(t.type),description:s.description||`AI-generated ${t.type} template`}}catch{return console.warn("Failed to parse JSON response, using raw content"),{name:`${t.type} Template`,content:r,variables:Zb(r),category:Xb(t.type),description:`AI-generated ${t.type} template`}}}function Zb(r){const t=/\{\{([^}]+)\}\}/g,s=r.match(t)||[];return[...new Set(s.map(a=>a.replace(/[{}]/g,"").trim()))]}function Xb(r){const t={contract:"contracts",agreement:"contracts","employment contract":"employment","service agreement":"contracts",nda:"contracts","non-disclosure agreement":"contracts","lease agreement":"real-estate","rental agreement":"real-estate","purchase agreement":"real-estate","partnership agreement":"corporate","shareholder agreement":"corporate","articles of incorporation":"corporate","trademark application":"intellectual-property","copyright notice":"intellectual-property","privacy policy":"compliance","terms of service":"compliance",will:"personal","power of attorney":"personal"},s=r.toLowerCase();return t[s]||"other"}async function QV(r,t=!1){try{const s={name:r.name,description:r.description,category:r.category,content:r.content,variables:r.variables,is_public:t};return await aE.createTemplate(s)}catch(s){throw console.error("Failed to save generated template:",s),new Error("Failed to save template")}}const YV=zi({type:ys().min(1,"Template type is required"),party1:ys().optional(),party2:ys().optional(),duration:ys().optional(),amount:ys().optional(),jurisdiction:og(["singapore","international"]).default("singapore"),language:og(["english","simplified"]).default("english"),customRequirements:ys().optional(),saveAsPublic:f2().default(!1)}),JV=[{value:"service agreement",label:"Service Agreement"},{value:"employment contract",label:"Employment Contract"},{value:"non-disclosure agreement",label:"Non-Disclosure Agreement (NDA)"},{value:"consulting agreement",label:"Consulting Agreement"},{value:"partnership agreement",label:"Partnership Agreement"},{value:"lease agreement",label:"Lease Agreement"},{value:"purchase agreement",label:"Purchase Agreement"},{value:"terms of service",label:"Terms of Service"},{value:"privacy policy",label:"Privacy Policy"},{value:"shareholder agreement",label:"Shareholder Agreement"},{value:"licensing agreement",label:"Licensing Agreement"},{value:"distribution agreement",label:"Distribution Agreement"}],ZV=({onTemplateGenerated:r,className:t=""})=>{const[s,a]=p.useState(!1),[n,i]=p.useState(null),[o,c]=p.useState(!1),{register:d,handleSubmit:h,watch:m,setValue:f,formState:{errors:g}}=Ui({resolver:$i(YV),defaultValues:{jurisdiction:"singapore",language:"english",saveAsPublic:!1}}),y=m("type"),b=async N=>{a(!0);try{const v={type:N.type,parties:{party1:N.party1,party2:N.party2},terms:{duration:N.duration,amount:N.amount,jurisdiction:N.jurisdiction},customRequirements:N.customRequirements,language:N.language,jurisdiction:N.jurisdiction},j=await HV(v);i(j),c(!0),r==null||r(j),te.success("Template generated successfully!")}catch(v){console.error("Template generation failed:",v),te.error("Failed to generate template: "+v.message)}finally{a(!1)}},w=async()=>{if(n)try{const N=m("saveAsPublic");await QV(n,N),te.success("Template saved successfully!")}catch(N){console.error("Failed to save template:",N),te.error("Failed to save template: "+N.message)}},S=N=>({"service agreement":"A contract for providing services between two parties","employment contract":"An agreement between employer and employee","non-disclosure agreement":"A confidentiality agreement to protect sensitive information","consulting agreement":"A contract for consulting services","partnership agreement":"An agreement between business partners","lease agreement":"A rental agreement for property","purchase agreement":"A contract for buying/selling goods or property","terms of service":"Terms and conditions for using a service or platform","privacy policy":"A policy explaining how personal data is collected and used","shareholder agreement":"An agreement between company shareholders"})[N]||"A legal document template";return e.jsxs("div",{className:`space-y-6 ${t}`,children:[e.jsx($,{children:e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(pl,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{children:"AI Template Generator"})]}),e.jsx(ye,{children:"Generate custom legal templates using AI. Fill in the details below to create a professional legal document."})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-lg",children:"Template Details"}),e.jsx(ye,{children:"Provide information about the template you want to generate"})]}),e.jsx(z,{children:e.jsxs("form",{onSubmit:h(b),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"type",children:"Template Type *"}),e.jsxs(it,{onValueChange:N=>f("type",N),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Select template type"})}),e.jsx(at,{children:JV.map(N=>e.jsx(ne,{value:N.value,children:N.label},N.value))})]}),g.type&&e.jsx("p",{className:"text-red-500 text-sm",children:g.type.message}),y&&e.jsx("p",{className:"text-sm text-gray-600",children:S(y)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"party1",children:"First Party"}),e.jsx(Pe,{...d("party1"),placeholder:"e.g., Service Provider, Employer"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"party2",children:"Second Party"}),e.jsx(Pe,{...d("party2"),placeholder:"e.g., Client, Employee"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"duration",children:"Duration/Term"}),e.jsx(Pe,{...d("duration"),placeholder:"e.g., 12 months, 2 years"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"amount",children:"Amount/Value"}),e.jsx(Pe,{...d("amount"),placeholder:"e.g., $5,000, SGD 10,000"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"jurisdiction",children:"Jurisdiction"}),e.jsxs(it,{onValueChange:N=>f("jurisdiction",N),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Select jurisdiction"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"singapore",children:"Singapore"}),e.jsx(ne,{value:"international",children:"International"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"language",children:"Language Style"}),e.jsxs(it,{onValueChange:N=>f("language",N),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Select language style"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"english",children:"Standard Legal"}),e.jsx(ne,{value:"simplified",children:"Plain English"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"customRequirements",children:"Additional Requirements"}),e.jsx(Sr,{...d("customRequirements"),placeholder:"Describe any specific clauses, terms, or requirements you need...",rows:3})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:"saveAsPublic",onCheckedChange:N=>f("saveAsPublic",!!N)}),e.jsx(Te,{htmlFor:"saveAsPublic",className:"text-sm",children:"Make this template public for other users"})]}),e.jsx(R,{type:"submit",disabled:s,className:"w-full",children:s?e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Template..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pl,{className:"mr-2 h-4 w-4"}),"Generate Template"]})})]})})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-lg",children:"Generated Template"}),e.jsx(ye,{children:"Preview and save your AI-generated template"})]}),n&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>c(!o),children:[e.jsx(Gt,{className:"h-4 w-4 mr-2"}),o?"Hide":"Show"," Preview"]}),e.jsxs(R,{size:"sm",onClick:w,children:[e.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})}),e.jsx(z,{children:n?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-600"}),e.jsx("h4",{className:"font-medium text-green-900",children:n.name})]}),e.jsx("p",{className:"text-sm text-green-700 mb-2",children:n.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-green-600",children:[e.jsxs("span",{children:["Category: ",n.category]}),e.jsxs("span",{children:["Variables: ",n.variables.length]}),e.jsxs("span",{children:["Confidence: ",Math.round(n.confidence*100),"%"]})]})]}),n.variables.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Template Variables:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.variables.map((N,v)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:N},v))})]}),o&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Template Content:"}),e.jsx("div",{className:"max-h-64 overflow-y-auto p-3 bg-gray-50 rounded border text-sm",children:e.jsx("pre",{className:"whitespace-pre-wrap font-mono",children:n.content})})]}),n.confidence<.7&&e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:"This template was generated with lower confidence. Please review carefully and consider consulting a legal professional."})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No template generated yet"}),e.jsx("p",{className:"text-gray-500",children:'Fill in the form and click "Generate Template" to create your custom legal document.'})]})})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"text-sm flex items-center space-x-2",children:[e.jsx(Sm,{className:"h-4 w-4"}),e.jsx("span",{children:"Tips for Better Templates"})]})}),e.jsx(z,{children:e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Be specific about the type of agreement you need"}),e.jsx("li",{children:'• Provide clear party descriptions (e.g., "Software Company" vs "Company A")'}),e.jsx("li",{children:"• Include specific terms like duration, amounts, and key obligations"}),e.jsx("li",{children:"• Mention any special requirements or unique clauses needed"}),e.jsx("li",{children:"• Choose the appropriate jurisdiction for your use case"}),e.jsx("li",{children:'• Use "Plain English" style for simpler, more readable templates'})]})})]})]})};class XV{constructor(){rs(this,"config",BM)}async getCategories(){const{data:t,error:s}=await D.from("template_categories").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(s)throw new Error(`Failed to fetch categories: ${s.message}`);return this.transformCategories(t||[])}async searchTemplates(t={}){let s=D.from("templates").select(`
        *,
        category:template_categories(id, name, slug, description, icon)
      `).eq("is_active",!0);switch(t.categoryId&&(s=s.eq("category_id",t.categoryId)),t.subcategory&&(s=s.eq("subcategory",t.subcategory)),t.accessLevel&&(s=s.eq("access_level",t.accessLevel)),t.priceRange&&(s=s.gte("price_sgd",t.priceRange.min).lte("price_sgd",t.priceRange.max)),t.tags&&t.tags.length>0&&(s=s.overlaps("tags",t.tags)),t.legalAreas&&t.legalAreas.length>0&&(s=s.overlaps("legal_areas",t.legalAreas)),t.minRating&&(s=s.gte("rating_average",t.minRating)),t.sortBy){case"popularity":s=s.order("download_count",{ascending:!1});break;case"rating":s=s.order("rating_average",{ascending:!1});break;case"newest":s=s.order("created_at",{ascending:!1});break;case"price_low":s=s.order("price_sgd",{ascending:!0});break;case"price_high":s=s.order("price_sgd",{ascending:!1});break;default:s=s.order("is_featured",{ascending:!1}).order("download_count",{ascending:!1})}const a=t.limit||20,n=t.offset||0;s=s.range(n,n+a-1);const{data:i,error:o,count:c}=await s;if(o)throw new Error(`Failed to search templates: ${o.message}`);const{count:d}=await D.from("templates").select("*",{count:"exact",head:!0}).eq("is_active",!0),h=this.transformTemplates(i||[]),m=d||0,f=n+a<m,g=await this.getFilterAggregations(t);return{templates:h,total:m,hasMore:f,filters:g}}async getTemplate(t){const{data:s,error:a}=await D.from("templates").select(`
        *,
        category:template_categories(id, name, slug, description, icon)
      `).or(`id.eq.${t},slug.eq.${t}`).eq("is_active",!0).single();if(a){if(a.code==="PGRST116")return null;throw new Error(`Failed to fetch template: ${a.message}`)}return this.transformTemplate(s)}async getTemplateBySlug(t){return this.getTemplate(t)}async getFeaturedTemplates(t=6){const{data:s,error:a}=await D.from("templates").select(`
        *,
        category:template_categories(id, name, slug, description, icon)
      `).eq("is_active",!0).eq("is_featured",!0).order("download_count",{ascending:!1}).limit(t);if(a)throw new Error(`Failed to fetch featured templates: ${a.message}`);return this.transformTemplates(s||[])}async getPopularTemplates(t,s,a=10){const{data:n,error:i}=await D.rpc("get_popular_templates",{limit_count:a,category_filter:t||null,access_level_filter:s||null});if(i)throw new Error(`Failed to fetch popular templates: ${i.message}`);return this.transformPopularTemplates(n||[])}async createCustomization(t,s,a,n){const{data:i,error:o}=await D.from("template_customizations").insert({template_id:t,user_id:a,session_id:n,custom_fields:s,status:"draft"}).select().single();if(o)throw new Error(`Failed to create customization: ${o.message}`);return this.transformCustomization(i)}async updateCustomization(t,s){const{data:a,error:n}=await D.from("template_customizations").update({custom_fields:s.customFields,generated_content:s.generatedContent,generated_html:s.generatedHtml,generated_pdf_url:s.generatedPdfUrl,status:s.status,error_message:s.errorMessage,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(n)throw new Error(`Failed to update customization: ${n.message}`);return this.transformCustomization(a)}async getUserCustomizations(t){const{data:s,error:a}=await D.from("template_customizations").select(`
        *,
        template:templates(id, title, slug)
      `).eq("user_id",t).order("created_at",{ascending:!1});if(a)throw new Error(`Failed to fetch customizations: ${a.message}`);return this.transformCustomizations(s||[])}async recordDownload(t,s,a="pdf",n,i){const{error:o}=await D.from("template_downloads").insert({template_id:t,customization_id:s,user_id:n,session_id:i,format:a,ip_address:await this.getClientIP(),user_agent:navigator.userAgent});o&&console.error("Failed to record download:",o)}async rateTemplate(t,s,a,n){const{error:i}=await D.from("template_ratings").upsert({template_id:t,user_id:s,rating:a,review:n,updated_at:new Date().toISOString()});if(i)throw new Error(`Failed to rate template: ${i.message}`)}async getTemplateRatings(t){const{data:s,error:a}=await D.from("template_ratings").select(`
        *,
        user:profiles(id, email, first_name, last_name, avatar_url)
      `).eq("template_id",t).order("created_at",{ascending:!1});if(a)throw new Error(`Failed to fetch template ratings: ${a.message}`);return s||[]}async getUserTemplateRating(t,s){const{data:a,error:n}=await D.from("template_ratings").select("*").eq("template_id",t).eq("user_id",s).single();if(n&&n.code!=="PGRST116")throw new Error(`Failed to fetch user rating: ${n.message}`);return a}async trackEvent(t,s,a={},n,i){const{error:o}=await D.from("template_analytics").insert({template_id:t,event_type:s,event_data:a,user_id:n,session_id:i,ip_address:await this.getClientIP(),user_agent:navigator.userAgent});o&&console.error("Failed to track analytics event:",o)}transformCategories(t){return t.map(s=>({id:s.id,name:s.name,slug:s.slug,description:s.description,icon:s.icon,parentId:s.parent_id,sortOrder:s.sort_order,isActive:s.is_active}))}transformTemplates(t){return t.map(s=>this.transformTemplate(s))}transformTemplate(t){return{id:t.id,title:t.title,slug:t.slug,description:t.description,categoryId:t.category_id,subcategory:t.subcategory,content:t.content,fields:t.fields,previewHtml:t.preview_html,previewPdfUrl:t.preview_pdf_url,accessLevel:t.access_level,priceSgd:parseFloat(t.price_sgd||"0"),jurisdiction:t.jurisdiction,legalAreas:t.legal_areas||[],complianceTags:t.compliance_tags||[],downloadCount:t.download_count,ratingAverage:parseFloat(t.rating_average||"0"),ratingCount:t.rating_count,createdBy:t.created_by,isActive:t.is_active,isFeatured:t.is_featured,tags:t.tags||[],language:t.language,version:t.version,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at),category:t.category?{id:t.category.id,name:t.category.name,slug:t.category.slug,description:t.category.description,icon:t.category.icon,sortOrder:0,isActive:!0}:void 0}}transformPopularTemplates(t){return t.map(s=>({id:s.template_id,title:s.title,slug:"",description:s.description,categoryId:"",content:{},fields:[],accessLevel:"public",priceSgd:0,jurisdiction:"Singapore",legalAreas:[],complianceTags:[],downloadCount:s.download_count,ratingAverage:parseFloat(s.rating_average||"0"),ratingCount:s.rating_count,isActive:!0,isFeatured:!1,tags:[],language:"en",version:1,createdAt:new Date,updatedAt:new Date,category:{id:"",name:s.category_name,slug:"",sortOrder:0,isActive:!0}}))}transformCustomization(t){return{id:t.id,templateId:t.template_id,userId:t.user_id,sessionId:t.session_id,customFields:t.custom_fields,generatedContent:t.generated_content,generatedHtml:t.generated_html,generatedPdfUrl:t.generated_pdf_url,status:t.status,errorMessage:t.error_message,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}}transformCustomizations(t){return t.map(s=>this.transformCustomization(s))}async getFilterAggregations(t){return{categories:[],priceRanges:[],tags:[]}}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"127.0.0.1"}}}const bs=new XV,e7=({template:r,className:t=""})=>{const{user:s}=ft(),[a,n]=p.useState([]),[i,o]=p.useState(!0),[c,d]=p.useState(!1),[h,m]=p.useState(!1),[f,g]=p.useState(null),[y,b]=p.useState(0),[w,S]=p.useState(0),[N,v]=p.useState("");p.useEffect(()=>{j()},[r.id]);const j=async()=>{try{o(!0);const L=(await bs.getTemplateRatings(r.id)).map(M=>({id:M.id,templateId:M.template_id,userId:M.user_id,rating:M.rating,review:M.review,isVerified:M.is_verified,createdAt:new Date(M.created_at),updatedAt:new Date(M.updated_at),user:M.user?{id:M.user.id,email:M.user.email,firstName:M.user.first_name,lastName:M.user.last_name,avatar:M.user.avatar_url}:void 0}));if(n(L),s)try{const M=await bs.getUserTemplateRating(r.id,s.id);if(M){const se={id:M.id,templateId:M.template_id,userId:M.user_id,rating:M.rating,review:M.review,isVerified:M.is_verified,createdAt:new Date(M.created_at),updatedAt:new Date(M.updated_at)};g(se),b(se.rating),v(se.review||"")}}catch{console.log("User has not rated this template yet")}}catch(A){console.error("Error loading ratings:",A),te.error("Failed to load ratings")}finally{o(!1)}},C=async()=>{if(!s){te.error("Please log in to rate this template");return}if(y===0){te.error("Please select a rating");return}try{d(!0),await bs.rateTemplate(r.id,s.id,y,N.trim()||void 0),te.success("Rating submitted successfully!"),m(!1),j(),await bs.trackEvent(r.id,"template_rated",{rating:y,has_review:!!N.trim()})}catch(A){console.error("Error submitting rating:",A),te.error("Failed to submit rating: "+A.message)}finally{d(!1)}},k=(A,L=!1,M="h-4 w-4")=>Array.from({length:5},(se,W)=>{const q=W+1,K=q<=(L?w||y:A);return e.jsx("button",{type:"button",disabled:!L,className:`${L?"cursor-pointer":"cursor-default"} transition-colors ${K?"text-yellow-400":"text-gray-300"} ${L?"hover:text-yellow-300":""}`,onMouseEnter:()=>L&&S(q),onMouseLeave:()=>L&&S(0),onClick:()=>L&&b(q),children:e.jsx(Ot,{className:`${M} ${K?"fill-current":""}`})},W)}),I=()=>{const A={5:0,4:0,3:0,2:0,1:0};return a.forEach(L=>{A[L.rating]++}),A},T=(A,L,M)=>A&&L?`${A[0]}${L[0]}`.toUpperCase():M?M.substring(0,2).toUpperCase():"U",O=I(),U=a.length;return e.jsxs("div",{className:`space-y-6 ${t}`,children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ot,{className:"h-5 w-5 text-yellow-400"}),"Ratings & Reviews"]}),s&&!f&&e.jsxs(cc,{open:h,onOpenChange:m,children:[e.jsx(Bd,{asChild:!0,children:e.jsxs(R,{size:"sm",children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Write Review"]})}),e.jsxs(Mo,{className:"sm:max-w-md",children:[e.jsxs(Lo,{children:[e.jsx(Uo,{children:"Rate this Template"}),e.jsx($o,{children:"Share your experience with this template to help other users"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rating"}),e.jsx("div",{className:"flex items-center gap-1",children:k(y,!0,"h-8 w-8")}),y>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[y===1&&"Poor",y===2&&"Fair",y===3&&"Good",y===4&&"Very Good",y===5&&"Excellent"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Review (Optional)"}),e.jsx(Sr,{placeholder:"Share your thoughts about this template...",value:N,onChange:A=>v(A.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[N.length,"/500 characters"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{onClick:C,disabled:c||y===0,className:"flex-1",children:c?"Submitting...":"Submit Rating"}),e.jsx(R,{variant:"outline",onClick:()=>m(!1),className:"flex-1",children:"Cancel"})]})]})]})]})]})}),e.jsxs(z,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:r.ratingAverage.toFixed(1)}),e.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:k(r.ratingAverage)}),e.jsxs("p",{className:"text-gray-600",children:["Based on ",r.ratingCount," review",r.ratingCount!==1?"s":""]})]}),e.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(A=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"w-8",children:A}),e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-400 h-2 rounded-full",style:{width:U>0?`${O[A]/U*100}%`:"0%"}})}),e.jsx("span",{className:"w-8 text-gray-600",children:O[A]})]},A))})]}),f&&e.jsxs(vt,{className:"mt-4",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsxs(wt,{children:["You rated this template ",f.rating," star",f.rating!==1?"s":"",".",f.review&&" Thank you for your review!"]})]})]})]}),a.length>0&&e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Reviews"})}),e.jsx(z,{children:e.jsx("div",{className:"space-y-6",children:a.map((A,L)=>{var M,se,W,q,K,Y,le,Ne;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(zr,{className:"h-10 w-10",children:[e.jsx($n,{src:(M=A.user)==null?void 0:M.avatar}),e.jsx(Br,{children:T((se=A.user)==null?void 0:se.firstName,(W=A.user)==null?void 0:W.lastName,(q=A.user)==null?void 0:q.email)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium",children:(K=A.user)!=null&&K.firstName&&((Y=A.user)!=null&&Y.lastName)?`${A.user.firstName} ${A.user.lastName}`:((Ne=(le=A.user)==null?void 0:le.email)==null?void 0:Ne.split("@")[0])||"Anonymous"}),A.isVerified&&e.jsxs(ae,{variant:"secondary",className:"text-xs",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Verified"]}),e.jsx("span",{className:"text-sm text-gray-500",children:Vt(A.createdAt,{addSuffix:!0})})]}),e.jsx("div",{className:"flex items-center gap-1 mb-2",children:k(A.rating)}),A.review&&e.jsx("p",{className:"text-gray-700 leading-relaxed",children:A.review})]})]}),L<a.length-1&&e.jsx(Ts,{className:"mt-6"})]},A.id)})})})]}),!i&&a.length===0&&e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Ft,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No reviews yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Be the first to review this template and help other users!"}),s&&e.jsx(R,{onClick:()=>m(!0),children:"Write the First Review"})]})})]})};class t7{async checkTemplateAccess(t,s,a){if(s==="public")return{hasAccess:!0};if(!t)return{hasAccess:!1,reason:"Authentication required for premium templates",upgradeRequired:"premium"};try{const n=await this.getUserSubscription(t);if(!n)return{hasAccess:!1,reason:"No active subscription found",upgradeRequired:s==="enterprise"?"enterprise":"premium"};if(n.status!=="active")return{hasAccess:!1,reason:"Subscription is not active",upgradeRequired:s==="enterprise"?"enterprise":"premium"};if(!this.checkTierAccess(n.tier,s))return{hasAccess:!1,reason:`${s} template requires ${s==="enterprise"?"Enterprise":"Premium"} subscription`,upgradeRequired:s==="enterprise"?"enterprise":"premium"};const o=await this.checkUsageLimits(t,n.tier);return o.hasAccess?{hasAccess:!0,remainingUsage:o.remainingUsage,resetDate:o.resetDate}:o}catch(n){return console.error("Error checking template access:",n),{hasAccess:!1,reason:"Error checking access permissions"}}}async checkCustomizationAccess(t,s){return this.checkTemplateAccess(t,s)}async checkDownloadAccess(t,s,a){const n=await this.checkTemplateAccess(t,s);if(!n.hasAccess)return n;if(!t&&a!=="pdf")return{hasAccess:!1,reason:"Account required for DOCX and HTML downloads",upgradeRequired:"premium"};if(!t)return{hasAccess:!0};try{const i=await this.getUserSubscription(t);if(!i)return a==="pdf"?{hasAccess:!0}:{hasAccess:!1,reason:"Premium subscription required for DOCX and HTML downloads",upgradeRequired:"premium"};const o=Pn[i.tier];return i.tier==="free"&&a!=="pdf"?{hasAccess:!1,reason:"Premium subscription required for DOCX and HTML downloads",upgradeRequired:"premium"}:{hasAccess:!0}}catch(i){return console.error("Error checking download access:",i),{hasAccess:!1,reason:"Error checking download permissions"}}}async getUserSubscription(t){const{data:s,error:a}=await D.from("user_subscriptions").select("*").eq("user_id",t).eq("status","active").single();if(a&&a.code!=="PGRST116")throw new Error(`Failed to fetch subscription: ${a.message}`);return s?{id:s.id,userId:s.user_id,tier:s.tier,status:s.status,currentPeriodStart:new Date(s.current_period_start),currentPeriodEnd:new Date(s.current_period_end),cancelAtPeriodEnd:s.cancel_at_period_end}:null}async getUserUsageStats(t){const{data:s,error:a}=await D.from("user_usage").select("*").eq("user_id",t).single();if(a&&a.code!=="PGRST116")throw new Error(`Failed to fetch usage stats: ${a.message}`);return s?{templatesUsedThisMonth:s.templates_used_this_month||0,templatesUsedToday:s.templates_used_today||0,customizationsThisMonth:s.customizations_this_month||0,downloadsThisMonth:s.downloads_this_month||0,lastResetDate:new Date(s.last_reset_date)}:{templatesUsedThisMonth:0,templatesUsedToday:0,customizationsThisMonth:0,downloadsThisMonth:0,lastResetDate:new Date}}async recordTemplateUsage(t,s){try{const{error:a}=await D.rpc("increment_template_usage",{p_user_id:t,p_action:s});a&&console.error("Error recording template usage:",a)}catch(a){console.error("Error recording template usage:",a)}}checkTierAccess(t,s){const a={free:0,premium:1,pro:2,enterprise:3},n={public:0,premium:1,enterprise:3};return a[t]>=n[s]}async checkUsageLimits(t,s){try{const a=await this.getUserUsageStats(t),n=Pn[s].limits;if(n.monthlyDocumentUploads!==-1&&a.templatesUsedThisMonth>=n.monthlyDocumentUploads)return{hasAccess:!1,reason:`Monthly template limit reached (${n.monthlyDocumentUploads})`,upgradeRequired:s==="free"?"premium":s==="premium"?"pro":"enterprise",remainingUsage:0,resetDate:this.getNextResetDate(a.lastResetDate)};if(n.dailyDocumentUploads!==-1&&a.templatesUsedToday>=n.dailyDocumentUploads)return{hasAccess:!1,reason:`Daily template limit reached (${n.dailyDocumentUploads})`,remainingUsage:0,resetDate:this.getTomorrowDate()};const i=n.monthlyDocumentUploads===-1?-1:n.monthlyDocumentUploads-a.templatesUsedThisMonth,o=n.dailyDocumentUploads===-1?-1:n.dailyDocumentUploads-a.templatesUsedToday;return{hasAccess:!0,remainingUsage:i===-1?o:Math.min(i,o),resetDate:this.getNextResetDate(a.lastResetDate)}}catch(a){return console.error("Error checking usage limits:",a),{hasAccess:!0}}}getNextResetDate(t){const s=new Date(t);return s.setMonth(s.getMonth()+1),s}getTomorrowDate(){const t=new Date;return t.setDate(t.getDate()+1),t.setHours(0,0,0,0),t}}const Mc=new t7;function s7(r,t){const{user:s}=ft(),[a,n]=p.useState(null),[i,o]=p.useState(null),[c,d]=p.useState(null),[h,m]=p.useState(!0),[f,g]=p.useState(null),y=async()=>{try{m(!0),g(null);const C=await Mc.checkTemplateAccess((s==null?void 0:s.id)||null,r,t);if(n(C),s)try{const[k,I]=await Promise.all([Mc.getUserSubscription(s.id),Mc.getUserUsageStats(s.id)]);o(k),d(I)}catch(k){console.error("Error loading user data:",k)}}catch(C){console.error("Error checking template access:",C),g(C instanceof Error?C.message:"Failed to check access"),n({hasAccess:!1,reason:"Error checking access"})}finally{m(!1)}},b=async C=>{if(s)try{await Mc.recordTemplateUsage(s.id,C);const k=await Mc.getUserUsageStats(s.id);d(k)}catch(k){console.error("Error recording usage:",k)}};p.useEffect(()=>{y()},[s==null?void 0:s.id,r,t]);const w=(a==null?void 0:a.hasAccess)??!1,S=w,N=w,v=w&&(!s||(i==null?void 0:i.tier)==="premium"||(i==null?void 0:i.tier)==="pro"||(i==null?void 0:i.tier)==="enterprise");return{canViewTemplate:w,canCustomizeTemplate:S,canDownloadPDF:N,canDownloadDOCX:v,canDownloadHTML:v,accessResult:a,subscription:i,usageStats:c,loading:h,error:f,checkAccess:y,recordUsage:b}}const r7=({children:r,templateAccessLevel:t,templateId:s,className:a=""})=>{const{user:n}=ft(),i=s7(t,s);return i.loading?e.jsx("div",{className:`flex items-center justify-center p-8 ${a}`,children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.canViewTemplate?e.jsxs("div",{className:a,children:[r,i.usageStats&&i.subscription&&e.jsx(o7,{accessData:i})]}):e.jsxs("div",{className:`space-y-6 ${a}`,children:[e.jsx(a7,{accessData:i,templateAccessLevel:t}),n&&e.jsx(n7,{accessData:i}),!n&&e.jsx(i7,{})]})},a7=({accessData:r,templateAccessLevel:t})=>{var n;const s=()=>{switch(t){case"premium":return e.jsx(jo,{className:"h-8 w-8 text-yellow-500"});case"enterprise":return e.jsx(Ot,{className:"h-8 w-8 text-purple-500"});default:return e.jsx(Gg,{className:"h-8 w-8 text-gray-500"})}},a=()=>{switch(t){case"premium":return e.jsx(ae,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Premium"});case"enterprise":return e.jsx(ae,{variant:"secondary",className:"bg-purple-100 text-purple-800",children:"Enterprise"});default:return e.jsx(ae,{variant:"secondary",children:"Public"})}};return e.jsxs($,{className:"border-2 border-dashed border-gray-300",children:[e.jsxs(Z,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:s()}),e.jsxs(X,{className:"flex items-center justify-center gap-2",children:["Access Restricted",a()]}),e.jsx(ye,{children:((n=r.accessResult)==null?void 0:n.reason)||"You need a subscription to access this template"})]}),e.jsx(z,{className:"text-center",children:e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs(wt,{children:["This template requires a ",t==="enterprise"?"Enterprise":"Premium"," subscription to access."]})]})})]})},n7=({accessData:r})=>{var n;const t=(n=r.accessResult)==null?void 0:n.upgradeRequired;if(!t)return null;const a=(i=>{switch(i){case"premium":return["Access to Premium templates","DOCX and HTML downloads","Advanced customization options","Priority support"];case"pro":return["Everything in Premium","Unlimited template usage","Advanced AI features","Team collaboration tools"];case"enterprise":return["Everything in Pro","Enterprise templates","Custom branding","Dedicated account manager","SLA guarantee"];default:return[]}})(t);return e.jsxs($,{className:"border-blue-200 bg-blue-50",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Nr,{className:"h-5 w-5 text-blue-600"}),"Upgrade to ",t.charAt(0).toUpperCase()+t.slice(1)]}),e.jsx(ye,{children:"Unlock this template and many more features"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsx("div",{className:"grid gap-2",children:a.map((i,o)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:i})]},o))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{asChild:!0,className:"flex-1",children:e.jsxs(gs,{to:Ye.pricing,children:[e.jsx(jo,{className:"h-4 w-4 mr-2"}),"Upgrade Now"]})}),e.jsx(R,{variant:"outline",asChild:!0,children:e.jsxs(gs,{to:Ye.pricing,children:["View Plans",e.jsx(Mn,{className:"h-4 w-4 ml-2"})]})})]})]})]})},i7=()=>e.jsxs($,{className:"border-green-200 bg-green-50",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5 text-green-600"}),"Sign In Required"]}),e.jsx(ye,{children:"Create a free account to access this template"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Free account creation"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Access to public templates"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Save your customizations"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{asChild:!0,className:"flex-1",children:e.jsx(gs,{to:Ye.register,children:"Create Account"})}),e.jsx(R,{variant:"outline",asChild:!0,children:e.jsxs(gs,{to:Ye.login,children:["Sign In",e.jsx(Mn,{className:"h-4 w-4 ml-2"})]})})]})]})]}),o7=({accessData:r})=>{const{subscription:t,usageStats:s,accessResult:a}=r;if(!t||!s||!(a!=null&&a.remainingUsage)||a.remainingUsage===-1)return null;const n=t.tier==="free"?Math.min(s.templatesUsedThisMonth/5*100,100):Math.min(s.templatesUsedThisMonth/50*100,100),i=n>80;return e.jsxs($,{className:`mt-4 ${i?"border-orange-200 bg-orange-50":"border-gray-200"}`,children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Template Usage",e.jsx(ae,{variant:i?"destructive":"secondary",className:"ml-auto",children:t.tier.charAt(0).toUpperCase()+t.tier.slice(1)})]})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"This month"}),e.jsxs("span",{children:[s.templatesUsedThisMonth," used"]})]}),e.jsx(na,{value:n,className:"h-2"}),a.remainingUsage>0&&e.jsxs("p",{className:"text-xs text-gray-600",children:[a.remainingUsage," templates remaining"]})]}),a.resetDate&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx(ln,{className:"h-3 w-3"}),"Resets on ",a.resetDate.toLocaleDateString()]}),i&&e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{className:"text-xs",children:"You're approaching your monthly limit. Consider upgrading for unlimited access."})]})]})]})};class l7{async getTemplateVersions(t){const{data:s,error:a}=await D.from("template_versions").select(`
        *,
        created_by_user:profiles!template_versions_created_by_fkey(id, email, first_name, last_name),
        approved_by_user:profiles!template_versions_approved_by_fkey(id, email, first_name, last_name)
      `).eq("template_id",t).order("major_version",{ascending:!1}).order("minor_version",{ascending:!1}).order("patch_version",{ascending:!1});if(a)throw new Error(`Failed to fetch template versions: ${a.message}`);return s.map(this.transformVersionData)}async getTemplateVersion(t){const{data:s,error:a}=await D.from("template_versions").select(`
        *,
        created_by_user:profiles!template_versions_created_by_fkey(id, email, first_name, last_name),
        approved_by_user:profiles!template_versions_approved_by_fkey(id, email, first_name, last_name)
      `).eq("id",t).single();if(a&&a.code!=="PGRST116")throw new Error(`Failed to fetch template version: ${a.message}`);return s?this.transformVersionData(s):null}async getCurrentVersion(t){const{data:s,error:a}=await D.from("template_versions").select(`
        *,
        created_by_user:profiles!template_versions_created_by_fkey(id, email, first_name, last_name),
        approved_by_user:profiles!template_versions_approved_by_fkey(id, email, first_name, last_name)
      `).eq("template_id",t).eq("is_current",!0).single();if(a&&a.code!=="PGRST116")throw new Error(`Failed to fetch current version: ${a.message}`);return s?this.transformVersionData(s):null}async createVersion(t,s){const{data:a,error:n}=await D.rpc("create_template_version",{p_template_id:t.templateId,p_title:t.title,p_description:t.description||null,p_content:t.content,p_fields:JSON.stringify(t.fields),p_change_summary:t.changeSummary,p_change_details:JSON.stringify(t.changeDetails||{}),p_breaking_changes:t.breakingChanges||!1,p_user_id:s,p_version_type:t.versionType||"minor"});if(n)throw new Error(`Failed to create template version: ${n.message}`);return a}async publishVersion(t,s){const{data:a,error:n}=await D.rpc("publish_template_version",{p_version_id:t,p_user_id:s});if(n)throw new Error(`Failed to publish template version: ${n.message}`);return a}async rollbackToVersion(t,s,a,n){const{data:i,error:o}=await D.rpc("rollback_template_version",{p_template_id:t,p_target_version_id:s,p_user_id:a,p_reason:n||"No reason provided"});if(o)throw new Error(`Failed to rollback template version: ${o.message}`);return i}async getChangeLog(t,s=50){const{data:a,error:n}=await D.from("template_change_log").select(`
        *,
        user:profiles!template_change_log_user_id_fkey(id, email, first_name, last_name),
        version:template_versions!template_change_log_version_id_fkey(version_number)
      `).eq("template_id",t).order("created_at",{ascending:!1}).limit(s);if(n)throw new Error(`Failed to fetch change log: ${n.message}`);return a.map(i=>({id:i.id,templateId:i.template_id,versionId:i.version_id,changeType:i.change_type,fieldChanged:i.field_changed,oldValue:i.old_value,newValue:i.new_value,changeReason:i.change_reason,userId:i.user_id,createdAt:new Date(i.created_at),user:i.user?{id:i.user.id,email:i.user.email,firstName:i.user.first_name,lastName:i.user.last_name}:void 0}))}async compareVersions(t,s){const[a,n]=await Promise.all([this.getTemplateVersion(t),this.getTemplateVersion(s)]);if(!a||!n)throw new Error("One or both versions not found");const i=this.calculateDifferences(a,n);return{version1:a,version2:n,differences:i}}async getVersionComments(t){const{data:s,error:a}=await D.from("template_version_comments").select(`
        *,
        user:profiles!template_version_comments_user_id_fkey(id, email, first_name, last_name),
        resolved_by_user:profiles!template_version_comments_resolved_by_fkey(id, email, first_name, last_name)
      `).eq("version_id",t).order("created_at",{ascending:!0});if(a)throw new Error(`Failed to fetch version comments: ${a.message}`);return s.map(n=>({id:n.id,versionId:n.version_id,userId:n.user_id,commentText:n.comment_text,commentType:n.comment_type,lineNumber:n.line_number,fieldName:n.field_name,isResolved:n.is_resolved,resolvedBy:n.resolved_by,resolvedAt:n.resolved_at?new Date(n.resolved_at):void 0,createdAt:new Date(n.created_at),updatedAt:new Date(n.updated_at),user:n.user?{id:n.user.id,email:n.user.email,firstName:n.user.first_name,lastName:n.user.last_name}:void 0}))}async addVersionComment(t,s,a,n="general",i,o){const{data:c,error:d}=await D.from("template_version_comments").insert({version_id:t,user_id:s,comment_text:a,comment_type:n,line_number:i,field_name:o}).select("id").single();if(d)throw new Error(`Failed to add comment: ${d.message}`);return c.id}async resolveComment(t,s){const{error:a}=await D.from("template_version_comments").update({is_resolved:!0,resolved_by:s,resolved_at:new Date().toISOString()}).eq("id",t);if(a)throw new Error(`Failed to resolve comment: ${a.message}`)}transformVersionData(t){return{id:t.id,templateId:t.template_id,versionNumber:t.version_number,majorVersion:t.major_version,minorVersion:t.minor_version,patchVersion:t.patch_version,isCurrent:t.is_current,isPublished:t.is_published,status:t.status,title:t.title,description:t.description,content:t.content,fields:t.fields||[],metadata:t.metadata||{},changeSummary:t.change_summary,changeDetails:t.change_details||{},breakingChanges:t.breaking_changes,migrationNotes:t.migration_notes,createdBy:t.created_by,approvedBy:t.approved_by,approvedAt:t.approved_at?new Date(t.approved_at):void 0,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at),publishedAt:t.published_at?new Date(t.published_at):void 0}}calculateDifferences(t,s){const a=[];["title","description","content"].forEach(c=>{const d=t[c],h=s[c];d!==h&&a.push({field:c,type:"modified",oldValue:d,newValue:h})});const i=t.fields||[],o=s.fields||[];return JSON.stringify(i)!==JSON.stringify(o)&&a.push({field:"fields",type:"modified",oldValue:i,newValue:o}),a}}const jl=new l7,nE=({templateId:r,currentVersionId:t,onVersionSelect:s,className:a=""})=>{const{user:n}=ft(),[i,o]=p.useState([]),[c,d]=p.useState([]),[h,m]=p.useState(!0),[f,g]=p.useState(null),[y,b]=p.useState(!1),[w,S]=p.useState(""),[N,v]=p.useState(!1);p.useEffect(()=>{j()},[r]);const j=async()=>{try{m(!0);const[O,U]=await Promise.all([jl.getTemplateVersions(r),jl.getChangeLog(r)]);o(O),d(U)}catch(O){console.error("Error loading version history:",O),te.error("Failed to load version history")}finally{m(!1)}},C=async O=>{if(!n){te.error("Please log in to rollback versions");return}try{v(!0),await jl.rollbackToVersion(r,O.id,n.id,w),te.success(`Successfully rolled back to version ${O.versionNumber}`),b(!1),S(""),j()}catch(U){console.error("Error rolling back version:",U),te.error("Failed to rollback version: "+U.message)}finally{v(!1)}},k=O=>{const A={draft:{variant:"secondary",label:"Draft",icon:Fe},review:{variant:"outline",label:"In Review",icon:Gt},published:{variant:"default",label:"Published",icon:Ue},archived:{variant:"secondary",label:"Archived",icon:rd},deprecated:{variant:"destructive",label:"Deprecated",icon:It}}[O.status],L=A.icon;return e.jsxs(ae,{variant:A.variant,className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-3 w-3"}),A.label]})},I=O=>O.breakingChanges?e.jsx(Nr,{className:"h-4 w-4 text-red-500",title:"Breaking Changes"}):O.majorVersion>1?e.jsx(uN,{className:"h-4 w-4 text-blue-500",title:"Major Version"}):e.jsx(Ih,{className:"h-4 w-4 text-green-500",title:"Minor/Patch Version"}),T=O=>({created:e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),updated:e.jsx(Fe,{className:"h-4 w-4 text-blue-500"}),published:e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),archived:e.jsx(rd,{className:"h-4 w-4 text-gray-500"}),restored:e.jsx(Hw,{className:"h-4 w-4 text-orange-500"}),deleted:e.jsx(It,{className:"h-4 w-4 text-red-500"})})[O]||e.jsx(Fe,{className:"h-4 w-4"});return h?e.jsx("div",{className:`space-y-4 ${a}`,children:[...Array(3)].map((O,U)=>e.jsx($,{className:"animate-pulse",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})]}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"})]})})},U))}):e.jsxs("div",{className:`space-y-6 ${a}`,children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(rd,{className:"h-5 w-5"}),"Version History"]}),e.jsx(ye,{children:"Track changes and manage different versions of this template"})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:i.map((O,U)=>e.jsxs("div",{className:"relative",children:[U<i.length-1&&e.jsx("div",{className:"absolute left-6 top-12 bottom-0 w-px bg-gray-200"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:I(O)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["v",O.versionNumber]}),O.isCurrent&&e.jsx(ae,{variant:"outline",className:"text-xs",children:"Current"}),k(O)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>{g(O),s==null||s(O)},children:[e.jsx(Gt,{className:"h-4 w-4 mr-1"}),"View"]}),!O.isCurrent&&O.isPublished&&n&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>{g(O),b(!0)},children:[e.jsx(Hw,{className:"h-4 w-4 mr-1"}),"Rollback"]})]})]}),O.changeSummary&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:O.changeSummary}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ln,{className:"h-3 w-3"}),Vt(O.createdAt,{addSuffix:!0})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(cn,{className:"h-3 w-3"}),O.createdBy]}),O.breakingChanges&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(It,{className:"h-3 w-3"}),"Breaking Changes"]})]})]})]})]},O.id))})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-5 w-5"}),"Change Log"]}),e.jsx(ye,{children:"Detailed history of all changes made to this template"})]}),e.jsx(z,{children:e.jsx(Po,{className:"h-64",children:e.jsx("div",{className:"space-y-3",children:c.map((O,U)=>{var A,L,M;return e.jsxs("div",{className:"relative",children:[U<c.length-1&&e.jsx("div",{className:"absolute left-6 top-8 bottom-0 w-px bg-gray-200"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:T(O.changeType)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium capitalize",children:O.changeType}),e.jsx("span",{className:"text-xs text-gray-500",children:Vt(O.createdAt,{addSuffix:!0})})]}),O.changeReason&&e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:O.changeReason}),e.jsxs("div",{className:"text-xs text-gray-500",children:["by ",(A=O.user)!=null&&A.firstName&&((L=O.user)!=null&&L.lastName)?`${O.user.firstName} ${O.user.lastName}`:((M=O.user)==null?void 0:M.email)||"Unknown"]})]})]})]},O.id)})})})})]}),e.jsx(cc,{open:y,onOpenChange:b,children:e.jsxs(Mo,{children:[e.jsxs(Lo,{children:[e.jsxs(Uo,{children:["Rollback to Version ",f==null?void 0:f.versionNumber]}),e.jsx($o,{children:"This will create a new version based on the selected version. The current version will remain in history."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:"Rolling back will create a new version. This action cannot be undone."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason for rollback (optional)"}),e.jsx("textarea",{className:"w-full p-2 border rounded-md",rows:3,value:w,onChange:O=>S(O.target.value),placeholder:"Explain why you're rolling back to this version..."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{onClick:()=>f&&C(f),disabled:N,className:"flex-1",children:N?"Rolling back...":"Confirm Rollback"}),e.jsx(R,{variant:"outline",onClick:()=>b(!1),className:"flex-1",children:"Cancel"})]})]})]})})]})},c7=({templateId:r,currentTitle:t,currentDescription:s,currentContent:a,currentFields:n,onVersionCreated:i,className:o=""})=>{const{user:c}=ft(),[d,h]=p.useState(!1),[m,f]=p.useState(!1),[g,y]=p.useState({title:t,description:s||"",content:a,fields:n,changeSummary:"",changeDetails:"",breakingChanges:!1,versionType:"minor"}),b=async S=>{if(S.preventDefault(),!c){te.error("Please log in to create a new version");return}if(!g.changeSummary.trim()){te.error("Please provide a change summary");return}try{f(!0);const N={templateId:r,title:g.title,description:g.description||void 0,content:g.content,fields:g.fields,changeSummary:g.changeSummary,changeDetails:g.changeDetails?{notes:g.changeDetails}:void 0,breakingChanges:g.breakingChanges,versionType:g.versionType},v=await jl.createVersion(N,c.id);te.success("New template version created successfully!"),h(!1),i==null||i(v),y({title:t,description:s||"",content:a,fields:n,changeSummary:"",changeDetails:"",breakingChanges:!1,versionType:"minor"})}catch(N){console.error("Error creating version:",N),te.error("Failed to create version: "+N.message)}finally{f(!1)}},w=S=>({major:{icon:e.jsx(uN,{className:"h-4 w-4 text-red-500"}),label:"Major Version",description:"Breaking changes, new features, or significant updates",example:"1.0.0 → 2.0.0"},minor:{icon:e.jsx(Ih,{className:"h-4 w-4 text-blue-500"}),label:"Minor Version",description:"New features or improvements without breaking changes",example:"1.0.0 → 1.1.0"},patch:{icon:e.jsx(Fe,{className:"h-4 w-4 text-green-500"}),label:"Patch Version",description:"Bug fixes, small improvements, or corrections",example:"1.0.0 → 1.0.1"}})[S];return e.jsx("div",{className:o,children:e.jsxs(cc,{open:d,onOpenChange:h,children:[e.jsx(Bd,{asChild:!0,children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(da,{className:"h-4 w-4"}),"Create New Version"]})}),e.jsxs(Mo,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Lo,{children:[e.jsxs(Uo,{className:"flex items-center gap-2",children:[e.jsx(Ih,{className:"h-5 w-5"}),"Create New Template Version"]}),e.jsx($o,{children:"Create a new version of this template with your changes and improvements."})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(Te,{className:"text-base font-medium",children:"Version Type"}),e.jsxs(it,{value:g.versionType,onValueChange:S=>y(N=>({...N,versionType:S})),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Select version type"})}),e.jsx(at,{children:["major","minor","patch"].map(S=>{const N=w(S);return e.jsx(ne,{value:S,children:e.jsxs("div",{className:"flex items-center gap-2",children:[N.icon,e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:N.label}),e.jsx("div",{className:"text-xs text-gray-500",children:N.example})]})]})},S)})})]}),g.versionType&&e.jsxs(vt,{children:[e.jsx(Hg,{className:"h-4 w-4"}),e.jsx(wt,{children:w(g.versionType).description})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"changeSummary",className:"text-base font-medium",children:"Change Summary *"}),e.jsx(Pe,{id:"changeSummary",value:g.changeSummary,onChange:S=>y(N=>({...N,changeSummary:S.target.value})),placeholder:"Brief description of what changed in this version",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{htmlFor:"changeDetails",className:"text-base font-medium",children:"Detailed Changes (Optional)"}),e.jsx(Sr,{id:"changeDetails",value:g.changeDetails,onChange:S=>y(N=>({...N,changeDetails:S.target.value})),placeholder:"Detailed description of changes, new features, bug fixes, etc.",rows:4})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:"breakingChanges",checked:g.breakingChanges,onCheckedChange:S=>y(N=>({...N,breakingChanges:S}))}),e.jsxs(Te,{htmlFor:"breakingChanges",className:"flex items-center gap-2",children:[e.jsx(Nr,{className:"h-4 w-4 text-red-500"}),"This version contains breaking changes"]})]}),g.breakingChanges&&e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:"Breaking changes may affect existing customizations or integrations. Make sure to document migration steps in the detailed changes."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{className:"text-base font-medium",children:"Template Content"}),e.jsxs($,{children:[e.jsxs(Z,{className:"pb-3",children:[e.jsx(X,{className:"text-sm",children:g.title}),g.description&&e.jsx(ye,{className:"text-xs",children:g.description})]}),e.jsxs(z,{className:"pt-0",children:[e.jsxs("div",{className:"text-xs text-gray-600 bg-gray-50 p-3 rounded border max-h-32 overflow-y-auto",children:[g.content.substring(0,200),g.content.length>200&&"..."]}),g.fields.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-700 mb-1",children:["Fields: ",g.fields.length]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.fields.slice(0,5).map((S,N)=>e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:S.label||S.name||`Field ${N+1}`},N)),g.fields.length>5&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",g.fields.length-5," more"]})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(R,{type:"submit",disabled:m||!g.changeSummary.trim(),className:"flex-1",children:[e.jsx(Ci,{className:"h-4 w-4 mr-2"}),m?"Creating Version...":"Create Version"]}),e.jsx(R,{type:"button",variant:"outline",onClick:()=>h(!1),className:"flex-1",children:"Cancel"})]})]})]})]})})},d7=({templateId:r,version1Id:t,version2Id:s,onVersionSelect:a,className:n=""})=>{const[i,o]=p.useState([]),[c,d]=p.useState(t||""),[h,m]=p.useState(s||""),[f,g]=p.useState(null),[y,b]=p.useState(!1);p.useEffect(()=>{w()},[r]),p.useEffect(()=>{c&&h&&c!==h&&S()},[c,h]);const w=async()=>{try{const k=await jl.getTemplateVersions(r);o(k),!t&&!s&&k.length>=2&&(d(k[0].id),m(k[1].id))}catch(k){console.error("Error loading versions:",k),te.error("Failed to load versions")}},S=async()=>{try{b(!0);const k=await jl.compareVersions(c,h);g(k)}catch(k){console.error("Error comparing versions:",k),te.error("Failed to compare versions")}finally{b(!1)}},N=k=>{switch(k){case"added":return e.jsx(da,{className:"h-4 w-4 text-green-500"});case"removed":return e.jsx(cN,{className:"h-4 w-4 text-red-500"});case"modified":return e.jsx(Yg,{className:"h-4 w-4 text-blue-500"});default:return e.jsx(Fe,{className:"h-4 w-4 text-gray-500"})}},v=k=>{const T={added:{variant:"default",label:"Added",className:"bg-green-100 text-green-800"},removed:{variant:"destructive",label:"Removed",className:"bg-red-100 text-red-800"},modified:{variant:"secondary",label:"Modified",className:"bg-blue-100 text-blue-800"}}[k];return e.jsx(ae,{variant:T.variant,className:T.className,children:T.label})},j=(k,I)=>e.jsxs($,{children:[e.jsxs(Z,{className:"pb-3",children:[e.jsxs(X,{className:"text-lg flex items-center justify-between",children:[I,e.jsxs(ae,{variant:k.isCurrent?"default":"secondary",children:["v",k.versionNumber]})]}),e.jsx(ye,{children:k.changeSummary||"No change summary available"})]}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Status:"}),e.jsx(ae,{variant:"outline",className:"ml-2",children:k.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Breaking:"}),k.breakingChanges?e.jsxs(ae,{variant:"destructive",className:"ml-2",children:[e.jsx(It,{className:"h-3 w-3 mr-1"}),"Yes"]}):e.jsxs(ae,{variant:"secondary",className:"ml-2",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"No"]})]})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ln,{className:"h-4 w-4"}),Vt(k.createdAt,{addSuffix:!0})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(cn,{className:"h-4 w-4"}),k.createdBy]})]}),e.jsx(Ts,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Content Preview"}),e.jsxs("div",{className:"text-xs bg-gray-50 p-3 rounded border max-h-24 overflow-y-auto",children:[k.content.substring(0,150),k.content.length>150&&"..."]})]})]})]}),C=()=>!f||!f.differences.length?e.jsxs(vt,{children:[e.jsx(Hg,{className:"h-4 w-4"}),e.jsx(wt,{children:"No differences found between the selected versions."})]}):e.jsx("div",{className:"space-y-4",children:f.differences.map((k,I)=>e.jsxs($,{children:[e.jsx(Z,{className:"pb-3",children:e.jsxs(X,{className:"text-sm flex items-center gap-2",children:[N(k.type),"Field: ",k.field,v(k.type)]})}),e.jsxs(z,{children:[k.type==="modified"&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-sm text-red-700 mb-2",children:["Before (v",f.version1.versionNumber,")"]}),e.jsxs("div",{className:"text-xs bg-red-50 border border-red-200 p-3 rounded",children:[typeof k.oldValue=="string"?k.oldValue.substring(0,200):JSON.stringify(k.oldValue,null,2).substring(0,200),(typeof k.oldValue=="string"?k.oldValue.length:JSON.stringify(k.oldValue).length)>200&&"..."]})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-sm text-green-700 mb-2",children:["After (v",f.version2.versionNumber,")"]}),e.jsxs("div",{className:"text-xs bg-green-50 border border-green-200 p-3 rounded",children:[typeof k.newValue=="string"?k.newValue.substring(0,200):JSON.stringify(k.newValue,null,2).substring(0,200),(typeof k.newValue=="string"?k.newValue.length:JSON.stringify(k.newValue).length)>200&&"..."]})]})]}),k.type==="added"&&e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-sm text-green-700 mb-2",children:["Added in v",f.version2.versionNumber]}),e.jsx("div",{className:"text-xs bg-green-50 border border-green-200 p-3 rounded",children:typeof k.newValue=="string"?k.newValue:JSON.stringify(k.newValue,null,2)})]}),k.type==="removed"&&e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-sm text-red-700 mb-2",children:["Removed from v",f.version1.versionNumber]}),e.jsx("div",{className:"text-xs bg-red-50 border border-red-200 p-3 rounded",children:typeof k.oldValue=="string"?k.oldValue:JSON.stringify(k.oldValue,null,2)})]})]})]},I))});return e.jsxs("div",{className:`space-y-6 ${n}`,children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(iN,{className:"h-5 w-5"}),"Compare Template Versions"]}),e.jsx(ye,{children:"Select two versions to compare their differences"})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Version 1"}),e.jsxs(it,{value:c,onValueChange:d,children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Select first version"})}),e.jsx(at,{children:i.map(k=>e.jsxs(ne,{value:k.id,children:["v",k.versionNumber," - ",k.changeSummary||"No summary"]},k.id))})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Mn,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Version 2"}),e.jsxs(it,{value:h,onValueChange:m,children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Select second version"})}),e.jsx(at,{children:i.map(k=>e.jsxs(ne,{value:k.id,children:["v",k.versionNumber," - ",k.changeSummary||"No summary"]},k.id))})]})]})]}),c&&h&&c===h&&e.jsxs(vt,{className:"mt-4",children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:"Please select two different versions to compare."})]})]})]}),f&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[j(f.version1,"Version 1"),j(f.version2,"Version 2")]}),f&&e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Differences"}),e.jsxs(ae,{variant:"outline",children:[f.differences.length," change",f.differences.length!==1?"s":""]})]}),e.jsxs(ye,{children:["Changes between v",f.version1.versionNumber," and v",f.version2.versionNumber]})]}),e.jsx(z,{children:y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx(Po,{className:"max-h-96",children:C()})})]})]})},u7=()=>{const[r,t]=p.useState("browse"),[s,a]=p.useState(null),[n,i]=p.useState(null),o=m=>{a(m),t("customize")},c=m=>{i(m);const f={id:"generated-"+Date.now(),name:m.name,description:m.description,category:m.category,content:m.content,variables:m.variables,is_public:!1,created_by:"current-user",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};a(f),t("customize")},d=[{title:"Available Templates",value:"150+",description:"Professional legal templates",icon:Fe,color:"text-blue-600"},{title:"AI Generated",value:"50+",description:"Custom AI-created templates",icon:pl,color:"text-purple-600"},{title:"Most Popular",value:"Service Agreement",description:"This month's top template",icon:Wa,color:"text-green-600"},{title:"Recently Added",value:"12",description:"New templates this week",icon:us,color:"text-orange-600"}],h=[{name:"Contracts & Agreements",count:45,description:"Service agreements, NDAs, and general contracts",popular:!0},{name:"Employment Law",count:28,description:"Employment contracts and HR documents",popular:!0},{name:"Corporate Documents",count:32,description:"Partnership agreements and corporate filings",popular:!1},{name:"Real Estate",count:18,description:"Lease agreements and property documents",popular:!1},{name:"Compliance & Regulatory",count:15,description:"Privacy policies and terms of service",popular:!0},{name:"Personal Legal",count:12,description:"Wills, powers of attorney, and personal documents",popular:!1}];return e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Legal Templates"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Browse, customize, and generate professional legal document templates"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",onClick:()=>t("generate"),children:[e.jsx(pl,{className:"h-4 w-4 mr-2"}),"Generate with AI"]}),e.jsxs(R,{onClick:()=>t("browse"),children:[e.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Browse Templates"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:d.map((m,f)=>e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.value}),e.jsx("p",{className:"text-xs text-gray-500",children:m.description})]}),e.jsx(m.icon,{className:`h-8 w-8 ${m.color}`})]})})},f))}),e.jsxs(fr,{value:r,onValueChange:t,children:[e.jsxs(nr,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ge,{value:"browse",className:"flex items-center space-x-2",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx("span",{children:"Browse Templates"})]}),e.jsxs(Ge,{value:"generate",className:"flex items-center space-x-2",children:[e.jsx(pl,{className:"h-4 w-4"}),e.jsx("span",{children:"AI Generator"})]}),e.jsxs(Ge,{value:"customize",className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:"Customize"})]})]}),e.jsxs(He,{value:"browse",className:"space-y-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-lg",children:"Template Categories"}),e.jsx(ye,{children:"Explore templates by category"})]}),e.jsx(z,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map((m,f)=>e.jsxs("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium",children:m.name}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ae,{variant:"secondary",children:m.count}),m.popular&&e.jsx(Ot,{className:"h-4 w-4 text-yellow-500"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:m.description})]},f))})})]}),e.jsx(VV,{onTemplateSelect:o,onTemplatePreview:m=>{a(m),t("customize")}})]}),e.jsx(He,{value:"generate",className:"space-y-6",children:e.jsx(ZV,{onTemplateGenerated:c})}),e.jsx(He,{value:"customize",className:"space-y-6",children:s?e.jsx(WV,{template:s,onSave:(m,f)=>{console.log("Template customized:",{content:m,variables:f})},onDownload:(m,f)=>{const g=new Blob([m],{type:"text/plain"}),y=URL.createObjectURL(g),b=document.createElement("a");b.href=y,b.download=f,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(y)}}):e.jsx($,{children:e.jsxs(z,{className:"text-center py-12",children:[e.jsx(Fe,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"No Template Selected"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Choose a template from the browser or generate a new one with AI to start customizing."}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs(R,{variant:"outline",onClick:()=>t("browse"),children:[e.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Browse Templates"]}),e.jsxs(R,{onClick:()=>t("generate"),children:[e.jsx(pl,{className:"h-4 w-4 mr-2"}),"Generate with AI"]})]})]})})})]})]})})},h7=()=>{const[r,t]=p.useState("directory"),[s,a]=p.useState(null),[n,i]=p.useState([]),[o,c]=p.useState([]),[d,h]=p.useState(!0),{user:m}=ft();p.useEffect(()=>{f()},[]);const f=async()=>{try{h(!0);const[v,j]=await Promise.all([Ur.getTopRatedLawFirms(6),Ur.getRecentLawFirms(3)]);i(v),c(j)}catch(v){console.error("Error loading featured data:",v)}finally{h(!1)}},g=v=>{a(v),t("profile")},y=()=>{s&&t("review")},b=()=>{t("profile")},w=()=>{t("directory"),a(null)},S=()=>{t("profile")},N=[{title:"Total Law Firms",value:"150+",description:"Verified legal professionals",icon:es,color:"text-blue-600"},{title:"Average Rating",value:"4.2",description:"Based on client reviews",icon:Ot,color:"text-yellow-600"},{title:"Practice Areas",value:"12+",description:"Specialized legal services",icon:Wa,color:"text-green-600"},{title:"Locations",value:"Singapore",description:"Nationwide coverage",icon:ia,color:"text-purple-600"}];return r==="profile"&&s?e.jsxs(la,{children:[e.jsx(GS,{firmId:s.id,onBack:w}),e.jsx("div",{className:"fixed bottom-6 right-6",children:e.jsxs(R,{onClick:y,size:"lg",className:"rounded-full shadow-lg",children:[e.jsx(da,{className:"h-5 w-5 mr-2"}),"Write Review"]})})]}):r==="review"&&s?e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(R,{variant:"outline",onClick:S,children:["← Back to ",s.name]})}),e.jsx(j8,{lawFirm:s,onReviewSubmitted:b,onCancel:S})]})}):e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Law Firm Directory"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Find and connect with verified legal professionals in Singapore"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",children:[e.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Advanced Search"]}),(m==null?void 0:m.role)==="admin"&&e.jsxs(R,{children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add Law Firm"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:N.map((v,j)=>e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:v.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.value}),e.jsx("p",{className:"text-xs text-gray-500",children:v.description})]}),e.jsx(v.icon,{className:`h-8 w-8 ${v.color}`})]})})},j))}),!d&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(Ot,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{children:"Top Rated Law Firms"})]}),e.jsx(ye,{children:"Highest rated legal professionals based on client reviews"})]}),e.jsx(z,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.slice(0,4).map(v=>e.jsxs("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow cursor-pointer",onClick:()=>g(v),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-medium truncate flex items-center space-x-1",children:[e.jsx("span",{children:v.name}),v.verified&&e.jsx(Ri,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-sm font-medium",children:v.rating.toFixed(1)})]})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:v.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:v.practice_areas.slice(0,2).map((j,C)=>e.jsx(ae,{variant:"secondary",className:"text-xs",children:j},C))})]},v.id))})})]})}),e.jsx("div",{children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(Wa,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{children:"Recently Added"})]}),e.jsx(ye,{children:"New law firms in our directory"})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-3",children:o.map(v=>e.jsxs("div",{className:"p-3 border rounded-lg hover:shadow-sm transition-shadow cursor-pointer",onClick:()=>g(v),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("h4",{className:"font-medium text-sm truncate flex items-center space-x-1",children:[e.jsx("span",{children:v.name}),v.verified&&e.jsx(Ri,{className:"h-3 w-3 text-blue-500"})]}),e.jsx(ae,{variant:"outline",className:"text-xs",children:"New"})]}),e.jsx("p",{className:"text-xs text-gray-600 line-clamp-1",children:v.practice_areas.slice(0,2).join(", ")})]},v.id))})})]})})]}),e.jsx(VL,{onFirmSelect:g})]})})},li={async getPermissions(){const{data:r,error:t}=await D.from("permissions").select("*").order("resource",{ascending:!0}).order("action",{ascending:!0});if(t)throw console.error("Error fetching permissions:",t),new Error("Failed to fetch permissions");return r||[]},async getRolePermissions(r){let t=D.from("role_permissions").select(`
        *,
        permission:permissions(*)
      `).order("role",{ascending:!0});r&&(t=t.eq("role",r));const{data:s,error:a}=await t;if(a)throw console.error("Error fetching role permissions:",a),new Error("Failed to fetch role permissions");return s||[]},async updateRolePermissions(r,t){const{error:s}=await D.from("role_permissions").delete().eq("role",r);if(s)throw console.error("Error deleting role permissions:",s),new Error("Failed to update role permissions");if(t.length>0){const a=t.map(i=>({role:r,permission_id:i})),{error:n}=await D.from("role_permissions").insert(a);if(n)throw console.error("Error inserting role permissions:",n),new Error("Failed to update role permissions")}await this.logAction("update_role_permissions","role_permissions",r,null,{role:r,permission_ids:t})},async getUsers(r={}){let t=D.from("profiles").select("*").order("created_at",{ascending:!1});r.role&&(t=t.eq("role",r.role)),r.search&&(t=t.or(`full_name.ilike.%${r.search}%,email.ilike.%${r.search}%`));const{data:s,error:a}=await t;if(a)throw console.error("Error fetching users:",a),new Error("Failed to fetch users");return s||[]},async getUserWithPermissions(r){const{data:t,error:s}=await D.rpc("get_user_permissions",{user_uuid:r});if(s)throw console.error("Error fetching user permissions:",s),new Error("Failed to fetch user permissions");const{data:a,error:n}=await D.from("profiles").select("*").eq("id",r).single();if(n)throw console.error("Error fetching user profile:",n),new Error("Failed to fetch user profile");return{...a,permissions:t||[]}},async updateUserRole(r,t){const{data:s}=await D.from("profiles").select("*").eq("id",r).single(),{data:a,error:n}=await D.from("profiles").update({role:t}).eq("id",r).select().single();if(n)throw console.error("Error updating user role:",n),new Error("Failed to update user role");return await this.logAction("update_user_role","profiles",r,{role:s==null?void 0:s.role},{role:t}),a},async deleteUser(r){const{data:t}=await D.from("profiles").select("*").eq("id",r).single(),{error:s}=await D.from("profiles").delete().eq("id",r);if(s)throw console.error("Error deleting user:",s),new Error("Failed to delete user");await this.logAction("delete_user","profiles",r,t,null)},async getUserPermissions(r){const{data:t,error:s}=await D.from("user_permissions").select(`
        *,
        permission:permissions(*),
        granted_by_user:profiles!user_permissions_granted_by_fkey(full_name, email)
      `).eq("user_id",r).order("created_at",{ascending:!1});if(s)throw console.error("Error fetching user permissions:",s),new Error("Failed to fetch user permissions");return t||[]},async grantUserPermission(r){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:s,error:a}=await D.from("user_permissions").upsert({...r,granted_by:t.id}).select(`
        *,
        permission:permissions(*)
      `).single();if(a)throw console.error("Error granting user permission:",a),new Error("Failed to grant user permission");return await this.logAction("grant_user_permission","user_permissions",s.id,null,r),s},async revokeUserPermission(r,t){const{error:s}=await D.from("user_permissions").delete().eq("user_id",r).eq("permission_id",t);if(s)throw console.error("Error revoking user permission:",s),new Error("Failed to revoke user permission");await this.logAction("revoke_user_permission","user_permissions",`${r}-${t}`,{user_id:r,permission_id:t},null)},async hasPermission(r){const{data:{user:t}}=await D.auth.getUser();if(!t)return!1;const{data:s,error:a}=await D.rpc("user_has_permission",{user_uuid:t.id,permission_name:r});return a?(console.error("Error checking permission:",a),!1):s||!1},async getUserPermissionsList(r){const{data:{user:t}}=await D.auth.getUser(),s=r||(t==null?void 0:t.id);if(!s)return[];const{data:a,error:n}=await D.rpc("get_user_permissions",{user_uuid:s});return n?(console.error("Error fetching user permissions list:",n),[]):(a||[]).filter(i=>i.granted_by_role||i.granted_individually).map(i=>i.permission_name)},async getAuditLogs(r={}){let t=D.from("audit_logs").select(`
        *,
        user:profiles(full_name, email, role)
      `).order("created_at",{ascending:!1}).limit(100);r.user_id&&(t=t.eq("user_id",r.user_id)),r.action&&(t=t.eq("action",r.action)),r.resource_type&&(t=t.eq("resource_type",r.resource_type)),r.date_from&&(t=t.gte("created_at",r.date_from.toISOString())),r.date_to&&(t=t.lte("created_at",r.date_to.toISOString()));const{data:s,error:a}=await t;if(a)throw console.error("Error fetching audit logs:",a),new Error("Failed to fetch audit logs");return s||[]},async logAction(r,t,s,a,n,i,o){const{data:{user:c}}=await D.auth.getUser();if(!c)return;const{error:d}=await D.rpc("log_admin_action",{user_uuid:c.id,action_name:r,resource_type_name:t,resource_id_value:s,old_values_json:a,new_values_json:n,ip_addr:i,user_agent_string:o});d&&console.error("Error logging action:",d)},async bulkUpdateUserRoles(r,t){const{error:s}=await D.from("profiles").update({role:t}).in("id",r);if(s)throw console.error("Error bulk updating user roles:",s),new Error("Failed to bulk update user roles");await this.logAction("bulk_update_user_roles","profiles",r.join(","),null,{user_ids:r,role:t})},async bulkDeleteUsers(r){const{error:t}=await D.from("profiles").delete().in("id",r);if(t)throw console.error("Error bulk deleting users:",t),new Error("Failed to bulk delete users");await this.logAction("bulk_delete_users","profiles",r.join(","),{user_ids:r},null)}},Xd=()=>{const[r,t]=p.useState([]),[s,a]=p.useState(!0),{user:n,profile:i}=ft(),o=async()=>{if(!n){t([]),a(!1);return}try{a(!0);const b=await li.getUserPermissionsList();t(b)}catch(b){console.error("Error fetching permissions:",b),t([])}finally{a(!1)}};p.useEffect(()=>{o()},[n]);const c=b=>r.includes(b),d=b=>b.some(w=>r.includes(w)),h=b=>b.every(w=>r.includes(w)),m=b=>i!=null&&i.role?Array.isArray(b)?b.includes(i.role):i.role===b:!1,f=m(["admin","super_admin"]),g=m(["moderator","admin","super_admin"]),y=m("super_admin");return{permissions:r,hasPermission:c,hasAnyPermission:d,hasAllPermissions:h,hasRole:m,isAdmin:f,isModerator:g,isSuperAdmin:y,loading:s,refetch:o}},m7=()=>{const{profile:r}=ft();return{canAccessAdmin:()=>(r==null?void 0:r.role)&&["admin","super_admin"].includes(r.role),canAccessModerator:()=>(r==null?void 0:r.role)&&["moderator","admin","super_admin"].includes(r.role),canManageUsers:()=>(r==null?void 0:r.role)&&["admin","super_admin"].includes(r.role),canManageSystem:()=>(r==null?void 0:r.role)==="super_admin",userRole:(r==null?void 0:r.role)||"user"}},$t={DOCUMENTS_CREATE:"documents.create",DOCUMENTS_READ:"documents.read",DOCUMENTS_UPDATE:"documents.update",DOCUMENTS_DELETE:"documents.delete",DOCUMENTS_READ_ALL:"documents.read_all",TEMPLATES_CREATE:"templates.create",TEMPLATES_READ:"templates.read",TEMPLATES_UPDATE:"templates.update",TEMPLATES_DELETE:"templates.delete",TEMPLATES_MODERATE:"templates.moderate",TEMPLATES_MANAGE:"templates.manage",LAW_FIRMS_CREATE:"law_firms.create",LAW_FIRMS_READ:"law_firms.read",LAW_FIRMS_UPDATE:"law_firms.update",LAW_FIRMS_DELETE:"law_firms.delete",LAW_FIRMS_VERIFY:"law_firms.verify",LAW_FIRMS_MODERATE_REVIEWS:"law_firms.moderate_reviews",USERS_CREATE:"users.create",USERS_READ:"users.read",USERS_UPDATE:"users.update",USERS_DELETE:"users.delete",USERS_MANAGE_ROLES:"users.manage_roles",USERS_MANAGE_PERMISSIONS:"users.manage_permissions",SYSTEM_ANALYTICS:"system.analytics",SYSTEM_MONITORING:"system.monitoring",SYSTEM_AUDIT_LOGS:"system.audit_logs",SYSTEM_SETTINGS:"system.settings"},hh=[{value:"user",label:"User",color:"bg-gray-100 text-gray-800"},{value:"moderator",label:"Moderator",color:"bg-blue-100 text-blue-800"},{value:"admin",label:"Admin",color:"bg-purple-100 text-purple-800"},{value:"super_admin",label:"Super Admin",color:"bg-red-100 text-red-800"}],f7=({className:r=""})=>{const[t,s]=p.useState([]),[a,n]=p.useState([]),[i,o]=p.useState(!0),[c,d]=p.useState(""),[h,m]=p.useState("all"),[f,g]=p.useState([]),[y,b]=p.useState(""),{hasPermission:w}=Xd();p.useEffect(()=>{S()},[]),p.useEffect(()=>{N()},[t,c,h]);const S=async()=>{try{o(!0);const A=await li.getUsers();s(A)}catch(A){console.error("Error loading users:",A),te.error("Failed to load users")}finally{o(!1)}},N=()=>{let A=[...t];if(c.trim()){const L=c.toLowerCase();A=A.filter(M=>{var se;return((se=M.full_name)==null?void 0:se.toLowerCase().includes(L))||M.email.toLowerCase().includes(L)})}h!=="all"&&(A=A.filter(L=>L.role===h)),n(A)},v=(A,L)=>{g(L?M=>[...M,A]:M=>M.filter(se=>se!==A))},j=A=>{g(A?a.map(L=>L.id):[])},C=async(A,L)=>{try{await li.updateUserRole(A,L),te.success("User role updated successfully"),S()}catch(M){console.error("Error updating user role:",M),te.error("Failed to update user role")}},k=async A=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{await li.deleteUser(A),te.success("User deleted successfully"),S()}catch(L){console.error("Error deleting user:",L),te.error("Failed to delete user")}},I=async()=>{if(!(f.length===0||!y))try{switch(y){case"delete":if(!confirm(`Are you sure you want to delete ${f.length} users? This action cannot be undone.`))return;await li.bulkDeleteUsers(f),te.success(`${f.length} users deleted successfully`);break;case"promote_moderator":await li.bulkUpdateUserRoles(f,"moderator"),te.success(`${f.length} users promoted to moderator`);break;case"demote_user":await li.bulkUpdateUserRoles(f,"user"),te.success(`${f.length} users demoted to user`);break;default:return}g([]),b(""),S()}catch(A){console.error("Error performing bulk action:",A),te.error("Failed to perform bulk action")}},T=A=>hh.find(L=>L.value===A)||hh[0],O=A=>A.split(" ").map(L=>L[0]).join("").toUpperCase().slice(0,2),U=()=>{const A=[["Name","Email","Role","Created At"].join(","),...a.map(W=>[W.full_name||"",W.email,W.role,new Date(W.created_at).toLocaleDateString()].join(","))].join(`
`),L=new Blob([A],{type:"text/csv"}),M=URL.createObjectURL(L),se=document.createElement("a");se.href=M,se.download=`users_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(M)};return w($t.USERS_READ)?e.jsxs("div",{className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage user accounts, roles, and permissions"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",onClick:U,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(R,{variant:"outline",onClick:S,children:[e.jsx(mr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:hh.map(A=>{const L=t.filter(M=>M.role===A.value).length;return e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-600",children:[A.label,"s"]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:L})]}),e.jsx(es,{className:"h-8 w-8 text-gray-400"})]})})},A.value)})}),e.jsx($,{children:e.jsxs(z,{className:"p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Pe,{placeholder:"Search users by name or email...",value:c,onChange:A=>d(A.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs(it,{value:h,onValueChange:A=>m(A),children:[e.jsx(rt,{children:e.jsx(ot,{placeholder:"Filter by role"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All Roles"}),hh.map(A=>e.jsx(ne,{value:A.value,children:A.label},A.value))]})]})})]}),f.length>0&&w($t.USERS_MANAGE_ROLES)&&e.jsxs("div",{className:"flex items-center space-x-4 mt-4 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[f.length," user",f.length===1?"":"s"," selected"]}),e.jsxs(it,{value:y,onValueChange:b,children:[e.jsx(rt,{className:"w-48",children:e.jsx(ot,{placeholder:"Bulk actions"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"promote_moderator",children:"Promote to Moderator"}),e.jsx(ne,{value:"demote_user",children:"Demote to User"}),e.jsx(ne,{value:"delete",children:"Delete Users"})]})]}),e.jsx(R,{onClick:I,disabled:!y,children:"Apply"}),e.jsx(R,{variant:"outline",onClick:()=>g([]),children:"Clear Selection"})]})]})}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(X,{children:["Users (",a.length,")"]}),w($t.USERS_MANAGE_ROLES)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{checked:f.length===a.length&&a.length>0,onCheckedChange:j}),e.jsx("span",{className:"text-sm text-gray-600",children:"Select All"})]})]})}),e.jsx(z,{children:i?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((A,L)=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 animate-pulse",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},L))}):a.length>0?e.jsx("div",{className:"space-y-2",children:a.map(A=>{const L=T(A.role);return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[w($t.USERS_MANAGE_ROLES)&&e.jsx(hr,{checked:f.includes(A.id),onCheckedChange:M=>v(A.id,!!M)}),e.jsx(zr,{children:e.jsx(Br,{children:A.full_name?O(A.full_name):A.email[0].toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:A.full_name||"Unnamed User"}),e.jsx(ae,{className:L.color,children:L.label})]}),e.jsx("p",{className:"text-sm text-gray-600",children:A.email}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Joined ",Vt(new Date(A.created_at),{addSuffix:!0})]})]})]}),w($t.USERS_UPDATE)&&e.jsxs(_d,{children:[e.jsx(Nd,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"sm",children:e.jsx(fx,{className:"h-4 w-4"})})}),e.jsxs(Yl,{align:"end",children:[e.jsx(sv,{children:"Actions"}),e.jsx(Ro,{}),w($t.USERS_MANAGE_ROLES)&&e.jsxs(e.Fragment,{children:[e.jsxs(ur,{onClick:()=>C(A.id,"moderator"),children:[e.jsx(r6,{className:"h-4 w-4 mr-2"}),"Promote to Moderator"]}),e.jsxs(ur,{onClick:()=>C(A.id,"user"),children:[e.jsx(a6,{className:"h-4 w-4 mr-2"}),"Demote to User"]}),e.jsx(Ro,{})]}),w($t.USERS_DELETE)&&e.jsxs(ur,{onClick:()=>k(A.id),className:"text-red-600",children:[e.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Delete User"]})]})]})]},A.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria or filters."})]})})]})]}):e.jsx($,{className:r,children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(vs,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-500",children:"You don't have permission to view user management."})]})})},p7=({className:r=""})=>{const[t,s]=p.useState([]),[a,n]=p.useState([]),[i,o]=p.useState({pendingReviews:0,pendingTemplates:0,totalReviews:0,totalTemplates:0}),[c,d]=p.useState(!0),[h,m]=p.useState("reviews"),{hasPermission:f}=Xd();p.useEffect(()=>{g()},[]);const g=async()=>{try{d(!0),s([]),n([]),o({pendingReviews:0,pendingTemplates:0,totalReviews:0,totalTemplates:0})}catch(v){console.error("Error loading moderation data:",v),te.error("Failed to load moderation data")}finally{d(!1)}},y=async(v,j)=>{try{await Ur.moderateReview(v,j),te.success(`Review ${j} successfully`),g()}catch(C){console.error("Error moderating review:",C),te.error("Failed to moderate review")}},b=async(v,j)=>{try{te.success(`Template ${j} successfully`),g()}catch(C){console.error("Error moderating template:",C),te.error("Failed to moderate template")}},w=v=>Array.from({length:5},(j,C)=>e.jsx(Ot,{className:`h-4 w-4 ${C<Math.floor(v)?"text-yellow-400 fill-current":"text-gray-300"}`},C)),S=v=>v.split(" ").map(j=>j[0]).join("").toUpperCase().slice(0,2);if(!f($t.LAW_FIRMS_MODERATE_REVIEWS)&&!f($t.TEMPLATES_MODERATE))return e.jsx($,{className:r,children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(xx,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-500",children:"You don't have permission to access content moderation."})]})});const N=[{title:"Pending Reviews",value:i.pendingReviews,total:i.totalReviews,description:"Reviews awaiting moderation",icon:Ft,color:"text-yellow-600"},{title:"Pending Templates",value:i.pendingTemplates,total:i.totalTemplates,description:"Templates awaiting approval",icon:Fe,color:"text-blue-600"},{title:"Total Content",value:i.totalReviews+i.totalTemplates,total:null,description:"All moderated content",icon:es,color:"text-green-600"},{title:"Moderation Queue",value:i.pendingReviews+i.pendingTemplates,total:null,description:"Items requiring attention",icon:us,color:"text-red-600"}];return e.jsxs("div",{className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Content Moderation"}),e.jsx("p",{className:"text-gray-600",children:"Review and moderate user-generated content"})]}),e.jsxs(R,{variant:"outline",onClick:g,children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Refresh Queue"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:N.map((v,j)=>e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:v.title}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[v.value,v.total!==null&&e.jsxs("span",{className:"text-sm text-gray-500 ml-1",children:["/ ",v.total]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:v.description})]}),e.jsx(v.icon,{className:`h-8 w-8 ${v.color}`})]})})},j))}),e.jsxs(fr,{value:h,onValueChange:m,children:[e.jsxs(nr,{className:"grid w-full grid-cols-2",children:[e.jsxs(Ge,{value:"reviews",className:"flex items-center space-x-2",children:[e.jsx(Ft,{className:"h-4 w-4"}),e.jsxs("span",{children:["Reviews (",i.pendingReviews,")"]})]}),e.jsxs(Ge,{value:"templates",className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Templates (",i.pendingTemplates,")"]})]})]}),e.jsx(He,{value:"reviews",className:"space-y-4",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Pending Reviews"}),e.jsx(ye,{children:"Law firm reviews awaiting moderation approval"})]}),e.jsx(z,{children:c?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((v,j)=>e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})},j))}):t.length>0?e.jsx("div",{className:"space-y-4",children:t.map(v=>{var j;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(zr,{children:e.jsx(Br,{children:v.user?S(v.user.full_name):"U"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:((j=v.user)==null?void 0:j.full_name)||"Anonymous"}),e.jsx(ae,{variant:"secondary",children:"Pending"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:"flex items-center space-x-1",children:w(v.rating)}),e.jsx("span",{className:"text-sm text-gray-500",children:Vt(new Date(v.created_at),{addSuffix:!0})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{size:"sm",onClick:()=>y(v.id,"approved"),children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(R,{variant:"destructive",size:"sm",onClick:()=>y(v.id,"rejected"),children:[e.jsx(Qs,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:v.title}),e.jsx("p",{className:"text-gray-700",children:v.content})]})]},v.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ft,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No pending reviews"}),e.jsx("p",{className:"text-gray-500",children:"All reviews have been moderated."})]})})]})}),e.jsx(He,{value:"templates",className:"space-y-4",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Pending Templates"}),e.jsx(ye,{children:"Public templates awaiting approval"})]}),e.jsx(z,{children:c?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((v,j)=>e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})},j))}):a.length>0?e.jsx("div",{className:"space-y-4",children:a.map(v=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:v.name}),e.jsx(ae,{variant:"secondary",children:"Pending"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v.category}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Created ",Vt(new Date(v.created_at),{addSuffix:!0})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{variant:"outline",size:"sm",children:[e.jsx(Gt,{className:"h-4 w-4 mr-1"}),"Preview"]}),e.jsxs(R,{size:"sm",onClick:()=>b(v.id,"approved"),children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(R,{variant:"destructive",size:"sm",onClick:()=>b(v.id,"rejected"),children:[e.jsx(Qs,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-gray-700",children:v.description}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Variables:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[v.variables.slice(0,3).map((j,C)=>e.jsx(ae,{variant:"outline",className:"text-xs",children:j},C)),v.variables.length>3&&e.jsxs(ae,{variant:"outline",className:"text-xs",children:["+",v.variables.length-3," more"]})]})]})]})]},v.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No pending templates"}),e.jsx("p",{className:"text-gray-500",children:"All templates have been reviewed."})]})})]})})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(It,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{children:"Moderation Guidelines"})]})}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Review Moderation"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Check for inappropriate language or content"}),e.jsx("li",{children:"• Verify reviews are constructive and helpful"}),e.jsx("li",{children:"• Ensure reviews don't contain personal information"}),e.jsx("li",{children:"• Look for potential fake or spam reviews"}),e.jsx("li",{children:"• Approve reviews that provide genuine feedback"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Template Moderation"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Verify legal accuracy and completeness"}),e.jsx("li",{children:"• Check for proper variable placement"}),e.jsx("li",{children:"• Ensure templates follow Singapore law"}),e.jsx("li",{children:"• Review for clarity and usability"}),e.jsx("li",{children:"• Approve templates that meet quality standards"})]})]})]})})]})]})},x7=({className:r=""})=>{const[t,s]=p.useState({totalUsers:0,activeUsers:0,totalDocuments:0,totalTemplates:0,totalLawFirms:0,systemHealth:"healthy",uptime:"99.9%",responseTime:120}),[a,n]=p.useState({dailyActiveUsers:0,documentsProcessed:0,templatesGenerated:0,searchQueries:0,aiOperations:0}),[i,o]=p.useState([]),[c,d]=p.useState(!0),[h,m]=p.useState("overview"),{hasPermission:f}=Xd();p.useEffect(()=>{g();const N=setInterval(g,3e4);return()=>clearInterval(N)},[]);const g=async()=>{try{d(!0);const N=await li.getAuditLogs({date_from:new Date(Date.now()-24*60*60*1e3)});o(N),s({totalUsers:1250,activeUsers:89,totalDocuments:5420,totalTemplates:156,totalLawFirms:89,systemHealth:"healthy",uptime:"99.9%",responseTime:Math.floor(Math.random()*50)+100}),n({dailyActiveUsers:89,documentsProcessed:234,templatesGenerated:45,searchQueries:1250,aiOperations:567})}catch(N){console.error("Error loading system data:",N),te.error("Failed to load system data")}finally{d(!1)}},y=N=>{switch(N){case"healthy":return"text-green-600";case"warning":return"text-yellow-600";case"critical":return"text-red-600";default:return"text-gray-600"}},b=N=>{switch(N){case"healthy":return Ue;case"warning":return It;case"critical":return It;default:return ji}};if(!f($t.SYSTEM_MONITORING))return e.jsx($,{className:r,children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Y5,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-500",children:"You don't have permission to view system monitoring."})]})});const w=[{title:"System Health",value:t.systemHealth,description:`${t.uptime} uptime`,icon:b(t.systemHealth),color:y(t.systemHealth),trend:null},{title:"Active Users",value:t.activeUsers,description:`${t.totalUsers} total users`,icon:es,color:"text-blue-600",trend:"+12%"},{title:"Documents",value:t.totalDocuments,description:`${a.documentsProcessed} processed today`,icon:Fe,color:"text-green-600",trend:"+8%"},{title:"Response Time",value:`${t.responseTime}ms`,description:"Average response time",icon:ji,color:t.responseTime>200?"text-yellow-600":"text-green-600",trend:t.responseTime>200?"+5%":"-3%"}],S=[{title:"Daily Active Users",value:a.dailyActiveUsers,icon:es,color:"text-blue-600"},{title:"Documents Processed",value:a.documentsProcessed,icon:Fe,color:"text-green-600"},{title:"Templates Generated",value:a.templatesGenerated,icon:Rh,color:"text-purple-600"},{title:"Search Queries",value:a.searchQueries,icon:Ba,color:"text-orange-600"},{title:"AI Operations",value:a.aiOperations,icon:ji,color:"text-red-600"}];return e.jsxs("div",{className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"System Monitoring"}),e.jsx("p",{className:"text-gray-600",children:"Monitor system health, performance, and usage metrics"})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(R,{variant:"outline",onClick:g,children:[e.jsx(mr,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:w.map((N,v)=>e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:N.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.value}),e.jsx("p",{className:"text-xs text-gray-500",children:N.description})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(N.icon,{className:`h-8 w-8 ${N.color}`}),N.trend&&e.jsxs("div",{className:`flex items-center mt-2 ${N.trend.startsWith("+")?"text-green-600":"text-red-600"}`,children:[N.trend.startsWith("+")?e.jsx(Wa,{className:"h-3 w-3 mr-1"}):e.jsx(t6,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"text-xs",children:N.trend})]})]})]})})},v))}),e.jsxs(fr,{value:h,onValueChange:m,children:[e.jsxs(nr,{className:"grid w-full grid-cols-3",children:[e.jsx(Ge,{value:"overview",children:"Overview"}),e.jsx(Ge,{value:"usage",children:"Usage Metrics"}),e.jsx(Ge,{value:"activity",children:"Recent Activity"})]}),e.jsx(He,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"System Status"}),e.jsx(ye,{children:"Current system health and performance"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Database"}),e.jsx(ae,{className:"bg-green-100 text-green-800",children:"Healthy"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"API Server"}),e.jsx(ae,{className:"bg-green-100 text-green-800",children:"Healthy"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"File Storage"}),e.jsx(ae,{className:"bg-green-100 text-green-800",children:"Healthy"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"AI Services"}),e.jsx(ae,{className:"bg-yellow-100 text-yellow-800",children:"Warning"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Email Service"}),e.jsx(ae,{className:"bg-green-100 text-green-800",children:"Healthy"})]})]})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Resource Usage"}),e.jsx(ye,{children:"Current system resource utilization"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"CPU Usage"}),e.jsx("span",{children:"45%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"45%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Memory Usage"}),e.jsx("span",{children:"67%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"67%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Storage Usage"}),e.jsx("span",{children:"23%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:"23%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Network I/O"}),e.jsx("span",{children:"12%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:"12%"}})})]})]})]})]})}),e.jsxs(He,{value:"usage",className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6",children:S.map((N,v)=>e.jsx($,{children:e.jsxs(z,{className:"p-6 text-center",children:[e.jsx(N.icon,{className:`h-8 w-8 ${N.color} mx-auto mb-2`}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.value}),e.jsx("p",{className:"text-sm text-gray-600",children:N.title})]})},v))}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Usage Trends (Last 7 Days)"}),e.jsx(ye,{children:"Daily usage patterns and trends"})]}),e.jsx(z,{children:e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(O5,{className:"h-12 w-12 mx-auto mb-2"}),e.jsx("p",{children:"Usage charts would be displayed here"}),e.jsx("p",{className:"text-sm",children:"Integration with charting library needed"})]})})})]})]}),e.jsx(He,{value:"activity",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Recent System Activity"}),e.jsx(ye,{children:"Latest admin actions and system events"})]}),e.jsx(z,{children:c?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((N,v)=>e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-1/2"})]})]})},v))}):i.length>0?e.jsx("div",{className:"space-y-3",children:i.map(N=>{var v;return e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ji,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:((v=N.user)==null?void 0:v.full_name)||"System"}),e.jsx("span",{className:"text-gray-600",children:N.action.replace(/_/g," ")}),e.jsx(ae,{variant:"outline",className:"text-xs",children:N.resource_type})]}),e.jsx("p",{className:"text-sm text-gray-500",children:Vt(new Date(N.created_at),{addSuffix:!0})})]})]},N.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(us,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No recent activity"}),e.jsx("p",{className:"text-gray-500",children:"System activity will appear here as it occurs."})]})})]})})]})]})},g7=({className:r=""})=>{const[t,s]=p.useState([]),[a,n]=p.useState([]),[i,o]=p.useState(!0),[c,d]=p.useState("firms");p.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0);const w=await Ur.getLawFirms();s(w)}catch(w){console.error("Error loading admin data:",w),te.error("Failed to load data")}finally{o(!1)}},m=async(w,S)=>{try{await Ur.verifyLawFirm(w,S),te.success(`Law firm ${S?"verified":"unverified"} successfully`),h()}catch(N){console.error("Error verifying firm:",N),te.error("Failed to update verification status")}},f=async w=>{if(confirm("Are you sure you want to delete this law firm? This action cannot be undone."))try{await Ur.deleteLawFirm(w),te.success("Law firm deleted successfully"),h()}catch(S){console.error("Error deleting firm:",S),te.error("Failed to delete law firm")}},g=async(w,S)=>{try{await Ur.moderateReview(w,S),te.success(`Review ${S} successfully`),h()}catch(N){console.error("Error moderating review:",N),te.error("Failed to moderate review")}},y=w=>Array.from({length:5},(S,N)=>e.jsx(Ot,{className:`h-4 w-4 ${N<Math.floor(w)?"text-yellow-400 fill-current":"text-gray-300"}`},N)),b=[{title:"Total Law Firms",value:t.length,description:"All registered firms",icon:es,color:"text-blue-600"},{title:"Verified Firms",value:t.filter(w=>w.verified).length,description:"Approved and verified",icon:Ue,color:"text-green-600"},{title:"Pending Verification",value:t.filter(w=>!w.verified).length,description:"Awaiting approval",icon:us,color:"text-yellow-600"},{title:"Pending Reviews",value:a.length,description:"Awaiting moderation",icon:Ft,color:"text-purple-600"}];return e.jsxs("div",{className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Law Firm Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage law firm listings, verifications, and reviews"})]}),e.jsxs(R,{children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add Law Firm"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:b.map((w,S)=>e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:w.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.value}),e.jsx("p",{className:"text-xs text-gray-500",children:w.description})]}),e.jsx(w.icon,{className:`h-8 w-8 ${w.color}`})]})})},S))}),e.jsxs(fr,{value:c,onValueChange:d,children:[e.jsxs(nr,{className:"grid w-full grid-cols-2",children:[e.jsxs(Ge,{value:"firms",children:["Law Firms (",t.length,")"]}),e.jsxs(Ge,{value:"reviews",children:["Pending Reviews (",a.length,")"]})]}),e.jsx(He,{value:"firms",className:"space-y-4",children:i?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((w,S)=>e.jsx($,{className:"animate-pulse",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})})},S))}):e.jsx("div",{className:"space-y-4",children:t.map(w=>e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(es,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:w.name}),e.jsx(ae,{variant:w.verified?"default":"secondary",children:w.verified?"Verified":"Pending"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:w.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[e.jsx("span",{children:w.address}),e.jsx("span",{children:w.phone}),e.jsxs("div",{className:"flex items-center space-x-1",children:[y(w.rating),e.jsx("span",{children:w.rating.toFixed(1)})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{variant:"outline",size:"sm",children:e.jsx(Gt,{className:"h-4 w-4"})}),w.verified?e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>m(w.id,!1),children:[e.jsx(Qs,{className:"h-4 w-4 mr-1"}),"Unverify"]}):e.jsxs(R,{size:"sm",onClick:()=>m(w.id,!0),children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Verify"]}),e.jsx(R,{variant:"destructive",size:"sm",onClick:()=>f(w.id),children:e.jsx(Ln,{className:"h-4 w-4"})})]})]})})},w.id))})}),e.jsx(He,{value:"reviews",className:"space-y-4",children:a.length===0?e.jsx($,{children:e.jsxs(z,{className:"text-center py-8",children:[e.jsx(Ft,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No pending reviews"}),e.jsx("p",{className:"text-gray-500",children:"All reviews have been moderated."})]})}):e.jsx("div",{className:"space-y-4",children:a.map(w=>{var S;return e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:w.title}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("div",{className:"flex items-center space-x-1",children:y(w.rating)}),e.jsxs("span",{className:"text-sm text-gray-500",children:["by ",((S=w.user)==null?void 0:S.full_name)||"Anonymous"]})]})]}),e.jsx(ae,{variant:"secondary",children:"Pending"})]}),e.jsx("p",{className:"text-gray-700",children:w.content}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(R,{size:"sm",onClick:()=>g(w.id,"approved"),children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(R,{variant:"destructive",size:"sm",onClick:()=>g(w.id,"rejected"),children:[e.jsx(Qs,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]})})},w.id)})})})]})]})};function _s({className:r,...t}){return e.jsx("div",{className:Ie("animate-pulse rounded-md bg-muted",r),...t})}const y7=()=>{const[r,t]=p.useState([]),[s,a]=p.useState([]),[n,i]=p.useState(!0),[o,c]=p.useState(""),[d,h]=p.useState(""),[m,f]=p.useState(""),[g,y]=p.useState(!1),b=Array.isArray(s)?s:[];p.useEffect(()=>{w()},[]);const w=async()=>{try{i(!0);const[k,I]=await Promise.all([bs.searchTemplates({limit:100,sortBy:"newest"}),bs.getCategories()]);t(k.templates),a(I)}catch(k){console.error("Failed to load data:",k),te.error("Failed to load template data")}finally{i(!1)}},S=async(k,I)=>{try{te.success(`Template ${I?"deactivated":"activated"} successfully`),w()}catch{te.error("Failed to update template status")}},N=async(k,I)=>{try{te.success(`Template ${I?"unfeatured":"featured"} successfully`),w()}catch{te.error("Failed to update template featured status")}},v=r.filter(k=>{const I=!o||k.title.toLowerCase().includes(o.toLowerCase())||k.description.toLowerCase().includes(o.toLowerCase()),T=!d||k.categoryId===d,O=!m||m==="active"&&k.isActive||m==="inactive"&&!k.isActive||m==="featured"&&k.isFeatured;return I&&T&&O}),j=k=>k.isActive?k.isFeatured?e.jsxs(ae,{variant:"default",children:[e.jsx(Ot,{className:"h-3 w-3 mr-1"}),"Featured"]}):e.jsxs(ae,{variant:"secondary",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(ae,{variant:"destructive",children:[e.jsx(Qs,{className:"h-3 w-3 mr-1"}),"Inactive"]}),C=k=>{const I={public:"outline",premium:"secondary",enterprise:"default"};return e.jsx(ae,{variant:I[k]||"outline",children:k.charAt(0).toUpperCase()+k.slice(1)})};return n?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_s,{className:"h-8 w-48"}),e.jsx(_s,{className:"h-10 w-32"})]}),e.jsx("div",{className:"grid gap-4",children:Array.from({length:5}).map((k,I)=>e.jsx(_s,{className:"h-24 w-full"},I))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Template Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage legal document templates and categories"})]}),e.jsxs(cc,{open:g,onOpenChange:y,children:[e.jsx(Bd,{asChild:!0,children:e.jsxs(R,{children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Create Template"]})}),e.jsxs(Mo,{className:"max-w-2xl",children:[e.jsxs(Lo,{children:[e.jsx(Uo,{children:"Create New Template"}),e.jsx($o,{children:"Create a new legal document template for the marketplace."})]}),e.jsxs(vt,{children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx(wt,{children:"Template creation interface would be implemented here with form fields for title, description, content, fields, etc."})]})]})]})]}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Pe,{placeholder:"Search templates...",value:o,onChange:k=>c(k.target.value),className:"pl-10"})]})}),e.jsxs(it,{value:d,onValueChange:h,children:[e.jsx(rt,{className:"w-full lg:w-48",children:e.jsx(ot,{placeholder:"All Categories"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"All Categories"}),b.map(k=>k&&k.id&&k.name?e.jsx(ne,{value:k.id,children:k.name},k.id):null)]})]}),e.jsxs(it,{value:m,onValueChange:f,children:[e.jsx(rt,{className:"w-full lg:w-32",children:e.jsx(ot,{placeholder:"All Status"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"",children:"All Status"}),e.jsx(ne,{value:"active",children:"Active"}),e.jsx(ne,{value:"inactive",children:"Inactive"}),e.jsx(ne,{value:"featured",children:"Featured"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:v.length===0?e.jsx($,{children:e.jsxs(z,{className:"text-center py-12",children:[e.jsx(Fe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-600",children:o||d||m?"Try adjusting your filters to see more templates.":"Get started by creating your first template."})]})}):v.map(k=>e.jsx($,{className:"hover:shadow-md transition-shadow",children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:k.title}),j(k),C(k.accessLevel)]}),e.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:k.description}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fs,{className:"h-4 w-4"}),k.downloadCount.toLocaleString()," downloads"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"h-4 w-4"}),k.ratingAverage.toFixed(1)," (",k.ratingCount," reviews)"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(us,{className:"h-4 w-4"}),new Date(k.createdAt).toLocaleDateString()]}),k.priceSgd>0&&e.jsxs("div",{className:"font-medium text-green-600",children:["S$",k.priceSgd.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsxs(R,{variant:"outline",size:"sm",children:[e.jsx(Gt,{className:"h-4 w-4 mr-1"}),"Preview"]}),e.jsxs(R,{variant:"outline",size:"sm",children:[e.jsx(Yg,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>N(k.id,k.isFeatured),children:[e.jsx(Ot,{className:`h-4 w-4 mr-1 ${k.isFeatured?"fill-current":""}`}),k.isFeatured?"Unfeature":"Feature"]}),e.jsx(R,{variant:k.isActive?"destructive":"default",size:"sm",onClick:()=>S(k.id,k.isActive),children:k.isActive?e.jsxs(e.Fragment,{children:[e.jsx(Qs,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Activate"]})})]})]})})},k.id))}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsx($,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Templates"})]})}),e.jsx($,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.filter(k=>k.isActive).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Templates"})]})}),e.jsx($,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:r.filter(k=>k.isFeatured).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Featured Templates"})]})}),e.jsx($,{children:e.jsxs(z,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.reduce((k,I)=>k+I.downloadCount,0).toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Downloads"})]})})]})]})};class v7{async getDashboardAnalytics(t){try{const s=(t==null?void 0:t.end)||new Date,a=(t==null?void 0:t.start)||new Date(Date.now()-30*24*60*60*1e3),[n,i,o,c]=await Promise.all([this.getTotalTemplates(),this.getTotalDownloads(),this.getTotalRevenue(),this.getTotalUsers()]),[d,h,m]=await Promise.all([this.getDownloadsInPeriod(a,s),this.getRevenueInPeriod(a,s),this.getNewUsersInPeriod(a,s)]),[f,g,y,b,w,S]=await Promise.all([this.getPopularTemplates(10),this.getCategoryStats(),this.getUserEngagementMetrics(a,s),this.getRevenueBreakdown(),this.getDownloadTrends(a,s),this.getFormatStats()]);return{totalTemplates:n,totalDownloads:i,totalRevenue:o,totalUsers:c,downloadsThisMonth:d,revenueThisMonth:h,newUsersThisMonth:m,popularTemplates:f,categoryStats:g,userEngagement:y,revenueBreakdown:b,downloadTrends:w,formatStats:S}}catch(s){throw console.error("Error fetching dashboard analytics:",s),new Error("Failed to fetch analytics data")}}async getTemplatePerformance(t){try{let s=D.from("templates").select(`
          id,
          title,
          download_count,
          rating_average,
          updated_at,
          template_analytics!inner(event_type),
          template_downloads!inner(format),
          template_customizations!inner(id)
        `);t&&(s=s.eq("id",t));const{data:a,error:n}=await s;if(n)throw n;return a.map(i=>{var h,m;const o=((h=i.template_analytics)==null?void 0:h.filter(f=>f.event_type==="template_view").length)||0,c=((m=i.template_customizations)==null?void 0:m.length)||0,d=i.download_count||0;return{templateId:i.id,title:i.title,views:o,customizations:c,downloads:d,revenue:d*50,rating:i.rating_average||0,conversionRate:o>0?d/o*100:0,lastUpdated:new Date(i.updated_at)}})}catch(s){throw console.error("Error fetching template performance:",s),new Error("Failed to fetch template performance data")}}async getRevenueAnalytics(){try{const t=await this.getTotalRevenue(),s=await this.getRevenueInPeriod(new Date(Date.now()-30*24*60*60*1e3),new Date),a=await this.getRevenueInPeriod(new Date(Date.now()-60*24*60*60*1e3),new Date(Date.now()-30*24*60*60*1e3)),n=a>0?(s-a)/a*100:0,i=await this.getTopRevenueTemplates(5),o=await this.getAverageOrderValue();return{totalRevenue:t,monthlyRevenue:s,revenueGrowth:n,averageOrderValue:o,topRevenueTemplates:i}}catch(t){throw console.error("Error fetching revenue analytics:",t),new Error("Failed to fetch revenue analytics")}}async getTotalTemplates(){const{count:t,error:s}=await D.from("templates").select("*",{count:"exact",head:!0}).eq("is_active",!0);if(s)throw s;return t||0}async getTotalDownloads(){const{count:t,error:s}=await D.from("template_downloads").select("*",{count:"exact",head:!0});if(s)throw s;return t||0}async getTotalRevenue(){return await this.getTotalDownloads()*25}async getTotalUsers(){const{count:t,error:s}=await D.from("profiles").select("*",{count:"exact",head:!0});if(s)throw s;return t||0}async getDownloadsInPeriod(t,s){const{count:a,error:n}=await D.from("template_downloads").select("*",{count:"exact",head:!0}).gte("created_at",t.toISOString()).lte("created_at",s.toISOString());if(n)throw n;return a||0}async getRevenueInPeriod(t,s){return await this.getDownloadsInPeriod(t,s)*25}async getNewUsersInPeriod(t,s){const{count:a,error:n}=await D.from("profiles").select("*",{count:"exact",head:!0}).gte("created_at",t.toISOString()).lte("created_at",s.toISOString());if(n)throw n;return a||0}async getPopularTemplates(t=10){const{data:s,error:a}=await D.from("templates").select(`
        id,
        title,
        download_count,
        price_sgd,
        categories(name)
      `).eq("is_active",!0).order("download_count",{ascending:!1}).limit(t);if(a)throw a;return s.map(n=>{var i;return{id:n.id,title:n.title,downloadCount:n.download_count||0,revenue:(n.download_count||0)*(n.price_sgd||0),category:((i=n.categories)==null?void 0:i.name)||"Uncategorized"}})}async getCategoryStats(){const{data:t,error:s}=await D.from("template_categories").select(`
        id,
        name,
        templates(id, download_count, price_sgd)
      `);if(s)throw s;return t.map(a=>{var n,i,o;return{categoryId:a.id,categoryName:a.name,templateCount:((n=a.templates)==null?void 0:n.length)||0,downloadCount:((i=a.templates)==null?void 0:i.reduce((c,d)=>c+(d.download_count||0),0))||0,revenue:((o=a.templates)==null?void 0:o.reduce((c,d)=>c+(d.download_count||0)*(d.price_sgd||0),0))||0}})}async getUserEngagementMetrics(t,s){return{averageSessionDuration:180,bounceRate:35.5,conversionRate:12.8,repeatUsers:45}}async getRevenueBreakdown(){return{public:0,premium:15e3,enterprise:8500}}async getDownloadTrends(t,s){const a=[],n=Math.ceil((s.getTime()-t.getTime())/864e5);for(let i=0;i<n;i++){const o=new Date(t.getTime()+i*24*60*60*1e3);a.push({date:o.toISOString().split("T")[0],downloads:Math.floor(Math.random()*50)+10,revenue:Math.floor(Math.random()*1e3)+200})}return a}async getFormatStats(){const{data:t,error:s}=await D.from("template_downloads").select("format");if(s)throw s;const a=t.reduce((i,o)=>(i[o.format]=(i[o.format]||0)+1,i),{}),n=Object.values(a).reduce((i,o)=>i+o,0);return Object.entries(a).map(([i,o])=>({format:i,count:o,percentage:n>0?o/n*100:0}))}async getTopRevenueTemplates(t=5){const{data:s,error:a}=await D.from("templates").select(`
        id,
        title,
        download_count,
        price_sgd
      `).eq("is_active",!0).order("download_count",{ascending:!1}).limit(t);if(a)throw a;return s.map(n=>({templateId:n.id,title:n.title,revenue:(n.download_count||0)*(n.price_sgd||0),downloads:n.download_count||0}))}async getAverageOrderValue(){const t=await this.getTotalRevenue(),s=await this.getTotalDownloads();return s>0?t/s:0}}const ox=new v7,iE=({className:r=""})=>{const[t,s]=p.useState(null),[a,n]=p.useState([]),[i,o]=p.useState(null),[c,d]=p.useState(!0),[h,m]=p.useState(null),[f,g]=p.useState("30d"),[y,b]=p.useState("overview");p.useEffect(()=>{w()},[f]);const w=async()=>{try{d(!0),m(null);const k=new Date,I=new Date;switch(f){case"7d":I.setDate(k.getDate()-7);break;case"30d":I.setDate(k.getDate()-30);break;case"90d":I.setDate(k.getDate()-90);break;case"1y":I.setFullYear(k.getFullYear()-1);break}const[T,O,U]=await Promise.all([ox.getDashboardAnalytics({start:I,end:k}),ox.getTemplatePerformance(),ox.getRevenueAnalytics()]);s(T),n(O),o(U)}catch(k){console.error("Error loading analytics:",k),m(k instanceof Error?k.message:"Failed to load analytics")}finally{d(!1)}},S=k=>new Intl.NumberFormat("en-SG",{style:"currency",currency:"SGD"}).format(k),N=k=>new Intl.NumberFormat("en-SG").format(k),v=k=>`${k.toFixed(1)}%`,j=k=>k>0?e.jsx(R5,{className:"h-4 w-4 text-green-500"}):k<0?e.jsx(T5,{className:"h-4 w-4 text-red-500"}):e.jsx(cN,{className:"h-4 w-4 text-gray-500"});if(c)return e.jsxs("div",{className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_s,{className:"h-8 w-64"}),e.jsx(_s,{className:"h-10 w-32"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((k,I)=>e.jsx(_s,{className:"h-32"},I))}),e.jsx(_s,{className:"h-96"})]});if(h||!t)return e.jsx("div",{className:r,children:e.jsx(vt,{children:e.jsx(wt,{children:h||"Failed to load analytics data. Please try again."})})});const C=[{title:"Total Templates",value:N(t.totalTemplates),change:"+12%",changeValue:12,icon:Fe,color:"text-blue-600"},{title:"Total Downloads",value:N(t.totalDownloads),change:"+8.5%",changeValue:8.5,icon:fs,color:"text-green-600"},{title:"Total Revenue",value:S(t.totalRevenue),change:"+15.2%",changeValue:15.2,icon:Ph,color:"text-purple-600"},{title:"Active Users",value:N(t.totalUsers),change:"+6.8%",changeValue:6.8,icon:es,color:"text-orange-600"}];return e.jsxs("div",{className:`space-y-6 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Template Analytics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights into template marketplace performance"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(it,{value:f,onValueChange:g,children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"7d",children:"Last 7 days"}),e.jsx(ne,{value:"30d",children:"Last 30 days"}),e.jsx(ne,{value:"90d",children:"Last 90 days"}),e.jsx(ne,{value:"1y",children:"Last year"})]})]}),e.jsxs(R,{variant:"outline",onClick:w,disabled:c,children:[e.jsx(mr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:C.map((k,I)=>e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:k.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:k.value}),e.jsxs("div",{className:"flex items-center mt-2",children:[j(k.changeValue),e.jsx("span",{className:`text-sm ml-1 ${k.changeValue>0?"text-green-600":k.changeValue<0?"text-red-600":"text-gray-600"}`,children:k.change}),e.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"vs last period"})]})]}),e.jsx(k.icon,{className:`h-8 w-8 ${k.color}`})]})})},I))}),e.jsxs(fr,{value:y,onValueChange:b,children:[e.jsxs(nr,{className:"grid w-full grid-cols-4",children:[e.jsx(Ge,{value:"overview",children:"Overview"}),e.jsx(Ge,{value:"performance",children:"Performance"}),e.jsx(Ge,{value:"revenue",children:"Revenue"}),e.jsx(Ge,{value:"engagement",children:"Engagement"})]}),e.jsxs(He,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Wa,{className:"h-5 w-5"}),"Popular Templates"]}),e.jsx(ye,{children:"Top performing templates by downloads"})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:t.popularTemplates.slice(0,5).map((k,I)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:I+1})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:k.title}),e.jsx("p",{className:"text-sm text-gray-500",children:k.category})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:N(k.downloadCount)}),e.jsx("p",{className:"text-sm text-gray-500",children:"downloads"})]})]},k.id))})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ba,{className:"h-5 w-5"}),"Category Performance"]}),e.jsx(ye,{children:"Downloads and revenue by category"})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:t.categoryStats.slice(0,5).map(k=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:k.categoryName}),e.jsxs("span",{className:"text-sm text-gray-500",children:[N(k.downloadCount)," downloads"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(k.downloadCount/Math.max(...t.categoryStats.map(I=>I.downloadCount))*100,100)}%`}})})]},k.categoryId))})})]})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Download Format Preferences"}),e.jsx(ye,{children:"User preferences for document formats"})]}),e.jsx(z,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.formatStats.map(k=>e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:v(k.percentage)}),e.jsx("div",{className:"text-sm text-gray-600 uppercase tracking-wide",children:k.format}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[N(k.count)," downloads"]})]},k.format))})})]})]}),e.jsx(He,{value:"performance",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Template Performance Metrics"}),e.jsx(ye,{children:"Detailed performance analysis for all templates"})]}),e.jsx(z,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Template"}),e.jsx("th",{className:"text-right p-2",children:"Views"}),e.jsx("th",{className:"text-right p-2",children:"Downloads"}),e.jsx("th",{className:"text-right p-2",children:"Conversion"}),e.jsx("th",{className:"text-right p-2",children:"Revenue"}),e.jsx("th",{className:"text-right p-2",children:"Rating"})]})}),e.jsx("tbody",{children:a.slice(0,10).map(k=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.title}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Updated ",Vt(k.lastUpdated,{addSuffix:!0})]})]})}),e.jsx("td",{className:"text-right p-2",children:N(k.views)}),e.jsx("td",{className:"text-right p-2",children:N(k.downloads)}),e.jsx("td",{className:"text-right p-2",children:v(k.conversionRate)}),e.jsx("td",{className:"text-right p-2",children:S(k.revenue)}),e.jsx("td",{className:"text-right p-2",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(Ot,{className:"h-4 w-4 text-yellow-400 fill-current"}),k.rating.toFixed(1)]})})]},k.templateId))})]})})})]})}),e.jsx(He,{value:"revenue",className:"space-y-6",children:i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Monthly Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S(i.monthlyRevenue)}),e.jsxs("div",{className:"flex items-center mt-1",children:[j(i.revenueGrowth),e.jsx("span",{className:`text-sm ml-1 ${i.revenueGrowth>0?"text-green-600":"text-red-600"}`,children:v(i.revenueGrowth)})]})]}),e.jsx(Ph,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Average Order Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S(i.averageOrderValue)})]}),e.jsx(Ba,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S(i.totalRevenue)})]}),e.jsx(Wa,{className:"h-8 w-8 text-purple-600"})]})})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Top Revenue Generating Templates"}),e.jsx(ye,{children:"Templates contributing most to revenue"})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:i.topRevenueTemplates.map((k,I)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-green-600",children:I+1})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:k.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[N(k.downloads)," downloads"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-bold text-green-600",children:S(k.revenue)})})]},k.templateId))})})]})]})}),e.jsx(He,{value:"engagement",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[t.userEngagement.averageSessionDuration,"s"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Session Duration"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v(t.userEngagement.bounceRate)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Bounce Rate"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v(t.userEngagement.conversionRate)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Conversion Rate"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v(t.userEngagement.repeatUsers)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Repeat Users"})]})})})]})})]})]})},w7=()=>{const[r,t]=p.useState("overview"),{hasPermission:s}=Xd(),{canAccessAdmin:a}=m7(),{profile:n}=ft();if(!a())return e.jsx(la,{children:e.jsx($,{children:e.jsxs(z,{className:"text-center py-12",children:[e.jsx(vs,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have permission to access the admin dashboard."}),e.jsx(R,{onClick:()=>window.history.back(),children:"Go Back"})]})})});const i=[{title:"Total Users",value:"1,250",description:"+12% from last month",icon:es,color:"text-blue-600",permission:$t.USERS_READ},{title:"Pending Reviews",value:"23",description:"Awaiting moderation",icon:Ft,color:"text-yellow-600",permission:$t.LAW_FIRMS_MODERATE_REVIEWS},{title:"System Health",value:"99.9%",description:"Uptime this month",icon:ji,color:"text-green-600",permission:$t.SYSTEM_MONITORING},{title:"Active Sessions",value:"89",description:"Currently online",icon:Ba,color:"text-purple-600",permission:$t.SYSTEM_ANALYTICS}],o=[{title:"Manage Users",description:"Add, edit, or remove user accounts",icon:es,action:()=>t("users"),permission:$t.USERS_READ},{title:"Content Moderation",description:"Review and moderate user content",icon:xx,action:()=>t("moderation"),permission:$t.LAW_FIRMS_MODERATE_REVIEWS},{title:"System Monitoring",description:"Monitor system health and performance",icon:ji,action:()=>t("monitoring"),permission:$t.SYSTEM_MONITORING},{title:"Law Firm Management",description:"Manage law firm listings and verifications",icon:Rh,action:()=>t("lawfirms"),permission:$t.LAW_FIRMS_VERIFY},{title:"Template Management",description:"Manage legal document templates",icon:Fe,action:()=>t("templates"),permission:$t.TEMPLATES_MANAGE},{title:"Analytics Dashboard",description:"View template marketplace analytics",icon:Ba,action:()=>t("analytics"),permission:$t.SYSTEM_ANALYTICS}],c=[{id:"overview",label:"Overview",icon:Ba,permission:null},{id:"users",label:"Users",icon:es,permission:$t.USERS_READ},{id:"moderation",label:"Moderation",icon:xx,permission:$t.LAW_FIRMS_MODERATE_REVIEWS},{id:"lawfirms",label:"Law Firms",icon:Rh,permission:$t.LAW_FIRMS_VERIFY},{id:"templates",label:"Templates",icon:Fe,permission:$t.TEMPLATES_MANAGE},{id:"analytics",label:"Analytics",icon:Ba,permission:$t.SYSTEM_ANALYTICS},{id:"monitoring",label:"Monitoring",icon:ji,permission:$t.SYSTEM_MONITORING}].filter(d=>!d.permission||s(d.permission));return e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Welcome back, ",(n==null?void 0:n.full_name)||(n==null?void 0:n.email)]})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(R,{variant:"outline",children:[e.jsx(Ei,{className:"h-4 w-4 mr-2"}),"Settings"]})})]}),e.jsxs(fr,{value:r,onValueChange:t,children:[e.jsx(nr,{className:`grid w-full grid-cols-${c.length}`,children:c.map(d=>e.jsxs(Ge,{value:d.id,className:"flex items-center space-x-2",children:[e.jsx(d.icon,{className:"h-4 w-4"}),e.jsx("span",{children:d.label})]},d.id))}),e.jsxs(He,{value:"overview",className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:i.filter(d=>!d.permission||s(d.permission)).map((d,h)=>e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:d.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.value}),e.jsx("p",{className:"text-xs text-gray-500",children:d.description})]}),e.jsx(d.icon,{className:`h-8 w-8 ${d.color}`})]})})},h))}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Quick Actions"}),e.jsx(ye,{children:"Common administrative tasks and shortcuts"})]}),e.jsx(z,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.filter(d=>!d.permission||s(d.permission)).map((d,h)=>e.jsxs(R,{variant:"outline",className:"h-auto p-4 flex flex-col items-center space-y-2",onClick:d.action,children:[e.jsx(d.icon,{className:"h-6 w-6"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:d.title}),e.jsx("p",{className:"text-xs text-gray-500",children:d.description})]})]},h))})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center space-x-2",children:[e.jsx(It,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{children:"System Alerts"})]}),e.jsx(ye,{children:"Important notifications and system status updates"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx(It,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"AI Service Performance"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Response times are slightly elevated. Monitoring the situation."})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(Fe,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"Content Moderation Queue"}),e.jsx("p",{className:"text-sm text-blue-700",children:"23 items pending review in the moderation queue."})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(ji,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800",children:"System Update Complete"}),e.jsx("p",{className:"text-sm text-green-700",children:"Successfully deployed security updates with zero downtime."})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Recent User Activity"})}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"New user registrations"}),e.jsx("span",{className:"font-medium",children:"+15 today"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Documents uploaded"}),e.jsx("span",{className:"font-medium",children:"234 today"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Templates generated"}),e.jsx("span",{className:"font-medium",children:"45 today"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"AI chat sessions"}),e.jsx("span",{className:"font-medium",children:"89 today"})]})]})})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"System Performance"})}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Average response time"}),e.jsx("span",{className:"font-medium text-green-600",children:"120ms"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Error rate"}),e.jsx("span",{className:"font-medium text-green-600",children:"0.02%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"CPU usage"}),e.jsx("span",{className:"font-medium text-yellow-600",children:"45%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Memory usage"}),e.jsx("span",{className:"font-medium text-yellow-600",children:"67%"})]})]})})]})]})]}),s($t.USERS_READ)&&e.jsx(He,{value:"users",children:e.jsx(f7,{})}),s($t.LAW_FIRMS_MODERATE_REVIEWS)&&e.jsx(He,{value:"moderation",children:e.jsx(p7,{})}),s($t.LAW_FIRMS_VERIFY)&&e.jsx(He,{value:"lawfirms",children:e.jsx(g7,{})}),s($t.TEMPLATES_MANAGE)&&e.jsx(He,{value:"templates",children:e.jsx(y7,{})}),s($t.SYSTEM_ANALYTICS)&&e.jsx(He,{value:"analytics",children:e.jsx(iE,{})}),s($t.SYSTEM_MONITORING)&&e.jsx(He,{value:"monitoring",children:e.jsx(x7,{})})]})]})})};var oE="basil",j7=function(t){return t===3?"v3":t},lE="https://js.stripe.com",b7="".concat(lE,"/").concat(oE,"/stripe.js"),_7=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,N7=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,e_="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",S7=function(t){return _7.test(t)||N7.test(t)},k7=function(){for(var t=document.querySelectorAll('script[src^="'.concat(lE,'"]')),s=0;s<t.length;s++){var a=t[s];if(S7(a.src))return a}return null},t_=function(t){var s="",a=document.createElement("script");a.src="".concat(b7).concat(s);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(a),a},C7=function(t,s){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"7.3.1",startTime:s})},Lc=null,mh=null,fh=null,E7=function(t){return function(s){t(new Error("Failed to load Stripe.js",{cause:s}))}},A7=function(t,s){return function(){window.Stripe?t(window.Stripe):s(new Error("Stripe.js not available"))}},T7=function(t){return Lc!==null?Lc:(Lc=new Promise(function(s,a){if(typeof window>"u"||typeof document>"u"){s(null);return}if(window.Stripe&&t&&console.warn(e_),window.Stripe){s(window.Stripe);return}try{var n=k7();if(n&&t)console.warn(e_);else if(!n)n=t_(t);else if(n&&fh!==null&&mh!==null){var i;n.removeEventListener("load",fh),n.removeEventListener("error",mh),(i=n.parentNode)===null||i===void 0||i.removeChild(n),n=t_(t)}fh=A7(s,a),mh=E7(a),n.addEventListener("load",fh),n.addEventListener("error",mh)}catch(o){a(o);return}}),Lc.catch(function(s){return Lc=null,Promise.reject(s)}))},R7=function(t,s,a){if(t===null)return null;var n=s[0],i=n.match(/^pk_test/),o=j7(t.version),c=oE;i&&o!==c&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("7.3.1"," expected Stripe.js@").concat(c,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var d=t.apply(void 0,s);return C7(d,a),d},Uc,cE=!1,dE=function(){return Uc||(Uc=T7(null).catch(function(t){return Uc=null,Promise.reject(t)}),Uc)};Promise.resolve().then(function(){return dE()}).catch(function(r){cE||console.warn(r)});var P7=function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];cE=!0;var n=Date.now();return dE().then(function(i){return R7(i,s,n)})};let lx;const I7=()=>(lx||(lx=P7(sr.stripe.publishableKey||"")),lx);class D7{constructor(){rs(this,"stripe");this.stripe=I7()}async createSubscription(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("User must be authenticated to create subscription");const{data:a,error:n}=await D.functions.invoke("create-subscription",{body:{priceId:t.priceId,successUrl:t.successUrl||`${window.location.origin}/dashboard?subscription=success`,cancelUrl:t.cancelUrl||`${window.location.origin}/pricing?subscription=cancelled`,metadata:t.metadata||{}}});if(n)throw console.error("Error creating subscription:",n),new Error(n.message||"Failed to create subscription");if(!(a!=null&&a.url))throw new Error("No checkout URL returned from server");window.location.href=a.url}getPriceId(t,s="monthly"){const a=zM[t];if(!a)throw new Error(`No price configuration found for tier: ${t}`);const n=s==="yearly"?a.yearly:a.monthly;if(!n)throw new Error(`No price ID found for ${t} ${s}`);return n}async subscribeTo(t,s="monthly",a){const n=this.getPriceId(t,s);await this.createSubscription({priceId:n,successUrl:a==null?void 0:a.successUrl,cancelUrl:a==null?void 0:a.cancelUrl,metadata:{tier:t,billing:s,...a==null?void 0:a.metadata}})}async getCurrentSubscription(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");const{data:s,error:a}=await D.functions.invoke("get-subscription",{body:{userId:t.id}});if(a)throw console.error("Error fetching subscription:",a),new Error(a.message||"Failed to fetch subscription");return(s==null?void 0:s.subscription)||null}async cancelSubscription(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");const{error:s}=await D.functions.invoke("cancel-subscription",{body:{userId:t.id}});if(s)throw console.error("Error cancelling subscription:",s),new Error(s.message||"Failed to cancel subscription")}async reactivateSubscription(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");const{error:s}=await D.functions.invoke("reactivate-subscription",{body:{userId:t.id}});if(s)throw console.error("Error reactivating subscription:",s),new Error(s.message||"Failed to reactivate subscription")}async createBillingPortalSession(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("User must be authenticated");const{data:a,error:n}=await D.functions.invoke("create-billing-portal",{body:{returnUrl:(t==null?void 0:t.returnUrl)||`${window.location.origin}/dashboard/subscription`}});if(n)throw console.error("Error creating billing portal session:",n),new Error(n.message||"Failed to create billing portal session");if(!(a!=null&&a.url))throw new Error("No billing portal URL returned from server");window.location.href=a.url}async updateSubscription(t,s="monthly"){const{data:{user:a}}=await D.auth.getUser();if(!a)throw new Error("User must be authenticated");const n=this.getPriceId(t,s),{error:i}=await D.functions.invoke("update-subscription",{body:{userId:a.id,newPriceId:n,metadata:{tier:t,billing:s}}});if(i)throw console.error("Error updating subscription:",i),new Error(i.message||"Failed to update subscription")}async getUsageInfo(){const{data:{user:t}}=await D.auth.getUser();if(!t)throw new Error("User must be authenticated");const{data:s,error:a}=await D.functions.invoke("get-usage-info",{body:{userId:t.id}});if(a)throw console.error("Error fetching usage info:",a),new Error(a.message||"Failed to fetch usage information");return s}}const ci=new D7,F7=()=>{const[r,t]=p.useState(null),[s,a]=p.useState(null),[n,i]=p.useState(!0),[o,c]=p.useState(!1),{profile:d}=ft(),{toast:h}=Bn();p.useEffect(()=>{m()},[]);const m=async()=>{try{i(!0);const[C,k]=await Promise.all([ci.getCurrentSubscription(),ci.getUsageInfo()]);t(C),a(k)}catch(C){console.error("Error loading subscription data:",C),h({title:"Error",description:"Failed to load subscription information",variant:"destructive"})}finally{i(!1)}},f=async C=>{try{c(!0),await ci.subscribeTo(C)}catch(k){console.error("Error upgrading subscription:",k),h({title:"Error",description:"Failed to upgrade subscription",variant:"destructive"})}finally{c(!1)}},g=async()=>{try{c(!0),await ci.cancelSubscription(),await m(),h({title:"Success",description:"Subscription cancelled. You can continue using your plan until the end of the billing period."})}catch(C){console.error("Error cancelling subscription:",C),h({title:"Error",description:"Failed to cancel subscription",variant:"destructive"})}finally{c(!1)}},y=async()=>{try{c(!0),await ci.reactivateSubscription(),await m(),h({title:"Success",description:"Subscription reactivated successfully."})}catch(C){console.error("Error reactivating subscription:",C),h({title:"Error",description:"Failed to reactivate subscription",variant:"destructive"})}finally{c(!1)}},b=async()=>{try{c(!0),await ci.createBillingPortalSession()}catch(C){console.error("Error opening billing portal:",C),h({title:"Error",description:"Failed to open billing portal",variant:"destructive"})}finally{c(!1)}},w=(C,k)=>k===-1?0:Math.min(C/k*100,100),S=C=>{switch(C){case"active":return e.jsx(Ue,{className:"h-5 w-5 text-green-500"});case"canceled":case"incomplete":return e.jsx(Qs,{className:"h-5 w-5 text-red-500"});default:return e.jsx(is,{className:"h-5 w-5 text-yellow-500"})}},N=C=>{switch(C){case"premium":return e.jsx(Nr,{className:"h-5 w-5 text-blue-500"});case"pro":return e.jsx(jo,{className:"h-5 w-5 text-purple-500"});default:return e.jsx(Ot,{className:"h-5 w-5 text-gray-500"})}};if(n)return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-32 bg-gray-100 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-48 bg-gray-100 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-32 bg-gray-100 rounded-lg animate-pulse"})]});const v=(d==null?void 0:d.subscription_tier)||"free",j=Pn[v];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[N(v),e.jsxs("div",{children:[e.jsx(X,{className:"text-xl",children:"Current Plan"}),e.jsx(ye,{children:"Manage your subscription and billing"})]})]}),r&&S(r.status)]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold capitalize",children:j.name}),e.jsx("p",{className:"text-sm text-gray-600",children:j.price===0?"Free forever":j.price===null?"Custom pricing":`$${j.price}/${j.period}`})]}),e.jsx(ae,{variant:(r==null?void 0:r.status)==="active"?"default":"secondary",children:(r==null?void 0:r.status)||"Free"})]}),r&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Billing Period"}),e.jsxs("span",{children:[new Date(r.current_period_start*1e3).toLocaleDateString()," - "," ",new Date(r.current_period_end*1e3).toLocaleDateString()]})]}),r.cancel_at_period_end&&e.jsxs(vt,{children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx(wt,{children:"Your subscription will be cancelled at the end of the current billing period."})]})]}),e.jsx(Ts,{}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[v==="free"&&e.jsxs(e.Fragment,{children:[e.jsxs(R,{onClick:()=>f("premium"),disabled:o,children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Upgrade to Premium"]}),e.jsxs(R,{variant:"outline",onClick:()=>f("pro"),disabled:o,children:[e.jsx(jo,{className:"h-4 w-4 mr-2"}),"Upgrade to Pro"]})]}),v==="premium"&&e.jsxs(R,{variant:"outline",onClick:()=>f("pro"),disabled:o,children:[e.jsx(jo,{className:"h-4 w-4 mr-2"}),"Upgrade to Pro"]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs(R,{variant:"outline",onClick:b,disabled:o,children:[e.jsx(Ei,{className:"h-4 w-4 mr-2"}),"Manage Billing"]}),r.cancel_at_period_end?e.jsx(R,{variant:"outline",onClick:y,disabled:o,children:"Reactivate Subscription"}):e.jsx(R,{variant:"destructive",onClick:g,disabled:o,children:"Cancel Subscription"})]})]})]})]}),s&&e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(Wa,{className:"h-5 w-5 mr-2"}),"Usage This Month"]}),e.jsx(ye,{children:"Track your usage against plan limits"})]}),e.jsx(z,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"AI Queries"}),e.jsxs("span",{children:[s.current.aiQueries||0," / ",s.limits.aiQueries===-1?"∞":s.limits.aiQueries]})]}),e.jsx(na,{value:w(s.current.aiQueries||0,s.limits.aiQueries),className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Document Downloads"}),e.jsxs("span",{children:[s.current.documentDownloads||0," / ",s.limits.documentDownloads===-1?"∞":s.limits.documentDownloads]})]}),e.jsx(na,{value:w(s.current.documentDownloads||0,s.limits.documentDownloads),className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Custom Documents"}),e.jsxs("span",{children:[s.current.customDocuments||0," / ",s.limits.customDocuments===-1?"∞":s.limits.customDocuments||0]})]}),e.jsx(na,{value:w(s.current.customDocuments||0,s.limits.customDocuments||0),className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Document Uploads"}),e.jsxs("span",{children:[s.current.documentUploads||0," / ",s.limits.documentUploads===-1?"∞":s.limits.documentUploads]})]}),e.jsx(na,{value:w(s.current.documentUploads||0,s.limits.documentUploads),className:"h-2"})]})]})})]})]})},O7=()=>e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Subscription"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your subscription, billing, and usage"})]}),e.jsx(F7,{})]})}),M7=({onSetupComplete:r})=>{const{user:t,refreshProfile:s}=ft(),[a,n]=p.useState(null),[i,o]=p.useState(null),[c,d]=p.useState(!1),[h,m]=p.useState(""),[f,g]=p.useState(!1),[y,b]=p.useState(!1),[w,S]=p.useState(""),[N,v]=p.useState(!1),[j,C]=p.useState("setup");p.useEffect(()=>{k()},[]);const k=async()=>{try{const M=await no.getTwoFactorStatus();n(M)}catch(M){console.error("Error loading 2FA status:",M),te.error("Failed to load 2FA status")}},I=async()=>{d(!0);try{const M=await no.setupTwoFactor();o(M),C("verify"),te.success("2FA setup initiated. Please scan the QR code with your authenticator app.")}catch(M){console.error("Error setting up 2FA:",M),te.error(M.message||"Failed to setup 2FA")}finally{d(!1)}},T=async()=>{if(!(!i||!h)){g(!0);try{await no.enableTwoFactor(h,i.secret),await s(),await k(),b(!0),C("backup"),te.success("Two-factor authentication enabled successfully!"),r==null||r()}catch(M){console.error("Error verifying 2FA:",M),te.error(M.message||"Invalid verification code")}finally{g(!1)}}},O=async()=>{if(w){v(!0);try{await no.disableTwoFactor(w),await s(),await k(),S(""),te.success("Two-factor authentication disabled")}catch(M){console.error("Error disabling 2FA:",M),te.error(M.message||"Failed to disable 2FA")}finally{v(!1)}}},U=async()=>{try{const M=await no.generateBackupCodes();o(se=>se?{...se,backupCodes:M}:null),te.success("New backup codes generated")}catch(M){console.error("Error generating backup codes:",M),te.error(M.message||"Failed to generate backup codes")}},A=M=>{navigator.clipboard.writeText(M),te.success("Copied to clipboard")},L=()=>{if(!(i!=null&&i.backupCodes))return;const M=`LawMattersSG - Two-Factor Authentication Backup Codes

Generated: ${new Date().toLocaleString()}
User: ${t==null?void 0:t.email}

Backup Codes:
${i.backupCodes.map((K,Y)=>`${Y+1}. ${K}`).join(`
`)}

Important:
- Store these codes in a safe place
- Each code can only be used once
- Use these codes if you lose access to your authenticator app`,se=new Blob([M],{type:"text/plain"}),W=URL.createObjectURL(se),q=document.createElement("a");q.href=W,q.download=`lawmatterssg-backup-codes-${Date.now()}.txt`,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(W)};return a?e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vs,{className:"h-5 w-5"}),e.jsx(X,{children:"Two-Factor Authentication"})]}),e.jsx(ae,{variant:a.isEnabled?"default":"secondary",children:a.isEnabled?e.jsxs(e.Fragment,{children:[e.jsx(J5,{className:"h-3 w-3 mr-1"}),"Enabled"]}):e.jsxs(e.Fragment,{children:[e.jsx(Np,{className:"h-3 w-3 mr-1"}),"Disabled"]})})]}),e.jsx(ye,{children:"Add an extra layer of security to your account with two-factor authentication"})]}),e.jsx(z,{children:a.isEnabled?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(vt,{children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsxs(wt,{children:["Two-factor authentication is enabled for your account.",a.lastUsed&&` Last used: ${new Date(a.lastUsed).toLocaleString()}`]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",onClick:U,className:"flex-1",children:[e.jsx(Dh,{className:"h-4 w-4 mr-2"}),"Generate New Backup Codes"]}),e.jsxs(cc,{children:[e.jsx(Bd,{asChild:!0,children:e.jsxs(R,{variant:"destructive",children:[e.jsx(Np,{className:"h-4 w-4 mr-2"}),"Disable 2FA"]})}),e.jsxs(Mo,{children:[e.jsxs(Lo,{children:[e.jsx(Uo,{children:"Disable Two-Factor Authentication"}),e.jsx($o,{children:"This will remove the extra security layer from your account. Please enter your password to confirm."})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"disable-password",children:"Password"}),e.jsx(Pe,{id:"disable-password",type:"password",value:w,onChange:M=>S(M.target.value),placeholder:"Enter your password"})]})}),e.jsx(y2,{children:e.jsxs(R,{variant:"destructive",onClick:O,disabled:!w||N,children:[N?e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Np,{className:"h-4 w-4 mr-2"}),"Disable 2FA"]})})]})]})]})]}):e.jsxs(fr,{value:j,onValueChange:C,children:[e.jsxs(nr,{className:"grid w-full grid-cols-3",children:[e.jsx(Ge,{value:"setup",children:"Setup"}),e.jsx(Ge,{value:"verify",disabled:!i,children:"Verify"}),e.jsx(Ge,{value:"backup",disabled:!y,children:"Backup Codes"})]}),e.jsxs(He,{value:"setup",className:"space-y-4",children:[e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:"Two-factor authentication is not enabled. Enable it to add an extra layer of security to your account."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"What you'll need:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• An authenticator app (Google Authenticator, Authy, etc.)"}),e.jsx("li",{children:"• Your smartphone or tablet"}),e.jsx("li",{children:"• A few minutes to complete the setup"})]})]}),e.jsxs(R,{onClick:I,disabled:c,className:"w-full",children:[c?e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Qg,{className:"h-4 w-4 mr-2"}),"Setup Two-Factor Authentication"]})]})]}),e.jsx(He,{value:"verify",className:"space-y-4",children:i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Scan QR Code"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Scan this QR code with your authenticator app"}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:i.qrCodeUrl,alt:"2FA QR Code",className:"border rounded-lg"})}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("p",{children:"Can't scan? Enter this code manually:"}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:i.secret}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>A(i.secret),className:"ml-2",children:e.jsx(sd,{className:"h-3 w-3"})})]})]}),e.jsx(Ts,{}),e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"verification-code",children:"Verification Code"}),e.jsx(Pe,{id:"verification-code",type:"text",value:h,onChange:M=>m(M.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",maxLength:6}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the 6-digit code from your authenticator app"})]}),e.jsxs(R,{onClick:T,disabled:h.length!==6||f,className:"w-full",children:[f?e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Verify and Enable 2FA"]})]})}),e.jsx(He,{value:"backup",className:"space-y-4",children:(i==null?void 0:i.backupCodes)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(vt,{children:[e.jsx(Dh,{className:"h-4 w-4"}),e.jsx(wt,{children:"Save these backup codes in a safe place. You can use them to access your account if you lose your authenticator device."})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm font-mono",children:i.backupCodes.map((M,se)=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border",children:[e.jsx("span",{children:M}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>A(M),children:e.jsx(sd,{className:"h-3 w-3"})})]},se))})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(R,{variant:"outline",onClick:L,className:"flex-1",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Download Codes"]}),e.jsxs(R,{onClick:()=>A(i.backupCodes.join(`
`)),className:"flex-1",children:[e.jsx(sd,{className:"h-4 w-4 mr-2"}),"Copy All"]})]})]})})]})})]}):e.jsx($,{children:e.jsx(z,{className:"flex items-center justify-center py-8",children:e.jsx(ds,{className:"h-6 w-6 animate-spin"})})})},L7=()=>{const{user:r,profile:t,refreshProfile:s}=ft(),[a,n]=p.useState("profile"),[i,o]=p.useState(!1),[c,d]=p.useState({first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",phone:(t==null?void 0:t.phone)||"",company:(t==null?void 0:t.company)||"",job_title:(t==null?void 0:t.job_title)||""}),h=async()=>{o(!0);try{await f1.updateProfile(c),await s(),te.success("Profile updated successfully")}catch(f){console.error("Error updating profile:",f),te.error(f.message||"Failed to update profile")}finally{o(!1)}},m=(f,g)=>{d(y=>({...y,[f]:g}))};return e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your account settings and preferences"})]}),e.jsxs(fr,{value:a,onValueChange:n,children:[e.jsxs(nr,{className:"grid w-full grid-cols-4",children:[e.jsxs(Ge,{value:"profile",className:"flex items-center space-x-2",children:[e.jsx(cn,{className:"h-4 w-4"}),e.jsx("span",{children:"Profile"})]}),e.jsxs(Ge,{value:"security",className:"flex items-center space-x-2",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:"Security"})]}),e.jsxs(Ge,{value:"notifications",className:"flex items-center space-x-2",children:[e.jsx(td,{className:"h-4 w-4"}),e.jsx("span",{children:"Notifications"})]}),e.jsxs(Ge,{value:"preferences",className:"flex items-center space-x-2",children:[e.jsx(yx,{className:"h-4 w-4"}),e.jsx("span",{children:"Preferences"})]})]}),e.jsx(He,{value:"profile",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(cn,{className:"h-5 w-5 mr-2"}),"Personal Information"]}),e.jsx(ye,{children:"Update your personal details and contact information"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"first_name",children:"First Name"}),e.jsx(Pe,{id:"first_name",value:c.first_name,onChange:f=>m("first_name",f.target.value),placeholder:"Enter your first name"})]}),e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"last_name",children:"Last Name"}),e.jsx(Pe,{id:"last_name",value:c.last_name,onChange:f=>m("last_name",f.target.value),placeholder:"Enter your last name"})]})]}),e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"email",children:"Email Address"}),e.jsx(Pe,{id:"email",type:"email",value:(r==null?void 0:r.email)||"",disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed. Contact support if you need to update your email."})]}),e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"phone",children:"Phone Number"}),e.jsx(Pe,{id:"phone",type:"tel",value:c.phone,onChange:f=>m("phone",f.target.value),placeholder:"+65 1234 5678"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"company",children:"Company"}),e.jsx(Pe,{id:"company",value:c.company,onChange:f=>m("company",f.target.value),placeholder:"Your company name"})]}),e.jsxs("div",{children:[e.jsx(Te,{htmlFor:"job_title",children:"Job Title"}),e.jsx(Pe,{id:"job_title",value:c.job_title,onChange:f=>m("job_title",f.target.value),placeholder:"Your job title"})]})]}),e.jsxs(R,{onClick:h,disabled:i,children:[e.jsx(Ci,{className:"h-4 w-4 mr-2"}),i?"Saving...":"Save Changes"]})]})]})}),e.jsxs(He,{value:"security",className:"space-y-6",children:[e.jsx(M7,{}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(Gg,{className:"h-5 w-5 mr-2"}),"Password"]}),e.jsx(ye,{children:"Change your account password"})]}),e.jsx(z,{children:e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx(wt,{children:'Password changes are handled through email verification. Use the "Forgot Password" link on the login page to reset your password.'})]})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(vs,{className:"h-5 w-5 mr-2"}),"Account Security"]}),e.jsx(ye,{children:"Monitor and manage your account security"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Login Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Get notified when someone logs into your account"})]}),e.jsx(R,{variant:"outline",size:"sm",children:"Configure"})]}),e.jsx(Ts,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Active Sessions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage devices that are currently logged in"})]}),e.jsx(R,{variant:"outline",size:"sm",children:"View Sessions"})]})]})]})]}),e.jsx(He,{value:"notifications",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(td,{className:"h-5 w-5 mr-2"}),"Notification Preferences"]}),e.jsx(ye,{children:"Choose how you want to be notified about important updates"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Receive updates via email"})]}),e.jsxs(it,{defaultValue:"important",children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All"}),e.jsx(ne,{value:"important",children:"Important"}),e.jsx(ne,{value:"none",children:"None"})]})]})]}),e.jsx(Ts,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Document Processing"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Notifications when documents are processed"})]}),e.jsxs(it,{defaultValue:"enabled",children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"enabled",children:"Enabled"}),e.jsx(ne,{value:"disabled",children:"Disabled"})]})]})]}),e.jsx(Ts,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Security Alerts"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Important security notifications"})]}),e.jsxs(it,{defaultValue:"enabled",children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"enabled",children:"Enabled"}),e.jsx(ne,{value:"disabled",children:"Disabled"})]})]})]})]}),e.jsxs(R,{children:[e.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Save Preferences"]})]})]})}),e.jsx(He,{value:"preferences",className:"space-y-6",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(yx,{className:"h-5 w-5 mr-2"}),"Display Preferences"]}),e.jsx(ye,{children:"Customize your application experience"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Theme"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choose your preferred theme"})]}),e.jsxs(it,{defaultValue:"light",children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"light",children:"Light"}),e.jsx(ne,{value:"dark",children:"Dark"}),e.jsx(ne,{value:"system",children:"System"})]})]})]}),e.jsx(Ts,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Language"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Select your preferred language"})]}),e.jsxs(it,{defaultValue:"en",children:[e.jsx(rt,{className:"w-32",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"en",children:"English"}),e.jsx(ne,{value:"zh",children:"中文"}),e.jsx(ne,{value:"ms",children:"Bahasa"}),e.jsx(ne,{value:"ta",children:"தமிழ்"})]})]})]}),e.jsx(Ts,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Timezone"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Your local timezone"})]}),e.jsxs(it,{defaultValue:"asia/singapore",children:[e.jsx(rt,{className:"w-48",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"asia/singapore",children:"Asia/Singapore"}),e.jsx(ne,{value:"asia/kuala_lumpur",children:"Asia/Kuala Lumpur"}),e.jsx(ne,{value:"asia/jakarta",children:"Asia/Jakarta"}),e.jsx(ne,{value:"utc",children:"UTC"})]})]})]}),e.jsxs(R,{children:[e.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Save Preferences"]})]})]})})]})]})})},U7=()=>{const{user:r,profile:t}=ft(),[s,a]=p.useState([]),[n,i]=p.useState([]),[o,c]=p.useState(!1),[d,h]=p.useState(!0),[m,f]=p.useState(!1);p.useEffect(()=>{r&&g()},[r]);const g=async()=>{if(r)try{h(!0);const j=await Ni.getUserSessions(r.id);a(j);const C=await Ni.getSecurityEvents(r.id,20);i(C);const k=await no.getTwoFactorStatus();c(k.isEnabled)}catch(j){console.error("Error loading security data:",j),te.error("Failed to load security information")}finally{h(!1)}},y=async j=>{try{await Ni.revokeSession(j),te.success("Session revoked successfully"),await g()}catch(C){console.error("Error revoking session:",C),te.error("Failed to revoke session")}},b=async()=>{if(r)try{const j=s.find(C=>C.isCurrentSession);j&&(await Ni.revokeAllOtherSessions(r.id,j.id),te.success("All other sessions revoked successfully"),await g())}catch(j){console.error("Error revoking sessions:",j),te.error("Failed to revoke other sessions")}},w=j=>{switch(j){case"mobile":return e.jsx(Qg,{className:"h-4 w-4"});case"tablet":return e.jsx(X5,{className:"h-4 w-4"});case"desktop":default:return e.jsx(G5,{className:"h-4 w-4"})}},S=j=>{switch(j){case"login":return e.jsx(Ue,{className:"h-4 w-4 text-green-500"});case"logout":return e.jsx(lN,{className:"h-4 w-4 text-blue-500"});case"failed_login":return e.jsx(Qs,{className:"h-4 w-4 text-red-500"});case"password_change":return e.jsx(vs,{className:"h-4 w-4 text-orange-500"});case"2fa_enabled":case"2fa_disabled":return e.jsx(vs,{className:"h-4 w-4 text-purple-500"});case"suspicious_activity":return e.jsx(It,{className:"h-4 w-4 text-red-500"});default:return e.jsx(vs,{className:"h-4 w-4 text-gray-500"})}},N=j=>{switch(j.eventType){case"login":return"Successful login";case"logout":return"Logged out";case"failed_login":return"Failed login attempt";case"password_change":return"Password changed";case"2fa_enabled":return"Two-factor authentication enabled";case"2fa_disabled":return"Two-factor authentication disabled";case"suspicious_activity":return"Suspicious activity detected";default:return"Security event"}};if(d)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})]})});const v=m?n:n.slice(0,5);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Account Security"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account security settings and monitor activity"})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(vs,{className:"h-5 w-5"}),"Two-Factor Authentication"]}),e.jsx(ye,{children:"Add an extra layer of security to your account"})]}),e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Enabled"}),e.jsx(ae,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Active"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Disabled"}),e.jsx(ae,{variant:"destructive",children:"Inactive"})]})}),e.jsx(R,{variant:o?"outline":"default",size:"sm",children:o?"Manage 2FA":"Enable 2FA"})]})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Active Sessions"}),e.jsx(ye,{children:"Devices and locations where you're currently signed in"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-4",children:[s.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No active sessions found"}):s.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w(j.deviceType),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[j.browser," on ",j.os]}),j.isCurrentSession&&e.jsx(ae,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"Current"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[j.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ia,{className:"h-3 w-3"}),j.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(us,{className:"h-3 w-3"}),"Last active ",Vt(new Date(j.lastActiveAt),{addSuffix:!0})]})]})]})]}),!j.isCurrentSession&&e.jsx(R,{variant:"outline",size:"sm",onClick:()=>y(j.id),children:"Revoke"})]},j.id)),s.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(Ts,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sign out of all other devices and locations"}),e.jsx(R,{variant:"outline",onClick:b,children:"Revoke All Other Sessions"})]})]})]})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Recent Security Activity"}),e.jsx(ye,{children:"Recent security events on your account"})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-4",children:[v.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No recent security activity"}):v.map(j=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[S(j.eventType),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:N(j)}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[j.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ia,{className:"h-3 w-3"}),j.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(us,{className:"h-3 w-3"}),Vt(new Date(j.createdAt),{addSuffix:!0})]})]})]})]},j.id)),n.length>5&&e.jsx("div",{className:"text-center",children:e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>f(!m),className:"flex items-center gap-2",children:m?e.jsxs(e.Fragment,{children:[e.jsx(Pi,{className:"h-4 w-4"}),"Show Less"]}):e.jsxs(e.Fragment,{children:[e.jsx(Gt,{className:"h-4 w-4"}),"Show All (",n.length," events)"]})})})]})})]}),!o&&e.jsxs(vt,{children:[e.jsx(It,{className:"h-4 w-4"}),e.jsxs(wt,{children:[e.jsx("strong",{children:"Security Recommendation:"})," Enable two-factor authentication to add an extra layer of security to your account."]})]})]})},$7=()=>e.jsx(Ey,{children:e.jsx(la,{children:e.jsx("div",{className:"container mx-auto py-6",children:e.jsx(U7,{})})})}),z7=()=>{const{tier:r}=Fi(),[t]=Dd(),s=ps(),{user:a}=ft(),{toast:n}=Bn(),[i,o]=p.useState(t.get("billing")==="yearly"),[c,d]=p.useState(!1),[h,m]=p.useState(null);p.useEffect(()=>{if(!a){s("/auth/login");return}if(!r||!["premium","pro"].includes(r)){s("/pricing");return}},[a,r,s]);const f=async()=>{if(!r||!["premium","pro"].includes(r)){m("Invalid subscription tier");return}try{d(!0),m(null),await ci.subscribeTo(r,i?"yearly":"monthly",{successUrl:`${window.location.origin}/payment/success`,cancelUrl:`${window.location.origin}/pricing?subscription=cancelled`,metadata:{source:"subscribe_page"}})}catch(v){console.error("Subscription error:",v),m(v instanceof Error?v.message:"Failed to start subscription process"),n({title:"Subscription Error",description:"Failed to start subscription process. Please try again.",variant:"destructive"})}finally{d(!1)}};if(!a||!r||!["premium","pro"].includes(r))return null;const g=Pn[r],y=g.price||0,b=Math.round(y*10),w=i?b:y,S=i?y*12-b:0,N=()=>{switch(r){case"premium":return e.jsx(Nr,{className:"h-8 w-8 text-blue-500"});case"pro":return e.jsx(jo,{className:"h-8 w-8 text-purple-500"});default:return e.jsx(wo,{className:"h-8 w-8 text-gray-500"})}};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:["Subscribe to ",g.name]}),e.jsx("p",{className:"text-xl text-gray-600",children:"Complete your subscription to unlock premium features"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs($,{className:"h-fit",children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[N(),e.jsxs("div",{children:[e.jsxs(X,{className:"text-2xl",children:[g.name," Plan"]}),e.jsxs(ye,{children:["Perfect for ",r==="premium"?"individuals and small businesses":"growing businesses and teams"]})]})]})}),e.jsxs(z,{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:`text-sm font-medium ${i?"text-gray-500":"text-gray-900"}`,children:"Monthly"}),e.jsx(wl,{checked:i,onCheckedChange:o,className:"data-[state=checked]:bg-blue-600"}),e.jsx("span",{className:`text-sm font-medium ${i?"text-gray-900":"text-gray-500"}`,children:"Yearly"}),i&&e.jsxs(ae,{variant:"secondary",className:"bg-green-100 text-green-800",children:["Save $",S]})]})}),e.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-4xl font-bold text-gray-900",children:["$",w]}),e.jsxs("div",{className:"text-gray-600",children:["per ",i?"year":"month"]}),i&&e.jsx("div",{className:"text-sm text-green-600 mt-2",children:"Save 20% with yearly billing"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"What's included:"}),e.jsx("ul",{className:"space-y-2",children:g.features.map((v,j)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(sc,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:v})]},j))})]})]})]}),e.jsxs($,{className:"h-fit",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(wo,{className:"h-5 w-5 mr-2"}),"Complete Your Subscription"]}),e.jsx(ye,{children:"Secure payment powered by Stripe"})]}),e.jsxs(z,{className:"space-y-6",children:[h&&e.jsx(vt,{variant:"destructive",children:e.jsx(wt,{children:h})}),e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-green-50 rounded-lg",children:[e.jsx(vs,{className:"h-5 w-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Secure Payment"}),e.jsx("p",{className:"text-xs text-green-700",children:"Your payment information is encrypted and secure. We use Stripe for payment processing."})]})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Plan"}),e.jsx("span",{className:"text-sm font-medium",children:g.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Billing"}),e.jsx("span",{className:"text-sm font-medium",children:i?"Yearly":"Monthly"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Price"}),e.jsxs("span",{className:"text-sm font-medium",children:["$",w,"/",i?"year":"month"]})]}),i&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{className:"text-sm",children:"Savings"}),e.jsxs("span",{className:"text-sm font-medium",children:["$",S,"/year"]})]})]}),e.jsx(R,{onClick:f,disabled:c,className:"w-full",size:"lg",children:c?e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(wo,{className:"h-4 w-4 mr-2"}),"Subscribe Now"]})}),e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["By subscribing, you agree to our"," ",e.jsx("a",{href:"/terms",className:"underline hover:text-gray-700",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"/privacy",className:"underline hover:text-gray-700",children:"Privacy Policy"}),". You can cancel anytime."]})]})]})]})]}),e.jsx(Ea,{})]})},B7=()=>{const[r]=Dd(),t=ps(),{user:s,profile:a}=ft(),[n,i]=p.useState(null),[o,c]=p.useState(!0);r.get("session_id"),r.get("subscription"),p.useEffect(()=>{if(!s){t("/auth/login");return}d()},[s]);const d=async()=>{try{const f=await ci.getCurrentSubscription();i(f)}catch(f){console.error("Error loading subscription:",f)}finally{c(!1)}},h=()=>{t("/dashboard")},m=()=>{t("/dashboard/subscription")};return s?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-6",children:e.jsx(Ue,{className:"h-8 w-8 text-green-600"})}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Payment Successful!"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Thank you for subscribing to LawMattersSG. Your account has been upgraded successfully."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(wo,{className:"h-5 w-5 mr-2"}),"Subscription Details"]}),e.jsx(ye,{children:"Your new subscription is now active"})]}),e.jsx(z,{className:"space-y-4",children:o?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})]}):n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Plan"}),e.jsx(ae,{variant:"default",className:"capitalize",children:n.tier})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Status"}),e.jsx(ae,{variant:"secondary",className:"capitalize",children:n.status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Next Billing"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(n.current_period_end*1e3).toLocaleDateString()})]})]}):e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Plan"}),e.jsx(ae,{variant:"default",className:"capitalize",children:(a==null?void 0:a.subscription_tier)||"Premium"})]})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(ln,{className:"h-5 w-5 mr-2"}),"What's Next?"]}),e.jsx(ye,{children:"Get started with your new features"})]}),e.jsx(z,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Access Premium Features"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Start using advanced AI tools and templates"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Increased Limits"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Enjoy higher monthly usage limits"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Priority Support"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Get faster response times for support"})]})]})]})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs(R,{onClick:h,size:"lg",className:"flex items-center",children:["Continue to Dashboard",e.jsx(Mn,{className:"h-4 w-4 ml-2"})]}),e.jsx(R,{variant:"outline",onClick:m,size:"lg",children:"Manage Subscription"})]}),e.jsxs("div",{className:"mt-12 p-6 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Important Information"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• You will receive a confirmation email shortly with your receipt"}),e.jsx("li",{children:"• Your subscription will automatically renew at the end of each billing period"}),e.jsx("li",{children:"• You can cancel or modify your subscription at any time from your account settings"}),e.jsx("li",{children:"• If you have any questions, please contact our support team"})]})]})]}),e.jsx(Ea,{})]}):null},q7=()=>{const[r]=Dd(),t=ps(),s=r.get("error"),a=r.get("error_description"),n=()=>{t("/pricing")},i=()=>{t("/dashboard")},o=()=>{window.location.href="mailto:support@lawmatterssg.com?subject=Payment Issue"},c=()=>{switch(s){case"payment_failed":return"Your payment could not be processed. Please check your payment details and try again.";case"card_declined":return"Your card was declined. Please try a different payment method or contact your bank.";case"insufficient_funds":return"Your card has insufficient funds. Please try a different payment method.";case"expired_card":return"Your card has expired. Please update your payment method and try again.";case"processing_error":return"There was an error processing your payment. Please try again in a few minutes.";default:return a||"We encountered an issue processing your payment. Please try again."}};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-6",children:e.jsx(Qs,{className:"h-8 w-8 text-red-600"})}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Payment Failed"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"We couldn't process your payment. Don't worry, no charges were made to your account."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center text-red-600",children:[e.jsx(Qs,{className:"h-5 w-5 mr-2"}),"What Happened?"]}),e.jsx(ye,{children:"Details about the payment issue"})]}),e.jsx(z,{children:e.jsxs(vt,{children:[e.jsx(mx,{className:"h-4 w-4"}),e.jsx(wt,{children:c()})]})})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center",children:[e.jsx(mr,{className:"h-5 w-5 mr-2"}),"What Can You Do?"]}),e.jsx(ye,{children:"Steps to resolve the issue"})]}),e.jsx(z,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Check Your Payment Method"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Ensure your card details are correct and up to date"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Try Again"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Return to pricing and attempt the payment again"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Contact Support"}),e.jsx("p",{className:"text-xs text-gray-600",children:"If the issue persists, our team is here to help"})]})]})]})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[e.jsxs(R,{onClick:n,size:"lg",className:"flex items-center",children:[e.jsx(wo,{className:"h-4 w-4 mr-2"}),"Try Payment Again"]}),e.jsxs(R,{variant:"outline",onClick:o,size:"lg",children:[e.jsx(mx,{className:"h-4 w-4 mr-2"}),"Contact Support"]}),e.jsxs(R,{variant:"ghost",onClick:i,size:"lg",children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Common Payment Issues"}),e.jsx(ye,{children:"Here are some common reasons why payments fail and how to fix them"})]}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Card Issues"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Expired or invalid card"}),e.jsx("li",{children:"• Insufficient funds"}),e.jsx("li",{children:"• Card blocked by bank"}),e.jsx("li",{children:"• Incorrect card details"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Technical Issues"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Network connectivity problems"}),e.jsx("li",{children:"• Browser compatibility issues"}),e.jsx("li",{children:"• Temporary payment processor issues"}),e.jsx("li",{children:"• Security verification required"})]})]})]})})]}),e.jsxs("div",{className:"mt-8 p-6 bg-gray-50 rounded-lg text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Need Help?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Our support team is available to help you resolve any payment issues."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center text-sm text-gray-600",children:[e.jsx("span",{children:"Email: support@lawmatterssg.com"}),e.jsx("span",{className:"hidden sm:inline",children:"•"}),e.jsx("span",{children:"Response time: Within 24 hours"})]})]})]}),e.jsx(Ea,{})]})};class V7{async createShareLink(t,s,a={}){const{data:{user:n}}=await D.auth.getUser();if(!n)throw new Error("Authentication required");const{data:i,error:o}=await D.from("uploaded_documents").select("user_id").eq("id",t).single();if(o||!i)throw new Error("Document not found");if(i.user_id!==n.id)throw new Error("You can only share documents you own");const c=this.generateShareToken(),d=a.expiresIn?new Date(Date.now()+a.expiresIn*60*60*1e3).toISOString():void 0,{data:h,error:m}=await D.from("document_shares").insert({document_id:t,shared_by:n.id,shared_with:a.shareWithEmail?await this.getUserIdByEmail(a.shareWithEmail):null,share_token:c,permissions:s,expires_at:d,is_active:!0,access_count:0}).select().single();if(m)throw new Error(`Failed to create share link: ${m.message}`);return a.shareWithEmail&&await this.sendShareNotification(a.shareWithEmail,n.email||"",t,c,a.message),{token:c,url:`${window.location.origin}/shared/${c}`,permissions:s,expiresAt:d}}async accessSharedDocument(t){const{data:s,error:a}=await D.from("document_shares").select(`
        *,
        document:uploaded_documents(*),
        shared_by_user:profiles!document_shares_shared_by_fkey(email, first_name, last_name)
      `).eq("share_token",t).eq("is_active",!0).single();if(a||!s)throw new Error("Invalid or expired share link");if(s.expires_at&&new Date(s.expires_at)<new Date)throw new Error("Share link has expired");if(s.shared_with){const{data:{user:n}}=await D.auth.getUser();if(!n||n.id!==s.shared_with)throw new Error("You do not have permission to access this document")}return await D.from("document_shares").update({access_count:s.access_count+1,last_accessed:new Date().toISOString()}).eq("id",s.id),{document:s.document,permissions:s.permissions,share:s}}async getDocumentShares(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("Authentication required");const{data:a,error:n}=await D.from("document_shares").select(`
        *,
        shared_with_user:profiles!document_shares_shared_with_fkey(email, first_name, last_name)
      `).eq("document_id",t).eq("shared_by",s.id).order("created_at",{ascending:!1});if(n)throw new Error(`Failed to fetch shares: ${n.message}`);return a||[]}async revokeShare(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("Authentication required");const{error:a}=await D.from("document_shares").update({is_active:!1}).eq("id",t).eq("shared_by",s.id);if(a)throw new Error(`Failed to revoke share: ${a.message}`)}async addComment(t,s,a,n){const{data:{user:i}}=await D.auth.getUser();if(!i)throw new Error("Authentication required");const{data:o,error:c}=await D.from("document_comments").insert({document_id:t,user_id:i.id,content:s,position:a,parent_id:n,is_resolved:!1}).select(`
        *,
        user:profiles(email, first_name, last_name, avatar_url)
      `).single();if(c)throw new Error(`Failed to add comment: ${c.message}`);return o}async getDocumentComments(t){const{data:s,error:a}=await D.from("document_comments").select(`
        *,
        user:profiles(email, first_name, last_name, avatar_url),
        replies:document_comments!parent_id(
          *,
          user:profiles(email, first_name, last_name, avatar_url)
        )
      `).eq("document_id",t).is("parent_id",null).order("created_at",{ascending:!0});if(a)throw new Error(`Failed to fetch comments: ${a.message}`);return s||[]}async resolveComment(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("Authentication required");const{error:a}=await D.from("document_comments").update({is_resolved:!0}).eq("id",t);if(a)throw new Error(`Failed to resolve comment: ${a.message}`)}async startCollaborationSession(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("Authentication required");const{data:a}=await D.from("collaboration_sessions").select("*").eq("document_id",t).eq("is_active",!0).single();if(a)return this.joinCollaborationSession(a.id);const{data:n,error:i}=await D.from("collaboration_sessions").insert({document_id:t,participants:[{user_id:s.id,user_name:s.email,joined_at:new Date().toISOString(),last_seen:new Date().toISOString()}],is_active:!0}).select().single();if(i)throw new Error(`Failed to start collaboration session: ${i.message}`);return n}async joinCollaborationSession(t){const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("Authentication required");const{data:a,error:n}=await D.from("collaboration_sessions").select("*").eq("id",t).single();if(n||!a)throw new Error("Collaboration session not found");const i=a.participants||[];if(!i.find(c=>c.user_id===s.id)){i.push({user_id:s.id,user_name:s.email||"Unknown User",joined_at:new Date().toISOString(),last_seen:new Date().toISOString()});const{error:c}=await D.from("collaboration_sessions").update({participants:i}).eq("id",t);if(c)throw new Error(`Failed to join session: ${c.message}`)}return{...a,participants:i}}generateShareToken(){return crypto.randomUUID().replace(/-/g,"")}async getUserIdByEmail(t){const{data:s}=await D.from("profiles").select("id").eq("email",t).single();return(s==null?void 0:s.id)||null}async sendShareNotification(t,s,a,n,i){console.log("Share notification:",{to:t,from:s,documentId:a,shareToken:n,message:i})}}const cx=new V7,W7=()=>{var A;const{shareToken:r}=Fi(),t=ps(),{toast:s}=Bn(),[a,n]=p.useState(!0),[i,o]=p.useState(null),[c,d]=p.useState(null),[h,m]=p.useState(null),[f,g]=p.useState(null),[y,b]=p.useState([]),[w,S]=p.useState(""),[N,v]=p.useState(!1),[j,C]=p.useState(!1);p.useEffect(()=>{r&&k()},[r]);const k=async()=>{if(r)try{n(!0),o(null);const L=await cx.accessSharedDocument(r);d(L.document),m(L.permissions),g(L.share),L.permissions.canComment&&await I(L.document.id)}catch(L){console.error("Failed to load shared document:",L),o(L instanceof Error?L.message:"Failed to load document")}finally{n(!1)}},I=async L=>{try{const M=await cx.getDocumentComments(L);b(M)}catch(M){console.error("Failed to load comments:",M)}},T=async()=>{if(!(!c||!(h!=null&&h.canDownload)))try{C(!0);const L=await kV.downloadDocument(c.id,{format:"pdf",includeAnalysis:!1}),M=URL.createObjectURL(L.blob),se=c.createElement("a");se.href=M,se.download=L.filename,c.body.appendChild(se),se.click(),c.body.removeChild(se),URL.revokeObjectURL(M),s({title:"Download Started",description:`Downloading ${L.filename}`})}catch(L){console.error("Download failed:",L),s({title:"Download Failed",description:L instanceof Error?L.message:"Failed to download document",variant:"destructive"})}finally{C(!1)}},O=async()=>{if(!(!c||!w.trim()||!(h!=null&&h.canComment)))try{v(!0),await cx.addComment(c.id,w.trim()),S(""),await I(c.id),s({title:"Comment Added",description:"Your comment has been added successfully"})}catch(L){console.error("Failed to add comment:",L),s({title:"Comment Failed",description:L instanceof Error?L.message:"Failed to add comment",variant:"destructive"})}finally{v(!1)}},U=()=>{if(!h)return null;const L=Object.entries(h).filter(([M,se])=>se&&M!=="expiresAt").map(([M])=>{switch(M){case"canView":return{icon:e.jsx(Gt,{className:"h-3 w-3"}),label:"View"};case"canDownload":return{icon:e.jsx(fs,{className:"h-3 w-3"}),label:"Download"};case"canComment":return{icon:e.jsx(Ft,{className:"h-3 w-3"}),label:"Comment"};case"canEdit":return{icon:e.jsx(Fe,{className:"h-3 w-3"}),label:"Edit"};default:return null}}).filter(Boolean);return e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map((M,se)=>e.jsxs(ae,{variant:"outline",className:"flex items-center space-x-1",children:[M==null?void 0:M.icon,e.jsx("span",{children:M==null?void 0:M.label})]},se))})};return a?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ds,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Loading shared document..."})]})}),e.jsx(Ea,{})]}):i?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:e.jsx($,{children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(is,{className:"h-12 w-12 text-red-500 mx-auto"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:i}),e.jsx(R,{onClick:()=>t("/"),children:"Go Home"})]})})})}),e.jsx(Ea,{})]}):!c||!h||!f?null:e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ca,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Od,{className:"h-6 w-6 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Shared Document"})]}),h.canDownload&&e.jsx(R,{onClick:T,disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}),"Downloading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Download"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold",children:c.filename}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Shared by ",((A=f.shared_by_user)==null?void 0:A.email)||"Unknown"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:Vt(new Date(f.created_at),{addSuffix:!0})}),f.expires_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),"Expires ",Vt(new Date(f.expires_at),{addSuffix:!0})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Your permissions:"}),U()]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center",children:[e.jsx(Fe,{className:"h-5 w-5 mr-2"}),"Document Content"]})}),e.jsx(z,{children:c.ocr_text?e.jsx("div",{className:"prose max-w-none",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:c.ocr_text})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Fe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Document content is not available for preview"}),h.canDownload&&e.jsx("p",{className:"text-sm",children:"Download the document to view its contents"})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-base",children:"Document Information"})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Type:"}),e.jsx("span",{className:"text-sm font-medium",children:c.document_type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Size:"}),e.jsxs("span",{className:"text-sm font-medium",children:[(c.file_size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Uploaded:"}),e.jsx("span",{className:"text-sm font-medium",children:Vt(new Date(c.created_at),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx(ae,{variant:c.processing_status==="completed"?"default":"secondary",children:c.processing_status})]})]})]}),h.canComment&&e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"text-base flex items-center",children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Comments (",y.length,")"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Sr,{placeholder:"Add a comment...",value:w,onChange:L=>S(L.target.value),rows:3}),e.jsx(R,{onClick:O,disabled:!w.trim()||N,size:"sm",className:"w-full",children:N?e.jsxs(e.Fragment,{children:[e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Add Comment"]})})]}),e.jsx("div",{className:"space-y-3",children:y.map(L=>{var M,se;return e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(cn,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:((M=L.user)==null?void 0:M.first_name)||((se=L.user)==null?void 0:se.email)||"Anonymous"}),e.jsx("span",{className:"text-xs text-gray-500",children:Vt(new Date(L.created_at),{addSuffix:!0})})]}),e.jsx("p",{className:"text-sm text-gray-700",children:L.content})]},L.id)})})]})]})]})]})]}),e.jsx(Ea,{})]})};function H7({onFileUpload:r,disabled:t=!1,maxFileSize:s=10*1024*1024,allowedTypes:a=["application/pdf","image/jpeg","image/png","image/webp"]}){const[n,i]=p.useState(null),[o,c]=p.useState(null),d=p.useCallback(N=>N.size>s?{valid:!1,error:`File size exceeds limit of ${Math.round(s/(1024*1024))}MB`}:a.includes(N.type)?{valid:!0}:{valid:!1,error:`File type not supported. Allowed types: ${a.map(j=>{switch(j){case"application/pdf":return"PDF";case"image/jpeg":return"JPEG";case"image/png":return"PNG";case"image/webp":return"WebP";default:return j}}).join(", ")}`},[s,a]),h=p.useCallback((N,v)=>{var j,C,k,I;if(c(null),v.length>0){const T=v[0];((C=(j=T.errors)==null?void 0:j[0])==null?void 0:C.code)==="file-too-large"?c(`File size exceeds limit of ${Math.round(s/(1024*1024))}MB`):((I=(k=T.errors)==null?void 0:k[0])==null?void 0:I.code)==="file-invalid-type"?c("File type not supported"):c("File upload failed");return}if(N.length>0){const T=N[0],O=d(T);if(!O.valid){c(O.error||"File validation failed");return}i(T),c(null)}},[s,d]),{getRootProps:m,getInputProps:f,isDragActive:g}=Qm({onDrop:h,accept:{"application/pdf":[".pdf"],"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/webp":[".webp"]},maxSize:s,multiple:!1,disabled:t}),y=()=>{n&&r(n)},b=()=>{i(null),c(null)},w=N=>{if(N===0)return"0 Bytes";const v=1024,j=["Bytes","KB","MB","GB"],C=Math.floor(Math.log(N)/Math.log(v));return parseFloat((N/Math.pow(v,C)).toFixed(2))+" "+j[C]},S=N=>N==="application/pdf"?e.jsx(Fe,{className:"h-8 w-8 text-red-500"}):N.startsWith("image/")?e.jsx(Fe,{className:"h-8 w-8 text-blue-500"}):e.jsx(Fe,{className:"h-8 w-8 text-gray-500"});return e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{className:Ie("border-2 border-dashed transition-colors",g?"border-blue-500 bg-blue-50":"border-gray-300",t&&"opacity-50 cursor-not-allowed"),children:e.jsx(z,{className:"p-8",children:e.jsxs("div",{...m(),className:Ie("text-center cursor-pointer",t&&"cursor-not-allowed"),children:[e.jsx("input",{...f()}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(_r,{className:Ie("h-12 w-12",g?"text-blue-500":"text-gray-400")})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g?"Drop your file here":"Upload Document"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Drag and drop your file here, or click to browse"})]}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(ae,{variant:"secondary",children:"PDF"}),e.jsx(ae,{variant:"secondary",children:"JPEG"}),e.jsx(ae,{variant:"secondary",children:"PNG"}),e.jsx(ae,{variant:"secondary",children:"WebP"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Maximum file size: ",Math.round(s/(1024*1024)),"MB"]})]})]})})}),o&&e.jsxs(vt,{className:"border-red-200 bg-red-50",children:[e.jsx(is,{className:"h-4 w-4 text-red-600"}),e.jsx(wt,{className:"text-red-700",children:o})]}),n&&e.jsx($,{className:"border-green-200 bg-green-50",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[S(n.type),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:n.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[w(n.size)," • ",n.type]})]}),e.jsx(Ue,{className:"h-5 w-5 text-green-600"})]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:b,className:"text-gray-500 hover:text-gray-700",children:e.jsx(Vs,{className:"h-4 w-4"})})]})})}),n&&e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{onClick:y,disabled:t,className:"px-8 py-2 bg-blue-600 hover:bg-blue-700",children:"Analyze Document"})}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Upload Guidelines:"}),e.jsxs("ul",{className:"space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Ensure document text is clear and readable"}),e.jsx("li",{children:"For best results, use high-resolution scans"}),e.jsx("li",{children:"Documents are automatically deleted after 24 hours"}),e.jsx("li",{children:"No personal information is stored permanently"})]})]})]})}class G7{constructor(){rs(this,"config",Wx)}async checkRateLimit(t){try{const{data:s,error:a}=await D.functions.invoke("public-rate-limiter",{body:{ipAddress:t,action:"check"}});return a?(console.error("Rate limiter error:",a),{allowed:!1,remaining:{hourly:0,daily:0},resetTime:{hourly:new Date,daily:new Date},message:"Unable to verify rate limit. Please try again."}):{allowed:s.allowed,remaining:s.remaining,resetTime:{hourly:new Date(s.resetTime.hourly),daily:new Date(s.resetTime.daily)},message:s.message}}catch(s){return console.error("Rate limit check failed:",s),{allowed:!1,remaining:{hourly:0,daily:0},resetTime:{hourly:new Date,daily:new Date},message:"Rate limit check failed. Please try again."}}}async getOrCreateSession(t,s){const a=new Date,n=new Date(a.getTime()+this.config.rateLimits.sessionDuration),{data:i}=await D.from("public_analysis_sessions").select("*").eq("ip_address",t).gt("expires_at",a.toISOString()).order("created_at",{ascending:!1}).limit(1).single();if(i)return{id:i.id,ipAddress:i.ip_address,userAgent:i.user_agent,documentsAnalyzed:i.documents_analyzed,createdAt:new Date(i.created_at),expiresAt:new Date(i.expires_at),totalStorageUsed:i.total_storage_used};const{data:o,error:c}=await D.from("public_analysis_sessions").insert({ip_address:t,user_agent:s,documents_analyzed:0,expires_at:n.toISOString(),total_storage_used:0}).select().single();if(c)throw new Error(`Failed to create session: ${c.message}`);return{id:o.id,ipAddress:o.ip_address,userAgent:o.user_agent,documentsAnalyzed:o.documents_analyzed,createdAt:new Date(o.created_at),expiresAt:new Date(o.expires_at),totalStorageUsed:o.total_storage_used}}validateFile(t){return t.size>this.config.rateLimits.maxFileSize?{valid:!1,error:`File size exceeds limit of ${this.config.rateLimits.maxFileSize/(1024*1024)}MB`}:this.config.rateLimits.allowedFileTypes.includes(t.type)?{valid:!0}:{valid:!1,error:`File type ${t.type} is not supported. Allowed types: PDF, JPEG, PNG, WebP`}}async analyzeDocument(t,s,a){const n=this.validateFile(t);if(!n.valid)throw new Error(n.error);const i=await this.checkRateLimit(a);if(!i.allowed)throw new Error(i.message||"Rate limit exceeded");try{const o=await this.fileToBase64(t),{data:c,error:d}=await D.functions.invoke("public-document-analysis",{body:{sessionId:s,ipAddress:a,filename:t.name,fileSize:t.size,fileType:t.type,fileContent:o}});if(d)throw new Error(`Analysis service error: ${d.message}`);if(!c.success)throw new Error(c.error??"Analysis failed");const h=await this.getAnalysisResult(c.analysisId);if(!h)throw new Error("Failed to retrieve analysis result");return h}catch(o){throw console.error("Error analyzing document:",o),new Error(`Analysis failed: ${o instanceof Error?o.message:"Unknown error"}`)}}async fileToBase64(t){return new Promise((s,a)=>{const n=new FileReader;n.onload=()=>{const o=n.result.split(",")[1];s(o)},n.onerror=()=>a(new Error("Failed to read file")),n.readAsDataURL(t)})}async getAnalysisResult(t){const{data:s,error:a}=await D.from("public_document_analyses").select("*").eq("id",t).gt("expires_at",new Date().toISOString()).single();return a||!s?null:{id:s.id,sessionId:s.session_id,filename:s.filename,fileSize:s.file_size,fileType:s.file_type,analysisResult:s.analysis_result,createdAt:new Date(s.created_at),expiresAt:new Date(s.expires_at)}}async cleanupExpiredData(){const t=new Date().toISOString();await D.from("public_document_analyses").delete().lt("expires_at",t),await D.from("public_analysis_sessions").delete().lt("expires_at",t)}}const so=new G7;class K7{constructor(){rs(this,"sessionId",null);rs(this,"sessionStartTime",Date.now())}async initializeSession(){return this.sessionId?this.sessionId:(this.sessionId=crypto.randomUUID(),this.sessionStartTime=Date.now(),await this.trackEvent("session_start",{timestamp:new Date().toISOString(),user_agent:navigator.userAgent,screen_resolution:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language}),this.sessionId)}async trackEvent(t,s={}){try{this.sessionId||await this.initializeSession();const a={event_type:t,event_data:{...s,session_duration:Date.now()-this.sessionStartTime},session_id:this.sessionId,ip_address:await this.getClientIP(),user_agent:navigator.userAgent,page_url:window.location.href,referrer:document.referrer||null,timestamp:new Date().toISOString()},{error:n}=await D.from("public_analytics_events").insert(a);n&&console.error("Analytics tracking error:",n),await this.sendToExternalAnalytics(a)}catch(a){console.error("Failed to track event:",a)}}async trackPageView(t,s={}){await this.trackEvent("page_view",{page_name:t,...s})}async trackDocumentUpload(t,s,a){var n;await this.trackEvent("document_upload",{file_size:t,file_type:s,file_name_length:a.length,file_extension:(n=a.split(".").pop())==null?void 0:n.toLowerCase()})}async trackAnalysisComplete(t,s,a,n){await this.trackEvent("analysis_complete",{analysis_id:t,processing_time:s,document_type:a,text_length:n})}async trackConversion(t,s={}){await this.trackEvent("conversion",{conversion_type:t,...s})}async trackInteraction(t,s,a={}){await this.trackEvent("user_interaction",{interaction_type:t,element:s,...a})}async trackError(t,s,a={}){await this.trackEvent("error",{error_type:t,error_message:s,...a})}async trackRateLimit(t,s){await this.trackEvent("rate_limit_hit",{limit_type:t,remaining_quota:s})}async getConversionFunnel(t){try{const{data:s,error:a}=await D.rpc("get_conversion_funnel",{start_date:t.start,end_date:t.end});return a?(console.error("Error getting conversion funnel:",a),[]):s||[]}catch(s){return console.error("Failed to get conversion funnel:",s),[]}}async getUsageMetrics(t){try{const{data:s,error:a}=await D.rpc("get_usage_metrics",{start_date:t.start,end_date:t.end});return a?(console.error("Error getting usage metrics:",a),null):s}catch(s){return console.error("Failed to get usage metrics:",s),null}}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"127.0.0.1"}}async sendToExternalAnalytics(t){try{typeof gtag<"u"&&gtag("event",t.event_type,{custom_parameter_1:JSON.stringify(t.event_data),session_id:t.session_id}),typeof posthog<"u"&&posthog.capture(t.event_type,{...t.event_data,session_id:t.session_id,ip_address:t.ip_address}),typeof mixpanel<"u"&&mixpanel.track(t.event_type,{...t.event_data,session_id:t.session_id})}catch(s){console.error("Failed to send to external analytics:",s)}}async trackSessionEnd(){this.sessionId&&await this.trackEvent("session_end",{session_duration:Date.now()-this.sessionStartTime})}getSessionId(){return this.sessionId}resetSession(){this.sessionId=null,this.sessionStartTime=Date.now()}}const Or=new K7;typeof window<"u"&&(window.addEventListener("beforeunload",()=>{Or.trackSessionEnd()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?Or.trackEvent("page_hidden"):Or.trackEvent("page_visible")}));function Q7(r={}){const{autoCheckRateLimit:t=!0,rateLimitCheckInterval:s=6e4}=r,a=qn(),[n,i]=p.useState({isAnalyzing:!1,progress:0,error:null,currentAnalysis:null}),o=p.useCallback(async()=>{try{const v=await fetch("https://api.ipify.org?format=json");if(!(v!=null&&v.ok))return console.warn("Failed to get IP address, using fallback"),"127.0.0.1";const j=await v.json();return(j==null?void 0:j.ip)??"127.0.0.1"}catch{return"127.0.0.1"}},[]);p.useEffect(()=>{Or.initializeSession(),Or.trackPageView("public_analysis")},[]);const{data:c,error:d,refetch:h,isLoading:m}=Fo({queryKey:["publicRateLimit"],queryFn:async()=>{const v=await o(),j=await so.checkRateLimit(v);return j.allowed||await Or.trackRateLimit(j.remaining.hourly===0?"hourly":"daily",j.remaining.hourly+j.remaining.daily),j},enabled:t,refetchInterval:s,staleTime:3e4,retry:2}),f=oa({mutationFn:async()=>{const v=await o(),j=navigator.userAgent;return so.getOrCreateSession(v,j)},onError:v=>{console.error("Session creation failed:",v),i(j=>({...j,error:"Failed to create analysis session"}))}}),g=oa({mutationFn:async({file:v,session:j,startTime:C})=>{const k=await o();await Or.trackDocumentUpload(v.size,v.type,v.name);const I=await so.analyzeDocument(v,j.id,k),T=Date.now()-C;return await Or.trackAnalysisComplete(I.id,T,I.analysisResult.documentType,I.analysisResult.textLength),I},onSuccess:v=>{i(j=>({...j,currentAnalysis:v,isAnalyzing:!1,progress:100,error:null})),a.invalidateQueries({queryKey:["publicRateLimit"]})},onError:v=>{console.error("Analysis failed:",v),Or.trackError("analysis_failed",v instanceof Error?v.message:"Unknown error"),i(j=>({...j,isAnalyzing:!1,progress:0,error:v instanceof Error?v.message:"Analysis failed"}))}}),y=p.useCallback(async v=>{try{return await so.getAnalysisResult(v)}catch(j){return console.error("Failed to get analysis result:",j),null}},[]),b=p.useCallback(async v=>{const j=Date.now();i(C=>({...C,isAnalyzing:!0,progress:0,error:null,currentAnalysis:null}));try{await Or.trackEvent("analysis_started",{file_size:v.size,file_type:v.type,file_name_length:v.name.length});const C=so.validateFile(v);if(!C.valid)throw await Or.trackError("validation_failed",C.error||"File validation failed"),new Error(C.error);i(U=>({...U,progress:10}));const k=await o(),I=await so.checkRateLimit(k);if(!I.allowed)throw await Or.trackRateLimit(I.remaining.hourly===0?"hourly":"daily",I.remaining.hourly+I.remaining.daily),new Error(I.message||"Rate limit exceeded");i(U=>({...U,progress:20}));const T=await f.mutateAsync();return i(U=>({...U,progress:40})),await g.mutateAsync({file:v,session:T,startTime:j})}catch(C){const k=C instanceof Error?C.message:"Analysis failed";throw i(I=>({...I,isAnalyzing:!1,progress:0,error:k})),C}},[f,g,o]),w=p.useCallback(()=>{i({isAnalyzing:!1,progress:0,error:null,currentAnalysis:null})},[]),S=p.useCallback(()=>c?c.allowed&&!n.isAnalyzing:!1,[c,n.isAnalyzing]),N=p.useCallback(()=>c?c.remaining:{hourly:0,daily:0},[c]);return p.useEffect(()=>{n.currentAnalysis&&!n.isAnalyzing&&h()},[n.currentAnalysis,n.isAnalyzing,h]),{analysisState:n,rateLimitStatus:c,isCheckingRateLimit:m,rateLimitError:d,analyzeDocument:b,getAnalysisResult:y,resetAnalysis:w,refetchRateLimit:h,canAnalyze:S,getRemainingUsage:N,getUserIP:o,isCreatingSession:f.isPending,isAnalyzing:g.isPending||n.isAnalyzing}}function Y7(r){return Fo({queryKey:["publicAnalysisResult",r],queryFn:()=>{if(!r)throw new Error("Analysis ID is required");return so.getAnalysisResult(r)},enabled:!!r,retry:2,staleTime:5*60*1e3})}function J7(){const r=ps(),{analysisState:t,rateLimitStatus:s,analyzeDocument:a}=Q7(),n=p.useCallback(async d=>{try{const h=await a(d);setTimeout(()=>{r(`${Ye.publicAnalysisResult}/${h.id}`)},500)}catch(h){console.error("Analysis error:",h)}},[a,r]),i=[{icon:Fe,title:"Text Extraction",description:"Extract text from PDFs and images using advanced OCR technology"},{icon:Nr,title:"Quick Analysis",description:"Get document summary and key insights in seconds"},{icon:vs,title:"Secure & Private",description:"Documents are automatically deleted after 24 hours"},{icon:us,title:"No Registration",description:"Start analyzing immediately without creating an account"}],o=["Basic text extraction and summary only","Limited to 3 documents per hour, 10 per day","Maximum file size: 10MB","Documents deleted after 24 hours"],c=["Advanced legal insights and compliance checks","Entity extraction and risk assessment","Unlimited document analysis","Permanent document storage","AI-powered legal Q&A","Custom document templates"];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Free Document Analysis"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Upload your legal documents and get instant analysis with our AI-powered platform. No registration required."})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs($,{className:"shadow-lg",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),"Upload Document"]}),e.jsx(ye,{children:"Upload a PDF or image file to get started with free document analysis"})]}),e.jsxs(z,{children:[t.error&&e.jsx(vt,{className:"mb-6 border-red-200 bg-red-50",children:e.jsx(wt,{className:"text-red-700",children:t.error})}),s&&!s.allowed&&e.jsx(vt,{className:"mb-6 border-orange-200 bg-orange-50",children:e.jsx(wt,{className:"text-orange-700",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:s.message}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{children:["Remaining today: ",s.remaining.daily," documents"]}),e.jsxs("p",{children:["Remaining this hour: ",s.remaining.hourly," documents"]})]})]})})}),t.isAnalyzing&&e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Analyzing document..."}),e.jsxs("span",{children:[t.progress,"%"]})]}),e.jsx(na,{value:t.progress,className:"h-2"})]}),e.jsx(H7,{onFileUpload:n,disabled:t.isAnalyzing||s&&!s.allowed,maxFileSize:Wx.rateLimits.maxFileSize,allowedTypes:Wx.rateLimits.allowedFileTypes}),(s==null?void 0:s.allowed)&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsx("p",{className:"font-medium",children:"Usage Remaining:"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("p",{children:["This hour: ",s.remaining.hourly," documents"]}),e.jsxs("p",{children:["Today: ",s.remaining.daily," documents"]})]})]})})]})]}),e.jsx("div",{className:"mt-8 grid md:grid-cols-2 gap-4",children:i.map(d=>e.jsx($,{className:"border-l-4 border-l-blue-500",children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(d.icon,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:d.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d.description})]})]})})},d.title))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"Free Analysis Includes"})}),e.jsx(z,{className:"space-y-3",children:o.map(d=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-600",children:d})]},d))})]}),e.jsxs($,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100",children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-lg text-blue-900",children:"Unlock Advanced Features"}),e.jsx(ye,{className:"text-blue-700",children:"Get unlimited access and advanced legal insights"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[c.slice(0,4).map(d=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-blue-800",children:d})]},d)),c.length>4&&e.jsxs("p",{className:"text-sm text-blue-700 font-medium",children:["+",c.length-4," more features"]})]}),e.jsx(Ts,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(R,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>{Or.trackInteraction("button_click","view_pricing_from_public_analysis"),r(Ye.pricing)},children:["View Pricing Plans",e.jsx(Mn,{className:"ml-2 h-4 w-4"})]}),e.jsx(R,{variant:"outline",className:"w-full border-blue-300 text-blue-700 hover:bg-blue-50",onClick:()=>{Or.trackInteraction("button_click","create_account_from_public_analysis"),r(Ye.register)},children:"Create Free Account"})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"File Requirements"})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Supported Formats"}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[e.jsx(ae,{variant:"secondary",children:"PDF"}),e.jsx(ae,{variant:"secondary",children:"JPEG"}),e.jsx(ae,{variant:"secondary",children:"PNG"}),e.jsx(ae,{variant:"secondary",children:"WebP"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Size Limit"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Maximum 10MB per file"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Privacy"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Files are automatically deleted after 24 hours"})]})]})]})]})]})]})})}function Z7(){const{analysisId:r}=Fi(),t=ps(),{data:s,isLoading:a,error:n}=Y7(r),i=m=>{if(m===0)return"0 Bytes";const f=1024,g=["Bytes","KB","MB","GB"],y=Math.floor(Math.log(m)/Math.log(f));return parseFloat((m/Math.pow(f,y)).toFixed(2))+" "+g[y]},o=m=>{const f=new Date,g=m.getTime()-f.getTime(),y=Math.floor(g/(1e3*60*60)),b=Math.floor(g%(1e3*60*60)/(1e3*60));return y>0?`${y}h ${b}m`:b>0?`${b}m`:"Expired"},c=[{icon:Ot,title:"Advanced Legal Insights",description:"Get detailed legal analysis, risk assessment, and compliance checks"},{icon:Nr,title:"Unlimited Analysis",description:"Analyze unlimited documents without rate limits or file size restrictions"},{icon:vs,title:"Secure Storage",description:"Permanent document storage with enterprise-grade security"},{icon:es,title:"Team Collaboration",description:"Share documents and collaborate with team members"}];if(a)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsx($,{className:"w-full max-w-md",children:e.jsx(z,{className:"p-8 text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Loading Analysis Results..."}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we retrieve your document analysis."})]})})})});if(n||!s)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsx($,{className:"w-full max-w-md",children:e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(is,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Analysis Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:(n==null?void 0:n.message)??"The analysis you're looking for doesn't exist or has expired."}),e.jsx(R,{onClick:()=>t(Ye.publicAnalysis),children:"Analyze New Document"})]})})});const d=o(s.expiresAt),h=new Date>s.expiresAt;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Document Analysis Complete"}),e.jsx("p",{className:"text-gray-600",children:"Here are the results from your free document analysis"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),"Document Information"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Filename"}),e.jsx("p",{className:"text-gray-600",children:s.filename})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"File Size"}),e.jsx("p",{className:"text-gray-600",children:i(s.fileSize)})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Document Type"}),e.jsx(ae,{variant:"secondary",children:s.analysisResult.documentType})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Text Length"}),e.jsxs("p",{className:"text-gray-600",children:[s.analysisResult.textLength.toLocaleString()," characters"]})]})]}),!h&&e.jsxs(vt,{className:"border-orange-200 bg-orange-50",children:[e.jsx(us,{className:"h-4 w-4 text-orange-600"}),e.jsxs(wt,{className:"text-orange-700",children:["This analysis will expire in ",d,". Results are automatically deleted after 24 hours."]})]}),h&&e.jsxs(vt,{className:"border-red-200 bg-red-50",children:[e.jsx(is,{className:"h-4 w-4 text-red-600"}),e.jsx(wt,{className:"text-red-700",children:"This analysis has expired and will be deleted soon."})]})]})]}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Document Summary"}),e.jsx(ye,{children:"AI-generated summary and key insights from your document"})]}),e.jsxs(z,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Text Extraction Quality"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(s.analysisResult.ocrQuality*100),"%"]})]}),e.jsx(na,{value:s.analysisResult.ocrQuality*100,className:"h-2"})]}),e.jsx(Ts,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Document Summary"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.analysisResult.summary})})]}),e.jsx(Ts,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Key Terms"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.analysisResult.keyWords.map(m=>e.jsx(ae,{variant:"outline",children:m},m))})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Next Steps"})}),e.jsx(z,{className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(R,{onClick:()=>t(Ye.publicAnalysis),variant:"outline",className:"w-full",children:"Analyze Another Document"}),e.jsxs(R,{onClick:()=>t(Ye.register),className:"w-full bg-blue-600 hover:bg-blue-700",children:["Create Free Account",e.jsx(Mn,{className:"ml-2 h-4 w-4"})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100",children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-blue-900",children:"Unlock Advanced Analysis"}),e.jsx(ye,{className:"text-blue-700",children:"Get deeper insights with our premium features"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:c.map(m=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(m.icon,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:m.title}),e.jsx("p",{className:"text-sm text-blue-700",children:m.description})]})]},m.title))}),e.jsx(Ts,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(R,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>t(Ye.pricing),children:["View Pricing Plans",e.jsx(Mn,{className:"ml-2 h-4 w-4"})]}),e.jsx(R,{variant:"outline",className:"w-full border-blue-300 text-blue-700 hover:bg-blue-50",onClick:()=>t(Ye.register),children:"Start Free Trial"})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"What You're Missing"})}),e.jsx(z,{className:"space-y-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Legal entity extraction"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Risk assessment"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Compliance checking"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Document comparison"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Export to Word/PDF"})]})]})})]})]})]})]})})}const X7={employment:rN,business:F5,property:Nm,family:es,"intellectual-property":Sm,compliance:vs};function s_(){const r=ps(),[t,s]=Dd(),[a,n]=p.useState([]),[i,o]=p.useState([]),[c,d]=p.useState([]),[h,m]=p.useState(!0),[f,g]=p.useState(!1),[y,b]=p.useState(null),[w,S]=p.useState("grid"),[N,v]=p.useState(!1),j=Array.isArray(i)?i:[],[C,k]=p.useState(t.get("q")||""),[I,T]=p.useState(t.get("category")||""),[O,U]=p.useState(t.get("access")||""),[A,L]=p.useState(t.get("sort")||"popularity"),[M,se]=p.useState(Number(t.get("rating"))||0),[W,q]=p.useState(!0),[K,Y]=p.useState(0),[le,Ne]=p.useState(0);p.useEffect(()=>{Ke()},[]),p.useEffect(()=>{const he={query:C||void 0,categoryId:I||void 0,accessLevel:O||void 0,sortBy:A,minRating:M||void 0,limit:20,offset:0};Ne(0),ke(he),$e()},[C,I,O,A,M]);const Ke=async()=>{try{m(!0);const[he,fe]=await Promise.all([bs.getCategories(),bs.getFeaturedTemplates(6)]);o(he),d(fe)}catch(he){b(he instanceof Error?he.message:"Failed to load data")}finally{m(!1)}},ke=async he=>{try{g(!0);const fe=await bs.searchTemplates(he);n(fe.templates),Y(fe.total),q(fe.hasMore)}catch(fe){b(fe instanceof Error?fe.message:"Search failed")}finally{g(!1)}},$e=()=>{const he=new URLSearchParams;C&&he.set("q",C),I&&he.set("category",I),O&&he.set("access",O),A!=="popularity"&&he.set("sort",A),M>0&&he.set("rating",M.toString()),s(he)},ce=p.useCallback(he=>{k(he)},[]),Re=async()=>{if(!(f||!W))try{g(!0);const he=le+20,fe={query:C||void 0,categoryId:I||void 0,accessLevel:O||void 0,sortBy:A,minRating:M||void 0,limit:20,offset:he},Me=await bs.searchTemplates(fe);n(ze=>[...ze,...Me.templates]),Ne(he),q(Me.hasMore)}catch(he){b(he instanceof Error?he.message:"Failed to load more templates")}finally{g(!1)}},Qe=he=>{var fe;bs.trackEvent(he.id,"template_view",{source:"browser",category:(fe=he.category)==null?void 0:fe.name,access_level:he.accessLevel}),r(`${Ye.templatePreview}/${he.slug}`)},nt=he=>he==null||isNaN(he)||he===0?"Free":`S$${he.toFixed(2)}`,We=he=>Array.from({length:5},(fe,Me)=>e.jsx(Ot,{className:`h-4 w-4 ${Me<Math.floor(he)?"text-yellow-400 fill-current":"text-gray-300"}`},Me)),ct=he=>{const fe=X7[he];return fe?e.jsx(fe,{className:"h-5 w-5"}):e.jsx(rN,{className:"h-5 w-5"})};return h?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(_s,{className:"h-12 w-full max-w-md mx-auto"}),e.jsx("div",{className:"grid md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((he,fe)=>e.jsx(_s,{className:"h-64 w-full"},`loading-${fe}`))})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Legal Document Templates"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Browse our comprehensive collection of Singapore-specific legal document templates. Customize, download, and use with confidence."})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Pe,{placeholder:"Search templates...",value:C,onChange:he=>ce(he.target.value),className:"pl-10"})]}),e.jsxs(it,{value:I||"all",onValueChange:he=>T(he==="all"?"":he),children:[e.jsx(rt,{className:"w-full lg:w-48",children:e.jsx(ot,{placeholder:"All Categories"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All Categories"}),j.map(he=>he&&he.id&&he.name?e.jsx(ne,{value:he.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[ct(he.slug),he.name]})},he.id):null)]})]}),e.jsxs(it,{value:O||"all",onValueChange:he=>U(he==="all"?"":he),children:[e.jsx(rt,{className:"w-full lg:w-32",children:e.jsx(ot,{placeholder:"All"})}),e.jsxs(at,{children:[e.jsx(ne,{value:"all",children:"All"}),e.jsx(ne,{value:"public",children:"Free"}),e.jsx(ne,{value:"premium",children:"Premium"}),e.jsx(ne,{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs(it,{value:A,onValueChange:L,children:[e.jsx(rt,{className:"w-full lg:w-40",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"popularity",children:"Most Popular"}),e.jsx(ne,{value:"rating",children:"Highest Rated"}),e.jsx(ne,{value:"newest",children:"Newest"}),e.jsx(ne,{value:"price_low",children:"Price: Low to High"}),e.jsx(ne,{value:"price_high",children:"Price: High to Low"})]})]}),e.jsxs("div",{className:"flex border rounded-lg",children:[e.jsx(R,{variant:w==="grid"?"default":"ghost",size:"sm",onClick:()=>S("grid"),className:"rounded-r-none",children:e.jsx(_m,{className:"h-4 w-4"})}),e.jsx(R,{variant:w==="list"?"default":"ghost",size:"sm",onClick:()=>S("list"),className:"rounded-l-none",children:e.jsx(So,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>v(!N),className:"text-gray-600",children:[e.jsx(dN,{className:"h-4 w-4 mr-2"}),"Advanced Filters",e.jsx(Vg,{className:`h-4 w-4 ml-2 transition-transform ${N?"rotate-180":""}`})]}),N&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"min-rating-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Rating"}),e.jsxs(it,{value:M.toString(),onValueChange:he=>se(Number(he)),children:[e.jsx(rt,{id:"min-rating-select",children:e.jsx(ot,{})}),e.jsxs(at,{children:[e.jsx(ne,{value:"0",children:"Any Rating"}),e.jsx(ne,{value:"3",children:"3+ Stars"}),e.jsx(ne,{value:"4",children:"4+ Stars"}),e.jsx(ne,{value:"4.5",children:"4.5+ Stars"})]})]})]})})})]})]}),c.length>0&&!C&&e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Featured Templates"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(he=>{var fe,Me;return e.jsxs($,{className:"cursor-pointer hover:shadow-lg transition-shadow border-2 border-blue-200",onClick:()=>Qe(he),children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(X,{className:"text-lg line-clamp-2",children:he.title}),e.jsx(ye,{className:"mt-2 line-clamp-2",children:he.description})]}),e.jsx(ae,{variant:"secondary",className:"ml-2 bg-blue-100 text-blue-800",children:"Featured"})]})}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[We(he.ratingAverage),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:["(",he.ratingCount,")"]})]}),e.jsx("span",{className:"font-semibold text-blue-600",children:nt(he.priceSgd)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fs,{className:"h-4 w-4"}),he.downloadCount.toLocaleString()]}),e.jsxs("div",{className:"flex items-center gap-1",children:[ct(((fe=he.category)==null?void 0:fe.slug)||""),(Me=he.category)==null?void 0:Me.name]})]})]})})]},he.id)})}),e.jsx(Ts,{className:"mt-12"})]}),e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:C?`Search Results for "${C}"`:"All Templates"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[K.toLocaleString()," templates found"]})]})}),f?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((he,fe)=>e.jsx(_s,{className:"h-64 w-full"},`search-loading-${fe}`))}):a.length>0?e.jsx("div",{className:w==="grid"?"grid md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:a.map(he=>{var fe,Me;return e.jsxs($,{className:`cursor-pointer hover:shadow-lg transition-shadow ${w==="list"?"flex":""}`,onClick:()=>Qe(he),children:[e.jsx(Z,{className:w==="list"?"flex-1":"",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(X,{className:"text-lg line-clamp-2",children:he.title}),e.jsx(ye,{className:"mt-2 line-clamp-2",children:he.description})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:nt(he.priceSgd)}),he.accessLevel!=="public"&&e.jsx(ae,{variant:"outline",className:"mt-1",children:he.accessLevel})]})]})}),e.jsxs(z,{className:w==="list"?"flex items-center":"",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-1",children:[We(he.ratingAverage),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:["(",he.ratingCount,")"]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fs,{className:"h-4 w-4"}),he.downloadCount.toLocaleString()]}),e.jsxs("div",{className:"flex items-center gap-1",children:[ct(((fe=he.category)==null?void 0:fe.slug)||""),(Me=he.category)==null?void 0:Me.name]})]}),he.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[he.tags.slice(0,3).map(ze=>e.jsx(ae,{variant:"outline",className:"text-xs",children:ze},ze)),he.tags.length>3&&e.jsxs(ae,{variant:"outline",className:"text-xs",children:["+",he.tags.length-3]})]})]}),w==="list"&&e.jsx("div",{className:"ml-4",children:e.jsxs(R,{size:"sm",children:[e.jsx(Gt,{className:"h-4 w-4 mr-2"}),"Preview"]})})]})]},he.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(Yt,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Try adjusting your search criteria or browse all categories."}),e.jsx(R,{onClick:()=>{k(""),T(""),U(""),se(0)},children:"Clear Filters"})]}),W&&a.length>0&&e.jsx("div",{className:"text-center mt-12",children:e.jsx(R,{variant:"outline",onClick:Re,disabled:f,children:f?"Loading...":"Load More Templates"})}),y&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-400 mb-4",children:e.jsx(is,{className:"h-16 w-16 mx-auto"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-6",children:y}),e.jsx(R,{onClick:()=>window.location.reload(),children:"Try Again"})]})]})})}function eW(){var v,j;const{slug:r}=Fi(),t=ps(),[s,a]=p.useState(null),[n,i]=p.useState(!0),[o,c]=p.useState(null),[d,h]=p.useState("preview"),[m,f]=p.useState(!1);p.useEffect(()=>{r&&g(r)},[r]);const g=async C=>{var k;try{i(!0);const I=await bs.getTemplate(C);if(!I){c("Template not found");return}a(I),await bs.trackEvent(I.id,"template_preview",{source:"direct_link",category:(k=I.category)==null?void 0:k.name,access_level:I.accessLevel})}catch(I){c(I instanceof Error?I.message:"Failed to load template")}finally{i(!1)}},y=()=>{s&&(bs.trackEvent(s.id,"customization_started",{source:"preview_page",access_level:s.accessLevel}),t(`${Ye.templateCustomize}/${s.slug}`))},b=async()=>{s&&(await bs.recordDownload(s.id,void 0,"pdf"),alert("Download functionality will be implemented with the generation system"))},w=async()=>{if(s)try{await navigator.share({title:s.title,text:s.description,url:window.location.href})}catch{await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!")}},S=C=>C===0?"Free":`S$${C.toFixed(2)}`,N=C=>Array.from({length:5},(k,I)=>e.jsx(Ot,{className:`h-4 w-4 ${I<Math.floor(C)?"text-yellow-400 fill-current":"text-gray-300"}`},I));return n?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[e.jsx(_s,{className:"h-8 w-32"}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(_s,{className:"h-64 w-full"}),e.jsx(_s,{className:"h-32 w-full"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_s,{className:"h-48 w-full"}),e.jsx(_s,{className:"h-32 w-full"})]})]})]})})}):o||!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx($,{className:"w-full max-w-md",children:e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(is,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Template Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:o||"The template you're looking for doesn't exist or has been removed."}),e.jsx(R,{onClick:()=>t(Ye.templateBrowser),children:"Browse Templates"})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-6",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>t(Ye.templateBrowser),className:"p-0 h-auto",children:[e.jsx($r,{className:"h-4 w-4 mr-1"}),"Back to Templates"]}),e.jsx("span",{children:"/"}),e.jsx("span",{children:(v=s.category)==null?void 0:v.name}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-gray-900",children:s.title})]}),e.jsx(r7,{templateAccessLevel:s.accessLevel,templateId:s.id,children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-lg text-gray-600 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[N(s.ratingAverage),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:[s.ratingAverage.toFixed(1)," (",s.ratingCount," reviews)"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(fs,{className:"h-4 w-4"}),s.downloadCount.toLocaleString()," downloads"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(ae,{variant:"outline",children:(j=s.category)==null?void 0:j.name}),s.subcategory&&e.jsx(ae,{variant:"outline",children:s.subcategory}),s.accessLevel!=="public"&&e.jsx(ae,{variant:"secondary",children:s.accessLevel}),s.tags.slice(0,3).map(C=>e.jsx(ae,{variant:"outline",className:"text-xs",children:C},C))]})]}),e.jsxs("div",{className:"text-right ml-6",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:S(s.priceSgd)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>f(!m),children:e.jsx(oN,{className:`h-4 w-4 ${m?"fill-current text-red-500":""}`})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:w,children:e.jsx(Od,{className:"h-4 w-4"})})]})]})]})}),e.jsxs(fr,{value:d,onValueChange:h,children:[e.jsxs(nr,{className:"grid w-full grid-cols-5",children:[e.jsxs(Ge,{value:"preview",children:[e.jsx(Gt,{className:"h-4 w-4 mr-2"}),"Preview"]}),e.jsxs(Ge,{value:"fields",children:[e.jsx(Ei,{className:"h-4 w-4 mr-2"}),"Fields"]}),e.jsxs(Ge,{value:"details",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Details"]}),e.jsxs(Ge,{value:"reviews",children:[e.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Reviews"]}),e.jsxs(Ge,{value:"versions",children:[e.jsx(rd,{className:"h-4 w-4 mr-2"}),"Versions"]})]}),e.jsx(He,{value:"preview",className:"mt-6",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Document Preview"}),e.jsx(ye,{children:"This is how your document will look when generated"})]}),e.jsx(z,{children:s.previewHtml?e.jsx("div",{className:"prose max-w-none border rounded-lg p-6 bg-white",dangerouslySetInnerHTML:{__html:s.previewHtml}}):s.previewPdfUrl?e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsx("iframe",{src:s.previewPdfUrl,className:"w-full h-96",title:"Template Preview"})}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Fe,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Preview not available for this template"})]})})]})}),e.jsx(He,{value:"fields",className:"mt-6",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Customizable Fields"}),e.jsx(ye,{children:"These fields can be customized when you use this template"})]}),e.jsx(z,{children:s.fields.length>0?e.jsx("div",{className:"space-y-4",children:s.fields.map(C=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:C.label}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{variant:"outline",className:"text-xs",children:C.type}),C.required&&e.jsx(ae,{variant:"destructive",className:"text-xs",children:"Required"})]})]}),C.helpText&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:C.helpText}),C.placeholder&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Placeholder: ",C.placeholder]})]},C.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ei,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"This template has no customizable fields"})]})})]})}),e.jsx(He,{value:"details",className:"mt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Legal Information"})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Jurisdiction"}),e.jsx("p",{className:"text-gray-600",children:s.jurisdiction})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Language"}),e.jsx("p",{className:"text-gray-600",children:s.language==="en"?"English":s.language})]})]}),s.legalAreas.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Legal Areas"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.legalAreas.map(C=>e.jsx(ae,{variant:"outline",children:C},C))})]}),s.complianceTags.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Compliance"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.complianceTags.map(C=>e.jsxs(ae,{variant:"outline",className:"text-green-700 border-green-300",children:[e.jsx(vs,{className:"h-3 w-3 mr-1"}),C]},C))})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Template Information"})}),e.jsx(z,{className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Version"}),e.jsxs("p",{className:"text-gray-600",children:["v",s.version]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Last Updated"}),e.jsx("p",{className:"text-gray-600",children:s.updatedAt.toLocaleDateString()})]})]})})]})]})}),e.jsx(He,{value:"reviews",className:"mt-6",children:e.jsx(e7,{template:s})}),e.jsx(He,{value:"versions",className:"mt-6",children:e.jsx(nE,{templateId:s.id,currentVersionId:s.id})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{className:"sticky top-6",children:[e.jsxs(Z,{children:[e.jsx(X,{className:"text-xl",children:"Get This Template"}),e.jsx(ye,{children:"Customize and download this template for your needs"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:S(s.priceSgd)}),s.accessLevel==="public"&&e.jsxs("p",{className:"text-sm text-green-600 mb-4",children:[e.jsx(Ue,{className:"h-4 w-4 inline mr-1"}),"Free to use and customize"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(R,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:y,children:[e.jsx(Ei,{className:"h-4 w-4 mr-2"}),"Customize Template"]}),e.jsxs(R,{variant:"outline",className:"w-full",onClick:b,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Download Sample"]})]}),s.accessLevel!=="public"&&e.jsxs(vt,{children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsxs(wt,{children:["This is a ",s.accessLevel," template.",s.accessLevel==="premium"?" Upgrade to Premium":" Contact us"," ","to access all features."]})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"What's Included"})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Customizable fields"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"PDF download"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Legal compliance checked"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Singapore jurisdiction"})]}),s.accessLevel==="premium"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:"Word document format"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:"Legal review included"})]})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Need Help?"})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs(R,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Contact Support"]}),e.jsxs(R,{variant:"outline",className:"w-full justify-start",children:[e.jsx(nN,{className:"h-4 w-4 mr-2"}),"View Documentation"]})]})]})]})]})})]})})})}function tW(){var W;const{slug:r}=Fi(),t=ps(),[s,a]=p.useState(null),[n,i]=p.useState(null),[o,c]=p.useState(!0),[d,h]=p.useState(!1),[m,f]=p.useState(!1),[g,y]=p.useState(null),[b,w]=p.useState({}),[S,N]=p.useState({}),[v,j]=p.useState(!1),[C,k]=p.useState("");p.useEffect(()=>{r&&I(r)},[r]);const I=async q=>{try{c(!0);const K=await bs.getTemplate(q);if(!K){y("Template not found");return}a(K);const Y={};K.fields.forEach(le=>{le.defaultValue!==void 0&&(Y[le.name]=le.defaultValue)}),w(Y),await bs.trackEvent(K.id,"customization_started",{source:"customize_page",access_level:K.accessLevel})}catch(K){y(K instanceof Error?K.message:"Failed to load template")}finally{c(!1)}},T=(q,K)=>{if(q.required&&(!K||K.toString().trim()===""))return`${q.label} is required`;if(K&&q.validation){const Y=q.validation;if(Y.minLength&&K.toString().length<Y.minLength)return`${q.label} must be at least ${Y.minLength} characters`;if(Y.maxLength&&K.toString().length>Y.maxLength)return`${q.label} must be no more than ${Y.maxLength} characters`;if(Y.pattern&&!new RegExp(Y.pattern).test(K.toString()))return`${q.label} format is invalid`;if(q.type==="number"){const le=Number(K);if(Y.min&&le<Y.min)return`${q.label} must be at least ${Y.min}`;if(Y.max&&le>Y.max)return`${q.label} must be no more than ${Y.max}`}}return null},O=()=>{if(!s)return!1;const q={};return s.fields.forEach(K=>{const Y=T(K,b[K.name]);Y&&(q[K.name]=Y)}),N(q),Object.keys(q).length===0},U=(q,K)=>{w(Y=>({...Y,[q]:K})),S[q]&&N(Y=>{const le={...Y};return delete le[q],le})},A=async()=>{if(!(!s||!O()))try{if(h(!0),n){const q=await bs.updateCustomization(n.id,{customFields:b});i(q)}else{const q=crypto.randomUUID(),K=await bs.createCustomization(s.id,b,void 0,q);i(K)}await bs.trackEvent(s.id,"customization_saved",{fields_filled:Object.keys(b).length,completion_rate:Object.keys(b).length/s.fields.length*100})}catch(q){y(q instanceof Error?q.message:"Failed to save customization")}finally{h(!1)}},L=async()=>{if(!(!s||!O()))try{f(!0);let q=s.content.template||"";Object.entries(b).forEach(([K,Y])=>{const le=new RegExp(`{{${K}}}`,"g");q=q.replace(le,(Y==null?void 0:Y.toString())||"")}),k(q),j(!0),await bs.trackEvent(s.id,"preview_generated",{fields_filled:Object.keys(b).length})}catch(q){y(q instanceof Error?q.message:"Failed to generate preview")}finally{f(!1)}},M=async(q="pdf")=>{if(!(!s||!n))try{f(!0);const{data:K,error:Y}=await D.functions.invoke("template-document-generator",{body:{customizationId:n.id,format:q,templateData:{title:s.title,content:s.content.template||"",customFields:b}}});if(Y)throw new Error(Y.message||"Failed to generate document");const le=document.createElement("a");le.href=K.downloadUrl,le.download=`${s.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.${q}`,document.body.appendChild(le),le.click(),document.body.removeChild(le),await bs.recordDownload(s.id,n.id,q)}catch(K){y(K instanceof Error?K.message:"Failed to download document")}finally{f(!1)}},se=q=>{var Ne,Ke,ke;const K=b[q.name]||"",Y=S[q.name],le={id:q.id,value:K,onChange:$e=>U(q.name,$e.target.value),placeholder:q.placeholder,className:Y?"border-red-500":""};switch(q.type){case"textarea":return e.jsx(Sr,{...le,rows:4});case"select":return e.jsxs(it,{value:K,onValueChange:$e=>U(q.name,$e),children:[e.jsx(rt,{className:Y?"border-red-500":"",children:e.jsx(ot,{placeholder:q.placeholder})}),e.jsx(at,{children:(Ne=q.options)==null?void 0:Ne.map($e=>e.jsx(ne,{value:$e.value,children:$e.label},$e.value))})]});case"checkbox":return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hr,{id:q.id,checked:K===!0,onCheckedChange:$e=>U(q.name,$e)}),e.jsx(Te,{htmlFor:q.id,children:q.label})]});case"number":return e.jsx(Pe,{...le,type:"number",min:(Ke=q.validation)==null?void 0:Ke.min,max:(ke=q.validation)==null?void 0:ke.max,onChange:$e=>U(q.name,Number($e.target.value))});case"date":return e.jsx(Pe,{...le,type:"date"});case"email":return e.jsx(Pe,{...le,type:"email"});case"phone":return e.jsx(Pe,{...le,type:"tel"});default:return e.jsx(Pe,{...le,type:"text"})}};return o?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsx(_s,{className:"h-8 w-32"}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(_s,{className:"h-64 w-full"}),e.jsx(_s,{className:"h-32 w-full"})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(_s,{className:"h-48 w-full"})})]})]})})}):g||!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx($,{className:"w-full max-w-md",children:e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(is,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to Load Template"}),e.jsx("p",{className:"text-gray-600 mb-6",children:g||"The template you're trying to customize is not available."}),e.jsx(R,{onClick:()=>t(Ye.templateBrowser),children:"Browse Templates"})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>t(`${Ye.templatePreview}/${s.slug}`),children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to Preview"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Customize: ",s.title]}),e.jsx("p",{className:"text-gray-600",children:"Fill in the fields below to customize your document"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{variant:"outline",children:(W=s.category)==null?void 0:W.name}),s.accessLevel!=="public"&&e.jsx(ae,{variant:"secondary",children:s.accessLevel})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ei,{className:"h-5 w-5"}),"Document Fields"]}),e.jsx(ye,{children:"Complete the form below to customize your document"})]}),e.jsx(z,{className:"space-y-6",children:s.fields.map(q=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Te,{htmlFor:q.id,className:"flex items-center gap-2",children:[q.label,q.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),se(q),q.helpText&&e.jsx("p",{className:"text-xs text-gray-500",children:q.helpText}),S[q.name]&&e.jsx("p",{className:"text-xs text-red-500",children:S[q.name]})]},q.id))})]}),e.jsx($,{children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(R,{onClick:A,disabled:d,className:"flex-1",children:[d?e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Save Progress"]}),e.jsxs(R,{variant:"outline",onClick:L,disabled:m,className:"flex-1",children:[m?e.jsx(ds,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Gt,{className:"h-4 w-4 mr-2"}),"Preview"]}),e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsxs(R,{variant:"outline",onClick:()=>M("pdf"),disabled:!n||m,className:"flex-1",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"PDF"]}),e.jsxs(R,{variant:"outline",onClick:()=>M("docx"),disabled:!n||m,className:"flex-1",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"DOCX"]}),e.jsxs(R,{variant:"outline",onClick:()=>M("html"),disabled:!n||m,className:"flex-1",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"HTML"]})]})]}),Object.keys(S).length>0&&e.jsxs(vt,{className:"mt-4",children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx(wt,{children:"Please fix the validation errors above before proceeding."})]})]})})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs($,{className:"sticky top-6",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),"Live Preview"]}),e.jsx(ye,{children:"See how your document will look as you fill in the fields"})]}),e.jsx(z,{children:v&&C?e.jsx("div",{className:"prose max-w-none border rounded-lg p-4 bg-white min-h-96 text-sm",dangerouslySetInnerHTML:{__html:C}}):s.previewHtml?e.jsx("div",{className:"prose max-w-none border rounded-lg p-4 bg-white min-h-96 text-sm opacity-60",dangerouslySetInnerHTML:{__html:s.previewHtml}}):e.jsx("div",{className:"border rounded-lg p-8 bg-white min-h-96 flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Fe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Fill in the fields to see your customized document"})]})})})]})})]})]})})})}function sW(){const{slug:r}=Fi(),t=ps(),{user:s}=ft(),[a,n]=p.useState(null),[i,o]=p.useState(!0),[c,d]=p.useState(null),[h,m]=p.useState("history");p.useEffect(()=>{r&&f(r)},[r]);const f=async y=>{try{o(!0),d(null);const b=await bs.getTemplateBySlug(y);if(!b){d("Template not found");return}if(!s||b.createdBy!==s.id){d("You do not have permission to manage this template");return}n(b)}catch(b){console.error("Error loading template:",b),d(b.message||"Failed to load template")}finally{o(!1)}},g=y=>{te.success("New version created successfully!"),r&&f(r)};return i?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsx(_s,{className:"h-8 w-64"}),e.jsx(_s,{className:"h-32 w-full"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx(_s,{className:"h-64 w-full"}),e.jsx(_s,{className:"h-64 w-full"})]})]})})}):c||!a?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx($,{className:"w-full max-w-md",children:e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(is,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-6",children:c||"You do not have permission to access this template's version management."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{onClick:()=>t(Ye.templateBrowser),className:"flex-1",children:"Browse Templates"}),e.jsx(R,{variant:"outline",onClick:()=>t(-1),className:"flex-1",children:"Go Back"})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-6",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>t(Ye.templateBrowser),className:"p-0 h-auto",children:[e.jsx($r,{className:"h-4 w-4 mr-1"}),"Templates"]}),e.jsx("span",{children:"/"}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>t(`${Ye.templatePreview}/${r}`),className:"p-0 h-auto",children:a.title}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-gray-900",children:"Version Management"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center gap-3",children:[e.jsx(Ih,{className:"h-8 w-8 text-blue-600"}),"Version Management"]}),e.jsxs("p",{className:"text-lg text-gray-600 mb-4",children:['Manage versions, track changes, and collaborate on "',a.title,'"']}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ae,{variant:"outline",children:["Current: v",a.version]}),e.jsxs(ae,{variant:"secondary",children:[a.versionCount," version",a.versionCount!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(Ue,{className:"h-4 w-4 text-green-500"}),a.accessLevel," template"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{variant:"outline",onClick:()=>t(`${Ye.templatePreview}/${r}`),children:[e.jsx(Gt,{className:"h-4 w-4 mr-2"}),"View Template"]}),e.jsxs(R,{variant:"outline",onClick:()=>t(`${Ye.templateCustomize}/${r}`),children:[e.jsx(Yg,{className:"h-4 w-4 mr-2"}),"Edit Template"]})]})]})}),e.jsxs(fr,{value:h,onValueChange:m,children:[e.jsxs(nr,{className:"grid w-full grid-cols-3",children:[e.jsxs(Ge,{value:"history",className:"flex items-center gap-2",children:[e.jsx(rd,{className:"h-4 w-4"}),"Version History"]}),e.jsxs(Ge,{value:"compare",className:"flex items-center gap-2",children:[e.jsx(iN,{className:"h-4 w-4"}),"Compare Versions"]}),e.jsxs(Ge,{value:"create",className:"flex items-center gap-2",children:[e.jsx(da,{className:"h-4 w-4"}),"Create Version"]})]}),e.jsx(He,{value:"history",className:"mt-6",children:e.jsx(nE,{templateId:a.id,currentVersionId:a.currentVersionId})}),e.jsx(He,{value:"compare",className:"mt-6",children:e.jsx(d7,{templateId:a.id})}),e.jsx(He,{value:"create",className:"mt-6",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(da,{className:"h-5 w-5"}),"Create New Version"]}),e.jsx(ye,{children:"Create a new version of this template with your changes and improvements."})]}),e.jsx(z,{children:e.jsx(c7,{templateId:a.id,currentTitle:a.title,currentDescription:a.description,currentContent:a.content,currentFields:a.fields,onVersionCreated:g})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"Current Version"})}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Version"}),e.jsxs(ae,{children:["v",a.version]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Status"}),e.jsx(ae,{variant:"default",children:"Published"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Fields"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.fields.length})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"Version Guidelines"})}),e.jsxs(z,{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Major (x.0.0):"})," Breaking changes, new features"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Minor (1.x.0):"})," New features, improvements"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Patch (1.0.x):"})," Bug fixes, corrections"]})]})]})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{className:"text-lg",children:"Best Practices"})}),e.jsxs(z,{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("p",{children:"• Always provide clear change summaries"}),e.jsx("p",{children:"• Test templates before publishing"}),e.jsx("p",{children:"• Mark breaking changes appropriately"}),e.jsx("p",{children:"• Include migration notes for major changes"})]})]})]})]})})]})]})})})}const rW=()=>{const{hasPermission:r}=Xd(),t=ps();return r($t.SYSTEM_ANALYTICS)?e.jsx(la,{children:e.jsx(iE,{})}):e.jsx(la,{children:e.jsx($,{children:e.jsxs(z,{className:"text-center py-12",children:[e.jsx(vs,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have permission to access template analytics."}),e.jsx("div",{className:"flex gap-2 justify-center",children:e.jsxs(R,{onClick:()=>t("/dashboard"),children:[e.jsx($r,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})})]})})})},aW=()=>{ft();const[r,t]=p.useState([]),[s,a]=p.useState([]),[n,i]=p.useState(!0),[o,c]=p.useState(""),[d,h]=p.useState("all");p.useEffect(()=>{const N=[{id:"1",query:"employment contract singapore",type:"legal_qa",timestamp:new Date(Date.now()-72e5),results_count:15,clicked_result:"Employment Act basics"},{id:"2",query:"corporate law firms",type:"law_firms",timestamp:new Date(Date.now()-18e6),results_count:8,clicked_result:"Lee & Associates"},{id:"3",query:"tenancy agreement template",type:"templates",timestamp:new Date(Date.now()-864e5),results_count:12,clicked_result:"Residential Tenancy Agreement"},{id:"4",query:"contract analysis",type:"documents",timestamp:new Date(Date.now()-1728e5),results_count:6},{id:"5",query:"divorce proceedings singapore",type:"legal_qa",timestamp:new Date(Date.now()-2592e5),results_count:22,clicked_result:"Family Court procedures"}];t(N),a(N),i(!1)},[]),p.useEffect(()=>{let N=r;o.trim()&&(N=N.filter(v=>{var j;return v.query.toLowerCase().includes(o.toLowerCase())||((j=v.clicked_result)==null?void 0:j.toLowerCase().includes(o.toLowerCase()))})),d!=="all"&&(N=N.filter(v=>v.type===d)),a(N)},[r,o,d]);const m=N=>{switch(N){case"legal_qa":return e.jsx(Ft,{className:"h-4 w-4"});case"law_firms":return e.jsx(No,{className:"h-4 w-4"});case"documents":return e.jsx(Fe,{className:"h-4 w-4"});case"templates":return e.jsx(Fe,{className:"h-4 w-4"});default:return e.jsx(Yt,{className:"h-4 w-4"})}},f=N=>{switch(N){case"legal_qa":return"Legal Q&A";case"law_firms":return"Law Firms";case"documents":return"Documents";case"templates":return"Templates";default:return"Search"}},g=N=>{switch(N){case"legal_qa":return"bg-blue-100 text-blue-800";case"law_firms":return"bg-green-100 text-green-800";case"documents":return"bg-purple-100 text-purple-800";case"templates":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},y=()=>{t([]),a([])},b=N=>{const v=r.filter(j=>j.id!==N);t(v)},S=(()=>{var C;const N=r.length,v=r.reduce((k,I)=>(k[I.type]=(k[I.type]||0)+1,k),{}),j=((C=Object.entries(v).reduce((k,I)=>v[k[0]]>v[I[0]]?k:I))==null?void 0:C[0])||"legal_qa";return{totalSearches:N,typeStats:v,mostSearchedType:j}})();return e.jsx(la,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Search History"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage your search activity across the platform"})]}),e.jsxs(R,{variant:"outline",onClick:y,className:"text-red-600 border-red-600 hover:bg-red-50",children:[e.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Clear History"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Searches"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.totalSearches})]}),e.jsx(Yt,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Most Used"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:f(S.mostSearchedType)})]}),e.jsx(Wa,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"This Week"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(N=>Date.now()-N.timestamp.getTime()<7*24*60*60*1e3).length})]}),e.jsx(ln,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Results"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length>0?Math.round(r.reduce((N,v)=>N+v.results_count,0)/r.length):0})]}),e.jsx(Ba,{className:"h-8 w-8 text-orange-600"})]})})})]}),e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Pe,{placeholder:"Filter search history...",value:o,onChange:N=>c(N.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{variant:d==="all"?"default":"outline",size:"sm",onClick:()=>h("all"),children:"All"}),e.jsx(R,{variant:d==="legal_qa"?"default":"outline",size:"sm",onClick:()=>h("legal_qa"),children:"Q&A"}),e.jsx(R,{variant:d==="law_firms"?"default":"outline",size:"sm",onClick:()=>h("law_firms"),children:"Law Firms"}),e.jsx(R,{variant:d==="documents"?"default":"outline",size:"sm",onClick:()=>h("documents"),children:"Documents"}),e.jsx(R,{variant:d==="templates"?"default":"outline",size:"sm",onClick:()=>h("templates"),children:"Templates"})]})]})})}),e.jsxs($,{children:[e.jsxs(Z,{children:[e.jsx(X,{children:"Recent Searches"}),e.jsx(ye,{children:"Your search activity across Legal Q&A, Law Firms, Documents, and Templates"})]}),e.jsx(z,{children:n?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((N,v)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},v))}):s.length>0?e.jsx("div",{className:"space-y-4",children:s.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[m(N.type),e.jsx(ae,{className:g(N.type),children:f(N.type)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:['"',N.query,'"']}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mt-1",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(us,{className:"h-3 w-3"}),e.jsx("span",{children:Vt(N.timestamp,{addSuffix:!0})})]}),e.jsxs("span",{children:[N.results_count," results"]}),N.clicked_result&&e.jsxs("span",{className:"text-blue-600",children:["→ ",N.clicked_result]})]})]})]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>b(N.id),className:"text-gray-400 hover:text-red-600",children:e.jsx(Ln,{className:"h-4 w-4"})})]},N.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Yt,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No search history found"}),e.jsx("p",{className:"text-gray-500",children:o||d!=="all"?"Try adjusting your filters to see more results.":"Start searching to see your history here."})]})})]})]})})},nW=()=>{const r=Ug();return p.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",r.pathname)},[r.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},iW=()=>{const{user:r,loading:t,profile:s}=ft(),[a,n]=p.useState([]),[i,o]=p.useState(!1),c=async()=>{o(!0);const m=[];m.push({name:"Authentication Status",status:r?"success":"error",message:r?`Authenticated as ${r.email}`:"Not authenticated",details:{user:r?{id:r.id,email:r.email}:null}}),m.push({name:"Profile Loading",status:s?"success":"warning",message:s?`Profile loaded: ${s.email}`:"No profile loaded",details:s});try{const{data:f,error:g}=await D.auth.getUser();m.push({name:"Supabase Connection",status:g?"error":"success",message:g?`Connection error: ${g.message}`:"Connected successfully",details:{data:f,error:g}})}catch(f){m.push({name:"Supabase Connection",status:"error",message:`Connection failed: ${f instanceof Error?f.message:"Unknown error"}`,details:f})}try{const f=await Ds.getDocuments();m.push({name:"Documents API",status:"success",message:`Successfully loaded ${f.length} documents`,details:f})}catch(f){m.push({name:"Documents API",status:"error",message:`Failed to load documents: ${f instanceof Error?f.message:"Unknown error"}`,details:f})}try{const{data:f,error:g}=await D.from("uploaded_documents").select("count(*)").limit(1);m.push({name:"Database Query",status:g?"error":"success",message:g?`Query failed: ${g.message}`:"Database query successful",details:{data:f,error:g}})}catch(f){m.push({name:"Database Query",status:"error",message:`Query error: ${f instanceof Error?f.message:"Unknown error"}`,details:f})}n(m),o(!1)};p.useEffect(()=>{t||c()},[t]);const d=m=>{switch(m){case"success":return e.jsx(Ue,{className:"h-5 w-5 text-green-500"});case"error":return e.jsx(Qs,{className:"h-5 w-5 text-red-500"});case"warning":return e.jsx(It,{className:"h-5 w-5 text-yellow-500"})}},h=m=>{switch(m){case"success":return"bg-green-100 text-green-800";case"error":return"bg-red-100 text-red-800";case"warning":return"bg-yellow-100 text-yellow-800"}};return t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(mr,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Loading authentication..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-4",children:"Authentication Debug"}),e.jsx("p",{className:"text-gray-600 text-center",children:"Debugging authentication and document loading issues"})]}),e.jsxs($,{className:"mb-6",children:[e.jsxs(Z,{children:[e.jsxs(X,{className:"flex items-center justify-between",children:["Debug Tests",e.jsxs(R,{onClick:c,disabled:i,size:"sm",children:[e.jsx(mr,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),i?"Running...":"Run Tests"]})]}),e.jsx(ye,{children:"Testing authentication, database connection, and API functionality"})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:a.map((m,f)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[d(m.status),e.jsx("h3",{className:"font-medium",children:m.name})]}),e.jsx(ae,{className:h(m.status),children:m.status})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:m.message}),m.details&&e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer text-gray-500 hover:text-gray-700",children:"Show details"}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-100 rounded overflow-auto",children:JSON.stringify(m.details,null,2)})]})]},f))})})]}),e.jsxs($,{children:[e.jsx(Z,{children:e.jsx(X,{children:"Environment Information"})}),e.jsx(z,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Supabase URL:"}),e.jsx("p",{className:"text-gray-600",children:"https://kvlaydeyqidlfpfutbmp.supabase.co"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Environment:"}),e.jsx("p",{className:"text-gray-600",children:"production"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"User Agent:"}),e.jsx("p",{className:"text-gray-600 break-all",children:navigator.userAgent})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Current URL:"}),e.jsx("p",{className:"text-gray-600 break-all",children:window.location.href})]})]})})]})]})})},oW=()=>{const{user:r,loading:t,signIn:s,signOut:a}=ft(),n=async()=>{try{await s("test@example.com","password123")}catch(o){console.error("Test login failed:",o)}},i=async()=>{try{await a()}catch(o){console.error("Test logout failed:",o)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Auth Test Page"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Loading:"})," ",t?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"User:"})," ",r?r.email:"Not logged in"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:n,className:"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",disabled:t,children:"Test Login"}),e.jsx("button",{onClick:i,className:"w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700",disabled:t,children:"Test Logout"})]})]})]})})};class lW{constructor(){rs(this,"errors",[]);rs(this,"maxErrors",50);this.setupErrorHandlers()}setupErrorHandlers(){window.addEventListener("error",a=>{var n;this.logError({type:"error",message:a.message,stack:(n=a.error)==null?void 0:n.stack,url:a.filename,line:a.lineno,column:a.colno})}),window.addEventListener("unhandledrejection",a=>{var n;this.logError({type:"error",message:`Unhandled Promise Rejection: ${a.reason}`,stack:(n=a.reason)==null?void 0:n.stack})});const t=console.error,s=console.warn;console.error=(...a)=>{this.logError({type:"error",message:a.join(" ")}),t.apply(console,a)},console.warn=(...a)=>{this.logError({type:"warning",message:a.join(" ")}),s.apply(console,a)}}logError(t){const s={timestamp:new Date().toISOString(),type:"error",message:"Unknown error",userAgent:navigator.userAgent,...t};this.errors.push(s),this.errors.length>this.maxErrors&&(this.errors=this.errors.slice(-this.maxErrors))}getErrors(){return[...this.errors]}getErrorsByType(t){return this.errors.filter(s=>s.type===t)}getRecentErrors(t=5){const s=new Date(Date.now()-t*60*1e3);return this.errors.filter(a=>new Date(a.timestamp)>s)}clearErrors(){this.errors=[]}getErrorSummary(){return{total:this.errors.length,errors:this.errors.filter(s=>s.type==="error").length,warnings:this.errors.filter(s=>s.type==="warning").length,recent:this.getRecentErrors(5).length,mostCommon:this.getMostCommonErrors()}}getMostCommonErrors(){const t=this.errors.reduce((s,a)=>{const n=a.message.substring(0,100);return s[n]=(s[n]||0)+1,s},{});return Object.entries(t).sort(([,s],[,a])=>a-s).slice(0,5).map(([s,a])=>({message:s,count:a}))}exportErrors(){return JSON.stringify({timestamp:new Date().toISOString(),url:window.location.href,userAgent:navigator.userAgent,errors:this.errors,summary:this.getErrorSummary()},null,2)}}const cW=new lW;window.__errorTracker=cW;const dW=p.lazy(()=>Ns(()=>import("./PdfAnnotationsDemo-Ds5wn2OS.js"),__vite__mapDeps([5,1,2,3,0,6]))),uW=new ZF,hW=()=>e.jsx(rO,{client:uW,children:e.jsx(RM,{children:e.jsxs(OF,{children:[e.jsx(B6,{}),e.jsx(gF,{}),e.jsx(YD,{children:e.jsxs(JD,{children:[e.jsx(Et,{path:Ye.home,element:e.jsx(tL,{})}),e.jsx(Et,{path:"/law-firms",element:e.jsx(cL,{})}),e.jsx(Et,{path:"/law-firms/:id",element:e.jsx(b8,{})}),e.jsx(Et,{path:"/documents",element:e.jsx(_8,{})}),e.jsx(Et,{path:"/legal-qa",element:e.jsx(E8,{})}),e.jsx(Et,{path:"/legal-qa/:id",element:e.jsx(k8,{})}),e.jsx(Et,{path:Ye.pricing,element:e.jsx(oL,{})}),e.jsx(Et,{path:Ye.login,element:e.jsx(Sz,{})}),e.jsx(Et,{path:Ye.register,element:e.jsx(Dz,{})}),e.jsx(Et,{path:Ye.forgotPassword,element:e.jsx(Mz,{})}),e.jsx(Et,{path:Ye.resetPassword,element:e.jsx(zz,{})}),e.jsx(Et,{path:"/debug",element:e.jsx(Ez,{})}),e.jsx(Et,{path:"/debug/upload",element:e.jsx(Rz,{})}),e.jsx(Et,{path:"/debug-auth",element:e.jsx(iW,{})}),e.jsx(Et,{path:"/auth-test",element:e.jsx(oW,{})}),e.jsx(Et,{path:Ye.dashboard,element:e.jsx(Bz,{})}),e.jsx(Et,{path:Ye.documents,element:e.jsx(UV,{})}),e.jsx(Et,{path:"/dashboard/ai-assistant",element:e.jsx(qV,{})}),e.jsx(Et,{path:"/dashboard/templates",element:e.jsx(u7,{})}),e.jsx(Et,{path:"/dashboard/law-firms",element:e.jsx(h7,{})}),e.jsx(Et,{path:"/dashboard/admin",element:e.jsx(w7,{})}),e.jsx(Et,{path:"/dashboard/template-analytics",element:e.jsx(rW,{})}),e.jsx(Et,{path:"/dashboard/search-history",element:e.jsx(aW,{})}),e.jsx(Et,{path:"/dashboard/subscription",element:e.jsx(O7,{})}),e.jsx(Et,{path:"/dashboard/settings",element:e.jsx(L7,{})}),e.jsx(Et,{path:"/dashboard/security",element:e.jsx($7,{})}),e.jsx(Et,{path:"/subscribe/:tier",element:e.jsx(z7,{})}),e.jsx(Et,{path:"/payment/success",element:e.jsx(B7,{})}),e.jsx(Et,{path:"/payment/failure",element:e.jsx(q7,{})}),e.jsx(Et,{path:"/shared/:shareToken",element:e.jsx(W7,{})}),e.jsx(Et,{path:Ye.publicAnalysis,element:e.jsx(J7,{})}),e.jsx(Et,{path:`${Ye.publicAnalysisResult}/:analysisId`,element:e.jsx(Z7,{})}),e.jsx(Et,{path:Ye.templateBrowser,element:e.jsx(s_,{})}),e.jsx(Et,{path:Ye.templateMarketplace,element:e.jsx(s_,{})}),e.jsx(Et,{path:`${Ye.templatePreview}/:slug`,element:e.jsx(eW,{})}),e.jsx(Et,{path:`${Ye.templateCustomize}/:slug`,element:e.jsx(tW,{})}),e.jsx(Et,{path:"/templates/:slug/versions",element:e.jsx(sW,{})}),e.jsx(Et,{path:"/pdf-annotations-demo",element:e.jsx(p.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsx(dW,{})})}),e.jsx(Et,{path:"*",element:e.jsx(nW,{})})]})})]})})});I_(document.getElementById("root")).render(e.jsx(hW,{}));export{us as $,$ as A,R as B,Vg as C,_d as D,z as E,z5 as F,U5 as G,q5 as H,Pe as I,Od as J,Ln as K,Sr as L,Ft as M,ln as N,Vt as O,yx as P,dV as Q,XW as R,Ts as S,OF as T,cn as U,M5 as V,n6 as W,Q5 as X,Fh as Y,i6 as Z,Ns as _,CU as a,fs as a0,nN as a1,Gt as a2,fr as a3,nr as a4,Ge as a5,Fe as a6,Ei as a7,He as a8,Z as a9,X as aa,Hg as ab,_r as ac,is as ad,Ue as ae,Ej as b,me as c,LW as d,g$ as e,eN as f,AU as g,Ie as h,Nd as i,Yl as j,ur as k,wW as l,UW as m,jW as n,ae as o,MF as p,ZW as q,Yt as r,Po as s,rr as t,JW as u,aN as v,cc as w,Mo as x,Lo as y,Uo as z};
