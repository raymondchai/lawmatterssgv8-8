import{r as e,j as s}from"./react-vendor-C9QDz5CC.js";import{w as a,C as t,t as i,u as l,B as n,y as c,n as r,i as o,g as d,L as m,M as x,I as h,$ as u,J as j,a9 as p,p as g,q as f,r as y,s as N,N as w}from"./index-COrRy3_e.js";import{b as v,s as b,u as S}from"./forms-DacywvDT.js";import{c as A}from"./openai-BCgshE9S.js";import{s as k}from"./search-C2gYYNQ9.js";import{p as D,aS as I,U as q,F as L,aU as T,K as G,aY as U,aL as z,bZ as C,c0 as F,bx as Q,v as E,Z as P}from"./ui-components-M2RDdGkt.js";import"./supabase-DX_zaqH8.js";import"./data-fetching-Cw7dONgA.js";import"./utilities-DM8KXhwQ.js";import"./ai-services-BdAg_3mV.js";const R=v({message:b().min(1,"Please enter a message")}),AIChat=({className:p="",documentContext:g=[]})=>{const[f,y]=e.useState([]),[N,w]=e.useState(!1),[v,b]=e.useState(g),C=e.useRef(null),{user:F}=a(),{register:Q,handleSubmit:E,reset:P,formState:{errors:_}}=S({resolver:u(R)});e.useEffect(()=>{C.current?.scrollIntoView({behavior:"smooth"})},[f]),e.useEffect(()=>{0===f.length&&y([{id:"welcome",role:"assistant",content:"Hello! I'm your AI legal assistant. I can help you with:\n\n• Understanding legal documents\n• Answering questions about Singapore law\n• Explaining legal concepts and procedures\n• Providing guidance on legal matters\n\nPlease note that this is for informational purposes only and does not constitute legal advice. For specific legal matters, please consult with a qualified lawyer.\n\nHow can I help you today?",timestamp:new Date,confidence:1}])},[f.length]);return s.jsxs(t,{className:`flex flex-col h-[600px] ${p}`,children:[s.jsxs(i,{className:"pb-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(D,{className:"h-5 w-5 text-blue-600"}),s.jsx(l,{className:"text-lg",children:"AI Legal Assistant"})]}),f.length>1&&s.jsx(n,{variant:"outline",size:"sm",onClick:()=>{y([])},children:"Clear Chat"})]}),s.jsx(c,{children:"Ask questions about your documents or Singapore law"})]}),s.jsxs(r,{className:"flex-1 flex flex-col space-y-4 p-4",children:[s.jsx(o,{className:"flex-1 pr-4",children:s.jsxs("div",{className:"space-y-4",children:[f.map(e=>{return s.jsx("div",{className:"flex "+("user"===e.role?"justify-end":"justify-start"),children:s.jsx("div",{className:"max-w-[80%] rounded-lg p-3 "+("user"===e.role?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:s.jsxs("div",{className:"flex items-start space-x-2",children:["assistant"===e.role&&s.jsx(I,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),"user"===e.role&&s.jsx(q,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"whitespace-pre-wrap text-sm",children:e.content}),e.sources&&e.sources.length>0&&s.jsxs("div",{className:"mt-2 space-y-1",children:[s.jsx("div",{className:"text-xs opacity-75",children:"Sources:"}),e.sources.map((e,a)=>s.jsxs(d,{variant:"secondary",className:"text-xs",children:[s.jsx(L,{className:"h-3 w-3 mr-1"}),e]},a))]}),"assistant"===e.role&&void 0!==e.confidence&&s.jsxs("div",{className:"mt-2 flex items-center space-x-1",children:[e.confidence>=.8?s.jsx(T,{className:"h-3 w-3 text-green-500"}):e.confidence>=.5?s.jsx(G,{className:"h-3 w-3 text-yellow-500"}):s.jsx(G,{className:"h-3 w-3 text-red-500"}),s.jsx("span",{className:"text-xs opacity-75",children:e.confidence>=.8?"High confidence":e.confidence>=.5?"Medium confidence":"Low confidence"})]}),s.jsx("div",{className:"text-xs opacity-75 mt-1",children:(a=e.timestamp,a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))})]})]})})},e.id);var a}),N&&s.jsx("div",{className:"flex justify-start",children:s.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(I,{className:"h-4 w-4"}),s.jsx(U,{className:"h-4 w-4 animate-spin"}),s.jsx("span",{className:"text-sm text-gray-600",children:"Thinking..."})]})})}),s.jsx("div",{ref:C})]})}),s.jsxs(m,{children:[s.jsx(G,{className:"h-4 w-4"}),s.jsx(x,{className:"text-xs",children:"This AI assistant provides general information only and does not constitute legal advice. Consult a qualified lawyer for specific legal matters."})]}),s.jsxs("form",{onSubmit:E(async e=>{if(!F)return void j.error("Please log in to use the AI chat");const s={id:Date.now().toString(),role:"user",content:e.message,timestamp:new Date};y(e=>[...e,s]),w(!0),P();try{let s=[...v];if(e.message.length>10)try{const a=(await k({query:e.message,userId:F.id,maxResults:3,similarityThreshold:.6})).map(e=>e.chunk_text);s=[...s,...a]}catch(a){console.warn("Failed to get document context:",a)}const t=f.slice(-6).map(e=>({role:e.role,content:e.content})),i=await A(e.message,s,t),l={id:(Date.now()+1).toString(),role:"assistant",content:i.message,timestamp:new Date,sources:i.sources,confidence:i.confidence};y(e=>[...e,l])}catch(t){console.error("Chat error:",t);const e={id:(Date.now()+1).toString(),role:"assistant",content:"I apologize, but I encountered an error while processing your request. Please try again or rephrase your question.",timestamp:new Date,confidence:0};y(s=>[...s,e]),j.error("Failed to get AI response")}finally{w(!1)}}),className:"flex space-x-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(h,{...Q("message"),placeholder:"Ask a legal question...",disabled:N,className:"w-full"}),_.message&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:_.message.message})]}),s.jsx(n,{type:"submit",disabled:N,size:"sm",children:s.jsx(z,{className:"h-4 w-4"})})]})]})]})},AIAssistant=()=>{const[o,m]=e.useState([]),[x,h]=e.useState(!0),{user:u}=a();e.useEffect(()=>{u&&(async()=>{try{const e=(await w.getDocuments()).filter(e=>e.ocr_text&&"completed"===e.processing_status).sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,5);m(e)}catch(e){console.error("Failed to load recent documents:",e)}finally{h(!1)}})()},[u]);const j=[{icon:D,title:"Legal Q&A",description:"Ask questions about Singapore law and get instant answers",color:"text-blue-600"},{icon:L,title:"Document Analysis",description:"Get AI-powered insights from your uploaded documents",color:"text-green-600"},{icon:C,title:"Smart Search",description:"Find relevant information using semantic search",color:"text-purple-600"},{icon:P,title:"Quick Summaries",description:"Get concise summaries of complex legal documents",color:"text-yellow-600"}];return s.jsx(p,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"AI Legal Assistant"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Get instant help with legal questions and document analysis"})]}),s.jsxs(d,{variant:"secondary",className:"flex items-center space-x-1",children:[s.jsx(C,{className:"h-3 w-3"}),s.jsx("span",{children:"Powered by GPT-4"})]})]}),s.jsxs(g,{defaultValue:"chat",className:"space-y-6",children:[s.jsxs(f,{className:"grid w-full grid-cols-3",children:[s.jsx(y,{value:"chat",children:"AI Chat"}),s.jsx(y,{value:"features",children:"Features"}),s.jsx(y,{value:"tips",children:"Usage Tips"})]}),s.jsx(N,{value:"chat",className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsx(AIChat,{className:"h-[700px]"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(t,{children:[s.jsxs(i,{className:"pb-3",children:[s.jsxs(l,{className:"text-sm flex items-center space-x-2",children:[s.jsx(L,{className:"h-4 w-4"}),s.jsx("span",{children:"Recent Documents"})]}),s.jsx(c,{className:"text-xs",children:"Documents available for AI analysis"})]}),s.jsx(r,{className:"space-y-2",children:x?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):o.length>0?o.map(e=>s.jsxs("div",{className:"p-2 border rounded-lg",children:[s.jsx("div",{className:"text-sm font-medium truncate",children:e.filename}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]},e.id)):s.jsx("div",{className:"text-sm text-gray-500",children:"No processed documents yet. Upload some documents to get started!"})})]}),s.jsxs(t,{children:[s.jsx(i,{className:"pb-3",children:s.jsx(l,{className:"text-sm",children:"Quick Actions"})}),s.jsxs(r,{className:"space-y-2",children:[s.jsxs(n,{variant:"outline",size:"sm",className:"w-full justify-start",children:[s.jsx(F,{className:"h-4 w-4 mr-2"}),"Analyze Latest Document"]}),s.jsxs(n,{variant:"outline",size:"sm",className:"w-full justify-start",children:[s.jsx(Q,{className:"h-4 w-4 mr-2"}),"Legal Trend Analysis"]}),s.jsxs(n,{variant:"outline",size:"sm",className:"w-full justify-start",children:[s.jsx(E,{className:"h-4 w-4 mr-2"}),"Recent Legal Updates"]})]})]})]})]})}),s.jsx(N,{value:"features",className:"space-y-6",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:j.map((e,a)=>s.jsxs(t,{children:[s.jsxs(i,{children:[s.jsxs(l,{className:"flex items-center space-x-2",children:[s.jsx(e.icon,{className:`h-5 w-5 ${e.color}`}),s.jsx("span",{children:e.title})]}),s.jsx(c,{children:e.description})]}),s.jsx(r,{children:s.jsxs("div",{className:"text-sm text-gray-600",children:["Legal Q&A"===e.title&&s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• Ask about Singapore law and regulations"}),s.jsx("li",{children:"• Get explanations of legal concepts"}),s.jsx("li",{children:"• Understand legal procedures"})]}),"Document Analysis"===e.title&&s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• Extract key information from documents"}),s.jsx("li",{children:"• Identify important clauses and terms"}),s.jsx("li",{children:"• Get risk assessments"})]}),"Smart Search"===e.title&&s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• Find documents by meaning, not just keywords"}),s.jsx("li",{children:"• Discover related content"}),s.jsx("li",{children:"• Get contextual results"})]}),"Quick Summaries"===e.title&&s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• Get executive summaries"}),s.jsx("li",{children:"• Understand key points quickly"}),s.jsx("li",{children:"• Save time on document review"})]})]})})]},a))})}),s.jsxs(N,{value:"tips",className:"space-y-6",children:[s.jsxs(t,{children:[s.jsxs(i,{children:[s.jsx(l,{children:"How to Get the Best Results"}),s.jsx(c,{children:"Tips for effective AI interaction"})]}),s.jsx(r,{children:s.jsx("div",{className:"space-y-4",children:["Ask specific questions about your documents for better results","Use natural language - no need for legal jargon","Reference document names or types for context","Ask for explanations of legal terms or concepts","Request summaries of long documents"].map((e,a)=>s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-blue-600 text-sm font-medium",children:a+1})}),s.jsx("p",{className:"text-sm text-gray-700",children:e})]},a))})})]}),s.jsxs(t,{children:[s.jsxs(i,{children:[s.jsx(l,{children:"Example Questions"}),s.jsx(c,{children:"Try asking these types of questions"})]}),s.jsx(r,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-sm mb-2",children:"Document Questions"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("li",{children:'• "What are the key terms in my contract?"'}),s.jsx("li",{children:'• "Summarize the main points of this agreement"'}),s.jsx("li",{children:'• "What are the payment obligations?"'})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-sm mb-2",children:"Legal Questions"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("li",{children:'• "What is the process for company incorporation in Singapore?"'}),s.jsx("li",{children:'• "Explain employment law requirements"'}),s.jsx("li",{children:'• "What are the data protection obligations?"'})]})]})]})})]})]})]})]})})};export{AIAssistant as default};
