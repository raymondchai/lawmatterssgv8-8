import{r as i,aJ as H,j as e,o as E,aT as C,aY as W,F as k,aV as $,aK as D,a_ as J,aL as V,cl as q,cp as Z,bG as K,v as Y,Z as O}from"./react-vendor-DgOuH3B5.js";import{y as F,C as m,u as x,v as h,B as g,z as j,o as u,j as X,h as G,L as ee,M as se,I as te,a9 as ae,aa as ne,q as ie,r as le,s as T,t as I,N as ce}from"./ai-services-DbCQJDXZ.js";import{o as re,s as oe,t as de}from"./forms-zYe9FhTN.js";import{s as me}from"./search-DX30jBWv.js";import{J as R}from"./vendor-DXfpcdns.js";import"./ui-components-BA32w1ww.js";import"./data-fetching-C9PAuT9r.js";import"./ocr-worker-CHC1Ilq1.js";import"./pdf-worker-D8bnToiL.js";import"./supabase-B5_W4sir.js";import"./utilities-x5TAO4by.js";const xe=re({message:oe().min(1,"Please enter a message")}),he=({className:f="",documentContext:w=[]})=>{const[l,c]=i.useState([]),[o,y]=i.useState(!1),[v,t]=i.useState(w),a=i.useRef(null),{user:N}=F(),{register:d,handleSubmit:b,reset:z,formState:{errors:L}}=H({resolver:de(xe)});i.useEffect(()=>{var s;(s=a.current)==null||s.scrollIntoView({behavior:"smooth"})},[l]),i.useEffect(()=>{l.length===0&&c([{id:"welcome",role:"assistant",content:`Hello! I'm your AI legal assistant. I can help you with:

• Understanding legal documents
• Answering questions about Singapore law
• Explaining legal concepts and procedures
• Providing guidance on legal matters

Please note that this is for informational purposes only and does not constitute legal advice. For specific legal matters, please consult with a qualified lawyer.

How can I help you today?`,timestamp:new Date,confidence:1}])},[l.length]);const U=async s=>{if(!N){R.error("Please log in to use the AI chat");return}const A={id:Date.now().toString(),role:"user",content:s.message,timestamp:new Date};c(n=>[...n,A]),y(!0),z();try{let n=[...v];if(s.message.length>10)try{const _=(await me({query:s.message,userId:N.id,maxResults:3,similarityThreshold:.6})).map(B=>B.chunk_text);n=[...n,..._]}catch(r){console.warn("Failed to get document context:",r)}const S=l.slice(-6).map(r=>({role:r.role,content:r.content})),p=await ae(s.message,n,S),P={id:(Date.now()+1).toString(),role:"assistant",content:p.message,timestamp:new Date,sources:p.sources,confidence:p.confidence};c(r=>[...r,P])}catch(n){console.error("Chat error:",n);const S={id:(Date.now()+1).toString(),role:"assistant",content:"I apologize, but I encountered an error while processing your request. Please try again or rephrase your question.",timestamp:new Date,confidence:0};c(p=>[...p,S]),R.error("Failed to get AI response")}finally{y(!1)}},Q=()=>{c([])},M=s=>s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsxs(m,{className:`flex flex-col h-[600px] ${f}`,children:[e.jsxs(x,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600"}),e.jsx(h,{className:"text-lg",children:"AI Legal Assistant"})]}),l.length>1&&e.jsx(g,{variant:"outline",size:"sm",onClick:Q,children:"Clear Chat"})]}),e.jsx(j,{children:"Ask questions about your documents or Singapore law"})]}),e.jsxs(u,{className:"flex-1 flex flex-col space-y-4 p-4",children:[e.jsx(X,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-4",children:[l.map(s=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${s.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[s.role==="assistant"&&e.jsx(C,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),s.role==="user"&&e.jsx(W,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"whitespace-pre-wrap text-sm",children:s.content}),s.sources&&s.sources.length>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("div",{className:"text-xs opacity-75",children:"Sources:"}),s.sources.map((A,n)=>e.jsxs(G,{variant:"secondary",className:"text-xs",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),A]},n))]}),s.role==="assistant"&&s.confidence!==void 0&&e.jsxs("div",{className:"mt-2 flex items-center space-x-1",children:[s.confidence>=.8?e.jsx($,{className:"h-3 w-3 text-green-500"}):s.confidence>=.5?e.jsx(D,{className:"h-3 w-3 text-yellow-500"}):e.jsx(D,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{className:"text-xs opacity-75",children:s.confidence>=.8?"High confidence":s.confidence>=.5?"Medium confidence":"Low confidence"})]}),e.jsx("div",{className:"text-xs opacity-75 mt-1",children:M(s.timestamp)})]})]})})},s.id)),o&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsx(J,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Thinking..."})]})})}),e.jsx("div",{ref:a})]})}),e.jsxs(ee,{children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx(se,{className:"text-xs",children:"This AI assistant provides general information only and does not constitute legal advice. Consult a qualified lawyer for specific legal matters."})]}),e.jsxs("form",{onSubmit:b(U),className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(te,{...d("message"),placeholder:"Ask a legal question...",disabled:o,className:"w-full"}),L.message&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:L.message.message})]}),e.jsx(g,{type:"submit",disabled:o,size:"sm",children:e.jsx(V,{className:"h-4 w-4"})})]})]})]})},Se=()=>{const[f,w]=i.useState([]),[l,c]=i.useState(!0),{user:o}=F();i.useEffect(()=>{o&&(async()=>{try{const N=(await ce.getDocuments()).filter(d=>d.ocr_text&&d.processing_status==="completed").sort((d,b)=>new Date(b.created_at).getTime()-new Date(d.created_at).getTime()).slice(0,5);w(N)}catch(a){console.error("Failed to load recent documents:",a)}finally{c(!1)}})()},[o]);const y=[{icon:E,title:"Legal Q&A",description:"Ask questions about Singapore law and get instant answers",color:"text-blue-600"},{icon:k,title:"Document Analysis",description:"Get AI-powered insights from your uploaded documents",color:"text-green-600"},{icon:q,title:"Smart Search",description:"Find relevant information using semantic search",color:"text-purple-600"},{icon:O,title:"Quick Summaries",description:"Get concise summaries of complex legal documents",color:"text-yellow-600"}],v=["Ask specific questions about your documents for better results","Use natural language - no need for legal jargon","Reference document names or types for context","Ask for explanations of legal terms or concepts","Request summaries of long documents"];return e.jsx(ne,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"AI Legal Assistant"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Get instant help with legal questions and document analysis"})]}),e.jsxs(G,{variant:"secondary",className:"flex items-center space-x-1",children:[e.jsx(q,{className:"h-3 w-3"}),e.jsx("span",{children:"Powered by GPT-4"})]})]}),e.jsxs(ie,{defaultValue:"chat",className:"space-y-6",children:[e.jsxs(le,{className:"grid w-full grid-cols-3",children:[e.jsx(T,{value:"chat",children:"AI Chat"}),e.jsx(T,{value:"features",children:"Features"}),e.jsx(T,{value:"tips",children:"Usage Tips"})]}),e.jsx(I,{value:"chat",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(he,{className:"h-[700px]"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(m,{children:[e.jsxs(x,{className:"pb-3",children:[e.jsxs(h,{className:"text-sm flex items-center space-x-2",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Recent Documents"})]}),e.jsx(j,{className:"text-xs",children:"Documents available for AI analysis"})]}),e.jsx(u,{className:"space-y-2",children:l?e.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):f.length>0?f.map(t=>e.jsxs("div",{className:"p-2 border rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:t.filename}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleDateString()})]},t.id)):e.jsx("div",{className:"text-sm text-gray-500",children:"No processed documents yet. Upload some documents to get started!"})})]}),e.jsxs(m,{children:[e.jsx(x,{className:"pb-3",children:e.jsx(h,{className:"text-sm",children:"Quick Actions"})}),e.jsxs(u,{className:"space-y-2",children:[e.jsxs(g,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Analyze Latest Document"]}),e.jsxs(g,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Legal Trend Analysis"]}),e.jsxs(g,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Recent Legal Updates"]})]})]})]})]})}),e.jsx(I,{value:"features",className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map((t,a)=>e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(t.icon,{className:`h-5 w-5 ${t.color}`}),e.jsx("span",{children:t.title})]}),e.jsx(j,{children:t.description})]}),e.jsx(u,{children:e.jsxs("div",{className:"text-sm text-gray-600",children:[t.title==="Legal Q&A"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Ask about Singapore law and regulations"}),e.jsx("li",{children:"• Get explanations of legal concepts"}),e.jsx("li",{children:"• Understand legal procedures"})]}),t.title==="Document Analysis"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Extract key information from documents"}),e.jsx("li",{children:"• Identify important clauses and terms"}),e.jsx("li",{children:"• Get risk assessments"})]}),t.title==="Smart Search"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Find documents by meaning, not just keywords"}),e.jsx("li",{children:"• Discover related content"}),e.jsx("li",{children:"• Get contextual results"})]}),t.title==="Quick Summaries"&&e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Get executive summaries"}),e.jsx("li",{children:"• Understand key points quickly"}),e.jsx("li",{children:"• Save time on document review"})]})]})})]},a))})}),e.jsxs(I,{value:"tips",className:"space-y-6",children:[e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"How to Get the Best Results"}),e.jsx(j,{children:"Tips for effective AI interaction"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:v.map((t,a)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 text-sm font-medium",children:a+1})}),e.jsx("p",{className:"text-sm text-gray-700",children:t})]},a))})})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsx(h,{children:"Example Questions"}),e.jsx(j,{children:"Try asking these types of questions"})]}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Document Questions"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:'• "What are the key terms in my contract?"'}),e.jsx("li",{children:'• "Summarize the main points of this agreement"'}),e.jsx("li",{children:'• "What are the payment obligations?"'})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Legal Questions"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:'• "What is the process for company incorporation in Singapore?"'}),e.jsx("li",{children:'• "Explain employment law requirements"'}),e.jsx("li",{children:'• "What are the data protection obligations?"'})]})]})]})})]})]})]})]})})};export{Se as default};
